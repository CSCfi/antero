USE [VipunenTK_SA]
GO
/****** Object:  View [dbo].[v_sa_2_9_Korkeakoulut_tutkinnot]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_9_Korkeakoulut_tutkinnot]
GO
/****** Object:  View [dbo].[v_sa_2_8e_Korkeakoulut_opiskelijat]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_8e_Korkeakoulut_opiskelijat]
GO
/****** Object:  View [dbo].[v_sa_2_8_Korkeakoulut_opiskelijat]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_8_Korkeakoulut_opiskelijat]
GO
/****** Object:  View [dbo].[v_sa_2_7_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet_jarjestajittain]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_7_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet_jarjestajittain]
GO
/****** Object:  View [dbo].[v_sa_2_6_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_6_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet]
GO
/****** Object:  View [dbo].[v_sa_2_5_Lukiokoulutuksen_ainevalinnat]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_5_Lukiokoulutuksen_ainevalinnat]
GO
/****** Object:  View [dbo].[v_sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot]
GO
/****** Object:  View [dbo].[v_sa_2_4_Amm_koulutuksen_tutkinnot]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_4_Amm_koulutuksen_tutkinnot]
GO
/****** Object:  View [dbo].[v_sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat]
GO
/****** Object:  View [dbo].[v_sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat]
GO
/****** Object:  View [dbo].[v_sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat]
GO
/****** Object:  View [dbo].[v_sa_2_23_Opisk_ja_tutksuor_vanh_aseman_muk]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_23_Opisk_ja_tutksuor_vanh_aseman_muk]
GO
/****** Object:  View [dbo].[v_sa_2_21_Lukio_ammpk_opisk_tutk]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_21_Lukio_ammpk_opisk_tutk]
GO
/****** Object:  View [dbo].[v_sa_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan]
GO
/****** Object:  View [dbo].[v_sa_2_18_Paivahoidossa_jarjestettava_esiopetus]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_18_Paivahoidossa_jarjestettava_esiopetus]
GO
/****** Object:  View [dbo].[v_sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan]
GO
/****** Object:  View [dbo].[v_sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan]
GO
/****** Object:  View [dbo].[v_sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan]
GO
/****** Object:  View [dbo].[v_sa_2_11_Oppilaitosten_tutkintoon_johtamaton]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_11_Oppilaitosten_tutkintoon_johtamaton]
GO
/****** Object:  View [dbo].[v_sa_2_10_Korkeakouluopiskelijoiden_aikaisempi_koulutus]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_sa_2_10_Korkeakouluopiskelijoiden_aikaisempi_koulutus]
GO
/****** Object:  View [dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
GO
/****** Object:  View [dbo].[v_K3_12_Perusk_paattaneet_amm_tutk_suorittaneet]    Script Date: 4.4.2019 18:09:00 ******/
DROP VIEW IF EXISTS [dbo].[v_K3_12_Perusk_paattaneet_amm_tutk_suorittaneet]
GO
/****** Object:  View [dbo].[v_K3_12_Perusk_paattaneet_amm_tutk_suorittaneet]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_K3_12_Perusk_paattaneet_amm_tutk_suorittaneet]'))
EXEC dbo.sp_executesql @statement = N'




/* LUE TÄMÄ:
KOPIOI KAKSI ALINTA SELECTIÄ JA MUUTA NIISSÄ KAIKKIIN KOHTIIN VUOSI+1
*/

CREATE VIEW [dbo].[v_K3_12_Perusk_paattaneet_amm_tutk_suorittaneet] AS

SELECT [tilv]
      ,[tilv_date]
      ,(case when [tutkryh] is NULL then '''' else [tutkryh] end ) as [tutkryh]
      ,(case when [suorv] is NULL then '''' else [suorv] end ) as [suorv]
	  ,(case when [suorlk] is NULL then '''' else [suorlk] end ) as [suorlk]
	  ,(case when [sp] is NULL then '''' else [sp] end ) as [sp]
      ,(case when [syntv]=''19XX'' or [syntv] is NULL then '''' else [syntv] end ) as [syntv]
	  ,(case when [aikielir1] is NULL then '''' else [aikielir1] end ) as [aikielir1]
      ,(case 
			when [tutkaskun]=''427'' then '''' 
			when [tutkaskun]=''946'' and (tilv= ''2009'' or tilv=''2010'') then ''945''
			when [tutkaskun]=''198'' then ''''
			when [tutkaskun]=''999'' then ''''
			when [tutkaskun] is NULL then '''' 
			else [tutkaskun] 
		end) as [tutkaskun]
      ,(case when [kansalr1] is NULL then '''' else [kansalr1] end ) as [kansalr1]
	  ,(case when [pohjmaa] is NULL then '''' else [pohjmaa] end ) as [pohjmaa]
      ,(case when [eumaa] is NULL then '''' else [eumaa] end ) as [eumaa]
      ,(case when [etamaa] is NULL then '''' else [etamaa] end ) as [etamaa]
      ,(case 
			 when [tunn] = ''BBBBB'' then ''''
			 when [tunn] = ''99999'' then ''''
			 when [tunn] = ''00000'' then '''' 
			 when [tunn] = ''90009'' AND [tilv] = ''2009'' then ''''
			 when [tunn] = ''90015'' AND [tilv] = ''2009'' then ''''
			 when [tunn] = ''90010'' AND [tilv] = ''2009'' then ''''
			 when [tunn] = ''90018'' AND [tilv] = ''2009'' then ''''
			 when [tunn] = ''90008'' AND [tilv] = ''2010'' then ''''
			 when [tunn] = ''90032'' AND [tilv] = ''2010'' then ''''
			 when [tunn] = ''90032'' AND [tilv] = ''2011'' then ''''
			 when [tunn] = ''90018'' AND [tilv] = ''2011'' then ''''
			 when [tunn] = ''90006'' AND [tilv] = ''2009'' then ''''
			 when [tunn] = ''90006'' AND [tilv] = ''2010'' then ''''
			 when [tunn] = ''90006'' AND [tilv] = ''2011'' then ''''
			 when [tunn] = ''90018'' AND [tilv] = ''2012'' then ''''
			 when [tunn] is NULL then '''' 
			 else [tunn] 
		end) as [tunn]
      ,(case when [jarj] is NULL then '''' else [jarj] end ) as [jarj]
      ,(case when [kkielir1] is NULL then '''' else [kkielir1] end ) as [kkielir1]
      ,(case when [tutklaja] is NULL then '''' else [tutklaja] end ) as [tutklaja]
      ,(case when [tutktav] is NULL then '''' else [tutktav] end ) as [tutktav]
      ,(case when [aikoul] is NULL then '''' else [aikoul] end ) as [aikoul]
      ,(case 
			when [tutkmaak] = ''99'' then ''''
			when [tutkmaak] is NULL then '''' 
			else [tutkmaak] 
		end) as [tutkmaak]
	  ,(case when [luopiskkoulk_1] is NULL then '''' else [luopiskkoulk_1] end ) as [luopiskkoulk_1]
	  ,(case 
			when [luopisktunn_1] = ''BBBBB'' then ''''
			when [luopisktunn_1] = ''99999'' then ''''
			when [luopisktunn_1] = ''00000'' then '''' 
			when [luopisktunn_1] is NULL then '''' 
			else [luopisktunn_1] 
		end) as [luopisktunn_1]
	  ,(case when [luopiskjarj_1] is NULL then '''' else [luopiskjarj_1] end ) as [luopiskjarj_1]
	  ,(case 
			when [luopiskmaak_1] = ''99'' then ''''
			when [luopiskmaak_1] is NULL then '''' 
			else [luopiskmaak_1] 
		end) as [luopiskmaak_1]
      ,(case when [ammopiskkoulk_1] is NULL then '''' else [ammopiskkoulk_1] end ) as [ammopiskkoulk_1]
	  ,(case 
			when [ammopisktunn_1] = ''BBBBB'' then ''''
			when [ammopisktunn_1] = ''99999'' then ''''
			when [ammopisktunn_1] = ''00000'' then ''''
			when [ammopisktunn_1] = ''90009'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_1] = ''90015'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_1] = ''90010'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_1] = ''90018'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_1] = ''90008'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_1] = ''90032'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_1] = ''90032'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_1] = ''90018'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_1] = ''90006'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_1] = ''90006'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_1] = ''90006'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_1] = ''90018'' AND [tilv] = ''2012'' then ''''
			when [ammopisktunn_1] is NULL then '''' 
			else [ammopisktunn_1] 
		end) as [ammopisktunn_1]
	  ,(case when [ammopiskjarj_1] is NULL then '''' else [ammopiskjarj_1] end ) as [ammopiskjarj_1]
	  ,(case 
			when [ammopiskmaak_1] = ''99'' then ''''
			when [ammopiskmaak_1] is NULL then '''' 
			else [ammopiskmaak_1] 
		end) as [ammopiskmaak_1]
	  ,(case when [amkopiskkoulk_1] is NULL then '''' else [amkopiskkoulk_1] end ) as [amkopiskkoulk_1]
	  ,(case 
			when [amkopisktunn_1] = ''BBBBB'' then ''''
			when [amkopisktunn_1] = ''99999'' then '''' 
			when [amkopisktunn_1] = ''00000'' then ''''
			when [amkopisktunn_1] is NULL then '''' 
			else [amkopisktunn_1] 
		end) as [amkopisktunn_1]
	  ,(case when [amkopiskjarj_1] is NULL then '''' else [amkopiskjarj_1] end ) as [amkopiskjarj_1]
	  ,(case 
			when [amkopiskmaak_1] = ''99'' then ''''
			when [amkopiskmaak_1] is NULL then '''' 
			else [amkopiskmaak_1] 
		end) as [amkopiskmaak_1]
      ,(case when [yoopiskkoulk_1] is NULL then '''' else [yoopiskkoulk_1] end ) as [yoopiskkoulk_1]
	  ,(case 
			when [yoopisktunn_1] = ''BBBBB'' then ''''
			when [yoopisktunn_1] = ''99999'' then ''''
			when [yoopisktunn_1] = ''00000'' then ''''
			when [yoopisktunn_1] is NULL then '''' 
			else [yoopisktunn_1] 
		end) as [yoopisktunn_1]
	  ,(case when [yoopiskjarj_1] is NULL then '''' else [yoopiskjarj_1] end ) as [yoopiskjarj_1]
	  ,(case 
			when [yoopiskmaak_1] = ''99'' then ''''
			when [yoopiskmaak_1] is NULL then '''' 
			else [yoopiskmaak_1] 
		end) as [yoopiskmaak_1]
      ,(case when [monihaku_1] is NULL then '''' else [monihaku_1] end ) as [monihaku_1]
	  ,(case when [ptoim1r4_1] is NULL then '''' else [ptoim1r4_1] end ) as [ptoim1r4_1]
	  ,(case when [amas_1] is NULL then '''' else [amas_1] end ) as [amas_1]  
      ,(case when [luopiskkoulk_2] is NULL then '''' else [luopiskkoulk_2] end ) as [luopiskkoulk_2]
	  ,(case 
			when [luopisktunn_2] = ''BBBBB'' then ''''
			when [luopisktunn_2] = ''99999'' then ''''
			when [luopisktunn_2] = ''00000'' then ''''
			when [luopisktunn_2] is NULL then '''' 
			else [luopisktunn_2] 
		end) as [luopisktunn_2]
	  ,(case when [luopiskjarj_2] is NULL then '''' else [luopiskjarj_2] end ) as [luopiskjarj_2]
	  ,(case 
			when [luopiskmaak_2] = ''99'' then ''''
			when [luopiskmaak_2] is NULL then '''' 
			else [luopiskmaak_2] 
		end) as [luopiskmaak_2]
      ,(case when [ammopiskkoulk_2] is NULL then '''' else [ammopiskkoulk_2] end ) as [ammopiskkoulk_2]
	  ,(case 
			when [ammopisktunn_2] = ''BBBBB'' then ''''
			when [ammopisktunn_2] = ''99999'' then ''''
			when [ammopisktunn_2] = ''00000'' then '''' 
			when [ammopisktunn_2] = ''90009'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_2] = ''90015'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_2] = ''90010'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_2] = ''90018'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_2] = ''90008'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_2] = ''90032'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_2] = ''90032'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_2] = ''90018'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_2] = ''90006'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_2] = ''90006'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_2] = ''90006'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_2] = ''90018'' AND [tilv] = ''2012'' then ''''
			when [ammopisktunn_2] is NULL then '''' 
			else [ammopisktunn_2] 
		end) as [ammopisktunn_2]
	  ,(case when [ammopiskjarj_2] is NULL then '''' else [ammopiskjarj_2] end ) as [ammopiskjarj_2]
	  ,(case 
			when [ammopiskmaak_2] = ''99'' then ''''
			when [ammopiskmaak_2] is NULL then '''' 
			else [ammopiskmaak_2] 
		end) as [ammopiskmaak_2]
	  ,(case when [amkopiskkoulk_2] is NULL then '''' else [amkopiskkoulk_2] end ) as [amkopiskkoulk_2]
	  ,(case 
			when [amkopisktunn_2] = ''BBBBB'' then ''''
			when [amkopisktunn_2] = ''99999'' then '''' 
			when [amkopisktunn_2] = ''00000'' then ''''
			when [amkopisktunn_2] is NULL then '''' 
			else [amkopisktunn_2] 
		end) as [amkopisktunn_2]
	  ,(case when [amkopiskjarj_2] is NULL then '''' else [amkopiskjarj_2] end ) as [amkopiskjarj_2]
	  ,(case 
			when [amkopiskmaak_2] = ''99'' then ''''
			when [amkopiskmaak_2] is NULL then '''' 
			else [amkopiskmaak_2] 
		end) as [amkopiskmaak_2]
      ,(case when [yoopiskkoulk_2] is NULL then '''' else [yoopiskkoulk_2] end ) as [yoopiskkoulk_2]
	  ,(case 
			when [yoopisktunn_2] = ''BBBBB'' then ''''
			when [yoopisktunn_2] = ''99999'' then ''''
			when [yoopisktunn_2] = ''00000'' then ''''
			when [yoopisktunn_2] is NULL then '''' else [yoopisktunn_2] end ) as [yoopisktunn_2]
	  ,(case when [yoopiskjarj_2] is NULL then '''' else [yoopiskjarj_2] end ) as [yoopiskjarj_2]
	  ,(case 
			when [yoopiskmaak_2] = ''99'' then ''''
			when [yoopiskmaak_2] is NULL then '''' 
			else [yoopiskmaak_2] 
		end) as [yoopiskmaak_2]
      ,(case when [monihaku_2] is NULL then '''' else [monihaku_2] end ) as [monihaku_2]
	  ,(case when [ptoim1r4_2] is NULL then '''' else [ptoim1r4_2] end ) as [ptoim1r4_2]
	  ,(case when [amas_2] is NULL then '''' else [amas_2] end ) as [amas_2]
      ,[lkm]
	  ,(case when [pohjkoul] is NULL then '''' else [pohjkoul] end ) as [pohjkoul]
      ,[tietolahde]
      ,[rivinumero]
FROM (


SELECT
tilv, 
CAST(tilv + ''0101'' AS date) AS tilv_date,
tutkryh,
suorv,
suorlk,
sp,
syntv,
aikielir1,
tutkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
tunn,
jarj,
kkielir1,
tutklaja,
tutktav,
aikoul,
tutkmaak,  
luopiskkoulk_2008 as luopiskkoulk_1,
luopisktunn_2008 AS luopisktunn_1,
luopiskjarj_2008 as luopiskjarj_1, 
luopiskmaak_2008 AS luopiskmaak_1, 
ammopiskkoulk_2008 as ammopiskkoulk_1, 
ammopisktunn_2008 AS ammopisktunn_1,
ammopiskjarj_2008 as ammopiskjarj_1, 
ammopiskmaak_2008 as ammopiskmaak_1, 
amkopiskkoulk_2008 as amkopiskkoulk_1, 
amkopisktunn_2008 AS amkopisktunn_1,
amkopiskjarj_2008 as amkopiskjarj_1,
amkopiskmaak_2008 AS amkopiskmaak_1, 
yoopiskkoulk_2008 as yoopiskkoulk_1, 
yoopisktunn_2008 AS yoopisktunn_1,
yoopiskjarj_2008 as yoopiskjarj_1,
yoopiskmaak_2008 AS yoopiskmaak_1,
monihaku_2008 as monihaku_1, 
ptoim1r4_2008 as ptoim1r4_1, 
amas_2008 as amas_1,  
luopiskkoulk_2009 as luopiskkoulk_2,
luopisktunn_2009 AS luopisktunn_2,
luopiskjarj_2009 as luopiskjarj_2, 
luopiskmaak_2009 AS luopiskmaak_2, 
ammopiskkoulk_2009 as ammopiskkoulk_2, 
ammopisktunn_2009 AS ammopisktunn_2,
ammopiskjarj_2009 as ammopiskjarj_2, 
ammopiskmaak_2009 as ammopiskmaak_2, 
amkopiskkoulk_2009 as amkopiskkoulk_2, 
amkopisktunn_2009 AS amkopisktunn_2,
amkopiskjarj_2009 as amkopiskjarj_2,
amkopiskmaak_2009 AS amkopiskmaak_2, 
yoopiskkoulk_2009 as yoopiskkoulk_2, 
yoopisktunn_2009 AS yoopisktunn_2,
yoopiskjarj_2009 as yoopiskjarj_2,
yoopiskmaak_2009 AS yoopiskmaak_2,
monihaku_2009 as monihaku_2, 
ptoim1r4_2009 as ptoim1r4_2, 
amas_2009 as amas_2, 
lkm, 
pohjkoul,
tietolahde=''K3_12_sopv_11'',
rivinumero = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_12_sopv_11]
where suorv = ''2008'' and (suorlk = ''1'' or suorlk= ''2'')
 
UNION ALL
 
SELECT
tilv, 
CAST(tilv + ''0101'' AS date) AS tilv_date,
tutkryh,
suorv,
suorlk,
sp,
syntv,
aikielir1,
tutkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
tunn,
jarj,
kkielir1,
tutklaja,
tutktav,
aikoul,
tutkmaak,  
luopiskkoulk_2009 as luopiskkoulk_1,
luopisktunn_2009 AS luopisktunn_1,
luopiskjarj_2009 as luopiskjarj_1, 
luopiskmaak_2009 AS luopiskmaak_1, 
ammopiskkoulk_2009 as ammopiskkoulk__1, 
ammopisktunn_2009 AS ammopisktunn_1,
ammopiskjarj_2009 as ammopiskjarj_1, 
ammopiskmaak_2009 as ammopiskmaak_1, 
amkopiskkoulk_2009 as amkopiskkoulk_1, 
amkopisktunn_2009 AS amkopisktunn_1,
amkopiskjarj_2009 as amkopiskjarj_1,
amkopiskmaak_2009 AS amkopiskmaak_1, 
yoopiskkoulk_2009 as yoopiskkoulk_1, 
yoopisktunn_2009 AS yoopisktunn_1,
yoopiskjarj_2009 as yoopiskjarj_1,
yoopiskmaak_2009 AS yoopiskmaak_1,
monihaku_2009 as monihaku_1, 
ptoim1r4_2009 as ptoim1r4_1, 
amas_2009 as amas_1,  
luopiskkoulk_2010 as luopiskkoulk_2,
luopisktunn_2010 AS luopisktunn_2,
luopiskjarj_2010 as luopiskjarj_2, 
luopiskmaak_2010 AS luopiskmaak_2, 
ammopiskkoulk_2010 as ammopiskkoulk_2, 
ammopisktunn_2010 AS ammopisktunn_2,
ammopiskjarj_2010 as ammopiskjarj_2, 
ammopiskmaak_2010 as ammopiskmaak_2, 
amkopiskkoulk_2010 as amkopiskkoulk_2, 
amkopisktunn_2010 AS amkopisktunn_2,
amkopiskjarj_2010 as amkopiskjarj_2,
amkopiskmaak_2010 AS amkopiskmaak_2, 
yoopiskkoulk_2010 as yoopiskkoulk_2, 
yoopisktunn_2010 AS yoopisktunn_2,
yoopiskjarj_2010 as yoopiskjarj_2,
yoopiskmaak_2010 AS yoopiskmaak_2,
monihaku_2010 as monihaku_2, 
ptoim1r4_2010 as ptoim1r4_2, 
amas_2010 as amas_2, 
lkm, 
pohjkoul,
tietolahde=''K3_12_sopv_12'',
rivinumero = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_12_sopv_12]
where suorv = ''2009'' and (suorlk = ''1'' or suorlk= ''2'')


UNION ALL
 
SELECT
tilv, 
CAST(tilv + ''0101'' AS date) AS tilv_date,
tutkryh,
suorv,
suorlk,
sp,
syntv,
aikielir1,
tutkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
tunn,
jarj,
kkielir1,
tutklaja,
tutktav,
aikoul,
tutkmaak,  
luopiskkoulk_2010 as luopiskkoulk_1,
luopisktunn_2010 AS luopisktunn_1,
luopiskjarj_2010 as luopiskjarj_1, 
luopiskmaak_2010 AS luopiskmaak_1, 
ammopiskkoulk_2010 as ammopiskkoulk__1, 
ammopisktunn_2010 AS ammopisktunn_1,
ammopiskjarj_2010 as ammopiskjarj_1, 
ammopiskmaak_2010 as ammopiskmaak_1, 
amkopiskkoulk_2010 as amkopiskkoulk_1, 
amkopisktunn_2010 AS amkopisktunn_1,
amkopiskjarj_2010 as amkopiskjarj_1,
amkopiskmaak_2010 AS amkopiskmaak_1, 
yoopiskkoulk_2010 as yoopiskkoulk_1, 
yoopisktunn_2010 AS yoopisktunn_1,
yoopiskjarj_2010 as yoopiskjarj_1,
yoopiskmaak_2010 AS yoopiskmaak_1,
monihaku_2010 as monihaku_1, 
ptoim1r4_2010 as ptoim1r4_1, 
amas_2010 as amas_1,  
luopiskkoulk_2011 as luopiskkoulk_2,
luopisktunn_2011 AS luopisktunn_2,
luopiskjarj_2011 as luopiskjarj_2, 
luopiskmaak_2011 AS luopiskmaak_2, 
ammopiskkoulk_2011 as ammopiskkoulk_2, 
ammopisktunn_2011 AS ammopisktunn_2,
ammopiskjarj_2011 as ammopiskjarj_2, 
ammopiskmaak_2011 as ammopiskmaak_2, 
amkopiskkoulk_2011 as amkopiskkoulk_2, 
amkopisktunn_2011 AS amkopisktunn_2,
amkopiskjarj_2011 as amkopiskjarj_2,
amkopiskmaak_2011 AS amkopiskmaak_2, 
yoopiskkoulk_2011 as yoopiskkoulk_2, 
yoopisktunn_2011 AS yoopisktunn_2,
yoopiskjarj_2011 as yoopiskjarj_2,
yoopiskmaak_2011 AS yoopiskmaak_2,
monihaku_2011 as monihaku_2, 
ptoim1r4_2011 as ptoim1r4_2, 
amas_2011 as amas_2, 
lkm, 
pohjkoul,
tietolahde =''K3_12_sopv_13'',
rivinumero = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_12_sopv_13]
where suorv = ''2010'' and (suorlk = ''1'' or suorlk= ''2'')


UNION ALL
 
SELECT
tilv, 
CAST(tilv + ''0101'' AS date) AS tilv_date,
tutkryh,
suorv,
suorlk,
sp,
syntv,
aikielir1,
tutkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
tunn,
jarj,
kkielir1,
tutklaja,
tutktav,
aikoul,
tutkmaak,  
luopiskkoulk_2011 as luopiskkoulk_1,
luopisktunn_2011 AS luopisktunn_1,
luopiskjarj_2011 as luopiskjarj_1, 
luopiskmaak_2011 AS luopiskmaak_1, 
ammopiskkoulk_2011 as ammopiskkoulk__1, 
ammopisktunn_2011 AS ammopisktunn_1,
ammopiskjarj_2011 as ammopiskjarj_1, 
ammopiskmaak_2011 as ammopiskmaak_1, 
amkopiskkoulk_2011 as amkopiskkoulk_1, 
amkopisktunn_2011 AS amkopisktunn_1,
amkopiskjarj_2011 as amkopiskjarj_1,
amkopiskmaak_2011 AS amkopiskmaak_1, 
yoopiskkoulk_2011 as yoopiskkoulk_1, 
yoopisktunn_2011 AS yoopisktunn_1,
yoopiskjarj_2011 as yoopiskjarj_1,
yoopiskmaak_2011 AS yoopiskmaak_1,
monihaku_2011 as monihaku_1, 
ptoim1r4_2011 as ptoim1r4_1, 
amas_2011 as amas_1,  
luopiskkoulk_2012 as luopiskkoulk_2,
luopisktunn_2012 AS luopisktunn_2,
luopiskjarj_2012 as luopiskjarj_2, 
luopiskmaak_2012 AS luopiskmaak_2, 
ammopiskkoulk_2012 as ammopiskkoulk_2, 
ammopisktunn_2012 AS ammopisktunn_2,
ammopiskjarj_2012 as ammopiskjarj_2, 
ammopiskmaak_2012 as ammopiskmaak_2, 
amkopiskkoulk_2012 as amkopiskkoulk_2, 
amkopisktunn_2012 AS amkopisktunn_2,
amkopiskjarj_2012 as amkopiskjarj_2,
amkopiskmaak_2012 AS amkopiskmaak_2, 
yoopiskkoulk_2012 as yoopiskkoulk_2, 
yoopisktunn_2012 AS yoopisktunn_2,
yoopiskjarj_2012 as yoopiskjarj_2,
yoopiskmaak_2012 AS yoopiskmaak_2,
monihaku_2012 as monihaku_2, 
ptoim1r4_2012 as ptoim1r4_2, 
amas_2012 as amas_2, 
lkm, 
pohjkoul,
tietolahde =''K3_12_sopv_14'',
rivinumero = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_12_sopv_14]
where suorv = ''2011'' and (suorlk = ''1'' or suorlk= ''2'')

UNION ALL
 
SELECT
tilv, 
CAST(tilv + ''0101'' AS date) AS tilv_date,
tutkryh,
suorv,
suorlk,
sp,
syntv,
aikielir1,
tutkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
tunn,
jarj,
kkielir1,
tutklaja,
tutktav,
aikoul,
tutkmaak,  
luopiskkoulk_2012 as luopiskkoulk_1,
luopisktunn_2012 AS luopisktunn_1,
luopiskjarj_2012 as luopiskjarj_1, 
luopiskmaak_2012 AS luopiskmaak_1, 
ammopiskkoulk_2012 as ammopiskkoulk__1, 
ammopisktunn_2012 AS ammopisktunn_1,
ammopiskjarj_2012 as ammopiskjarj_1, 
ammopiskmaak_2012 as ammopiskmaak_1, 
amkopiskkoulk_2012 as amkopiskkoulk_1, 
amkopisktunn_2012 AS amkopisktunn_1,
amkopiskjarj_2012 as amkopiskjarj_1,
amkopiskmaak_2012 AS amkopiskmaak_1, 
yoopiskkoulk_2012 as yoopiskkoulk_1, 
yoopisktunn_2012 AS yoopisktunn_1,
yoopiskjarj_2012 as yoopiskjarj_1,
yoopiskmaak_2012 AS yoopiskmaak_1,
monihaku_2012 as monihaku_1, 
ptoim1r4_2012 as ptoim1r4_1, 
amas_2012 as amas_1,  
luopiskkoulk_2013 as luopiskkoulk_2,
luopisktunn_2013 AS luopisktunn_2,
luopiskjarj_2013 as luopiskjarj_2, 
luopiskmaak_2013 AS luopiskmaak_2, 
ammopiskkoulk_2013 as ammopiskkoulk_2, 
ammopisktunn_2013 AS ammopisktunn_2,
ammopiskjarj_2013 as ammopiskjarj_2, 
ammopiskmaak_2013 as ammopiskmaak_2, 
amkopiskkoulk_2013 as amkopiskkoulk_2, 
amkopisktunn_2013 AS amkopisktunn_2,
amkopiskjarj_2013 as amkopiskjarj_2,
amkopiskmaak_2013 AS amkopiskmaak_2, 
yoopiskkoulk_2013 as yoopiskkoulk_2, 
yoopisktunn_2013 AS yoopisktunn_2,
yoopiskjarj_2013 as yoopiskjarj_2,
yoopiskmaak_2013 AS yoopiskmaak_2,
monihaku_2013 as monihaku_2, 
ptoim1r4_2013 as ptoim1r4_2, 
amas_2013 as amas_2, 
lkm, 
pohjkoul,
tietolahde=''K3_12_sopv_15'',
rivinumero = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_12_sopv_15]
where suorv = ''2012'' and (suorlk = ''1'' or suorlk= ''2'')

UNION ALL
 
SELECT
tilv, 
CAST(tilv + ''0101'' AS date) AS tilv_date,
tutkryh,
suorv,
suorlk,
sp,
syntv,
aikielir1,
tutkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
tunn,
jarj,
kkielir1,
tutklaja,
tutktav,
aikoul,
tutkmaak,  
luopiskkoulk_2013 as luopiskkoulk_1,
luopisktunn_2013 AS luopisktunn_1,
luopiskjarj_2013 as luopiskjarj_1, 
luopiskmaak_2013 AS luopiskmaak_1, 
ammopiskkoulk_2013 as ammopiskkoulk__1, 
ammopisktunn_2013 AS ammopisktunn_1,
ammopiskjarj_2013 as ammopiskjarj_1, 
ammopiskmaak_2013 as ammopiskmaak_1, 
amkopiskkoulk_2013 as amkopiskkoulk_1, 
amkopisktunn_2013 AS amkopisktunn_1,
amkopiskjarj_2013 as amkopiskjarj_1,
amkopiskmaak_2013 AS amkopiskmaak_1, 
yoopiskkoulk_2013 as yoopiskkoulk_1, 
yoopisktunn_2013 AS yoopisktunn_1,
yoopiskjarj_2013 as yoopiskjarj_1,
yoopiskmaak_2013 AS yoopiskmaak_1,
monihaku_2013 as monihaku_1, 
ptoim1r4_2013 as ptoim1r4_1, 
amas_2013 as amas_1,  
luopiskkoulk_2014 as luopiskkoulk_2,
luopisktunn_2014 AS luopisktunn_2,
luopiskjarj_2014 as luopiskjarj_2, 
luopiskmaak_2014 AS luopiskmaak_2, 
ammopiskkoulk_2014 as ammopiskkoulk_2, 
ammopisktunn_2014 AS ammopisktunn_2,
ammopiskjarj_2014 as ammopiskjarj_2, 
ammopiskmaak_2014 as ammopiskmaak_2, 
amkopiskkoulk_2014 as amkopiskkoulk_2, 
amkopisktunn_2014 AS amkopisktunn_2,
amkopiskjarj_2014 as amkopiskjarj_2,
amkopiskmaak_2014 AS amkopiskmaak_2, 
yoopiskkoulk_2014 as yoopiskkoulk_2, 
yoopisktunn_2014 AS yoopisktunn_2,
yoopiskjarj_2014 as yoopiskjarj_2,
yoopiskmaak_2014 AS yoopiskmaak_2,
monihaku_2014 as monihaku_2, 
ptoim1r4_2014 as ptoim1r4_2, 
amas_2014 as amas_2, 
lkm, 
pohjkoul,
tietolahde =''K3_12_sopv_16'',
rivinumero = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_12_sopv_16] 
where suorv = ''2013'' and (suorlk = ''1'' or suorlk= ''2'')

UNION ALL
 
SELECT
tilv, 
CAST(tilv + ''0101'' AS date) AS tilv_date,
tutkryh,
suorv,
suorlk,
sp,
syntv,
aikielir1,
tutkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
tunn,
jarj,
kkielir1,
tutklaja,
tutktav,
aikoul,
tutkmaak,  
luopiskkoulk_2014 as luopiskkoulk_1,
luopisktunn_2014 AS luopisktunn_1,
luopiskjarj_2014 as luopiskjarj_1, 
luopiskmaak_2014 AS luopiskmaak_1, 
ammopiskkoulk_2014 as ammopiskkoulk__1, 
ammopisktunn_2014 AS ammopisktunn_1,
ammopiskjarj_2014 as ammopiskjarj_1, 
ammopiskmaak_2014 as ammopiskmaak_1, 
amkopiskkoulk_2014 as amkopiskkoulk_1, 
amkopisktunn_2014 AS amkopisktunn_1,
amkopiskjarj_2014 as amkopiskjarj_1,
amkopiskmaak_2014 AS amkopiskmaak_1, 
yoopiskkoulk_2014 as yoopiskkoulk_1, 
yoopisktunn_2014 AS yoopisktunn_1,
yoopiskjarj_2014 as yoopiskjarj_1,
yoopiskmaak_2014 AS yoopiskmaak_1,
monihaku_2014 as monihaku_1, 
ptoim1r4_2014 as ptoim1r4_1, 
amas_2014 as amas_1,  
luopiskkoulk_2015 as luopiskkoulk_2,
luopisktunn_2015 AS luopisktunn_2,
luopiskjarj_2015 as luopiskjarj_2, 
luopiskmaak_2015 AS luopiskmaak_2, 
ammopiskkoulk_2015 as ammopiskkoulk_2, 
ammopisktunn_2015 AS ammopisktunn_2,
ammopiskjarj_2015 as ammopiskjarj_2, 
ammopiskmaak_2015 as ammopiskmaak_2, 
amkopiskkoulk_2015 as amkopiskkoulk_2, 
amkopisktunn_2015 AS amkopisktunn_2,
amkopiskjarj_2015 as amkopiskjarj_2,
amkopiskmaak_2015 AS amkopiskmaak_2, 
yoopiskkoulk_2015 as yoopiskkoulk_2, 
yoopisktunn_2015 AS yoopisktunn_2,
yoopiskjarj_2015 as yoopiskjarj_2,
yoopiskmaak_2015 AS yoopiskmaak_2,
monihaku_2015 as monihaku_2, 
ptoim1r4_2015 as ptoim1r4_2, 
amas_2015 as amas_2, 
lkm, 
pohjkoul,
tietolahde=''K3_12_sopv_17'',
rivinumero = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_12_sopv_17] 
where suorv = ''2014'' and (suorlk = ''1'' or suorlk= ''2'')

UNION ALL
 
SELECT
tilv, 
CAST(tilv + ''0101'' AS date) AS tilv_date,
tutkryh,
suorv,
suorlk,
sp,
syntv,
aikielir1,
tutkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
tunn,
jarj,
kkielir1,
tutklaja,
tutktav,
aikoul,
tutkmaak,  
luopiskkoulk_2015 as luopiskkoulk_1,
luopisktunn_2015 AS luopisktunn_1,
luopiskjarj_2015 as luopiskjarj_1, 
luopiskmaak_2015 AS luopiskmaak_1, 
ammopiskkoulk_2015 as ammopiskkoulk__1, 
ammopisktunn_2015 AS ammopisktunn_1,
ammopiskjarj_2015 as ammopiskjarj_1, 
ammopiskmaak_2015 as ammopiskmaak_1, 
amkopiskkoulk_2015 as amkopiskkoulk_1, 
amkopisktunn_2015 AS amkopisktunn_1,
amkopiskjarj_2015 as amkopiskjarj_1,
amkopiskmaak_2015 AS amkopiskmaak_1, 
yoopiskkoulk_2015 as yoopiskkoulk_1, 
yoopisktunn_2015 AS yoopisktunn_1,
yoopiskjarj_2015 as yoopiskjarj_1,
yoopiskmaak_2015 AS yoopiskmaak_1,
monihaku_2015 as monihaku_1, 
ptoim1r4_2015 as ptoim1r4_1, 
amas_2015 as amas_1,  
luopiskkoulk_2016 as luopiskkoulk_2,
luopisktunn_2016 AS luopisktunn_2,
luopiskjarj_2016 as luopiskjarj_2, 
luopiskmaak_2016 AS luopiskmaak_2, 
ammopiskkoulk_2016 as ammopiskkoulk_2, 
ammopisktunn_2016 AS ammopisktunn_2,
ammopiskjarj_2016 as ammopiskjarj_2, 
ammopiskmaak_2016 as ammopiskmaak_2, 
amkopiskkoulk_2016 as amkopiskkoulk_2, 
amkopisktunn_2016 AS amkopisktunn_2,
amkopiskjarj_2016 as amkopiskjarj_2,
amkopiskmaak_2016 AS amkopiskmaak_2, 
yoopiskkoulk_2016 as yoopiskkoulk_2, 
yoopisktunn_2016 AS yoopisktunn_2,
yoopiskjarj_2016 as yoopiskjarj_2,
yoopiskmaak_2016 AS yoopiskmaak_2,
monihaku_2016 as monihaku_2, 
ptoim1r4_2016 as ptoim1r4_2, 
amas_2016 as amas_2, 
lkm, 
pohjkoul,
tietolahde=''K3_12_sopv_18'',
rivinumero = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_12_sopv_18] 
WHERE suorv = ''2015 '' and (suorlk = ''1'' or suorlk= ''2'')

UNION ALL
 
SELECT
tilv, 
CAST(tilv + ''0101'' AS date) AS tilv_date,
tutkryh,
suorv,
suorlk,
sp,
syntv,
aikielir1,
tutkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
tunn,
jarj,
kkielir1,
tutklaja,
tutktav,
aikoul,
tutkmaak,  
luopiskkoulk_2016 as luopiskkoulk_1,
luopisktunn_2016 AS luopisktunn_1,
luopiskjarj_2016 as luopiskjarj_1, 
luopiskmaak_2016 AS luopiskmaak_1, 
ammopiskkoulk_2016 as ammopiskkoulk__1, 
ammopisktunn_2016 AS ammopisktunn_1,
ammopiskjarj_2016 as ammopiskjarj_1, 
ammopiskmaak_2016 as ammopiskmaak_1, 
amkopiskkoulk_2016 as amkopiskkoulk_1, 
amkopisktunn_2016 AS amkopisktunn_1,
amkopiskjarj_2016 as amkopiskjarj_1,
amkopiskmaak_2016 AS amkopiskmaak_1, 
yoopiskkoulk_2016 as yoopiskkoulk_1, 
yoopisktunn_2016 AS yoopisktunn_1,
yoopiskjarj_2016 as yoopiskjarj_1,
yoopiskmaak_2016 AS yoopiskmaak_1,
monihaku_2016 as monihaku_1, 
ptoim1r4_2016 as ptoim1r4_1, 
amas_2016 as amas_1,  
luopiskkoulk_2017 as luopiskkoulk_2,
luopisktunn_2017 AS luopisktunn_2,
luopiskjarj_2017 as luopiskjarj_2, 
luopiskmaak_2017 AS luopiskmaak_2, 
ammopiskkoulk_2017 as ammopiskkoulk_2, 
ammopisktunn_2017 AS ammopisktunn_2,
ammopiskjarj_2017 as ammopiskjarj_2, 
ammopiskmaak_2017 as ammopiskmaak_2, 
amkopiskkoulk_2017 as amkopiskkoulk_2, 
amkopisktunn_2017 AS amkopisktunn_2,
amkopiskjarj_2017 as amkopiskjarj_2,
amkopiskmaak_2017 AS amkopiskmaak_2, 
yoopiskkoulk_2017 as yoopiskkoulk_2, 
yoopisktunn_2017 AS yoopisktunn_2,
yoopiskjarj_2017 as yoopiskjarj_2,
yoopiskmaak_2017 AS yoopiskmaak_2,
monihaku_2017 as monihaku_2, 
ptoim1r4_2017 as ptoim1r4_2, 
amas_2017 as amas_2, 
lkm, 
pohjkoul,
tietolahde=''K3_12_sopv_19'',
rivinumero = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_12_sopv_19] 
WHERE suorv = ''2016 '' and (suorlk = ''1'' or suorlk= ''2'')
UNION ALL

--haetaan myös uusimman tilastovuoden välittömän sijoittumisen tiedot mikäli seuraavaa aineistoa ei ole vielä saatavilla
SELECT
tilv, 
CAST(tilv + ''0101'' AS date) AS tilv_date,
tutkryh,
suorv,
suorlk,
sp,
syntv,
aikielir1,
tutkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
tunn,
jarj,
kkielir1,
tutklaja,
tutktav,
aikoul,
tutkmaak,  
luopiskkoulk_2016 as luopiskkoulk_1,
luopisktunn_2016 AS luopisktunn_1,
luopiskjarj_2016 as luopiskjarj_1, 
luopiskmaak_2016 AS luopiskmaak_1, 
ammopiskkoulk_2016 as ammopiskkoulk__1, 
ammopisktunn_2016 AS ammopisktunn_1,
ammopiskjarj_2016 as ammopiskjarj_1, 
ammopiskmaak_2016 as ammopiskmaak_1, 
amkopiskkoulk_2016 as amkopiskkoulk_1, 
amkopisktunn_2016 AS amkopisktunn_1,
amkopiskjarj_2016 as amkopiskjarj_1,
amkopiskmaak_2016 AS amkopiskmaak_1, 
yoopiskkoulk_2016 as yoopiskkoulk_1, 
yoopisktunn_2016 AS yoopisktunn_1,
yoopiskjarj_2016 as yoopiskjarj_1,
yoopiskmaak_2016 AS yoopiskmaak_1,
monihaku_2016 as monihaku_1, 
ptoim1r4_2016 as ptoim1r4_1, 
amas_2016 as amas_1,  
luopiskkoulk_2 = '''',
luopisktunn_2 = '''',
luopiskjarj_2 = '''', 
luopiskmaak_2 = '''', 
ammopiskkoulk_2 = '''', 
ammopisktunn_2 = '''',
ammopiskjarj_2 = '''', 
ammopiskmaak_2 = '''', 
amkopiskkoulk_2 = '''', 
amkopisktunn_2 = '''',
amkopiskjarj_2 = '''',
amkopiskmaak_2 = '''', 
yoopiskkoulk_2 = '''', 
yoopisktunn_2 = '''',
yoopiskjarj_2 = '''',
yoopiskmaak_2 = '''',
monihaku_2 = '''', 
ptoim1r4_2 = '''', 
amas_2 = '''', 
lkm, 
pohjkoul,
tietolahde=''K3_12_sopv_19'',
rivinumero = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_12_sopv_19] 
where 
suorv = (CASE 
			WHEN NOT EXISTS (SELECT TOP 1 1 FROM TK_H9098_CSC.sys.tables t INNER JOIN TK_H9098_CSC.sys.partitions p on t.object_id = p.object_id WHERE t.name = ''TK_K3_12_sopv_20'' and p.rows > 0) THEN ''2017''
		 END)
and suorlk = ''1''

 ) Aineistot


 










' 
GO
/****** Object:  View [dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]'))
EXEC dbo.sp_executesql @statement = N'




CREATE VIEW [dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet] as
SELECT
	   [tilv]
	  ,[tilv_date]
	  ,(case when [tutkryh] is NULL then '''' else [tutkryh] end ) as [tutkryh]
      ,(case when [suorv] is NULL then '''' else [suorv] end ) as [suorv]
	  ,(case when [suorlk] is NULL then '''' else [suorlk] end ) as [suorlk]
	  ,(case when [sp] is NULL then '''' else [sp] end ) as [sp]
      ,(case 
			when [syntv] = ''19XX'' then ''''
			when [syntv] is NULL then '''' 
			else [syntv] 
		end) as [syntv]
	  ,(case when [aikielir1] is NULL then '''' else [aikielir1] end ) as [aikielir1]
      ,(case 
			when [tutkaskun]=''427'' then ''''
			when [tutkaskun]= ''946'' and (tilv= ''2009'' or tilv=''2010'') then ''945''
			when [tutkaskun]= ''198'' then ''''
			when [tutkaskun]= ''168'' then '''' 
			when [tutkaskun]= ''999'' then ''''
			when [tutkaskun] is NULL then '''' 
			else [tutkaskun] 
		end) as [tutkaskun]
      ,(case when [kansalr1] is NULL then '''' else [kansalr1] end ) as [kansalr1]
      ,(case when [pohjmaa] is NULL then '''' else [pohjmaa] end ) as [pohjmaa]
      ,(case when [eumaa] is NULL then '''' else [eumaa] end ) as [eumaa]
      ,(case when [etamaa] is NULL then '''' else [etamaa] end ) as [etamaa]
      ,(case 
			when [tunn] = ''BBBBB'' then ''''
			when [tunn] = ''99999'' then ''''
			when [tunn] = ''00000'' then '''' 
			when [tunn] = ''90009'' AND [tilv] = ''2009'' then ''''
			when [tunn] = ''90015'' AND [tilv] = ''2009'' then ''''
			when [tunn] = ''90010'' AND [tilv] = ''2009'' then ''''
			when [tunn] = ''90018'' AND [tilv] = ''2009'' then ''''
			when [tunn] = ''90008'' AND [tilv] = ''2010'' then ''''
			when [tunn] = ''90032'' AND [tilv] = ''2010'' then ''''
			when [tunn] = ''90032'' AND [tilv] = ''2011'' then ''''
			when [tunn] = ''90018'' AND [tilv] = ''2011'' then ''''
			when [tunn] = ''90006'' AND [tilv] = ''2009'' then ''''
			when [tunn] = ''90006'' AND [tilv] = ''2010'' then ''''
			when [tunn] = ''90006'' AND [tilv] = ''2011'' then ''''
			when [tunn] = ''90010'' AND [tilv] = ''2010'' then ''''
			when [tunn] = ''90010'' AND [tilv] = ''2011'' then ''''
			when [tunn] = ''90008'' AND [tilv] = ''2011'' then ''''
			when [tunn] = ''90018'' AND [tilv] = ''2010'' then ''''
			when [tunn] = ''90018'' AND [tilv] = ''2011'' then ''''
			when [tunn] = ''90018'' AND [tilv] = ''2012'' then ''''
			when [tunn] is NULL then '''' 
			else [tunn] 
		end) as [tunn]
      ,(case when [jarj] is NULL then '''' else [jarj] end ) as [jarj]
      ,(case when [kkielir1] is NULL then '''' else [kkielir1] end ) as [kkielir1]
      ,(case when [tutklaja] is NULL then '''' else [tutklaja] end ) as [tutklaja]
      ,(case when [tutktav] is NULL then '''' else [tutktav] end ) as [tutktav]
      ,(case when [aikoul] is NULL then '''' else [aikoul] end ) as [aikoul]
      ,(case 
			when [tutkmaak] = ''99'' then ''''
			when [tutkmaak] is NULL then '''' 
			else [tutkmaak] 
		end) as [tutkmaak]
	  ,(case when [luopiskkoulk_1] is NULL then '''' else [luopiskkoulk_1] end ) as [luopiskkoulk_1]
	  ,(case 
			when [luopisktunn_1] = ''BBBBB'' then ''''
			when [luopisktunn_1] = ''99999'' then ''''
			when [luopisktunn_1] is NULL then '''' 
			else [luopisktunn_1] 
		end) as [luopisktunn_1]
	  ,(case when [luopiskjarj_1] is NULL then '''' else [luopiskjarj_1] end ) as [luopiskjarj_1]
	  ,(case 
			when [luopiskmaak_1] = ''99'' then ''''
			when [luopiskmaak_1] is NULL then '''' 
			else [luopiskmaak_1] 
		end) as [luopiskmaak_1]
	  ,(case when [ammopiskkoulk_1] is NULL then '''' else [ammopiskkoulk_1] end ) as [ammopiskkoulk_1]
	  ,(case 
			when [ammopisktunn_1] = ''BBBBB'' then ''''
			when [ammopisktunn_1] = ''99999'' then ''''
			when [ammopisktunn_1] = ''00000'' then ''''
			when [ammopisktunn_1] = ''90009'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_1] = ''90015'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_1] = ''90010'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_1] = ''90018'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_1] = ''90008'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_1] = ''90032'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_1] = ''90032'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_1] = ''90018'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_1] = ''90006'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_1] = ''90006'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_1] = ''90006'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_1] = ''90010'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_1] = ''90010'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_1] = ''90008'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_1] = ''90018'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_1] = ''90018'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_1] = ''90018'' AND [tilv] = ''2012'' then ''''
			when [ammopisktunn_1] is NULL then '''' 
			else [ammopisktunn_1] 
		end) as [ammopisktunn_1]
	  ,(case when [ammopiskjarj_1] is NULL then '''' else [ammopiskjarj_1] end ) as [ammopiskjarj_1]
	  ,(case 
			when [ammopiskmaak_1] = ''99'' then ''''
			when [ammopiskmaak_1] is NULL then '''' 
			else [ammopiskmaak_1] 
		end) as [ammopiskmaak_1]
	  ,(case when [amkopiskkoulk_1] is NULL then '''' else [amkopiskkoulk_1] end ) as [amkopiskkoulk_1]
	  ,(case 
			when [amkopisktunn_1] = ''BBBBB'' then ''''
			when [amkopisktunn_1] = ''99999'' then ''''
			when [amkopisktunn_1] is NULL then '''' 
			else [amkopisktunn_1] 
		end) as [amkopisktunn_1]
	  ,(case when [amkopiskjarj_1] is NULL then '''' else [amkopiskjarj_1] end ) as [amkopiskjarj_1]
	  ,(case 
			when [amkopiskmaak_1] = ''99'' then ''''
			when [amkopiskmaak_1] is NULL then '''' 
			else [amkopiskmaak_1] 
		end) as [amkopiskmaak_1]
      ,(case when [yoopiskkoulk_1] is NULL then '''' else [yoopiskkoulk_1] end ) as [yoopiskkoulk_1]
	  ,(case 
			when [yoopisktunn_1] = ''BBBBB'' then ''''
			when [yoopisktunn_1] = ''99999'' then ''''
			when [yoopisktunn_1] is NULL then '''' 
			else [yoopisktunn_1] 
		end) as [yoopisktunn_1]
	  ,(case when [yoopiskjarj_1] is NULL then '''' else [yoopiskjarj_1] end ) as [yoopiskjarj_1]
	  ,(case 
			when [yoopiskmaak_1] = ''99'' then ''''
			when [yoopiskmaak_1] is NULL then '''' 
			else [yoopiskmaak_1] 
		end) as [yoopiskmaak_1]
      ,(case when [monihaku_1] is NULL then '''' else [monihaku_1] end ) as [monihaku_1]
	  ,(case when [ptoim1r4_1] is NULL then '''' else [ptoim1r4_1] end ) as [ptoim1r4_1]
      ,(case when [amas_1] is NULL then '''' else [amas_1] end ) as [amas_1]
      ,(case when [luopiskkoulk_2] is NULL then '''' else [luopiskkoulk_2] end ) as [luopiskkoulk_2]
	  ,(case 
			when [luopisktunn_2] = ''BBBBB'' then ''''
			when [luopisktunn_2] = ''99999'' then ''''
			when [luopisktunn_2] is NULL then '''' 
			else [luopisktunn_2] 
		end) as [luopisktunn_2]
	  ,(case when [luopiskjarj_2] is NULL then '''' else [luopiskjarj_2] end ) as [luopiskjarj_2]
      ,(case 
			when [luopiskmaak_2] = ''99'' then ''''
			when [luopiskmaak_2] is NULL then '''' 
			else [luopiskmaak_2] 
		end) as [luopiskmaak_2]
	  ,(case when [ammopiskkoulk_2] is NULL then '''' else [ammopiskkoulk_2] end ) as [ammopiskkoulk_2]
	  ,(case 
			when [ammopisktunn_2] = ''BBBBB'' then ''''
			when [ammopisktunn_2] = ''99999'' then ''''
			when [ammopisktunn_2] = ''00000'' then ''''
			when [ammopisktunn_2] = ''90009'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_2] = ''90015'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_2] = ''90010'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_2] = ''90018'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_2] = ''90008'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_2] = ''90032'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_2] = ''90032'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_2] = ''90018'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_2] = ''90006'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_2] = ''90006'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_2] = ''90006'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_2] = ''90010'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_2] = ''90010'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_2] = ''90008'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_2] = ''90018'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_2] = ''90018'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_2] = ''90018'' AND [tilv] = ''2012'' then ''''
			when [ammopisktunn_2] is NULL then '''' 
			else [ammopisktunn_2] 
		end) as [ammopisktunn_2]
	  ,(case when [ammopiskjarj_2] is NULL then '''' else [ammopiskjarj_2] end ) as [ammopiskjarj_2]
	  ,(case 
			when [ammopiskmaak_2] = ''99'' then ''''
			when [ammopiskmaak_2] is NULL then '''' 
			else [ammopiskmaak_2] 
		end) as [ammopiskmaak_2]
	  ,(case when [amkopiskkoulk_2] is NULL then '''' else [amkopiskkoulk_2] end ) as [amkopiskkoulk_2]
	  ,(case 
			when [amkopisktunn_2] = ''BBBBB'' then ''''
			when [amkopisktunn_2] = ''99999'' then ''''
			when [amkopisktunn_2] is NULL then '''' 
			else [amkopisktunn_2] 
		end) as [amkopisktunn_2]
	  ,(case when [amkopiskjarj_2] is NULL then '''' else [amkopiskjarj_2] end ) as [amkopiskjarj_2]
	  ,(case 
			when [amkopiskmaak_2] = ''99'' then ''''
			when [amkopiskmaak_2] is NULL then '''' 
			else [amkopiskmaak_2] 
		end) as [amkopiskmaak_2]
      ,(case when [yoopiskkoulk_2] is NULL then '''' else [yoopiskkoulk_2] end ) as [yoopiskkoulk_2]
	  ,(case 
			when [yoopisktunn_2] = ''BBBBB'' then ''''
			when [yoopisktunn_2] = ''99999'' then ''''
			when [yoopisktunn_2] is NULL then '''' 
			else [yoopisktunn_2] 
		end) as [yoopisktunn_2]
	  ,(case when [yoopiskjarj_2] is NULL then '''' else [yoopiskjarj_2] end ) as [yoopiskjarj_2]
	  ,(case 
			when [yoopiskmaak_2] = ''99'' then ''''
			when [yoopiskmaak_2] is NULL then '''' 
			else [yoopiskmaak_2] 
		end) as [yoopiskmaak_2]
      ,(case when [monihaku_2] is NULL then '''' else [monihaku_2] end ) as [monihaku_2]
	  ,(case when [ptoim1r4_2] is NULL then '''' else [ptoim1r4_2] end ) as [ptoim1r4_2]
      ,(case when [amas_2] is NULL then '''' else [amas_2] end ) as [amas_2]
      ,(case when [luopiskkoulk_3] is NULL then '''' else [luopiskkoulk_3] end ) as [luopiskkoulk_3]
	  ,(case 
			when [luopisktunn_3] = ''BBBBB'' then ''''
			when [luopisktunn_3] = ''99999'' then ''''
			when [luopisktunn_3] is NULL then '''' 
			else [luopisktunn_3] 
		end) as [luopisktunn_3]
	  ,(case when [luopiskjarj_3] is NULL then '''' else [luopiskjarj_3] end ) as [luopiskjarj_3]
	  ,(case 
			when [luopiskmaak_3] = ''99'' then ''''
			when [luopiskmaak_3] is NULL then '''' 
			else [luopiskmaak_3] 
		end) as [luopiskmaak_3]
	  ,(case when [ammopiskkoulk_3] is NULL then '''' else [ammopiskkoulk_3] end ) as [ammopiskkoulk_3]
	  ,(case 
			when [ammopisktunn_3] = ''BBBBB'' then ''''
			when [ammopisktunn_3] = ''99999'' then ''''
			when [ammopisktunn_3] = ''00000'' then ''''
			when [ammopisktunn_3] = ''90009'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_3] = ''90015'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_3] = ''90010'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_3] = ''90018'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_3] = ''90008'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_3] = ''90032'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_3] = ''90032'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_3] = ''90018'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_3] = ''90006'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_3] = ''90006'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_3] = ''90006'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_3] = ''90010'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_3] = ''90010'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_3] = ''90008'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_3] = ''90018'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_3] = ''90018'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_3] = ''90018'' AND [tilv] = ''2012'' then ''''
			when [ammopisktunn_3] is NULL then '''' 
			else [ammopisktunn_3] 
		end) as [ammopisktunn_3]
	  ,(case when [ammopiskjarj_3] is NULL then '''' else [ammopiskjarj_3] end ) as [ammopiskjarj_3]
	  ,(case 
			when [ammopiskmaak_3] = ''99'' then ''''
			when [ammopiskmaak_3] is NULL then '''' 
			else [ammopiskmaak_3] 
		end) as [ammopiskmaak_3]
	  ,(case when [amkopiskkoulk_3] is NULL then '''' else [amkopiskkoulk_3] end ) as [amkopiskkoulk_3]
	  ,(case 
			when [amkopisktunn_3] = ''BBBBB'' then ''''
			when [amkopisktunn_3] = ''99999'' then ''''
			when [amkopisktunn_3] is NULL then '''' 
			else [amkopisktunn_3] 
		end) as [amkopisktunn_3]
	  ,(case when [amkopiskjarj_3] is NULL then '''' else [amkopiskjarj_3] end ) as [amkopiskjarj_3]
	  ,(case 
			when [amkopiskmaak_3] = ''99'' then ''''
			when [amkopiskmaak_3] is NULL then '''' 
			else [amkopiskmaak_3] 
		end) as [amkopiskmaak_3]
      ,(case when [yoopiskkoulk_3] is NULL then '''' else [yoopiskkoulk_3] end ) as [yoopiskkoulk_3]
	  ,(case 
			when [yoopisktunn_3] = ''BBBBB'' then ''''
			when [yoopisktunn_3] = ''99999'' then ''''
			when [yoopisktunn_3] is NULL then '''' 
			else [yoopisktunn_3] 
		end) as [yoopisktunn_3]
	  ,(case when [yoopiskjarj_3] is NULL then '''' else [yoopiskjarj_3] end ) as [yoopiskjarj_3]
	  ,(case 
			when [yoopiskmaak_3] = ''99'' then ''''
			when [yoopiskmaak_3] is NULL then '''' 
			else [yoopiskmaak_3] 
		end) as [yoopiskmaak_3]
      ,(case when [monihaku_3] is NULL then '''' else [monihaku_3] end ) as [monihaku_3]
	  ,(case when [ptoim1r4_3] is NULL then '''' else [ptoim1r4_3] end ) as [ptoim1r4_3]
      ,(case when [amas_3] is NULL then '''' else [amas_3] end ) as [amas_3]
      ,(case when [luopiskkoulk_4] is NULL then '''' else [luopiskkoulk_4] end ) as [luopiskkoulk_4]
	  ,(case 
			when [luopisktunn_4] = ''BBBBB'' then ''''
			when [luopisktunn_4] = ''99999'' then ''''
			when [luopisktunn_4] is NULL then '''' 
			else [luopisktunn_4] 
		end) as [luopisktunn_4]
	  ,(case when [luopiskjarj_4] is NULL then '''' else [luopiskjarj_4] end ) as [luopiskjarj_4]
	  ,(case 
			when [luopiskmaak_4] = ''99'' then ''''
			when [luopiskmaak_4] is NULL then '''' 
			else [luopiskmaak_4] 
		end) as [luopiskmaak_4]
	  ,(case when [ammopiskkoulk_4] is NULL then '''' else [ammopiskkoulk_4] end ) as [ammopiskkoulk_4]
	  ,(case 
			when [ammopisktunn_4] = ''BBBBB'' then ''''
			when [ammopisktunn_4] = ''99999'' then ''''
			when [ammopisktunn_4] = ''00000'' then ''''
			when [ammopisktunn_4] = ''90009'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_4] = ''90015'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_4] = ''90010'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_4] = ''90018'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_4] = ''90008'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_4] = ''90032'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_4] = ''90032'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_4] = ''90018'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_4] = ''90006'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_4] = ''90006'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_4] = ''90006'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_4] = ''90010'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_4] = ''90010'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_4] = ''90008'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_4] = ''90018'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_4] = ''90018'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_4] = ''90018'' AND [tilv] = ''2012'' then ''''
			when [ammopisktunn_4] is NULL then '''' 
			else [ammopisktunn_4] 
		end) as [ammopisktunn_4]
      ,(case when [ammopiskjarj_4] is NULL then '''' else [ammopiskjarj_4] end ) as [ammopiskjarj_4]
	  ,(case 
			when [ammopiskmaak_4] = ''99'' then ''''
			when [ammopiskmaak_4] is NULL then '''' 
			else [ammopiskmaak_4] 
		end) as [ammopiskmaak_4]
	  ,(case when [amkopiskkoulk_4] is NULL then '''' else [amkopiskkoulk_4] end ) as [amkopiskkoulk_4]
	  ,(case 
			when [amkopisktunn_4] = ''BBBBB'' then ''''
			when [amkopisktunn_4] = ''99999'' then ''''
			when [amkopisktunn_4] is NULL then '''' 
			else [amkopisktunn_4] 
		end) as [amkopisktunn_4]
	  ,(case when [amkopiskjarj_4] is NULL then '''' else [amkopiskjarj_4] end ) as [amkopiskjarj_4]
	  ,(case 
			when [amkopiskmaak_4] = ''99'' then ''''
			when [amkopiskmaak_4] is NULL then '''' 
			else [amkopiskmaak_4] 
		end) as [amkopiskmaak_4]
      ,(case when [yoopiskkoulk_4] is NULL then '''' else [yoopiskkoulk_4] end ) as [yoopiskkoulk_4]
	  ,(case 
			when [yoopisktunn_4] = ''BBBBB'' then ''''
			when [yoopisktunn_4] = ''99999'' then ''''
			when [yoopisktunn_4] is NULL then '''' 
			else [yoopisktunn_4] 
		end) as [yoopisktunn_4]
      ,(case when [yoopiskjarj_4] is NULL then '''' else [yoopiskjarj_4] end ) as [yoopiskjarj_4]
	  ,(case 
			when [yoopiskmaak_4] = ''99'' then ''''
			when [yoopiskmaak_4] is NULL then '''' 
			else [yoopiskmaak_4] 
		end) as [yoopiskmaak_4]
      ,(case when [monihaku_4] is NULL then '''' else [monihaku_4] end ) as [monihaku_4]
	  ,(case when [ptoim1r4_4] is NULL then '''' else [ptoim1r4_4] end ) as [ptoim1r4_4]
      ,(case when [amas_4] is NULL then '''' else [amas_4] end ) as [amas_4]
      ,(case when [luopiskkoulk_5] is NULL then '''' else [luopiskkoulk_5] end ) as [luopiskkoulk_5]
	  ,(case 
			when [luopisktunn_5] = ''BBBBB'' then ''''
			when [luopisktunn_5] = ''99999'' then ''''
			when [luopisktunn_5] is NULL then '''' 
			else [luopisktunn_5] 
		end) as [luopisktunn_5]
	  ,(case when [luopiskjarj_5] is NULL then '''' else [luopiskjarj_5] end ) as [luopiskjarj_5]
	  ,(case 
			when [luopiskmaak_5] = ''99'' then ''''
			when [luopiskmaak_5] is NULL then '''' 
			else [luopiskmaak_5] 
		end) as [luopiskmaak_5]
	  ,(case when [ammopiskkoulk_5] is NULL then '''' else [ammopiskkoulk_5] end ) as [ammopiskkoulk_5]
	  ,(case 
			when [ammopisktunn_5] = ''BBBBB'' then ''''
			when [ammopisktunn_5] = ''99999'' then ''''
			when [ammopisktunn_5] = ''00000'' then ''''
			when [ammopisktunn_5] = ''90009'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_5] = ''90015'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_5] = ''90010'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_5] = ''90018'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_5] = ''90008'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_5] = ''90032'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_5] = ''90032'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_5] = ''90018'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_5] = ''90006'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_5] = ''90006'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_5] = ''90006'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_5] = ''90010'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_5] = ''90010'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_5] = ''90008'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_5] = ''90018'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_5] = ''90018'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_5] = ''90018'' AND [tilv] = ''2012'' then ''''
			when [ammopisktunn_5] is NULL then '''' 
			else [ammopisktunn_5] 
		end) as [ammopisktunn_5]
	  ,(case when [ammopiskjarj_5] is NULL then '''' else [ammopiskjarj_5] end ) as [ammopiskjarj_5]
	  ,(case 
			when [ammopiskmaak_5] = ''99'' then ''''
			when [ammopiskmaak_5] is NULL then '''' 
			else [ammopiskmaak_5] 
		end) as [ammopiskmaak_5]
	  ,(case when [amkopiskkoulk_5] is NULL then '''' else [amkopiskkoulk_5] end ) as [amkopiskkoulk_5]
	  ,(case 
			when [amkopisktunn_5] = ''BBBBB'' then ''''
			when [amkopisktunn_5] = ''99999'' then ''''
			when [amkopisktunn_5] is NULL then '''' 
			else [amkopisktunn_5] 
		end) as [amkopisktunn_5]
	  ,(case when [amkopiskjarj_5] is NULL then '''' else [amkopiskjarj_5] end ) as [amkopiskjarj_5]
	  ,(case 
			when [amkopiskmaak_5] = ''99'' then ''''
			when [amkopiskmaak_5] is NULL then '''' 
			else [amkopiskmaak_5] 
		end) as [amkopiskmaak_5]
      ,(case when [yoopiskkoulk_5] is NULL then '''' else [yoopiskkoulk_5] end ) as [yoopiskkoulk_5]
	  ,(case 
			when [yoopisktunn_5] = ''BBBBB'' then ''''
			when [yoopisktunn_5] = ''99999'' then ''''
			when [yoopisktunn_5] is NULL then '''' 
			else [yoopisktunn_5] 
		end) as [yoopisktunn_5]
	  ,(case when [yoopiskjarj_5] is NULL then '''' else [yoopiskjarj_5] end ) as [yoopiskjarj_5]
	  ,(case 
			when [yoopiskmaak_5] = ''99'' then ''''
			when [yoopiskmaak_5] is NULL then '''' 
			else [yoopiskmaak_5] 
		end) as [yoopiskmaak_5]
      ,(case when [monihaku_5] is NULL then '''' else [monihaku_5] end ) as [monihaku_5]
	  ,(case when [ptoim1r4_5] is NULL then '''' else [ptoim1r4_5] end ) as [ptoim1r4_5]
      ,(case when [amas_5] is NULL then '''' else [amas_5] end ) as [amas_5]
      ,(case when [luopiskkoulk_6] is NULL then '''' else [luopiskkoulk_6] end ) as [luopiskkoulk_6]
	  ,(case 
			when [luopisktunn_6] = ''BBBBB'' then ''''
			when [luopisktunn_6] = ''99999'' then ''''
			when [luopisktunn_6] is NULL then '''' else [luopisktunn_6] end ) as [luopisktunn_6]
	  ,(case when [luopiskjarj_6] is NULL then '''' else [luopiskjarj_6] end ) as [luopiskjarj_6]
	  ,(case 
			when [luopiskmaak_6] = ''99'' then ''''
			when [luopiskmaak_6] is NULL then '''' 
			else [luopiskmaak_6] 
		end) as [luopiskmaak_6]
	  ,(case when [ammopiskkoulk_6] is NULL then '''' else [ammopiskkoulk_6] end ) as [ammopiskkoulk_6]
	  ,(case 
			when [ammopisktunn_6] = ''BBBBB'' then ''''
			when [ammopisktunn_6] = ''99999'' then ''''
			when [ammopisktunn_6] = ''00000'' then ''''
			when [ammopisktunn_6] = ''90009'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_6] = ''90015'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_6] = ''90010'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_6] = ''90018'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_6] = ''90008'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_6] = ''90032'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_6] = ''90032'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_6] = ''90018'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_6] = ''90006'' AND [tilv] = ''2009'' then ''''
			when [ammopisktunn_6] = ''90006'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_6] = ''90006'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_6] = ''90010'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_6] = ''90010'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_6] = ''90008'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_6] = ''90018'' AND [tilv] = ''2010'' then ''''
			when [ammopisktunn_6] = ''90018'' AND [tilv] = ''2011'' then ''''
			when [ammopisktunn_6] = ''90018'' AND [tilv] = ''2012'' then ''''
			when [ammopisktunn_6] is NULL then '''' 
			else [ammopisktunn_6] 
		end) as [ammopisktunn_6]
	  ,(case when [ammopiskjarj_6] is NULL then '''' else [ammopiskjarj_6] end ) as [ammopiskjarj_6]
	  ,(case 
			when [ammopiskmaak_6] = ''99'' then ''''
			when [ammopiskmaak_6] is NULL then '''' 
			else [ammopiskmaak_6] 
		end) as [ammopiskmaak_6]
	  ,(case when [amkopiskkoulk_6] is NULL then '''' else [amkopiskkoulk_6] end ) as [amkopiskkoulk_6]
	  ,(case 
			when [amkopisktunn_6] = ''BBBBB'' then ''''
			when [amkopisktunn_6] = ''99999'' then ''''
			when [amkopisktunn_6] is NULL then '''' 
			else [amkopisktunn_6] 
		end) as [amkopisktunn_6]
	  ,(case when [amkopiskjarj_6] is NULL then '''' else [amkopiskjarj_6] end ) as [amkopiskjarj_6]
	  ,(case 
			when [amkopiskmaak_6] = ''99'' then ''''
			when [amkopiskmaak_6] is NULL then '''' 
			else [amkopiskmaak_6] 
		end) as [amkopiskmaak_6]
      ,(case when [yoopiskkoulk_6] is NULL then '''' else [yoopiskkoulk_6] end ) as [yoopiskkoulk_6]
	  ,(case 
			when [yoopisktunn_6] = ''BBBBB'' then ''''
			when [yoopisktunn_6] = ''99999'' then ''''
			when [yoopisktunn_6] is NULL then '''' 
			else [yoopisktunn_6] 
		end) as [yoopisktunn_6]
	  ,(case when [yoopiskjarj_6] is NULL then '''' else [yoopiskjarj_6] end ) as [yoopiskjarj_6]
	  ,(case 
			when [yoopiskmaak_6] = ''99'' then ''''
			when [yoopiskmaak_6] is NULL then '''' 
			else [yoopiskmaak_6] 
		end) as [yoopiskmaak_6]
      ,(case when [monihaku_6] is NULL then '''' else [monihaku_6] end ) as [monihaku_6]
	  ,(case when [ptoim1r4_6] is NULL then '''' else [ptoim1r4_6] end ) as [ptoim1r4_6]
      ,(case when [amas_6] is NULL then '''' else [amas_6] end ) as [amas_6]
	  ,[lkm]
	  ,(case when [pohjkoul] is NULL then '''' else [pohjkoul] end ) as [pohjkoul]
	  ,[tietolahde]
	  ,[rivinumero]
FROM (

SELECT
       [tilv]
      ,cast(tilv + ''0101'' as date) as tilv_date
      ,[tutkryh]
      ,[suorv]
      ,[suorlk]
      ,[sp]
      ,[syntv]
      ,[aikielir1]
      ,[tutkaskun]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
      ,[tunn] 
      ,[jarj]
      ,[kkielir1]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[tutkmaak] 

      ,[luopiskkoulk_2004] as luopiskkoulk_1
      ,[luopisktunn_2004] as luopisktunn_1
      ,[luopiskjarj_2004] as luopiskjarj_1
      ,[luopiskmaak_2004] as luopiskmaak_1
      ,[ammopiskkoulk_2004] as ammopiskkoulk_1
      ,[ammopisktunn_2004] as ammopisktunn_1
      ,[ammopiskjarj_2004] as ammopiskjarj_1
      ,[ammopiskmaak_2004] as ammopiskmaak_1
      ,[amkopiskkoulk_2004] as amkopiskkoulk_1
      ,[amkopisktunn_2004] as amkopisktunn_1
      ,[amkopiskjarj_2004] as amkopiskjarj_1
      ,[amkopiskmaak_2004] as amkopiskmaak_1
      ,[yoopiskkoulk_2004] as yoopiskkoulk_1
      ,[yoopisktunn_2004] as yoopisktunn_1
      ,[yoopiskjarj_2004] as yoopiskjarj_1
      ,[yoopiskmaak_2004] as yoopiskmaak_1
      ,[monihaku_2004] as monihaku_1
      ,[ptoim1r4_2004] as [ptoim1r4_1]
      ,[amas_2004] as [amas_1]

      ,[luopiskkoulk_2005] as luopiskkoulk_2
      ,[luopisktunn_2005] as luopisktunn_2
      ,[luopiskjarj_2005] as luopiskjarj_2
      ,[luopiskmaak_2005] as luopiskmaak_2
      ,[ammopiskkoulk_2005] as ammopiskkoulk_2
      ,[ammopisktunn_2005] as ammopisktunn_2
      ,[ammopiskjarj_2005] as ammopiskjarj_2
      ,[ammopiskmaak_2005] as ammopiskmaak_2
      ,[amkopiskkoulk_2005] as amkopiskkoulk_2
      ,[amkopisktunn_2005] as amkopisktunn_2
      ,[amkopiskjarj_2005] as amkopiskjarj_2
      ,[amkopiskmaak_2005] as amkopiskmaak_2
      ,[yoopiskkoulk_2005] as yoopiskkoulk_2
      ,[yoopisktunn_2005] as yoopisktunn_2
      ,[yoopiskjarj_2005] as yoopiskjarj_2
      ,[yoopiskmaak_2005] as yoopiskmaak_2
      ,[monihaku_2005] as monihaku_2
      ,[ptoim1r4_2005] as ptoim1r4_2
      ,[amas_2005] as amas_2

      ,[luopiskkoulk_2006] as luopiskkoulk_3
      ,[luopisktunn_2006] as luopisktunn_3
      ,[luopiskjarj_2006] as luopiskjarj_3
      ,[luopiskmaak_2006] as luopiskmaak_3
      ,[ammopiskkoulk_2006] as ammopiskkoulk_3    
      ,[ammopisktunn_2006] as ammopisktunn_3
	  ,[ammopiskjarj_2006] as ammopiskjarj_3
      ,[ammopiskmaak_2006] as ammopiskmaak_3
      ,[amkopiskkoulk_2006] as amkopiskkoulk_3
      ,[amkopisktunn_2006] as amkopisktunn_3
      ,[amkopiskjarj_2006] as amkopiskjarj_3
      ,[amkopiskmaak_2006] as amkopiskmaak_3
      ,[yoopiskkoulk_2006] as yoopiskkoulk_3
      ,[yoopisktunn_2006] as yoopisktunn_3
      ,[yoopiskjarj_2006] as yoopiskjarj_3
      ,[yoopiskmaak_2006] as yoopiskmaak_3
      ,[monihaku_2006] as monihaku_3
      ,[ptoim1r4_2006] as ptoim1r4_3
      ,[amas_2006] as amas_3

      ,[luopiskkoulk_2007] as luopiskkoulk_4
      ,[luopisktunn_2007] as luopisktunn_4
      ,[luopiskjarj_2007] as luopiskjarj_4
      ,[luopiskmaak_2007] as luopiskmaak_4
      ,[ammopiskkoulk_2007] as ammopiskkoulk_4
      ,[ammopisktunn_2007] as ammopisktunn_4
      ,[ammopiskjarj_2007] as ammopiskjarj_4
      ,[ammopiskmaak_2007] as ammopiskmaak_4
      ,[amkopiskkoulk_2007] as amkopiskkoulk_4
      ,[amkopisktunn_2007] as amkopisktunn_4
      ,[amkopiskjarj_2007] as amkopiskjarj_4
      ,[amkopiskmaak_2007] as amkopiskmaak_4
      ,[yoopiskkoulk_2007] as yoopiskkoulk_4
      ,[yoopisktunn_2007] as yoopisktunn_4
      ,[yoopiskjarj_2007] as yoopiskjarj_4
      ,[yoopiskmaak_2007] as yoopiskmaak_4
      ,[monihaku_2007] as monihaku_4
      ,[ptoim1r4_2007] as ptoim1r4_4
      ,[amas_2007] as amas_4

      ,[luopiskkoulk_2008] as luopiskkoulk_5
      ,[luopisktunn_2008] as luopisktunn_5
      ,[luopiskjarj_2008] as luopiskjarj_5
      ,[luopiskmaak_2008] as luopiskmaak_5
      ,[ammopiskkoulk_2008] as ammopiskkoulk_5
      ,[ammopisktunn_2008] as ammopisktunn_5
      ,[ammopiskjarj_2008] as ammopiskjarj_5
      ,[ammopiskmaak_2008] as ammopiskmaak_5
      ,[amkopiskkoulk_2008] as amkopiskkoulk_5
      ,[amkopisktunn_2008] as amkopisktunn_5
      ,[amkopiskjarj_2008] as amkopiskjarj_5
      ,[amkopiskmaak_2008] as amkopiskmaak_5
      ,[yoopiskkoulk_2008] as yoopiskkoulk_5
      ,[yoopisktunn_2008] as yoopisktunn_5
      ,[yoopiskjarj_2008] as yoopiskjarj_5
      ,[yoopiskmaak_2008] as yoopiskmaak_5
      ,[monihaku_2008] as monihaku_5
      ,[ptoim1r4_2008] as ptoim1r4_5
      ,[amas_2008] as amas_5

      ,[luopiskkoulk_2009] as luopiskkoulk_6
      ,[luopisktunn_2009] as luopisktunn_6
      ,[luopiskjarj_2009] as luopiskjarj_6
      ,[luopiskmaak_2009] as luopiskmaak_6
      ,[ammopiskkoulk_2009] as ammopiskkoulk_6
      ,[ammopisktunn_2009] as ammopisktunn_6
      ,[ammopiskjarj_2009] as ammopiskjarj_6
      ,[ammopiskmaak_2009] as ammopiskmaak_6
      ,[amkopiskkoulk_2009] as amkopiskkoulk_6
      ,[amkopisktunn_2009] as amkopisktunn_6
      ,[amkopiskjarj_2009] as amkopiskjarj_6
      ,[amkopiskmaak_2009] as amkopiskmaak_6
      ,[yoopiskkoulk_2009] as yoopiskkoulk_6
      ,[yoopisktunn_2009] as yoopisktunn_6
      ,[yoopiskjarj_2009] as yoopiskjarj_6
      ,[yoopiskmaak_2009] as yoopiskmaak_6
      ,[monihaku_2009] as monihaku_6
      ,[ptoim1r4_2009] as ptoim1r4_6
      ,[amas_2009] as amas_6

	  ,[lkm]
	  ,[pohjkoul]
      ,[tietolahde]=''K3_13_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_13_sopv_11]

UNION ALL

SELECT
       [tilv]
      ,cast(tilv + ''0101'' as date) as tilv_date
      ,[tutkryh]
      ,[suorv]
      ,[suorlk]
      ,[sp]
      ,[syntv]
      ,[aikielir1]
      ,[tutkaskun]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
      ,[tunn] 
      ,[jarj]
      ,[kkielir1]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[tutkmaak] 

      ,[luopiskkoulk_2005] as luopiskkoulk_1
      ,[luopisktunn_2005] as luopisktunn_1
      ,[luopiskjarj_2005] as luopiskjarj_1
      ,[luopiskmaak_2005] as luopiskmaak_1
      ,[ammopiskkoulk_2005] as ammopiskkoulk_1
      ,[ammopisktunn_2005] as ammopisktunn_1
      ,[ammopiskjarj_2005] as ammopiskjarj_1
      ,[ammopiskmaak_2005] as ammopiskmaak_1
      ,[amkopiskkoulk_2005] as amkopiskkoulk_1
      ,[amkopisktunn_2005] as amkopisktunn_1
      ,[amkopiskjarj_2005] as amkopiskjarj_1
      ,[amkopiskmaak_2005] as amkopiskmaak_1
      ,[yoopiskkoulk_2005] as yoopiskkoulk_1
      ,[yoopisktunn_2005] as yoopisktunn_1
      ,[yoopiskjarj_2005] as yoopiskjarj_1
      ,[yoopiskmaak_2005] as yoopiskmaak_1
      ,[monihaku_2005] as monihaku_1
      ,[ptoim1r4_2005] as [ptoim1r4_1]
      ,[amas_2005] as [amas_1]

      ,[luopiskkoulk_2006] as luopiskkoulk_2
      ,[luopisktunn_2006] as luopisktunn_2
      ,[luopiskjarj_2006] as luopiskjarj_2
      ,[luopiskmaak_2006] as luopiskmaak_2
      ,[ammopiskkoulk_2006] as ammopiskkoulk_2
      ,[ammopisktunn_2006] as ammopisktunn_2
      ,[ammopiskjarj_2006] as ammopiskjarj_2
      ,[ammopiskmaak_2006] as ammopiskmaak_2
      ,[amkopiskkoulk_2006] as amkopiskkoulk_2
      ,[amkopisktunn_2006] as amkopisktunn_2
      ,[amkopiskjarj_2006] as amkopiskjarj_2
      ,[amkopiskmaak_2006] as amkopiskmaak_2
      ,[yoopiskkoulk_2006] as yoopiskkoulk_2
      ,[yoopisktunn_2006] as yoopisktunn_2
      ,[yoopiskjarj_2006] as yoopiskjarj_2
      ,[yoopiskmaak_2006] as yoopiskmaak_2
      ,[monihaku_2006] as monihaku_2
      ,[ptoim1r4_2006] as ptoim1r4_2
      ,[amas_2006] as amas_2

      ,[luopiskkoulk_2007] as luopiskkoulk_3
      ,[luopisktunn_2007] as luopisktunn_3
      ,[luopiskjarj_2007] as luopiskjarj_3
      ,[luopiskmaak_2007] as luopiskmaak_3
      ,[ammopiskkoulk_2007] as ammopiskkoulk_3    
      ,[ammopisktunn_2007] as ammopisktunn_3
	  ,[ammopiskjarj_2007] as ammopiskjarj_3
      ,[ammopiskmaak_2007] as ammopiskmaak_3
      ,[amkopiskkoulk_2007] as amkopiskkoulk_3
      ,[amkopisktunn_2007] as amkopisktunn_3
      ,[amkopiskjarj_2007] as amkopiskjarj_3
      ,[amkopiskmaak_2007] as amkopiskmaak_3
      ,[yoopiskkoulk_2007] as yoopiskkoulk_3
      ,[yoopisktunn_2007] as yoopisktunn_3
      ,[yoopiskjarj_2007] as yoopiskjarj_3
      ,[yoopiskmaak_2007] as yoopiskmaak_3
      ,[monihaku_2007] as monihaku_3
      ,[ptoim1r4_2007] as ptoim1r4_3
      ,[amas_2007] as amas_3

      ,[luopiskkoulk_2008] as luopiskkoulk_4
      ,[luopisktunn_2008] as luopisktunn_4
      ,[luopiskjarj_2008] as luopiskjarj_4
      ,[luopiskmaak_2008] as luopiskmaak_4
      ,[ammopiskkoulk_2008] as ammopiskkoulk_4
      ,[ammopisktunn_2008] as ammopisktunn_4
      ,[ammopiskjarj_2008] as ammopiskjarj_4
      ,[ammopiskmaak_2008] as ammopiskmaak_4
      ,[amkopiskkoulk_2008] as amkopiskkoulk_4
      ,[amkopisktunn_2008] as amkopisktunn_4
      ,[amkopiskjarj_2008] as amkopiskjarj_4
      ,[amkopiskmaak_2008] as amkopiskmaak_4
      ,[yoopiskkoulk_2008] as yoopiskkoulk_4
      ,[yoopisktunn_2008] as yoopisktunn_4
      ,[yoopiskjarj_2008] as yoopiskjarj_4
      ,[yoopiskmaak_2008] as yoopiskmaak_4
      ,[monihaku_2008] as monihaku_4
      ,[ptoim1r4_2008] as ptoim1r4_4
      ,[amas_2008] as amas_4

      ,[luopiskkoulk_2009] as luopiskkoulk_5
      ,[luopisktunn_2009] as luopisktunn_5
      ,[luopiskjarj_2009] as luopiskjarj_5
      ,[luopiskmaak_2009] as luopiskmaak_5
      ,[ammopiskkoulk_2009] as ammopiskkoulk_5
      ,[ammopisktunn_2009] as ammopisktunn_5
      ,[ammopiskjarj_2009] as ammopiskjarj_5
      ,[ammopiskmaak_2009] as ammopiskmaak_5
      ,[amkopiskkoulk_2009] as amkopiskkoulk_5
      ,[amkopisktunn_2009] as amkopisktunn_5
      ,[amkopiskjarj_2009] as amkopiskjarj_5
      ,[amkopiskmaak_2009] as amkopiskmaak_5
      ,[yoopiskkoulk_2009] as yoopiskkoulk_5
      ,[yoopisktunn_2009] as yoopisktunn_5
      ,[yoopiskjarj_2009] as yoopiskjarj_5
      ,[yoopiskmaak_2009] as yoopiskmaak_5
      ,[monihaku_2009] as monihaku_5
      ,[ptoim1r4_2009] as ptoim1r4_5
      ,[amas_2009] as amas_5

      ,[luopiskkoulk_2010] as luopiskkoulk_6
      ,[luopisktunn_2010] as luopisktunn_6
      ,[luopiskjarj_2010] as luopiskjarj_6
      ,[luopiskmaak_2010] as luopiskmaak_6
      ,[ammopiskkoulk_2010] as ammopiskkoulk_6
      ,[ammopisktunn_2010] as ammopisktunn_6
      ,[ammopiskjarj_2010] as ammopiskjarj_6
      ,[ammopiskmaak_2010] as ammopiskmaak_6
      ,[amkopiskkoulk_2010] as amkopiskkoulk_6
      ,[amkopisktunn_2010] as amkopisktunn_6
      ,[amkopiskjarj_2010] as amkopiskjarj_6
      ,[amkopiskmaak_2010] as amkopiskmaak_6
      ,[yoopiskkoulk_2010] as yoopiskkoulk_6
      ,[yoopisktunn_2010] as yoopisktunn_6
      ,[yoopiskjarj_2010] as yoopiskjarj_6
      ,[yoopiskmaak_2010] as yoopiskmaak_6
      ,[monihaku_2010] as monihaku_6
      ,[ptoim1r4_2010] as ptoim1r4_6
      ,[amas_2010] as amas_6

	  ,[lkm]
	  ,[pohjkoul]
      ,[tietolahde]=''K3_13_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_13_sopv_12]

UNION ALL

SELECT
       [tilv]
      ,cast(tilv + ''0101'' as date) as tilv_date
      ,[tutkryh]
      ,[suorv]
      ,[suorlk]
      ,[sp]
      ,[syntv]
      ,[aikielir1]
      ,[tutkaskun]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
      ,[tunn] 
      ,[jarj]
      ,[kkielir1]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[tutkmaak] 

      ,[luopiskkoulk_2006] as luopiskkoulk_1
      ,[luopisktunn_2006] as luopisktunn_1
      ,[luopiskjarj_2006] as luopiskjarj_1
      ,[luopiskmaak_2006] as luopiskmaak_1
      ,[ammopiskkoulk_2006] as ammopiskkoulk_1
      ,[ammopisktunn_2006] as ammopisktunn_1
      ,[ammopiskjarj_2006] as ammopiskjarj_1
      ,[ammopiskmaak_2006] as ammopiskmaak_1
      ,[amkopiskkoulk_2006] as amkopiskkoulk_1
      ,[amkopisktunn_2006] as amkopisktunn_1
      ,[amkopiskjarj_2006] as amkopiskjarj_1
      ,[amkopiskmaak_2006] as amkopiskmaak_1
      ,[yoopiskkoulk_2006] as yoopiskkoulk_1
      ,[yoopisktunn_2006] as yoopisktunn_1
      ,[yoopiskjarj_2006] as yoopiskjarj_1
      ,[yoopiskmaak_2006] as yoopiskmaak_1
      ,[monihaku_2006] as monihaku_1
      ,[ptoim1r4_2006] as [ptoim1r4_1]
      ,[amas_2006] as [amas_1]

      ,[luopiskkoulk_2007] as luopiskkoulk_2
      ,[luopisktunn_2007] as luopisktunn_2
      ,[luopiskjarj_2007] as luopiskjarj_2
      ,[luopiskmaak_2007] as luopiskmaak_2
      ,[ammopiskkoulk_2007] as ammopiskkoulk_2
      ,[ammopisktunn_2007] as ammopisktunn_2
      ,[ammopiskjarj_2007] as ammopiskjarj_2
      ,[ammopiskmaak_2007] as ammopiskmaak_2
      ,[amkopiskkoulk_2007] as amkopiskkoulk_2
      ,[amkopisktunn_2007] as amkopisktunn_2
      ,[amkopiskjarj_2007] as amkopiskjarj_2
      ,[amkopiskmaak_2007] as amkopiskmaak_2
      ,[yoopiskkoulk_2007] as yoopiskkoulk_2
      ,[yoopisktunn_2007] as yoopisktunn_2
      ,[yoopiskjarj_2007] as yoopiskjarj_2
      ,[yoopiskmaak_2007] as yoopiskmaak_2
      ,[monihaku_2007] as monihaku_2
      ,[ptoim1r4_2007] as ptoim1r4_2
      ,[amas_2007] as amas_2

      ,[luopiskkoulk_2008] as luopiskkoulk_3
      ,[luopisktunn_2008] as luopisktunn_3
      ,[luopiskjarj_2008] as luopiskjarj_3
      ,[luopiskmaak_2008] as luopiskmaak_3
      ,[ammopiskkoulk_2008] as ammopiskkoulk_3    
      ,[ammopisktunn_2008] as ammopisktunn_3
	  ,[ammopiskjarj_2008] as ammopiskjarj_3
      ,[ammopiskmaak_2008] as ammopiskmaak_3
      ,[amkopiskkoulk_2008] as amkopiskkoulk_3
      ,[amkopisktunn_2008] as amkopisktunn_3
      ,[amkopiskjarj_2008] as amkopiskjarj_3
      ,[amkopiskmaak_2008] as amkopiskmaak_3
      ,[yoopiskkoulk_2008] as yoopiskkoulk_3
      ,[yoopisktunn_2008] as yoopisktunn_3
      ,[yoopiskjarj_2008] as yoopiskjarj_3
      ,[yoopiskmaak_2008] as yoopiskmaak_3
      ,[monihaku_2008] as monihaku_3
      ,[ptoim1r4_2008] as ptoim1r4_3
      ,[amas_2008] as amas_3

      ,[luopiskkoulk_2009] as luopiskkoulk_4
      ,[luopisktunn_2009] as luopisktunn_4
      ,[luopiskjarj_2009] as luopiskjarj_4
      ,[luopiskmaak_2009] as luopiskmaak_4
      ,[ammopiskkoulk_2009] as ammopiskkoulk_4
      ,[ammopisktunn_2009] as ammopisktunn_4
      ,[ammopiskjarj_2009] as ammopiskjarj_4
      ,[ammopiskmaak_2009] as ammopiskmaak_4
      ,[amkopiskkoulk_2009] as amkopiskkoulk_4
      ,[amkopisktunn_2009] as amkopisktunn_4
      ,[amkopiskjarj_2009] as amkopiskjarj_4
      ,[amkopiskmaak_2009] as amkopiskmaak_4
      ,[yoopiskkoulk_2009] as yoopiskkoulk_4
      ,[yoopisktunn_2009] as yoopisktunn_4
      ,[yoopiskjarj_2009] as yoopiskjarj_4
      ,[yoopiskmaak_2009] as yoopiskmaak_4
      ,[monihaku_2009] as monihaku_4
      ,[ptoim1r4_2009] as ptoim1r4_4
      ,[amas_2009] as amas_4

      ,[luopiskkoulk_2010] as luopiskkoulk_5
      ,[luopisktunn_2010] as luopisktunn_5
      ,[luopiskjarj_2010] as luopiskjarj_5
      ,[luopiskmaak_2010] as luopiskmaak_5
      ,[ammopiskkoulk_2010] as ammopiskkoulk_5
      ,[ammopisktunn_2010] as ammopisktunn_5
      ,[ammopiskjarj_2010] as ammopiskjarj_5
      ,[ammopiskmaak_2010] as ammopiskmaak_5
      ,[amkopiskkoulk_2010] as amkopiskkoulk_5
      ,[amkopisktunn_2010] as amkopisktunn_5
      ,[amkopiskjarj_2010] as amkopiskjarj_5
      ,[amkopiskmaak_2010] as amkopiskmaak_5
      ,[yoopiskkoulk_2010] as yoopiskkoulk_5
      ,[yoopisktunn_2010] as yoopisktunn_5
      ,[yoopiskjarj_2010] as yoopiskjarj_5
      ,[yoopiskmaak_2010] as yoopiskmaak_5
      ,[monihaku_2010] as monihaku_5
      ,[ptoim1r4_2010] as ptoim1r4_5
      ,[amas_2010] as amas_5

      ,[luopiskkoulk_2011] as luopiskkoulk_6
      ,[luopisktunn_2011] as luopisktunn_6
      ,[luopiskjarj_2011] as luopiskjarj_6
      ,[luopiskmaak_2011] as luopiskmaak_6
      ,[ammopiskkoulk_2011] as ammopiskkoulk_6
      ,[ammopisktunn_2011] as ammopisktunn_6
      ,[ammopiskjarj_2011] as ammopiskjarj_6
      ,[ammopiskmaak_2011] as ammopiskmaak_6
      ,[amkopiskkoulk_2011] as amkopiskkoulk_6
      ,[amkopisktunn_2011] as amkopisktunn_6
      ,[amkopiskjarj_2011] as amkopiskjarj_6
      ,[amkopiskmaak_2011] as amkopiskmaak_6
      ,[yoopiskkoulk_2011] as yoopiskkoulk_6
      ,[yoopisktunn_2011] as yoopisktunn_6
      ,[yoopiskjarj_2011] as yoopiskjarj_6
      ,[yoopiskmaak_2011] as yoopiskmaak_6
      ,[monihaku_2011] as monihaku_6
      ,[ptoim1r4_2011] as ptoim1r4_6
      ,[amas_2011] as amas_6

	  ,[lkm]
	  ,[pohjkoul]
      ,[tietolahde]=''K3_13_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_13_sopv_13]

UNION ALL

SELECT
       [tilv]
      ,cast(tilv + ''0101'' as date) as tilv_date
      ,[tutkryh]
      ,[suorv]
      ,[suorlk]
      ,[sp]
      ,[syntv]
      ,[aikielir1]
      ,[tutkaskun]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
      ,[tunn] 
      ,[jarj]
      ,[kkielir1]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[tutkmaak] 

      ,[luopiskkoulk_2007] as luopiskkoulk_1
      ,[luopisktunn_2007] as luopisktunn_1
      ,[luopiskjarj_2007] as luopiskjarj_1
      ,[luopiskmaak_2007] as luopiskmaak_1
      ,[ammopiskkoulk_2007] as ammopiskkoulk_1
      ,[ammopisktunn_2007] as ammopisktunn_1
      ,[ammopiskjarj_2007] as ammopiskjarj_1
      ,[ammopiskmaak_2007] as ammopiskmaak_1
      ,[amkopiskkoulk_2007] as amkopiskkoulk_1
      ,[amkopisktunn_2007] as amkopisktunn_1
      ,[amkopiskjarj_2007] as amkopiskjarj_1
      ,[amkopiskmaak_2007] as amkopiskmaak_1
      ,[yoopiskkoulk_2007] as yoopiskkoulk_1
      ,[yoopisktunn_2007] as yoopisktunn_1
      ,[yoopiskjarj_2007] as yoopiskjarj_1
      ,[yoopiskmaak_2007] as yoopiskmaak_1
      ,[monihaku_2007] as monihaku_1
      ,[ptoim1r4_2007] as [ptoim1r4_1]
      ,[amas_2007] as [amas_1]

      ,[luopiskkoulk_2008] as luopiskkoulk_2
      ,[luopisktunn_2008] as luopisktunn_2
      ,[luopiskjarj_2008] as luopiskjarj_2
      ,[luopiskmaak_2008] as luopiskmaak_2
      ,[ammopiskkoulk_2008] as ammopiskkoulk_2
      ,[ammopisktunn_2008] as ammopisktunn_2
      ,[ammopiskjarj_2008] as ammopiskjarj_2
      ,[ammopiskmaak_2008] as ammopiskmaak_2
      ,[amkopiskkoulk_2008] as amkopiskkoulk_2
      ,[amkopisktunn_2008] as amkopisktunn_2
      ,[amkopiskjarj_2008] as amkopiskjarj_2
      ,[amkopiskmaak_2008] as amkopiskmaak_2
      ,[yoopiskkoulk_2008] as yoopiskkoulk_2
      ,[yoopisktunn_2008] as yoopisktunn_2
      ,[yoopiskjarj_2008] as yoopiskjarj_2
      ,[yoopiskmaak_2008] as yoopiskmaak_2
      ,[monihaku_2008] as monihaku_2
      ,[ptoim1r4_2008] as ptoim1r4_2
      ,[amas_2008] as amas_2

      ,[luopiskkoulk_2009] as luopiskkoulk_3
      ,[luopisktunn_2009] as luopisktunn_3
      ,[luopiskjarj_2009] as luopiskjarj_3
      ,[luopiskmaak_2009] as luopiskmaak_3
      ,[ammopiskkoulk_2009] as ammopiskkoulk_3    
      ,[ammopisktunn_2009] as ammopisktunn_3
	  ,[ammopiskjarj_2009] as ammopiskjarj_3
      ,[ammopiskmaak_2009] as ammopiskmaak_3
      ,[amkopiskkoulk_2009] as amkopiskkoulk_3
      ,[amkopisktunn_2009] as amkopisktunn_3
      ,[amkopiskjarj_2009] as amkopiskjarj_3
      ,[amkopiskmaak_2009] as amkopiskmaak_3
      ,[yoopiskkoulk_2009] as yoopiskkoulk_3
      ,[yoopisktunn_2009] as yoopisktunn_3
      ,[yoopiskjarj_2009] as yoopiskjarj_3
      ,[yoopiskmaak_2009] as yoopiskmaak_3
      ,[monihaku_2009] as monihaku_3
      ,[ptoim1r4_2009] as ptoim1r4_3
      ,[amas_2009] as amas_3

      ,[luopiskkoulk_2010] as luopiskkoulk_4
      ,[luopisktunn_2010] as luopisktunn_4
      ,[luopiskjarj_2010] as luopiskjarj_4
      ,[luopiskmaak_2010] as luopiskmaak_4
      ,[ammopiskkoulk_2010] as ammopiskkoulk_4
      ,[ammopisktunn_2010] as ammopisktunn_4
      ,[ammopiskjarj_2010] as ammopiskjarj_4
      ,[ammopiskmaak_2010] as ammopiskmaak_4
      ,[amkopiskkoulk_2010] as amkopiskkoulk_4
      ,[amkopisktunn_2010] as amkopisktunn_4
      ,[amkopiskjarj_2010] as amkopiskjarj_4
      ,[amkopiskmaak_2010] as amkopiskmaak_4
      ,[yoopiskkoulk_2010] as yoopiskkoulk_4
      ,[yoopisktunn_2010] as yoopisktunn_4
      ,[yoopiskjarj_2010] as yoopiskjarj_4
      ,[yoopiskmaak_2010] as yoopiskmaak_4
      ,[monihaku_2010] as monihaku_4
      ,[ptoim1r4_2010] as ptoim1r4_4
      ,[amas_2010] as amas_4

      ,[luopiskkoulk_2011] as luopiskkoulk_5
      ,[luopisktunn_2011] as luopisktunn_5
      ,[luopiskjarj_2011] as luopiskjarj_5
      ,[luopiskmaak_2011] as luopiskmaak_5
      ,[ammopiskkoulk_2011] as ammopiskkoulk_5
      ,[ammopisktunn_2011] as ammopisktunn_5
      ,[ammopiskjarj_2011] as ammopiskjarj_5
      ,[ammopiskmaak_2011] as ammopiskmaak_5
      ,[amkopiskkoulk_2011] as amkopiskkoulk_5
      ,[amkopisktunn_2011] as amkopisktunn_5
      ,[amkopiskjarj_2011] as amkopiskjarj_5
      ,[amkopiskmaak_2011] as amkopiskmaak_5
      ,[yoopiskkoulk_2011] as yoopiskkoulk_5
      ,[yoopisktunn_2011] as yoopisktunn_5
      ,[yoopiskjarj_2011] as yoopiskjarj_5
      ,[yoopiskmaak_2011] as yoopiskmaak_5
      ,[monihaku_2011] as monihaku_5
      ,[ptoim1r4_2011] as ptoim1r4_5
      ,[amas_2011] as amas_5

      ,[luopiskkoulk_2012] as luopiskkoulk_6
      ,[luopisktunn_2012] as luopisktunn_6
      ,[luopiskjarj_2012] as luopiskjarj_6
      ,[luopiskmaak_2012] as luopiskmaak_6
      ,[ammopiskkoulk_2012] as ammopiskkoulk_6
      ,[ammopisktunn_2012] as ammopisktunn_6
      ,[ammopiskjarj_2012] as ammopiskjarj_6
      ,[ammopiskmaak_2012] as ammopiskmaak_6
      ,[amkopiskkoulk_2012] as amkopiskkoulk_6
      ,[amkopisktunn_2012] as amkopisktunn_6
      ,[amkopiskjarj_2012] as amkopiskjarj_6
      ,[amkopiskmaak_2012] as amkopiskmaak_6
      ,[yoopiskkoulk_2012] as yoopiskkoulk_6
      ,[yoopisktunn_2012] as yoopisktunn_6
      ,[yoopiskjarj_2012] as yoopiskjarj_6
      ,[yoopiskmaak_2012] as yoopiskmaak_6
      ,[monihaku_2012] as monihaku_6
      ,[ptoim1r4_2012] as ptoim1r4_6
      ,[amas_2012] as amas_6

	  ,[lkm]
	  ,[pohjkoul]
      ,[tietolahde]=''K3_13_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_13_sopv_14]

UNION ALL

SELECT
       [tilv]
      ,cast(tilv + ''0101'' as date) as tilv_date
      ,[tutkryh]
      ,[suorv]
      ,[suorlk]
      ,[sp]
      ,[syntv]
      ,[aikielir1]
      ,[tutkaskun]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
      ,[tunn] 
      ,[jarj]
      ,[kkielir1]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[tutkmaak] 

      ,[luopiskkoulk_2008] as luopiskkoulk_1
      ,[luopisktunn_2008] as luopisktunn_1
      ,[luopiskjarj_2008] as luopiskjarj_1
      ,[luopiskmaak_2008] as luopiskmaak_1
      ,[ammopiskkoulk_2008] as ammopiskkoulk_1
      ,[ammopisktunn_2008] as ammopisktunn_1
      ,[ammopiskjarj_2008] as ammopiskjarj_1
      ,[ammopiskmaak_2008] as ammopiskmaak_1
      ,[amkopiskkoulk_2008] as amkopiskkoulk_1
      ,[amkopisktunn_2008] as amkopisktunn_1
      ,[amkopiskjarj_2008] as amkopiskjarj_1
      ,[amkopiskmaak_2008] as amkopiskmaak_1
      ,[yoopiskkoulk_2008] as yoopiskkoulk_1
      ,[yoopisktunn_2008] as yoopisktunn_1
      ,[yoopiskjarj_2008] as yoopiskjarj_1
      ,[yoopiskmaak_2008] as yoopiskmaak_1
      ,[monihaku_2008] as monihaku_1
      ,[ptoim1r4_2008] as [ptoim1r4_1]
      ,[amas_2008] as [amas_1]

      ,[luopiskkoulk_2009] as luopiskkoulk_2
      ,[luopisktunn_2009] as luopisktunn_2
      ,[luopiskjarj_2009] as luopiskjarj_2
      ,[luopiskmaak_2009] as luopiskmaak_2
      ,[ammopiskkoulk_2009] as ammopiskkoulk_2
      ,[ammopisktunn_2009] as ammopisktunn_2
      ,[ammopiskjarj_2009] as ammopiskjarj_2
      ,[ammopiskmaak_2009] as ammopiskmaak_2
      ,[amkopiskkoulk_2009] as amkopiskkoulk_2
      ,[amkopisktunn_2009] as amkopisktunn_2
      ,[amkopiskjarj_2009] as amkopiskjarj_2
      ,[amkopiskmaak_2009] as amkopiskmaak_2
      ,[yoopiskkoulk_2009] as yoopiskkoulk_2
      ,[yoopisktunn_2009] as yoopisktunn_2
      ,[yoopiskjarj_2009] as yoopiskjarj_2
      ,[yoopiskmaak_2009] as yoopiskmaak_2
      ,[monihaku_2009] as monihaku_2
      ,[ptoim1r4_2009] as ptoim1r4_2
      ,[amas_2009] as amas_2

      ,[luopiskkoulk_2010] as luopiskkoulk_3
      ,[luopisktunn_2010] as luopisktunn_3
      ,[luopiskjarj_2010] as luopiskjarj_3
      ,[luopiskmaak_2010] as luopiskmaak_3
      ,[ammopiskkoulk_2010] as ammopiskkoulk_3    
      ,[ammopisktunn_2010] as ammopisktunn_3
	  ,[ammopiskjarj_2010] as ammopiskjarj_3
      ,[ammopiskmaak_2010] as ammopiskmaak_3
      ,[amkopiskkoulk_2010] as amkopiskkoulk_3
      ,[amkopisktunn_2010] as amkopisktunn_3
      ,[amkopiskjarj_2010] as amkopiskjarj_3
      ,[amkopiskmaak_2010] as amkopiskmaak_3
      ,[yoopiskkoulk_2010] as yoopiskkoulk_3
      ,[yoopisktunn_2010] as yoopisktunn_3
      ,[yoopiskjarj_2010] as yoopiskjarj_3
      ,[yoopiskmaak_2010] as yoopiskmaak_3
      ,[monihaku_2010] as monihaku_3
      ,[ptoim1r4_2010] as ptoim1r4_3
      ,[amas_2010] as amas_3

      ,[luopiskkoulk_2011] as luopiskkoulk_4
      ,[luopisktunn_2011] as luopisktunn_4
      ,[luopiskjarj_2011] as luopiskjarj_4
      ,[luopiskmaak_2011] as luopiskmaak_4
      ,[ammopiskkoulk_2011] as ammopiskkoulk_4
      ,[ammopisktunn_2011] as ammopisktunn_4
      ,[ammopiskjarj_2011] as ammopiskjarj_4
      ,[ammopiskmaak_2011] as ammopiskmaak_4
      ,[amkopiskkoulk_2011] as amkopiskkoulk_4
      ,[amkopisktunn_2011] as amkopisktunn_4
      ,[amkopiskjarj_2011] as amkopiskjarj_4
      ,[amkopiskmaak_2011] as amkopiskmaak_4
      ,[yoopiskkoulk_2011] as yoopiskkoulk_4
      ,[yoopisktunn_2011] as yoopisktunn_4
      ,[yoopiskjarj_2011] as yoopiskjarj_4
      ,[yoopiskmaak_2011] as yoopiskmaak_4
      ,[monihaku_2011] as monihaku_4
      ,[ptoim1r4_2011] as ptoim1r4_4
      ,[amas_2011] as amas_4

      ,[luopiskkoulk_2012] as luopiskkoulk_5
      ,[luopisktunn_2012] as luopisktunn_5
      ,[luopiskjarj_2012] as luopiskjarj_5
      ,[luopiskmaak_2012] as luopiskmaak_5
      ,[ammopiskkoulk_2012] as ammopiskkoulk_5
      ,[ammopisktunn_2012] as ammopisktunn_5
      ,[ammopiskjarj_2012] as ammopiskjarj_5
      ,[ammopiskmaak_2012] as ammopiskmaak_5
      ,[amkopiskkoulk_2012] as amkopiskkoulk_5
      ,[amkopisktunn_2012] as amkopisktunn_5
      ,[amkopiskjarj_2012] as amkopiskjarj_5
      ,[amkopiskmaak_2012] as amkopiskmaak_5
      ,[yoopiskkoulk_2012] as yoopiskkoulk_5
      ,[yoopisktunn_2012] as yoopisktunn_5
      ,[yoopiskjarj_2012] as yoopiskjarj_5
      ,[yoopiskmaak_2012] as yoopiskmaak_5
      ,[monihaku_2012] as monihaku_5
      ,[ptoim1r4_2012] as ptoim1r4_5
      ,[amas_2012] as amas_5

      ,[luopiskkoulk_2013] as luopiskkoulk_6
      ,[luopisktunn_2013] as luopisktunn_6
      ,[luopiskjarj_2013] as luopiskjarj_6
      ,[luopiskmaak_2013] as luopiskmaak_6
      ,[ammopiskkoulk_2013] as ammopiskkoulk_6
      ,[ammopisktunn_2013] as ammopisktunn_6
      ,[ammopiskjarj_2013] as ammopiskjarj_6
      ,[ammopiskmaak_2013] as ammopiskmaak_6
      ,[amkopiskkoulk_2013] as amkopiskkoulk_6
      ,[amkopisktunn_2013] as amkopisktunn_6
      ,[amkopiskjarj_2013] as amkopiskjarj_6
      ,[amkopiskmaak_2013] as amkopiskmaak_6
      ,[yoopiskkoulk_2013] as yoopiskkoulk_6
      ,[yoopisktunn_2013] as yoopisktunn_6
      ,[yoopiskjarj_2013] as yoopiskjarj_6
      ,[yoopiskmaak_2013] as yoopiskmaak_6
      ,[monihaku_2013] as monihaku_6
      ,[ptoim1r4_2013] as ptoim1r4_6
      ,[amas_2013] as amas_6

	  ,[lkm]
	  ,[pohjkoul]
      ,[tietolahde]=''K3_13_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_13_sopv_15]

UNION ALL

SELECT
       [tilv]
      ,cast(tilv + ''0101'' as date) as tilv_date
      ,[tutkryh]
      ,[suorv]
      ,[suorlk]
      ,[sp]
      ,[syntv]
      ,[aikielir1]
      ,[tutkaskun]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
      ,[tunn] 
      ,[jarj]
      ,[kkielir1]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[tutkmaak] 

      ,[luopiskkoulk_2009] as luopiskkoulk_1
      ,[luopisktunn_2009] as luopisktunn_1
      ,[luopiskjarj_2009] as luopiskjarj_1
      ,[luopiskmaak_2009] as luopiskmaak_1
      ,[ammopiskkoulk_2009] as ammopiskkoulk_1
      ,[ammopisktunn_2009] as ammopisktunn_1
      ,[ammopiskjarj_2009] as ammopiskjarj_1
      ,[ammopiskmaak_2009] as ammopiskmaak_1
      ,[amkopiskkoulk_2009] as amkopiskkoulk_1
      ,[amkopisktunn_2009] as amkopisktunn_1
      ,[amkopiskjarj_2009] as amkopiskjarj_1
      ,[amkopiskmaak_2009] as amkopiskmaak_1
      ,[yoopiskkoulk_2009] as yoopiskkoulk_1
      ,[yoopisktunn_2009] as yoopisktunn_1
      ,[yoopiskjarj_2009] as yoopiskjarj_1
      ,[yoopiskmaak_2009] as yoopiskmaak_1
      ,[monihaku_2009] as monihaku_1
      ,[ptoim1r4_2009] as [ptoim1r4_1]
      ,[amas_2009] as [amas_1]

      ,[luopiskkoulk_2010] as luopiskkoulk_2
      ,[luopisktunn_2010] as luopisktunn_2
      ,[luopiskjarj_2010] as luopiskjarj_2
      ,[luopiskmaak_2010] as luopiskmaak_2
      ,[ammopiskkoulk_2010] as ammopiskkoulk_2
      ,[ammopisktunn_2010] as ammopisktunn_2
      ,[ammopiskjarj_2010] as ammopiskjarj_2
      ,[ammopiskmaak_2010] as ammopiskmaak_2
      ,[amkopiskkoulk_2010] as amkopiskkoulk_2
      ,[amkopisktunn_2010] as amkopisktunn_2
      ,[amkopiskjarj_2010] as amkopiskjarj_2
      ,[amkopiskmaak_2010] as amkopiskmaak_2
      ,[yoopiskkoulk_2010] as yoopiskkoulk_2
      ,[yoopisktunn_2010] as yoopisktunn_2
      ,[yoopiskjarj_2010] as yoopiskjarj_2
      ,[yoopiskmaak_2010] as yoopiskmaak_2
      ,[monihaku_2010] as monihaku_2
      ,[ptoim1r4_2010] as ptoim1r4_2
      ,[amas_2010] as amas_2

      ,[luopiskkoulk_2011] as luopiskkoulk_3
      ,[luopisktunn_2011] as luopisktunn_3
      ,[luopiskjarj_2011] as luopiskjarj_3
      ,[luopiskmaak_2011] as luopiskmaak_3
      ,[ammopiskkoulk_2011] as ammopiskkoulk_3    
      ,[ammopisktunn_2011] as ammopisktunn_3
	  ,[ammopiskjarj_2011] as ammopiskjarj_3
      ,[ammopiskmaak_2011] as ammopiskmaak_3
      ,[amkopiskkoulk_2011] as amkopiskkoulk_3
      ,[amkopisktunn_2011] as amkopisktunn_3
      ,[amkopiskjarj_2011] as amkopiskjarj_3
      ,[amkopiskmaak_2011] as amkopiskmaak_3
      ,[yoopiskkoulk_2011] as yoopiskkoulk_3
      ,[yoopisktunn_2011] as yoopisktunn_3
      ,[yoopiskjarj_2011] as yoopiskjarj_3
      ,[yoopiskmaak_2011] as yoopiskmaak_3
      ,[monihaku_2011] as monihaku_3
      ,[ptoim1r4_2011] as ptoim1r4_3
      ,[amas_2011] as amas_3

      ,[luopiskkoulk_2012] as luopiskkoulk_4
      ,[luopisktunn_2012] as luopisktunn_4
      ,[luopiskjarj_2012] as luopiskjarj_4
      ,[luopiskmaak_2012] as luopiskmaak_4
      ,[ammopiskkoulk_2012] as ammopiskkoulk_4
      ,[ammopisktunn_2012] as ammopisktunn_4
      ,[ammopiskjarj_2012] as ammopiskjarj_4
      ,[ammopiskmaak_2012] as ammopiskmaak_4
      ,[amkopiskkoulk_2012] as amkopiskkoulk_4
      ,[amkopisktunn_2012] as amkopisktunn_4
      ,[amkopiskjarj_2012] as amkopiskjarj_4
      ,[amkopiskmaak_2012] as amkopiskmaak_4
      ,[yoopiskkoulk_2012] as yoopiskkoulk_4
      ,[yoopisktunn_2012] as yoopisktunn_4
      ,[yoopiskjarj_2012] as yoopiskjarj_4
      ,[yoopiskmaak_2012] as yoopiskmaak_4
      ,[monihaku_2012] as monihaku_4
      ,[ptoim1r4_2012] as ptoim1r4_4
      ,[amas_2012] as amas_4

      ,[luopiskkoulk_2013] as luopiskkoulk_5
      ,[luopisktunn_2013] as luopisktunn_5
      ,[luopiskjarj_2013] as luopiskjarj_5
      ,[luopiskmaak_2013] as luopiskmaak_5
      ,[ammopiskkoulk_2013] as ammopiskkoulk_5
      ,[ammopisktunn_2013] as ammopisktunn_5
      ,[ammopiskjarj_2013] as ammopiskjarj_5
      ,[ammopiskmaak_2013] as ammopiskmaak_5
      ,[amkopiskkoulk_2013] as amkopiskkoulk_5
      ,[amkopisktunn_2013] as amkopisktunn_5
      ,[amkopiskjarj_2013] as amkopiskjarj_5
      ,[amkopiskmaak_2013] as amkopiskmaak_5
      ,[yoopiskkoulk_2013] as yoopiskkoulk_5
      ,[yoopisktunn_2013] as yoopisktunn_5
      ,[yoopiskjarj_2013] as yoopiskjarj_5
      ,[yoopiskmaak_2013] as yoopiskmaak_5
      ,[monihaku_2013] as monihaku_5
      ,[ptoim1r4_2013] as ptoim1r4_5
      ,[amas_2013] as amas_5

      ,[luopiskkoulk_2014] as luopiskkoulk_6
      ,[luopisktunn_2014] as luopisktunn_6
      ,[luopiskjarj_2014] as luopiskjarj_6
      ,[luopiskmaak_2014] as luopiskmaak_6
      ,[ammopiskkoulk_2014] as ammopiskkoulk_6
      ,[ammopisktunn_2014] as ammopisktunn_6
      ,[ammopiskjarj_2014] as ammopiskjarj_6
      ,[ammopiskmaak_2014] as ammopiskmaak_6
      ,[amkopiskkoulk_2014] as amkopiskkoulk_6
      ,[amkopisktunn_2014] as amkopisktunn_6
      ,[amkopiskjarj_2014] as amkopiskjarj_6
      ,[amkopiskmaak_2014] as amkopiskmaak_6
      ,[yoopiskkoulk_2014] as yoopiskkoulk_6
      ,[yoopisktunn_2014] as yoopisktunn_6
      ,[yoopiskjarj_2014] as yoopiskjarj_6
      ,[yoopiskmaak_2014] as yoopiskmaak_6
      ,[monihaku_2014] as monihaku_6
      ,[ptoim1r4_2014] as ptoim1r4_6
      ,[amas_2014] as amas_6

	  ,[lkm]
	  ,[pohjkoul]
      ,[tietolahde]=''K3_13_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_13_sopv_16]

UNION ALL

SELECT
       [tilv]
      ,cast(tilv + ''0101'' as date) as tilv_date
      ,[tutkryh]
      ,[suorv]
      ,[suorlk]
      ,[sp]
      ,[syntv]
      ,[aikielir1]
      ,[tutkaskun]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
      ,[tunn] 
      ,[jarj]
      ,[kkielir1]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[tutkmaak] 

      ,[luopiskkoulk_2010] as luopiskkoulk_1
      ,[luopisktunn_2010] as luopisktunn_1
      ,[luopiskjarj_2010] as luopiskjarj_1
      ,[luopiskmaak_2010] as luopiskmaak_1
      ,[ammopiskkoulk_2010] as ammopiskkoulk_1
      ,[ammopisktunn_2010] as ammopisktunn_1
      ,[ammopiskjarj_2010] as ammopiskjarj_1
      ,[ammopiskmaak_2010] as ammopiskmaak_1
      ,[amkopiskkoulk_2010] as amkopiskkoulk_1
      ,[amkopisktunn_2010] as amkopisktunn_1
      ,[amkopiskjarj_2010] as amkopiskjarj_1
      ,[amkopiskmaak_2010] as amkopiskmaak_1
      ,[yoopiskkoulk_2010] as yoopiskkoulk_1
      ,[yoopisktunn_2010] as yoopisktunn_1
      ,[yoopiskjarj_2010] as yoopiskjarj_1
      ,[yoopiskmaak_2010] as yoopiskmaak_1
      ,[monihaku_2010] as monihaku_1
      ,[ptoim1r4_2010] as [ptoim1r4_1]
      ,[amas_2010] as [amas_1]

      ,[luopiskkoulk_2011] as luopiskkoulk_2
      ,[luopisktunn_2011] as luopisktunn_2
      ,[luopiskjarj_2011] as luopiskjarj_2
      ,[luopiskmaak_2011] as luopiskmaak_2
      ,[ammopiskkoulk_2011] as ammopiskkoulk_2
      ,[ammopisktunn_2011] as ammopisktunn_2
      ,[ammopiskjarj_2011] as ammopiskjarj_2
      ,[ammopiskmaak_2011] as ammopiskmaak_2
      ,[amkopiskkoulk_2011] as amkopiskkoulk_2
      ,[amkopisktunn_2011] as amkopisktunn_2
      ,[amkopiskjarj_2011] as amkopiskjarj_2
      ,[amkopiskmaak_2011] as amkopiskmaak_2
      ,[yoopiskkoulk_2011] as yoopiskkoulk_2
      ,[yoopisktunn_2011] as yoopisktunn_2
      ,[yoopiskjarj_2011] as yoopiskjarj_2
      ,[yoopiskmaak_2011] as yoopiskmaak_2
      ,[monihaku_2011] as monihaku_2
      ,[ptoim1r4_2011] as ptoim1r4_2
      ,[amas_2011] as amas_2

      ,[luopiskkoulk_2012] as luopiskkoulk_3
      ,[luopisktunn_2012] as luopisktunn_3
      ,[luopiskjarj_2012] as luopiskjarj_3
      ,[luopiskmaak_2012] as luopiskmaak_3
      ,[ammopiskkoulk_2012] as ammopiskkoulk_3    
      ,[ammopisktunn_2012] as ammopisktunn_3
	  ,[ammopiskjarj_2012] as ammopiskjarj_3
      ,[ammopiskmaak_2012] as ammopiskmaak_3
      ,[amkopiskkoulk_2012] as amkopiskkoulk_3
      ,[amkopisktunn_2012] as amkopisktunn_3
      ,[amkopiskjarj_2012] as amkopiskjarj_3
      ,[amkopiskmaak_2012] as amkopiskmaak_3
      ,[yoopiskkoulk_2012] as yoopiskkoulk_3
      ,[yoopisktunn_2012] as yoopisktunn_3
      ,[yoopiskjarj_2012] as yoopiskjarj_3
      ,[yoopiskmaak_2012] as yoopiskmaak_3
      ,[monihaku_2012] as monihaku_3
      ,[ptoim1r4_2012] as ptoim1r4_3
      ,[amas_2012] as amas_3

      ,[luopiskkoulk_2013] as luopiskkoulk_4
      ,[luopisktunn_2013] as luopisktunn_4
      ,[luopiskjarj_2013] as luopiskjarj_4
      ,[luopiskmaak_2013] as luopiskmaak_4
      ,[ammopiskkoulk_2013] as ammopiskkoulk_4
      ,[ammopisktunn_2013] as ammopisktunn_4
      ,[ammopiskjarj_2013] as ammopiskjarj_4
      ,[ammopiskmaak_2013] as ammopiskmaak_4
      ,[amkopiskkoulk_2013] as amkopiskkoulk_4
      ,[amkopisktunn_2013] as amkopisktunn_4
      ,[amkopiskjarj_2013] as amkopiskjarj_4
      ,[amkopiskmaak_2013] as amkopiskmaak_4
      ,[yoopiskkoulk_2013] as yoopiskkoulk_4
      ,[yoopisktunn_2013] as yoopisktunn_4
      ,[yoopiskjarj_2013] as yoopiskjarj_4
      ,[yoopiskmaak_2013] as yoopiskmaak_4
      ,[monihaku_2013] as monihaku_4
      ,[ptoim1r4_2013] as ptoim1r4_4
      ,[amas_2013] as amas_4

      ,[luopiskkoulk_2014] as luopiskkoulk_5
      ,[luopisktunn_2014] as luopisktunn_5
      ,[luopiskjarj_2014] as luopiskjarj_5
      ,[luopiskmaak_2014] as luopiskmaak_5
      ,[ammopiskkoulk_2014] as ammopiskkoulk_5
      ,[ammopisktunn_2014] as ammopisktunn_5
      ,[ammopiskjarj_2014] as ammopiskjarj_5
      ,[ammopiskmaak_2014] as ammopiskmaak_5
      ,[amkopiskkoulk_2014] as amkopiskkoulk_5
      ,[amkopisktunn_2014] as amkopisktunn_5
      ,[amkopiskjarj_2014] as amkopiskjarj_5
      ,[amkopiskmaak_2014] as amkopiskmaak_5
      ,[yoopiskkoulk_2014] as yoopiskkoulk_5
      ,[yoopisktunn_2014] as yoopisktunn_5
      ,[yoopiskjarj_2014] as yoopiskjarj_5
      ,[yoopiskmaak_2014] as yoopiskmaak_5
      ,[monihaku_2014] as monihaku_5
      ,[ptoim1r4_2014] as ptoim1r4_5
      ,[amas_2014] as amas_5

      ,[luopiskkoulk_2015] as luopiskkoulk_6
      ,[luopisktunn_2015] as luopisktunn_6
      ,[luopiskjarj_2015] as luopiskjarj_6
      ,[luopiskmaak_2015] as luopiskmaak_6
      ,[ammopiskkoulk_2015] as ammopiskkoulk_6
      ,[ammopisktunn_2015] as ammopisktunn_6
      ,[ammopiskjarj_2015] as ammopiskjarj_6
      ,[ammopiskmaak_2015] as ammopiskmaak_6
      ,[amkopiskkoulk_2015] as amkopiskkoulk_6
      ,[amkopisktunn_2015] as amkopisktunn_6
      ,[amkopiskjarj_2015] as amkopiskjarj_6
      ,[amkopiskmaak_2015] as amkopiskmaak_6
      ,[yoopiskkoulk_2015] as yoopiskkoulk_6
      ,[yoopisktunn_2015] as yoopisktunn_6
      ,[yoopiskjarj_2015] as yoopiskjarj_6
      ,[yoopiskmaak_2015] as yoopiskmaak_6
      ,[monihaku_2015] as monihaku_6
      ,[ptoim1r4_2015] as ptoim1r4_6
      ,[amas_2015] as amas_6

	  ,[lkm]
	  ,[pohjkoul]
      ,[tietolahde]=''K3_13_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_13_sopv_17]

UNION ALL

SELECT
       [tilv]
      ,cast(tilv + ''0101'' as date) as tilv_date
      ,[tutkryh]
      ,[suorv]
      ,[suorlk]
      ,[sp]
      ,[syntv]
      ,[aikielir1]
      ,[tutkaskun]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
      ,[tunn] 
      ,[jarj]
      ,[kkielir1]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[tutkmaak] 

      ,[luopiskkoulk_2011] as luopiskkoulk_1
      ,[luopisktunn_2011] as luopisktunn_1
      ,[luopiskjarj_2011] as luopiskjarj_1
      ,[luopiskmaak_2011] as luopiskmaak_1
      ,[ammopiskkoulk_2011] as ammopiskkoulk_1
      ,[ammopisktunn_2011] as ammopisktunn_1
      ,[ammopiskjarj_2011] as ammopiskjarj_1
      ,[ammopiskmaak_2011] as ammopiskmaak_1
      ,[amkopiskkoulk_2011] as amkopiskkoulk_1
      ,[amkopisktunn_2011] as amkopisktunn_1
      ,[amkopiskjarj_2011] as amkopiskjarj_1
      ,[amkopiskmaak_2011] as amkopiskmaak_1
      ,[yoopiskkoulk_2011] as yoopiskkoulk_1
      ,[yoopisktunn_2011] as yoopisktunn_1
      ,[yoopiskjarj_2011] as yoopiskjarj_1
      ,[yoopiskmaak_2011] as yoopiskmaak_1
      ,[monihaku_2011] as monihaku_1
      ,[ptoim1r4_2011] as [ptoim1r4_1]
      ,[amas_2011] as [amas_1]

      ,[luopiskkoulk_2012] as luopiskkoulk_2
      ,[luopisktunn_2012] as luopisktunn_2
      ,[luopiskjarj_2012] as luopiskjarj_2
      ,[luopiskmaak_2012] as luopiskmaak_2
      ,[ammopiskkoulk_2012] as ammopiskkoulk_2
      ,[ammopisktunn_2012] as ammopisktunn_2
      ,[ammopiskjarj_2012] as ammopiskjarj_2
      ,[ammopiskmaak_2012] as ammopiskmaak_2
      ,[amkopiskkoulk_2012] as amkopiskkoulk_2
      ,[amkopisktunn_2012] as amkopisktunn_2
      ,[amkopiskjarj_2012] as amkopiskjarj_2
      ,[amkopiskmaak_2012] as amkopiskmaak_2
      ,[yoopiskkoulk_2012] as yoopiskkoulk_2
      ,[yoopisktunn_2012] as yoopisktunn_2
      ,[yoopiskjarj_2012] as yoopiskjarj_2
      ,[yoopiskmaak_2012] as yoopiskmaak_2
      ,[monihaku_2012] as monihaku_2
      ,[ptoim1r4_2012] as ptoim1r4_2
      ,[amas_2012] as amas_2

      ,[luopiskkoulk_2013] as luopiskkoulk_3
      ,[luopisktunn_2013] as luopisktunn_3
      ,[luopiskjarj_2013] as luopiskjarj_3
      ,[luopiskmaak_2013] as luopiskmaak_3
      ,[ammopiskkoulk_2013] as ammopiskkoulk_3    
      ,[ammopisktunn_2013] as ammopisktunn_3
	  ,[ammopiskjarj_2013] as ammopiskjarj_3
      ,[ammopiskmaak_2013] as ammopiskmaak_3
      ,[amkopiskkoulk_2013] as amkopiskkoulk_3
      ,[amkopisktunn_2013] as amkopisktunn_3
      ,[amkopiskjarj_2013] as amkopiskjarj_3
      ,[amkopiskmaak_2013] as amkopiskmaak_3
      ,[yoopiskkoulk_2013] as yoopiskkoulk_3
      ,[yoopisktunn_2013] as yoopisktunn_3
      ,[yoopiskjarj_2013] as yoopiskjarj_3
      ,[yoopiskmaak_2013] as yoopiskmaak_3
      ,[monihaku_2013] as monihaku_3
      ,[ptoim1r4_2013] as ptoim1r4_3
      ,[amas_2013] as amas_3

      ,[luopiskkoulk_2014] as luopiskkoulk_4
      ,[luopisktunn_2014] as luopisktunn_4
      ,[luopiskjarj_2014] as luopiskjarj_4
      ,[luopiskmaak_2014] as luopiskmaak_4
      ,[ammopiskkoulk_2014] as ammopiskkoulk_4
      ,[ammopisktunn_2014] as ammopisktunn_4
      ,[ammopiskjarj_2014] as ammopiskjarj_4
      ,[ammopiskmaak_2014] as ammopiskmaak_4
      ,[amkopiskkoulk_2014] as amkopiskkoulk_4
      ,[amkopisktunn_2014] as amkopisktunn_4
      ,[amkopiskjarj_2014] as amkopiskjarj_4
      ,[amkopiskmaak_2014] as amkopiskmaak_4
      ,[yoopiskkoulk_2014] as yoopiskkoulk_4
      ,[yoopisktunn_2014] as yoopisktunn_4
      ,[yoopiskjarj_2014] as yoopiskjarj_4
      ,[yoopiskmaak_2014] as yoopiskmaak_4
      ,[monihaku_2014] as monihaku_4
      ,[ptoim1r4_2014] as ptoim1r4_4
      ,[amas_2014] as amas_4

      ,[luopiskkoulk_2015] as luopiskkoulk_5
      ,[luopisktunn_2015] as luopisktunn_5
      ,[luopiskjarj_2015] as luopiskjarj_5
      ,[luopiskmaak_2015] as luopiskmaak_5
      ,[ammopiskkoulk_2015] as ammopiskkoulk_5
      ,[ammopisktunn_2015] as ammopisktunn_5
      ,[ammopiskjarj_2015] as ammopiskjarj_5
      ,[ammopiskmaak_2015] as ammopiskmaak_5
      ,[amkopiskkoulk_2015] as amkopiskkoulk_5
      ,[amkopisktunn_2015] as amkopisktunn_5
      ,[amkopiskjarj_2015] as amkopiskjarj_5
      ,[amkopiskmaak_2015] as amkopiskmaak_5
      ,[yoopiskkoulk_2015] as yoopiskkoulk_5
      ,[yoopisktunn_2015] as yoopisktunn_5
      ,[yoopiskjarj_2015] as yoopiskjarj_5
      ,[yoopiskmaak_2015] as yoopiskmaak_5
      ,[monihaku_2015] as monihaku_5
      ,[ptoim1r4_2015] as ptoim1r4_5
      ,[amas_2015] as amas_5

      ,[luopiskkoulk_2016] as luopiskkoulk_6
      ,[luopisktunn_2016] as luopisktunn_6
      ,[luopiskjarj_2016] as luopiskjarj_6
      ,[luopiskmaak_2016] as luopiskmaak_6
      ,[ammopiskkoulk_2016] as ammopiskkoulk_6
      ,[ammopisktunn_2016] as ammopisktunn_6
      ,[ammopiskjarj_2016] as ammopiskjarj_6
      ,[ammopiskmaak_2016] as ammopiskmaak_6
      ,[amkopiskkoulk_2016] as amkopiskkoulk_6
      ,[amkopisktunn_2016] as amkopisktunn_6
      ,[amkopiskjarj_2016] as amkopiskjarj_6
      ,[amkopiskmaak_2016] as amkopiskmaak_6
      ,[yoopiskkoulk_2016] as yoopiskkoulk_6
      ,[yoopisktunn_2016] as yoopisktunn_6
      ,[yoopiskjarj_2016] as yoopiskjarj_6
      ,[yoopiskmaak_2016] as yoopiskmaak_6
      ,[monihaku_2016] as monihaku_6
      ,[ptoim1r4_2016] as ptoim1r4_6
      ,[amas_2016] as amas_6

	  ,[lkm]
	  ,[pohjkoul]
      ,[tietolahde]=''K3_13_sopv_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_13_sopv_18]

UNION ALL

SELECT
       [tilv]
      ,cast(tilv + ''0101'' as date) as tilv_date
      ,[tutkryh]
      ,[suorv]
      ,[suorlk]
      ,[sp]
      ,[syntv]
      ,[aikielir1]
      ,[tutkaskun]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
      ,[tunn] 
      ,[jarj]
      ,[kkielir1]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[tutkmaak] 

      ,[luopiskkoulk_2012] as luopiskkoulk_1
      ,[luopisktunn_2012] as luopisktunn_1
      ,[luopiskjarj_2012] as luopiskjarj_1
      ,[luopiskmaak_2012] as luopiskmaak_1
      ,[ammopiskkoulk_2012] as ammopiskkoulk_1
      ,[ammopisktunn_2012] as ammopisktunn_1
      ,[ammopiskjarj_2012] as ammopiskjarj_1
      ,[ammopiskmaak_2012] as ammopiskmaak_1
      ,[amkopiskkoulk_2012] as amkopiskkoulk_1
      ,[amkopisktunn_2012] as amkopisktunn_1
      ,[amkopiskjarj_2012] as amkopiskjarj_1
      ,[amkopiskmaak_2012] as amkopiskmaak_1
      ,[yoopiskkoulk_2012] as yoopiskkoulk_1
      ,[yoopisktunn_2012] as yoopisktunn_1
      ,[yoopiskjarj_2012] as yoopiskjarj_1
      ,[yoopiskmaak_2012] as yoopiskmaak_1
      ,[monihaku_2012] as monihaku_1
      ,[ptoim1r4_2012] as [ptoim1r4_1]
      ,[amas_2012] as [amas_1]

      ,[luopiskkoulk_2013] as luopiskkoulk_2
      ,[luopisktunn_2013] as luopisktunn_2
      ,[luopiskjarj_2013] as luopiskjarj_2
      ,[luopiskmaak_2013] as luopiskmaak_2
      ,[ammopiskkoulk_2013] as ammopiskkoulk_2
      ,[ammopisktunn_2013] as ammopisktunn_2
      ,[ammopiskjarj_2013] as ammopiskjarj_2
      ,[ammopiskmaak_2013] as ammopiskmaak_2
      ,[amkopiskkoulk_2013] as amkopiskkoulk_2
      ,[amkopisktunn_2013] as amkopisktunn_2
      ,[amkopiskjarj_2013] as amkopiskjarj_2
      ,[amkopiskmaak_2013] as amkopiskmaak_2
      ,[yoopiskkoulk_2013] as yoopiskkoulk_2
      ,[yoopisktunn_2013] as yoopisktunn_2
      ,[yoopiskjarj_2013] as yoopiskjarj_2
      ,[yoopiskmaak_2013] as yoopiskmaak_2
      ,[monihaku_2013] as monihaku_2
      ,[ptoim1r4_2013] as ptoim1r4_2
      ,[amas_2013] as amas_2

      ,[luopiskkoulk_2014] as luopiskkoulk_3
      ,[luopisktunn_2014] as luopisktunn_3
      ,[luopiskjarj_2014] as luopiskjarj_3
      ,[luopiskmaak_2014] as luopiskmaak_3
      ,[ammopiskkoulk_2014] as ammopiskkoulk_3    
      ,[ammopisktunn_2014] as ammopisktunn_3
	  ,[ammopiskjarj_2014] as ammopiskjarj_3
      ,[ammopiskmaak_2014] as ammopiskmaak_3
      ,[amkopiskkoulk_2014] as amkopiskkoulk_3
      ,[amkopisktunn_2014] as amkopisktunn_3
      ,[amkopiskjarj_2014] as amkopiskjarj_3
      ,[amkopiskmaak_2014] as amkopiskmaak_3
      ,[yoopiskkoulk_2014] as yoopiskkoulk_3
      ,[yoopisktunn_2014] as yoopisktunn_3
      ,[yoopiskjarj_2014] as yoopiskjarj_3
      ,[yoopiskmaak_2014] as yoopiskmaak_3
      ,[monihaku_2014] as monihaku_3
      ,[ptoim1r4_2014] as ptoim1r4_3
      ,[amas_2014] as amas_3

      ,[luopiskkoulk_2015] as luopiskkoulk_4
      ,[luopisktunn_2015] as luopisktunn_4
      ,[luopiskjarj_2015] as luopiskjarj_4
      ,[luopiskmaak_2015] as luopiskmaak_4
      ,[ammopiskkoulk_2015] as ammopiskkoulk_4
      ,[ammopisktunn_2015] as ammopisktunn_4
      ,[ammopiskjarj_2015] as ammopiskjarj_4
      ,[ammopiskmaak_2015] as ammopiskmaak_4
      ,[amkopiskkoulk_2015] as amkopiskkoulk_4
      ,[amkopisktunn_2015] as amkopisktunn_4
      ,[amkopiskjarj_2015] as amkopiskjarj_4
      ,[amkopiskmaak_2015] as amkopiskmaak_4
      ,[yoopiskkoulk_2015] as yoopiskkoulk_4
      ,[yoopisktunn_2015] as yoopisktunn_4
      ,[yoopiskjarj_2015] as yoopiskjarj_4
      ,[yoopiskmaak_2015] as yoopiskmaak_4
      ,[monihaku_2015] as monihaku_4
      ,[ptoim1r4_2015] as ptoim1r4_4
      ,[amas_2015] as amas_4

      ,[luopiskkoulk_2016] as luopiskkoulk_5
      ,[luopisktunn_2016] as luopisktunn_5
      ,[luopiskjarj_2016] as luopiskjarj_5
      ,[luopiskmaak_2016] as luopiskmaak_5
      ,[ammopiskkoulk_2016] as ammopiskkoulk_5
      ,[ammopisktunn_2016] as ammopisktunn_5
      ,[ammopiskjarj_2016] as ammopiskjarj_5
      ,[ammopiskmaak_2016] as ammopiskmaak_5
      ,[amkopiskkoulk_2016] as amkopiskkoulk_5
      ,[amkopisktunn_2016] as amkopisktunn_5
      ,[amkopiskjarj_2016] as amkopiskjarj_5
      ,[amkopiskmaak_2016] as amkopiskmaak_5
      ,[yoopiskkoulk_2016] as yoopiskkoulk_5
      ,[yoopisktunn_2016] as yoopisktunn_5
      ,[yoopiskjarj_2016] as yoopiskjarj_5
      ,[yoopiskmaak_2016] as yoopiskmaak_5
      ,[monihaku_2016] as monihaku_5
      ,[ptoim1r4_2016] as ptoim1r4_5
      ,[amas_2016] as amas_5

      ,[luopiskkoulk_2017] as luopiskkoulk_6
      ,[luopisktunn_2017] as luopisktunn_6
      ,[luopiskjarj_2017] as luopiskjarj_6
      ,[luopiskmaak_2017] as luopiskmaak_6
      ,[ammopiskkoulk_2017] as ammopiskkoulk_6
      ,[ammopisktunn_2017] as ammopisktunn_6
      ,[ammopiskjarj_2017] as ammopiskjarj_6
      ,[ammopiskmaak_2017] as ammopiskmaak_6
      ,[amkopiskkoulk_2017] as amkopiskkoulk_6
      ,[amkopisktunn_2017] as amkopisktunn_6
      ,[amkopiskjarj_2017] as amkopiskjarj_6
      ,[amkopiskmaak_2017] as amkopiskmaak_6
      ,[yoopiskkoulk_2017] as yoopiskkoulk_6
      ,[yoopisktunn_2017] as yoopisktunn_6
      ,[yoopiskjarj_2017] as yoopiskjarj_6
      ,[yoopiskmaak_2017] as yoopiskmaak_6
      ,[monihaku_2017] as monihaku_6
      ,[ptoim1r4_2017] as ptoim1r4_6
      ,[amas_2017] as amas_6

	  ,[lkm]
	  ,[pohjkoul]
      ,[tietolahde]=''K3_13_sopv_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_13_sopv_19]

--kopio koodi alta ja päivitä vuodet lähdemateriaalin mukaan REPLACE-toiminnolla, esim. TK_K3_13_sopv_18 VUOSI1 -> 2011
/*
UNION ALL

SELECT
       [tilv]
      ,cast(tilv + ''0101'' as date) as tilv_date
      ,[tutkryh]
      ,[suorv]
      ,[suorlk]
      ,[sp]
      ,[syntv]
      ,[aikielir1]
      ,[tutkaskun]
      ,[kansalr1]
      ,[pohjmaa]
      ,[eumaa]
      ,[etamaa]
      ,[tunn] 
      ,[jarj]
      ,[kkielir1]
      ,[tutklaja]
      ,[tutktav]
      ,[aikoul]
      ,[tutkmaak] 

      ,[luopiskkoulk_VUOSI1] as luopiskkoulk_1
      ,[luopisktunn_VUOSI1] as luopisktunn_1
      ,[luopiskjarj_VUOSI1] as luopiskjarj_1
      ,[luopiskmaak_VUOSI1] as luopiskmaak_1
      ,[ammopiskkoulk_VUOSI1] as ammopiskkoulk_1
      ,[ammopisktunn_VUOSI1] as ammopisktunn_1
      ,[ammopiskjarj_VUOSI1] as ammopiskjarj_1
      ,[ammopiskmaak_VUOSI1] as ammopiskmaak_1
      ,[amkopiskkoulk_VUOSI1] as amkopiskkoulk_1
      ,[amkopisktunn_VUOSI1] as amkopisktunn_1
      ,[amkopiskjarj_VUOSI1] as amkopiskjarj_1
      ,[amkopiskmaak_VUOSI1] as amkopiskmaak_1
      ,[yoopiskkoulk_VUOSI1] as yoopiskkoulk_1
      ,[yoopisktunn_VUOSI1] as yoopisktunn_1
      ,[yoopiskjarj_VUOSI1] as yoopiskjarj_1
      ,[yoopiskmaak_VUOSI1] as yoopiskmaak_1
      ,[monihaku_VUOSI1] as monihaku_1
      ,[ptoim1r4_VUOSI1] as [ptoim1r4_1]
      ,[amas_VUOSI1] as [amas_1]

      ,[luopiskkoulk_VUOSI2] as luopiskkoulk_2
      ,[luopisktunn_VUOSI2] as luopisktunn_2
      ,[luopiskjarj_VUOSI2] as luopiskjarj_2
      ,[luopiskmaak_VUOSI2] as luopiskmaak_2
      ,[ammopiskkoulk_VUOSI2] as ammopiskkoulk_2
      ,[ammopisktunn_VUOSI2] as ammopisktunn_2
      ,[ammopiskjarj_VUOSI2] as ammopiskjarj_2
      ,[ammopiskmaak_VUOSI2] as ammopiskmaak_2
      ,[amkopiskkoulk_VUOSI2] as amkopiskkoulk_2
      ,[amkopisktunn_VUOSI2] as amkopisktunn_2
      ,[amkopiskjarj_VUOSI2] as amkopiskjarj_2
      ,[amkopiskmaak_VUOSI2] as amkopiskmaak_2
      ,[yoopiskkoulk_VUOSI2] as yoopiskkoulk_2
      ,[yoopisktunn_VUOSI2] as yoopisktunn_2
      ,[yoopiskjarj_VUOSI2] as yoopiskjarj_2
      ,[yoopiskmaak_VUOSI2] as yoopiskmaak_2
      ,[monihaku_VUOSI2] as monihaku_2
      ,[ptoim1r4_VUOSI2] as ptoim1r4_2
      ,[amas_VUOSI2] as amas_2

      ,[luopiskkoulk_VUOSI3] as luopiskkoulk_3
      ,[luopisktunn_VUOSI3] as luopisktunn_3
      ,[luopiskjarj_VUOSI3] as luopiskjarj_3
      ,[luopiskmaak_VUOSI3] as luopiskmaak_3
      ,[ammopiskkoulk_VUOSI3] as ammopiskkoulk_3    
      ,[ammopisktunn_VUOSI3] as ammopisktunn_3
	  ,[ammopiskjarj_VUOSI3] as ammopiskjarj_3
      ,[ammopiskmaak_VUOSI3] as ammopiskmaak_3
      ,[amkopiskkoulk_VUOSI3] as amkopiskkoulk_3
      ,[amkopisktunn_VUOSI3] as amkopisktunn_3
      ,[amkopiskjarj_VUOSI3] as amkopiskjarj_3
      ,[amkopiskmaak_VUOSI3] as amkopiskmaak_3
      ,[yoopiskkoulk_VUOSI3] as yoopiskkoulk_3
      ,[yoopisktunn_VUOSI3] as yoopisktunn_3
      ,[yoopiskjarj_VUOSI3] as yoopiskjarj_3
      ,[yoopiskmaak_VUOSI3] as yoopiskmaak_3
      ,[monihaku_VUOSI3] as monihaku_3
      ,[ptoim1r4_VUOSI3] as ptoim1r4_3
      ,[amas_VUOSI3] as amas_3

      ,[luopiskkoulk_VUOSI4] as luopiskkoulk_4
      ,[luopisktunn_VUOSI4] as luopisktunn_4
      ,[luopiskjarj_VUOSI4] as luopiskjarj_4
      ,[luopiskmaak_VUOSI4] as luopiskmaak_4
      ,[ammopiskkoulk_VUOSI4] as ammopiskkoulk_4
      ,[ammopisktunn_VUOSI4] as ammopisktunn_4
      ,[ammopiskjarj_VUOSI4] as ammopiskjarj_4
      ,[ammopiskmaak_VUOSI4] as ammopiskmaak_4
      ,[amkopiskkoulk_VUOSI4] as amkopiskkoulk_4
      ,[amkopisktunn_VUOSI4] as amkopisktunn_4
      ,[amkopiskjarj_VUOSI4] as amkopiskjarj_4
      ,[amkopiskmaak_VUOSI4] as amkopiskmaak_4
      ,[yoopiskkoulk_VUOSI4] as yoopiskkoulk_4
      ,[yoopisktunn_VUOSI4] as yoopisktunn_4
      ,[yoopiskjarj_VUOSI4] as yoopiskjarj_4
      ,[yoopiskmaak_VUOSI4] as yoopiskmaak_4
      ,[monihaku_VUOSI4] as monihaku_4
      ,[ptoim1r4_VUOSI4] as ptoim1r4_4
      ,[amas_VUOSI4] as amas_4

      ,[luopiskkoulk_VUOSI5] as luopiskkoulk_5
      ,[luopisktunn_VUOSI5] as luopisktunn_5
      ,[luopiskjarj_VUOSI5] as luopiskjarj_5
      ,[luopiskmaak_VUOSI5] as luopiskmaak_5
      ,[ammopiskkoulk_VUOSI5] as ammopiskkoulk_5
      ,[ammopisktunn_VUOSI5] as ammopisktunn_5
      ,[ammopiskjarj_VUOSI5] as ammopiskjarj_5
      ,[ammopiskmaak_VUOSI5] as ammopiskmaak_5
      ,[amkopiskkoulk_VUOSI5] as amkopiskkoulk_5
      ,[amkopisktunn_VUOSI5] as amkopisktunn_5
      ,[amkopiskjarj_VUOSI5] as amkopiskjarj_5
      ,[amkopiskmaak_VUOSI5] as amkopiskmaak_5
      ,[yoopiskkoulk_VUOSI5] as yoopiskkoulk_5
      ,[yoopisktunn_VUOSI5] as yoopisktunn_5
      ,[yoopiskjarj_VUOSI5] as yoopiskjarj_5
      ,[yoopiskmaak_VUOSI5] as yoopiskmaak_5
      ,[monihaku_VUOSI5] as monihaku_5
      ,[ptoim1r4_VUOSI5] as ptoim1r4_5
      ,[amas_VUOSI5] as amas_5

      ,[luopiskkoulk_VUOSI6] as luopiskkoulk_6
      ,[luopisktunn_VUOSI6] as luopisktunn_6
      ,[luopiskjarj_VUOSI6] as luopiskjarj_6
      ,[luopiskmaak_VUOSI6] as luopiskmaak_6
      ,[ammopiskkoulk_VUOSI6] as ammopiskkoulk_6
      ,[ammopisktunn_VUOSI6] as ammopisktunn_6
      ,[ammopiskjarj_VUOSI6] as ammopiskjarj_6
      ,[ammopiskmaak_VUOSI6] as ammopiskmaak_6
      ,[amkopiskkoulk_VUOSI6] as amkopiskkoulk_6
      ,[amkopisktunn_VUOSI6] as amkopisktunn_6
      ,[amkopiskjarj_VUOSI6] as amkopiskjarj_6
      ,[amkopiskmaak_VUOSI6] as amkopiskmaak_6
      ,[yoopiskkoulk_VUOSI6] as yoopiskkoulk_6
      ,[yoopisktunn_VUOSI6] as yoopisktunn_6
      ,[yoopiskjarj_VUOSI6] as yoopiskjarj_6
      ,[yoopiskmaak_VUOSI6] as yoopiskmaak_6
      ,[monihaku_VUOSI6] as monihaku_6
      ,[ptoim1r4_VUOSI6] as ptoim1r4_6
      ,[amas_VUOSI6] as amas_6

	  ,[lkm]
	  ,[pohjkoul]
      ,[tietolahde]=''K3_13_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K3_13_sopv_17]

*/

 
   ) Aineistot






' 
GO
/****** Object:  View [dbo].[v_sa_2_10_Korkeakouluopiskelijoiden_aikaisempi_koulutus]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_10_Korkeakouluopiskelijoiden_aikaisempi_koulutus]'))
EXEC dbo.sp_executesql @statement = N'




CREATE VIEW [dbo].[v_sa_2_10_Korkeakouluopiskelijoiden_aikaisempi_koulutus] AS

SELECT
      [tilv]= cast(kaikkivuodet.tilv as nvarchar(4))
	  ,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
      ,[lahde] = CAST(kaikkivuodet.lahde as nvarchar (2))
      ,[tunn]= CAST(kaikkivuodet.tunn as nvarchar (5))
      ,[jarj]= CAST(kaikkivuodet.jarj as nvarchar (10))
      ,[koulk]= CAST(kaikkivuodet.koulk as nvarchar (6))
	  ,[koulk_opintoala1995] = CAST(kaikkivuodet.koulk_opintoala1995 as nvarchar (6))
	  ,[koulk_opintoala2002] = CAST(kaikkivuodet.koulk_opintoala2002 as nvarchar (6))
	  ,[koulk_koulutusala2002] = CAST(kaikkivuodet.koulk_koulutusala2002 as nvarchar (6))
	  ,[koulk_koulutusaste2002] = CAST(kaikkivuodet.koulk_koulutusaste2002 as nvarchar (6))
      ,[kkun]= CAST(kaikkivuodet.kkun as nvarchar (3))
      ,[sp]= CAST(kaikkivuodet.sp as nvarchar (1))
      ,[aikielir1]= CAST(kaikkivuodet.aikielir1 as nvarchar (2))
      ,[syntv]= CAST(kaikkivuodet.syntv as nvarchar (4))
      ,[tilvaskun]= CAST(kaikkivuodet.tilvaskun as nvarchar (3))
      ,[kansal]= CAST(kaikkivuodet.kansal as nvarchar (1))
      ,[olotamm]= CAST(kaikkivuodet.olotamm as nvarchar (1))
      ,[olosyys]= CAST(kaikkivuodet.olosyys as nvarchar (1))
      ,[rahlahde]= CAST(kaikkivuodet.rahlahde as nvarchar (1))
      ,[fte]= CAST(kaikkivuodet.fte as nvarchar (1))
      ,[op45]= CAST(kaikkivuodet.op45 as nvarchar (1))
	  ,[op55]= CAST(kaikkivuodet.op55 as nvarchar (1))
      ,[alvv]= CAST(kaikkivuodet.alvv as nvarchar (4))
      ,[allk]= CAST(kaikkivuodet.allk as nvarchar (4))
      ,[alvv_kksek]= CAST(kaikkivuodet.alvv_kksek as nvarchar (4))
      ,[alvv_kksek_lasna]= CAST(kaikkivuodet.alvv_kksek_lasna as nvarchar (4))
      ,[alvv_sek]= CAST(kaikkivuodet.alvv_sek as nvarchar (4))
      ,[alvv_sek_lasna]= CAST(kaikkivuodet.alvv_sek_lasna as nvarchar (4))
      ,[alvv_kk]= CAST(kaikkivuodet.alvv_kk as nvarchar (4))
      ,[alvv_kk_lasna]= CAST(kaikkivuodet.alvv_kk_lasna as nvarchar (4))
      ,[alvv_opa]= CAST(kaikkivuodet.alvv_opa as nvarchar (4))
      ,[alvv_opa_lasna]= CAST(kaikkivuodet.alvv_opa_lasna as nvarchar (4))
      ,[koulutyp]= CAST(kaikkivuodet.koulutyp as nvarchar (1))
      ,[om]= CAST(kaikkivuodet.om as nvarchar (1))
      ,[avo]= CAST(kaikkivuodet.avo as nvarchar (1))
      ,[aikyotutk]= CAST(kaikkivuodet.aikyotutk as nvarchar (1))
      ,[aikyotutkkoulk]= CAST(kaikkivuodet.aikyotutkkoulk as nvarchar (6))
	  ,[aikyotutkkoulk_opintoala1995] = CAST(kaikkivuodet.koulk_opintoala1995 as nvarchar (6))
	  ,[aikyotutkkoulk_opintoala2002] = CAST(kaikkivuodet.koulk_opintoala2002 as nvarchar (6))
	  ,[aikyotutkkoulk_koulutusala2002] = CAST(kaikkivuodet.koulk_koulutusala2002 as nvarchar (6))
	  ,[aikyotutkkoulk_koulutusaste2002] = CAST(kaikkivuodet.koulk_koulutusaste2002 as nvarchar (6))
      ,[suvuosiyotutk]= CAST(kaikkivuodet.suvuosiyotutk as nvarchar (4))
      ,[tunnyotutk]= CAST(kaikkivuodet.tunnyotutk as nvarchar (5))
      ,[aikamm]= CAST(kaikkivuodet.aikamm as nvarchar (1))
      ,[aikammkoulk]= CAST(kaikkivuodet.aikammkoulk as nvarchar (6))
	  ,[aikammkoulk_opintoala1995] = CAST(kaikkivuodet.aikammkoulk_opintoala1995 as nvarchar (6))
	  ,[aikammkoulk_opintoala2002] = CAST(kaikkivuodet.aikammkoulk_opintoala2002 as nvarchar (6))
	  ,[aikammkoulk_koulutusala2002] = CAST(kaikkivuodet.aikammkoulk_koulutusala2002 as nvarchar (6))
	  ,[aikammkoulk_koulutusaste2002] = CAST(kaikkivuodet.aikammkoulk_koulutusaste2002 as nvarchar (6))
      ,[suvuosiamm]= CAST(kaikkivuodet.suvuosiamm as nvarchar (4))
      ,[tunnamm]= CAST(kaikkivuodet.tunnamm as nvarchar (5))
      ,[aikamk]= CAST(kaikkivuodet.aikamk as nvarchar (1))
      ,[aikamkkoulk]= CAST(kaikkivuodet.aikamkkoulk as nvarchar (6))
	  ,[aikamkkoulk_opintoala1995] = CAST(kaikkivuodet.aikamkkoulk_opintoala1995 as nvarchar (6))
	  ,[aikamkkoulk_opintoala2002] = CAST(kaikkivuodet.aikamkkoulk_opintoala2002 as nvarchar (6))
	  ,[aikamkkoulk_koulutusala2002] = CAST(kaikkivuodet.aikamkkoulk_koulutusala2002 as nvarchar (6))
	  ,[aikamkkoulk_koulutusaste2002] = CAST(kaikkivuodet.aikamkkoulk_koulutusaste2002 as nvarchar (6))
      ,[suvuosiamk]= CAST(kaikkivuodet.suvuosiamk as nvarchar (4))
      ,[tunnamk]= CAST(kaikkivuodet.tunnamk as nvarchar (5))
      ,[aikylamk]= CAST(kaikkivuodet.aikylamk as nvarchar (1))
      ,[aikylamkkoulk]= CAST(kaikkivuodet.aikylamkkoulk as nvarchar (6))
	  ,[aikylamkkoulk_opintoala1995] = CAST(kaikkivuodet.aikylamkkoulk_opintoala1995 as nvarchar (6))
	  ,[aikylamkkoulk_opintoala2002] = CAST(kaikkivuodet.aikylamkkoulk_opintoala2002 as nvarchar (6))
	  ,[aikylamkkoulk_koulutusala2002] = CAST(kaikkivuodet.aikylamkkoulk_koulutusala2002 as nvarchar (6))
	  ,[aikylamkkoulk_koulutusaste2002] = CAST(kaikkivuodet.aikylamkkoulk_koulutusaste2002 as nvarchar (6))
      ,[suvuosiylamk]= CAST(kaikkivuodet.suvuosiylamk as nvarchar (4))
      ,[tunnylamk]= CAST(kaikkivuodet.tunnylamk as nvarchar (5))
      ,[aikalkk]= CAST(kaikkivuodet.aikalkk as nvarchar (1))
      ,[aikalkkkoulk]= CAST(kaikkivuodet.aikalkkkoulk as nvarchar (6))
	  ,[aikalkkkoulk_opintoala1995] = CAST(kaikkivuodet.aikalkkkoulk_opintoala1995 as nvarchar (6))
	  ,[aikalkkkoulk_opintoala2002] = CAST(kaikkivuodet.aikalkkkoulk_opintoala2002 as nvarchar (6))
	  ,[aikalkkkoulk_koulutusala2002] = CAST(kaikkivuodet.aikalkkkoulk_koulutusala2002 as nvarchar (6))
	  ,[aikalkkkoulk_koulutusaste2002] = CAST(kaikkivuodet.aikalkkkoulk_koulutusaste2002 as nvarchar (6))
      ,[suvuosialkk]= CAST(kaikkivuodet.suvuosialkk as nvarchar (4))
      ,[tunnalkk]= CAST(kaikkivuodet.tunnalkk as nvarchar (5))
      ,[aikylkk]= CAST(kaikkivuodet.aikylkk as nvarchar (1))
      ,[aikylkkkoulk]= CAST(kaikkivuodet.aikylkkkoulk as nvarchar (6))
	  ,[aikylkkkoulk_opintoala1995] = CAST(kaikkivuodet.aikylkkkoulk_opintoala1995 as nvarchar (6))
	  ,[aikylkkkoulk_opintoala2002] = CAST(kaikkivuodet.aikylkkkoulk_opintoala2002 as nvarchar (6))
	  ,[aikylkkkoulk_koulutusala2002] = CAST(kaikkivuodet.aikylkkkoulk_koulutusala2002 as nvarchar (6))
	  ,[aikylkkkoulk_koulutusaste2002] = CAST(kaikkivuodet.aikylkkkoulk_koulutusaste2002 as nvarchar (6))
      ,[suvuosiylkk]= CAST(kaikkivuodet.suvuosiylkk as nvarchar (4))
      ,[tunnylkk]= CAST(kaikkivuodet.tunnylkk as nvarchar (5))
      ,[koulked]= CAST(kaikkivuodet.koulked as nvarchar (6))
      ,[opm02opaed]= CAST(kaikkivuodet.opm02opaed as nvarchar (3))
      ,[opm95opaed]= CAST(kaikkivuodet.opm95opaed as nvarchar (2))
      ,[lkm]= CAST(kaikkivuodet.lkm as int)
      ,[tietolahde]= CAST(kaikkivuodet.tietolahde as nvarchar(20))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)
 FROM (
SELECT [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
	  ,[koulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))

      ,[koulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
	  ,[koulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[kkun]
      ,[sp]
      ,[aikielir1]
      ,(CASE WHEN [syntv] = ''19XX'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvaskun]
      ,[kansal]
      ,[olotamm]
      ,[olosyys]
      ,[rahlahde]
      ,[fte]
      ,[op45]
	  ,[op55]= ''''
      ,[alvv]
      ,[allk]
      ,[alvv_kksek]
      ,[alvv_kksek_lasna]
      ,[alvv_sek]
      ,[alvv_sek_lasna]
      ,[alvv_kk]
      ,[alvv_kk_lasna]
      ,[alvv_opa]
      ,[alvv_opa_lasna]
      ,[koulutyp]
      ,[om]
      ,[avo]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
	  ,[aikyotutkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk] AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk] AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikyotutkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk] AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk] AND tilv+''0101'' between alkaa and paattyy)
	  ,(CASE WHEN [suvuosiyotutk] = ''19XX'' THEN ''''
      ELSE [suvuosiyotutk] END) AS suvuosiyotutk
      ,[opyotutk] as tunnyotutk
      ,[aikamm]
      ,[aikammkoulk]
	  ,[aikammkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikammkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
        ,(CASE WHEN [suvuosiamm] = ''19XX'' THEN ''''
      ELSE [suvuosiamm] END) AS suvuosiamm
      ,[opamm]as tunnamm
      ,[aikamk]
      ,[aikamkkoulk]
	  ,[aikamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosiamk] = ''19XX'' THEN ''''
      ELSE [suvuosiamk] END) AS suvuosiamk
      ,[kkamk] as tunnamk
      ,[aikylamk]
      ,[aikylamkkoulk]
	  ,[aikylamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	    ,(CASE WHEN [suvuosiylamk] = ''19XX'' THEN ''''
      ELSE [suvuosiylamk] END) AS suvuosiylamk
      ,[kkylamk] as tunnylamk
      ,[aikalkk]
      ,[aikalkkkoulk]
	  ,[aikalkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikalkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,(CASE WHEN [suvuosialkk] = ''19XX'' THEN ''''
      ELSE [suvuosialkk] END) AS suvuosialkk
      ,[kkalkk] as tunnalkk
      ,[aikylkk]
      ,[aikylkkkoulk]
	  ,[aikylkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	   ,(CASE WHEN [suvuosiylkk] = ''19XX'' THEN ''''
      ELSE [suvuosiylkk] END) AS suvuosiylkk
      ,[kkylkk] as tunnylkk
      ,[koulked]
      ,[opm02opaed]
      ,[opm95opaed]
      ,[lkm]
      ,[tietolahde]=''TK_2_10_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_10_sopv_11]	
  UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
      ,[koulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_opintoala2002] = (select distinct opintoala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
	  ,[koulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[kkun]
      ,[sp]
      ,[aikielir1]
       ,(CASE WHEN [syntv] = ''19XX'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvaskun]
      ,[kansal]
      ,[olotamm]
      ,[olosyys]
      ,[rahlahde]
      ,[fte]
      ,[op45]
	  ,[op55]
      ,[alvv]
      ,[allk]
      ,[alvv_kksek]
      ,[alvv_kksek_lasna]
      ,[alvv_sek]
      ,[alvv_sek_lasna]
      ,[alvv_kk]
      ,[alvv_kk_lasna]
      ,[alvv_opa]
      ,[alvv_opa_lasna]
      ,[koultyp]
      ,[om]
      ,[avo]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
	  ,[aikyotutkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikyotutkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
        ,(CASE WHEN [suvuosiyotutk] = ''19XX'' THEN ''''
      ELSE [suvuosiyotutk] END) AS suvuosiyotutk
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
	  ,[aikammkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus]where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikammkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosiamm] = ''19XX'' THEN ''''
      ELSE [suvuosiamm] END) AS suvuosiamm
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
	  ,[aikamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
     ,(CASE WHEN [suvuosiamk] = ''19XX'' THEN ''''
      ELSE [suvuosiamk] END) AS suvuosiamk
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
	  ,[aikylamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosiylamk] = ''19XX'' THEN ''''
      ELSE [suvuosiylamk] END) AS suvuosiylamk
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
	  ,[aikalkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikalkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosialkk] = ''19XX'' THEN ''''
      ELSE [suvuosialkk] END) AS suvuosialkk
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
	  ,[aikylkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiylkk] = ''19XX'' THEN ''''
      ELSE [suvuosiylkk] END) AS suvuosiylkk
      ,[tunnylkk]
      ,[koulked]
      ,[opm02opaed]
      ,[opm95opaed]
      ,[lkm]
      ,[tietolahde]=''TK_2_10_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_10_sopv_12]	-- vaihda takaisin siirtokantaan, kun TK:lta saadaan korjattu - Lasse 31.10.2016  -- vaihdettu takas 1.2.2017 - Lasse
 UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
	  ,[koulk_opintoala1995] = (select distinct opintoala1995_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_opintoala2002] = (select distinct opintoala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
	  ,[koulk_koulutusala2002] = (select distinct koulutusala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[kkun]
      ,[sp]
      ,[aikielir1]
       ,(CASE WHEN [syntv] = ''19XX'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvaskun]
      ,[kansal]
      ,[olotamm]
      ,[olosyys]
      ,[rahlahde]
      ,[fte]
      ,[op45]
	  ,[op55]
      ,[alvv]
      ,[allk]
      ,[alvv_kksek]
      ,[alvv_kksek_lasna]
      ,[alvv_sek]
      ,[alvv_sek_lasna]
      ,[alvv_kk]
      ,[alvv_kk_lasna]
      ,[alvv_opa]
      ,[alvv_opa_lasna]
      ,[koultyp]
      ,[om]
      ,[avo]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
	  ,[aikyotutkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikyotutkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
        ,(CASE WHEN [suvuosiyotutk] = ''19XX'' THEN ''''
      ELSE [suvuosiyotutk] END) AS suvuosiyotutk
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
	  ,[aikammkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikammkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamm] = ''19XX'' THEN ''''
      ELSE [suvuosiamm] END) AS suvuosiamm
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
	  ,[aikamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamk] = ''19XX'' THEN ''''
      ELSE [suvuosiamk] END) AS suvuosiamk
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
	  ,[aikylamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosiylamk] = ''19XX'' THEN ''''
      ELSE [suvuosiylamk] END) AS suvuosiylamk
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
	  ,[aikalkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikalkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
    ,(CASE WHEN [suvuosialkk] = ''19XX'' THEN ''''
      ELSE [suvuosialkk] END) AS suvuosialkk
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
	  ,[aikylkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiylkk] = ''19XX'' THEN ''''
      ELSE [suvuosiylkk] END) AS suvuosiylkk
      ,[tunnylkk]
      ,[koulked]
      ,[opm02opaed]
      ,[opm95opaed]
      ,[lkm]
      ,[tietolahde]=''TK_2_10_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_10_sopv_14]	

 UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
	  ,[koulk_opintoala1995] = (select distinct opintoala1995_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_opintoala2002] = (select distinct opintoala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
	  ,[koulk_koulutusala2002] = (select distinct koulutusala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[kkun]
      ,[sp]
      ,[aikielir1]
     ,(CASE WHEN [syntv] = ''19XX'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvaskun]
      ,[kansal]
      ,[olotamm]
      ,[olosyys]
      ,[rahlahde]
      ,[fte]
      ,[op45]
	  ,[op55]
      ,[alvv]
      ,[allk]
      ,[alvv_kksek]
      ,[alvv_kksek_lasna]
      ,[alvv_sek]
      ,[alvv_sek_lasna]
      ,[alvv_kk]
      ,[alvv_kk_lasna]
      ,[alvv_opa]
      ,[alvv_opa_lasna]
      ,[koultyp]
      ,[om]
      ,[avo]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
	  ,[aikyotutkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikyotutkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
        ,(CASE WHEN [suvuosiyotutk] = ''19XX'' THEN ''''
      ELSE [suvuosiyotutk] END) AS suvuosiyotutk
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
	  ,[aikammkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikammkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamm] = ''19XX'' THEN ''''
      ELSE [suvuosiamm] END) AS suvuosiamm
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
	  ,[aikamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamk] = ''19XX'' THEN ''''
      ELSE [suvuosiamk] END) AS suvuosiamk
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
	  ,[aikylamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus]where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosiylamk] = ''19XX'' THEN ''''
      ELSE [suvuosiylamk] END) AS suvuosiylamk
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
	  ,[aikalkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikalkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
     ,(CASE WHEN [suvuosialkk] = ''19XX'' THEN ''''
      ELSE [suvuosialkk] END) AS suvuosialkk
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
	  ,[aikylkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiylkk] = ''19XX'' THEN ''''
      ELSE [suvuosiylkk] END) AS suvuosiylkk
      ,[tunnylkk]
      ,[koulked]
      ,[opm02opaed]
      ,[opm95opaed]
      ,[lkm]
      ,[tietolahde]=''TK_2_10_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_10_sopv_15]	

 UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
	  ,[koulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_opintoala2002] = (select distinct opintoala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
	  ,[koulk_koulutusala2002] = (select distinct koulutusala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[kkun]
      ,[sp]
      ,[aikielir1]
     ,(CASE WHEN [syntv] = ''19XX'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvaskun]
      ,[kansal]
      ,[olotamm]
      ,[olosyys]
      ,[rahlahde]
      ,[fte]
      ,[op45]
	  ,[op55]
      ,[alvv]
      ,[allk]
      ,[alvv_kksek]
      ,[alvv_kksek_lasna]
      ,[alvv_sek]
      ,[alvv_sek_lasna]
      ,[alvv_kk]
      ,[alvv_kk_lasna]
      ,[alvv_opa]
      ,[alvv_opa_lasna]
      ,[koultyp]
      ,[om]
      ,[avo]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
	  ,[aikyotutkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikyotutkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
        ,(CASE WHEN [suvuosiyotutk] = ''19XX'' THEN ''''
      ELSE [suvuosiyotutk] END) AS suvuosiyotutk
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
	  ,[aikammkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikammkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamm] = ''19XX'' THEN ''''
      ELSE [suvuosiamm] END) AS suvuosiamm
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
	  ,[aikamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamk] = ''19XX'' THEN ''''
      ELSE [suvuosiamk] END) AS suvuosiamk
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
	  ,[aikylamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus]  where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosiylamk] = ''19XX'' THEN ''''
      ELSE [suvuosiylamk] END) AS suvuosiylamk
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
	  ,[aikalkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikalkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
     ,(CASE WHEN [suvuosialkk] = ''19XX'' THEN ''''
      ELSE [suvuosialkk] END) AS suvuosialkk
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
	  ,[aikylkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiylkk] = ''19XX'' THEN ''''
      ELSE [suvuosiylkk] END) AS suvuosiylkk
      ,[tunnylkk]
      ,[koulked]
      ,[opm02opaed]
      ,[opm95opaed]
      ,[lkm]
      ,[tietolahde]=''TK_2_10_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_10_sopv_16]	


 UNION ALL

  SELECT [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
	  ,[koulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_opintoala2002] = (select distinct opintoala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
	  ,[koulk_koulutusala2002] = (select distinct koulutusala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[kkun]
      ,[sp]
      ,[aikielir1]
     ,(CASE WHEN [syntv] = ''19XX'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvaskun]
      ,[kansal]
      ,[olotamm]
      ,[olosyys]
      ,[rahlahde]
      ,[fte]
      ,[op45]
	  ,[op55]
      ,[alvv]
      ,[allk]
      ,[alvv_kksek]
      ,[alvv_kksek_lasna]
      ,[alvv_sek]
      ,[alvv_sek_lasna]
      ,[alvv_kk]
      ,[alvv_kk_lasna]
      ,[alvv_opa]
      ,[alvv_opa_lasna]
      ,[koultyp]
      ,[om]
      ,[avo]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
	  ,[aikyotutkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikyotutkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
        ,(CASE WHEN [suvuosiyotutk] = ''19XX'' THEN ''''
      ELSE [suvuosiyotutk] END) AS suvuosiyotutk
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
	  ,[aikammkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikammkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamm] = ''19XX'' THEN ''''
      ELSE [suvuosiamm] END) AS suvuosiamm
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
	  ,[aikamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamk] = ''19XX'' THEN ''''
      ELSE [suvuosiamk] END) AS suvuosiamk
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
	  ,[aikylamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus]  where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosiylamk] = ''19XX'' THEN ''''
      ELSE [suvuosiylamk] END) AS suvuosiylamk
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
	  ,[aikalkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikalkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
     ,(CASE WHEN [suvuosialkk] = ''19XX'' THEN ''''
      ELSE [suvuosialkk] END) AS suvuosialkk
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
	  ,[aikylkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiylkk] = ''19XX'' THEN ''''
      ELSE [suvuosiylkk] END) AS suvuosiylkk
      ,[tunnylkk]
      ,[koulked]
      ,[opm02opaed]
      ,[opm95opaed]
      ,[lkm]
      ,[tietolahde]=''TK_2_10_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_10_sopv_17]
  
  UNION ALL

  SELECT [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
	  ,[koulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_opintoala2002] = (select distinct opintoala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
	  ,[koulk_koulutusala2002] = (select distinct koulutusala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[kkun]
      ,[sp]
      ,[aikielir1]
     ,(CASE WHEN [syntv] = ''19XX'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvaskun]
      ,[kansal]
      ,[olotamm]
      ,[olosyys]
      ,[rahlahde]
      ,[fte]
      ,[op45]
	  ,[op55]
      ,[alvv]
      ,[allk]
      ,[alvv_kksek]
      ,[alvv_kksek_lasna]
      ,[alvv_sek]
      ,[alvv_sek_lasna]
      ,[alvv_kk]
      ,[alvv_kk_lasna]
      ,[alvv_opa]
      ,[alvv_opa_lasna]
      ,[koultyp]
      ,[om]
      ,[avo]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
	  ,[aikyotutkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikyotutkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
        ,(CASE WHEN [suvuosiyotutk] = ''19XX'' THEN ''''
      ELSE [suvuosiyotutk] END) AS suvuosiyotutk
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
	  ,[aikammkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikammkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamm] = ''19XX'' THEN ''''
      ELSE [suvuosiamm] END) AS suvuosiamm
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
	  ,[aikamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamk] = ''19XX'' THEN ''''
      ELSE [suvuosiamk] END) AS suvuosiamk
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
	  ,[aikylamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus]  where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosiylamk] = ''19XX'' THEN ''''
      ELSE [suvuosiylamk] END) AS suvuosiylamk
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
	  ,[aikalkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikalkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
     ,(CASE WHEN [suvuosialkk] = ''19XX'' THEN ''''
      ELSE [suvuosialkk] END) AS suvuosialkk
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
	  ,[aikylkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiylkk] = ''19XX'' THEN ''''
      ELSE [suvuosiylkk] END) AS suvuosiylkk
      ,[tunnylkk]
      ,[koulked]
      ,[opm02opaed]
      ,[opm95opaed]
      ,[lkm]
      ,[tietolahde]=''TK_2_10_sopv_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_10_sopv_18]
 
  UNION ALL

  SELECT [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
	  ,[koulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_opintoala2002] = (select distinct opintoala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
	  ,[koulk_koulutusala2002] = (select distinct koulutusala2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[koulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi    from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk] and tilv+''0101'' between
	  (alkaa) and (paattyy))
      ,[kkun]
      ,[sp]
      ,[aikielir1]
     ,(CASE WHEN [syntv] = ''19XX'' THEN ''''
      ELSE [syntv] END) AS syntv
      ,[tilvaskun]
      ,[kansal]
      ,[olotamm]
      ,[olosyys]
      ,[rahlahde]
      ,[fte]
      ,[op45]
	  ,[op55]
      ,[alvv]
      ,[allk]
      ,[alvv_kksek]
      ,[alvv_kksek_lasna]
      ,[alvv_sek]
      ,[alvv_sek_lasna]
      ,[alvv_kk]
      ,[alvv_kk_lasna]
      ,[alvv_opa]
      ,[alvv_opa_lasna]
      ,[koultyp]
      ,[om]
      ,[avo]
      ,[aikyotutk]
      ,[aikyotutkkoulk]
	  ,[aikyotutkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikyotutkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikyotutkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikyotutkkoulk]AND tilv+''0101'' between alkaa and paattyy)
        ,(CASE WHEN [suvuosiyotutk] = ''19XX'' THEN ''''
      ELSE [suvuosiyotutk] END) AS suvuosiyotutk
      ,[tunnyotutk]
      ,[aikamm]
      ,[aikammkoulk]
	  ,[aikammkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikammkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikammkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikammkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamm] = ''19XX'' THEN ''''
      ELSE [suvuosiamm] END) AS suvuosiamm
      ,[tunnamm]
      ,[aikamk]
      ,[aikamkkoulk]
	  ,[aikamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiamk] = ''19XX'' THEN ''''
      ELSE [suvuosiamk] END) AS suvuosiamk
      ,[tunnamk]
      ,[aikylamk]
      ,[aikylamkkoulk]
	  ,[aikylamkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylamkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus]  where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylamkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylamkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,(CASE WHEN [suvuosiylamk] = ''19XX'' THEN ''''
      ELSE [suvuosiylamk] END) AS suvuosiylamk
      ,[tunnylamk]
      ,[aikalkk]
      ,[aikalkkkoulk]
	  ,[aikalkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikalkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikalkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikalkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
     ,(CASE WHEN [suvuosialkk] = ''19XX'' THEN ''''
      ELSE [suvuosialkk] END) AS suvuosialkk
      ,[tunnalkk]
      ,[aikylkk]
      ,[aikylkkkoulk]
	  ,[aikylkkkoulk_opintoala1995] = (select distinct opintoala1995_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_opintoala2002] = (select distinct opintoala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
	  ,[aikylkkkoulk_koulutusala2002] = (select distinct koulutusala2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
      ,[aikylkkkoulk_koulutusaste2002] = (select distinct koulutusaste2002_koodi   from [VipunenTK_DW].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [aikylkkkoulk]AND tilv+''0101'' between alkaa and paattyy)
       ,(CASE WHEN [suvuosiylkk] = ''19XX'' THEN ''''
      ELSE [suvuosiylkk] END) AS suvuosiylkk
      ,[tunnylkk]
      ,[koulked]
      ,[opm02opaed]
      ,[opm95opaed] = null
      ,[lkm]
      ,[tietolahde]=''TK_2_10_sopv_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K2_10_sopv_19]


) as kaikkivuodet




' 
GO
/****** Object:  View [dbo].[v_sa_2_11_Oppilaitosten_tutkintoon_johtamaton]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_11_Oppilaitosten_tutkintoon_johtamaton]'))
EXEC dbo.sp_executesql @statement = N'





-- CSC Jarmo Nieminen 8.5.2014
-- Näkymä hakee kaikki Tutkintoon johtamattoman kuution lähdetaulut ja kokoaa ne yhteen 
-- 
-- Select * from VipunenTK_SA.[dbo].v_sa_2_11_Oppilaitosten_tutkintoon_johtamaton
--
-- Drop table VipunenTK_DW.[dbo].sa_2_11_Oppilaitosten_tutkintoon_johtamaton
-- Select * into VipunenTK_DW.[dbo].sa_2_11_Oppilaitosten_tutkintoon_johtamaton from VipunenTK_SA.[dbo].v_sa_2_11_Oppilaitosten_tutkintoon_johtamaton
--
-- Truncate table VipunenTK_DW.[dbo].sa_2_11_Oppilaitosten_tutkintoon_johtamaton
-- Insert into VipunenTK_DW.[dbo].sa_2_11_Oppilaitosten_tutkintoon_johtamaton Select * from VipunenTK_SA.[dbo].v_sa_2_11_Oppilaitosten_tutkintoon_johtamaton



CREATE VIEW [dbo].[v_sa_2_11_Oppilaitosten_tutkintoon_johtamaton] AS

SELECT [tilv] = Cast(tilv as varchar(4))
	  ,tilv_date = Cast(tilv+''0101'' as DATE)
      ,[tunn] = Cast(isnull(nullif(right(''00000''+tunn,5),''00000''),''-1'') as nvarchar(5)) --Täydennetään etunollat. Jos tyhjä niin -1.
      ,[jarj] = Cast(jarj AS nvarchar(10))
      ,[osa1] = Cast([osa1] as int)
      ,[suo1] = Cast([suo1] as int)
      ,[osa2] = Cast([osa2] as int)
      ,[suo2] = Cast([suo2] as int)
      ,[osa3] = Cast([osa3] as int)
      ,[suo3] = Cast([suo3] as int)
      ,[kur4] = Cast([kur4] as int)
      ,[osa4] = Cast([osa4] as int)
      ,[nai4] = Cast([nai4] as int)
      ,[tun4] = Cast([tun4] as int)
      ,[kur5] = Cast([kur5] as int)
      ,[osa5] = Cast([osa5] as int)
      ,[nai5] = Cast([nai5] as int)
      ,[tun5] = Cast([tun5] as int)
      ,[kur6] = Cast([kur6] as int)
      ,[osa6] = Cast([osa6] as int)
      ,[nai6] = Cast([nai6] as int)
      ,[tun6] = Cast([tun6] as int)
      ,[kur7] = Cast([kur7] as int)
      ,[osa7] = Cast([osa7] as int)
      ,[nai7] = Cast([nai7] as int)
      ,[kur8] = Cast([kur8] as int)
      ,[osa8] = Cast([osa8] as int)
      ,[nai8] = Cast([nai8] as int)
      ,[kur9] = Cast([kur9] as int)
      ,[osa9] = Cast([osa9] as int)
      ,[nai9] = Cast([nai9] as int)
      ,[kur10] = Cast([kur10] as int)
      ,[osa10] = Cast([osa10] as int)
      ,[nai10] = Cast([nai10] as int)
      ,[kur11] = Cast([kur11] as int)
      ,[osa11] = Cast([osa11] as int)
      ,[nai11] = Cast([nai11] as int)
      ,[kur12] = Cast([kur12] as int)
      ,[osa12] = Cast([osa12] as int)
      ,[nai12] = Cast([nai12] as int)
      ,[kur13] = Cast([kur13] as int)
      ,[osa13] = Cast([osa13] as int)
      ,[nai13] = Cast([nai13] as int)
      ,[kur14] = Cast([kur14] as int)
      ,[osa14] = Cast([osa14] as int)
      ,[nai14] = Cast([nai14] as int)
      ,[kurd] = Cast([kurd] as int)
      ,[osad] = Cast([osad] as int)
      ,[naid] = Cast([naid] as int)
      ,[E11] = Cast([E11] as int)
      ,[E12] = Cast([E12] as int)
      ,[E13] = Cast([E13] as int)
      ,[E14] = Cast([E14] as int)
      ,[E15] = Cast([E15] as int)
      ,[E16] = Cast([E16] as int)
      ,[E17] = Cast([E17] as int)
      ,[E18] = Cast([E18] as int)
      ,[E19] = Cast([E19] as int)
      ,[E21] = Cast([E21] as int)
      ,[E22] = Cast([E22] as int)
      ,[E23] = Cast([E23] as int)
      ,[E24] = Cast([E24] as int)
      ,[E25] = Cast([E25] as int)
      ,[E26] = Cast([E26] as int)
      ,[E27] = Cast([E27] as int)
      ,[E28] = Cast([E28] as int)
      ,[E29] = Cast([E29] as int)
      ,[E31] = Cast([E31] as int)
      ,[E32] = Cast([E32] as int)
      ,[E33] = Cast([E33] as int)
      ,[E34] = Cast([E34] as int)
      ,[E35] = Cast([E35] as int)
      ,[E36] = Cast([E36] as int)
      ,[E37] = Cast([E37] as int)
      ,[E38] = Cast([E38] as int)
      ,[E39] = Cast([E39] as int)
      ,[E41] = Cast([E41] as int)
      ,[E42] = Cast([E42] as int)
      ,[E43] = Cast([E43] as int)
      ,[E44] = Cast([E44] as int)
      ,[E45] = Cast([E45] as int)
      ,[E46] = Cast([E46] as int)
      ,[E47] = Cast([E47] as int)
      ,[E48] = Cast([E48] as int)
      ,[E49] = Cast([E49] as int)
      ,[E51] = Cast([E51] as int)
      ,[E52] = Cast([E52] as int)
      ,[E53] = Cast([E53] as int)
      ,[E54] = Cast([E54] as int)
      ,[E55] = Cast([E55] as int)
      ,[E56] = Cast([E56] as int)
      ,[E57] = Cast([E57] as int)
      ,[E58] = Cast([E58] as int)
      ,[E59] = Cast([E59] as int)
      ,[E61] = Cast([E61] as int)
      ,[E62] = Cast([E62] as int)
      ,[E63] = Cast([E63] as int)
      ,[E64] = Cast([E64] as int)
      ,[E65] = Cast([E65] as int)
      ,[E66] = Cast([E66] as int)
      ,[E67] = Cast([E67] as int)
      ,[E68] = Cast([E68] as int)
      ,[E69] = Cast([E69] as int)
      ,[E71] = Cast([E71] as int)
      ,[E72] = Cast([E72] as int)
      ,[E73] = Cast([E73] as int)
      ,[E74] = Cast([E74] as int)
      ,[E75] = Cast([E75] as int)
      ,[E76] = Cast([E76] as int)
      ,[E77] = Cast([E77] as int)
      ,[E78] = Cast([E78] as int)
      ,[E79] = Cast([E79] as int)
      ,[E81] = Cast([E81] as int)
      ,[E82] = Cast([E82] as int)
      ,[E83] = Cast([E83] as int)
      ,[E84] = Cast([E84] as int)
      ,[E85] = Cast([E85] as int)
      ,[E86] = Cast([E86] as int)
      ,[E87] = Cast([E87] as int)
      ,[E88] = Cast([E88] as int)
      ,[E89] = Cast([E89] as int)
      ,[E91] = Cast([E91] as int)
      ,[E92] = Cast([E92] as int)
      ,[E93] = Cast([E93] as int)
      ,[E94] = Cast([E94] as int)
      ,[E95] = Cast([E95] as int)
      ,[E96] = Cast([E96] as int)
      ,[E97] = Cast([E97] as int)
      ,[E98] = Cast([E98] as int)
      ,[E99] = Cast([E99] as int)
      ,[E101] = Cast([E101] as int)
      ,[E102] = Cast([E102] as int)
      ,[E103] = Cast([E103] as int)
      ,[E104] = Cast([E104] as int)
      ,[E105] = Cast([E105] as int)
      ,[E106] = Cast([E106] as int)
      ,[E107] = Cast([E107] as int)
      ,[E108] = Cast([E108] as int)
      ,[E109] = Cast([E109] as int)
      ,[E111] = Cast([E111] as int)
      ,[E112] = Cast([E112] as int)
      ,[E113] = Cast([E113] as int)
      ,[E114] = Cast([E114] as int)
      ,[E115] = Cast([E115] as int)
      ,[E116] = Cast([E116] as int)
      ,[E117] = Cast([E117] as int)
      ,[E118] = Cast([E118] as int)
      ,[E119] = Cast([E119] as int)
      ,[E121] = Cast([E121] as int)
      ,[E122] = Cast([E122] as int)
      ,[E123] = Cast([E123] as int)
      ,[E124] = Cast([E124] as int)
      ,[E125] = Cast([E125] as int)
      ,[E126] = Cast([E126] as int)
      ,[E127] = Cast([E127] as int)
      ,[E128] = Cast([E128] as int)
      ,[E129] = Cast([E129] as int)
      ,[E131] = Cast([E131] as int)
      ,[E132] = Cast([E132] as int)
      ,[E133] = Cast([E133] as int)
      ,[E134] = Cast([E134] as int)
      ,[E135] = Cast([E135] as int)
      ,[E136] = Cast([E136] as int)
      ,[E137] = Cast([E137] as int)
      ,[E138] = Cast([E138] as int)
      ,[E139] = Cast([E139] as int)
      ,[E141] = Cast([E141] as int)
      ,[E142] = Cast([E142] as int)
      ,[E143] = Cast([E143] as int)
      ,[E144] = Cast([E144] as int)
      ,[E145] = Cast([E145] as int)
      ,[E146] = Cast([E146] as int)
      ,[E147] = Cast([E147] as int)
      ,[E148] = Cast([E148] as int)
      ,[E149] = Cast([E149] as int)
      ,[E151] = Cast([E151] as int)
      ,[E152] = Cast([E152] as int)
      ,[E153] = Cast([E153] as int)
      ,[E154] = Cast([E154] as int)
      ,[E155] = Cast([E155] as int)
      ,[E156] = Cast([E156] as int)
      ,[E157] = Cast([E157] as int)
      ,[E158] = Cast([E158] as int)
      ,[E159] = Cast([E159] as int)
      ,[E161] = Cast([E161] as int)
      ,[E162] = Cast([E162] as int)
      ,[E163] = Cast([E163] as int)
      ,[E164] = Cast([E164] as int)
      ,[E165] = Cast([E165] as int)
      ,[E166] = Cast([E166] as int)
      ,[E167] = Cast([E167] as int)
      ,[E168] = Cast([E168] as int)
      ,[E169] = Cast([E169] as int)
      ,[E171] = Cast([E171] as int)
      ,[E172] = Cast([E172] as int)
      ,[E173] = Cast([E173] as int)
      ,[E174] = Cast([E174] as int)
      ,[E175] = Cast([E175] as int)
      ,[E176] = Cast([E176] as int)
      ,[E177] = Cast([E177] as int)
      ,[E178] = Cast([E178] as int)
      ,[E179] = Cast([E179] as int)
      ,[E181] = Cast([E181] as int)
      ,[E182] = Cast([E182] as int)
      ,[E183] = Cast([E183] as int)
      ,[E184] = Cast([E184] as int)
      ,[E185] = Cast([E185] as int)
      ,[E186] = Cast([E186] as int)
      ,[E187] = Cast([E187] as int)
      ,[E188] = Cast([E188] as int)
      ,[E189] = Cast([E189] as int)
      ,[E191] = Cast([E191] as int)
      ,[E192] = Cast([E192] as int)
      ,[E193] = Cast([E193] as int)
      ,[E194] = Cast([E194] as int)
      ,[E195] = Cast([E195] as int)
      ,[E196] = Cast([E196] as int)
      ,[E197] = Cast([E197] as int)
      ,[E198] = Cast([E198] as int)
      ,[E199] = Cast([E199] as int)
      ,[E201] = Cast([E201] as int)
      ,[E202] = Cast([E202] as int)
      ,[E203] = Cast([E203] as int)
      ,[E204] = Cast([E204] as int)
      ,[E205] = Cast([E205] as int)
      ,[E206] = Cast([E206] as int)
      ,[E207] = Cast([E207] as int)
      ,[E208] = Cast([E208] as int)
      ,[E209] = Cast([E209] as int)
      ,[E211] = Cast([E211] as int)
      ,[E212] = Cast([E212] as int)
      ,[E213] = Cast([E213] as int)
      ,[E214] = Cast([E214] as int)
      ,[E215] = Cast([E215] as int)
      ,[E216] = Cast([E216] as int)
      ,[E217] = Cast([E217] as int)
      ,[E218] = Cast([E218] as int)
      ,[E219] = Cast([E219] as int)
      ,[E221] = Cast([E221] as int)
      ,[E222] = Cast([E222] as int)
      ,[E223] = Cast([E223] as int)
      ,[E224] = Cast([E224] as int)
      ,[E225] = Cast([E225] as int)
      ,[E226] = Cast([E226] as int)
      ,[E227] = Cast([E227] as int)
      ,[E228] = Cast([E228] as int)
      ,[E229] = Cast([E229] as int)
      ,[E231] = Cast([E231] as int)
      ,[E232] = Cast([E232] as int)
      ,[E233] = Cast([E233] as int)
      ,[E234] = Cast([E234] as int)
      ,[E235] = Cast([E235] as int)
      ,[E236] = Cast([E236] as int)
      ,[E237] = Cast([E237] as int)
      ,[E238] = Cast([E238] as int)
      ,[E239] = Cast([E239] as int)
      ,[E241] = Cast([E241] as int)
      ,[E242] = Cast([E242] as int)
      ,[E243] = Cast([E243] as int)
      ,[E244] = Cast([E244] as int)
      ,[E245] = Cast([E245] as int)
      ,[E246] = Cast([E246] as int)
      ,[E247] = Cast([E247] as int)
      ,[E248] = Cast([E248] as int)
      ,[E249] = Cast([E249] as int)
      ,[E251] = Cast([E251] as int)
      ,[E252] = Cast([E252] as int)
      ,[E253] = Cast([E253] as int)
      ,[E254] = Cast([E254] as int)
      ,[E255] = Cast([E255] as int)
      ,[E256] = Cast([E256] as int)
      ,[E257] = Cast([E257] as int)
      ,[E258] = Cast([E258] as int)
      ,[E259] = Cast([E259] as int)
      ,[E261] = Cast([E261] as int)
      ,[E262] = Cast([E262] as int)
      ,[E263] = Cast([E263] as int)
      ,[E264] = Cast([E264] as int)
      ,[E265] = Cast([E265] as int)
      ,[E266] = Cast([E266] as int)
      ,[E267] = Cast([E267] as int)
      ,[E268] = Cast([E268] as int)
      ,[E269] = Cast([E269] as int)
      ,[E271] = Cast([E271] as int)
      ,[E272] = Cast([E272] as int)
      ,[E273] = Cast([E273] as int)
      ,[E274] = Cast([E274] as int)
      ,[E275] = Cast([E275] as int)
      ,[E276] = Cast([E276] as int)
      ,[E277] = Cast([E277] as int)
      ,[E278] = Cast([E278] as int)
      ,[E279] = Cast([E279] as int)
      ,[E281] = Cast([E281] as int)
      ,[E282] = Cast([E282] as int)
      ,[E283] = Cast([E283] as int)
      ,[E284] = Cast([E284] as int)
      ,[E285] = Cast([E285] as int)
      ,[E286] = Cast([E286] as int)
      ,[E287] = Cast([E287] as int)
      ,[E288] = Cast([E288] as int)
      ,[E289] = Cast([E289] as int)
      ,[E291] = Cast([E291] as int)
      ,[E292] = Cast([E292] as int)
      ,[E293] = Cast([E293] as int)
      ,[E294] = Cast([E294] as int)
      ,[E295] = Cast([E295] as int)
      ,[E296] = Cast([E296] as int)
      ,[E297] = Cast([E297] as int)
      ,[E298] = Cast([E298] as int)
      ,[E299] = Cast([E299] as int)
      ,[E301] = Cast([E301] as int)
      ,[E302] = Cast([E302] as int)
      ,[E303] = Cast([E303] as int)
      ,[E304] = Cast([E304] as int)
      ,[E305] = Cast([E305] as int)
      ,[E306] = Cast([E306] as int)
      ,[E307] = Cast([E307] as int)
      ,[E308] = Cast([E308] as int)
      ,[E309] = Cast([E309] as int)
      ,[E311] = Cast([E311] as int)
      ,[E312] = Cast([E312] as int)
      ,[E313] = Cast([E313] as int)
      ,[E314] = Cast([E314] as int)
      ,[E315] = Cast([E315] as int)
      ,[E316] = Cast([E316] as int)
      ,[E317] = Cast([E317] as int)
      ,[E318] = Cast([E318] as int)
      ,[E319] = Cast([E319] as int)
      ,[E321] = Cast([E321] as int)
      ,[E322] = Cast([E322] as int)
      ,[E323] = Cast([E323] as int)
      ,[E324] = Cast([E324] as int)
      ,[E325] = Cast([E325] as int)
      ,[E326] = Cast([E326] as int)
      ,[E327] = Cast([E327] as int)
      ,[E328] = Cast([E328] as int)
      ,[E329] = Cast([E329] as int)
      ,[E331] = Cast([E331] as int)
      ,[E332] = Cast([E332] as int)
      ,[E333] = Cast([E333] as int)
      ,[E334] = Cast([E334] as int)
      ,[E335] = Cast([E335] as int)
      ,[E336] = Cast([E336] as int)
      ,[E337] = Cast([E337] as int)
      ,[E338] = Cast([E338] as int)
      ,[E339] = Cast([E339] as int)
      ,[E341] = Cast([E341] as int)
      ,[E342] = Cast([E342] as int)
      ,[E343] = Cast([E343] as int)
      ,[E344] = Cast([E344] as int)
      ,[E345] = Cast([E345] as int)
      ,[E346] = Cast([E346] as int)
      ,[E347] = Cast([E347] as int)
      ,[E348] = Cast([E348] as int)
      ,[E349] = Cast([E349] as int)
      ,[E351] = Cast([E351] as int)
      ,[E352] = Cast([E352] as int)
      ,[E353] = Cast([E353] as int)
      ,[E354] = Cast([E354] as int)
      ,[E355] = Cast([E355] as int)
      ,[E356] = Cast([E356] as int)
      ,[E357] = Cast([E357] as int)
      ,[E358] = Cast([E358] as int)
      ,[E359] = Cast([E359] as int)
      ,[E361] = Cast([E361] as int)
      ,[E362] = Cast([E362] as int)
      ,[E363] = Cast([E363] as int)
      ,[E364] = Cast([E364] as int)
      ,[E365] = Cast([E365] as int)
      ,[E366] = Cast([E366] as int)
      ,[E367] = Cast([E367] as int)
      ,[E368] = Cast([E368] as int)
      ,[E369] = Cast([E369] as int)
      ,[E371] = Cast([E371] as int)
      ,[E372] = Cast([E372] as int)
      ,[E373] = Cast([E373] as int)
      ,[E374] = Cast([E374] as int)
      ,[E375] = Cast([E375] as int)
      ,[E376] = Cast([E376] as int)
      ,[E377] = Cast([E377] as int)
      ,[E378] = Cast([E378] as int)
      ,[E379] = Cast([E379] as int)
      ,[E381] = Cast([E381] as int)
      ,[E382] = Cast([E382] as int)
      ,[E383] = Cast([E383] as int)
      ,[E384] = Cast([E384] as int)
      ,[E385] = Cast([E385] as int)
      ,[E386] = Cast([E386] as int)
      ,[E387] = Cast([E387] as int)
      ,[E388] = Cast([E388] as int)
      ,[E389] = Cast([E389] as int)
      ,[E391] = Cast([E391] as int)
      ,[E392] = Cast([E392] as int)
      ,[E393] = Cast([E393] as int)
      ,[E394] = Cast([E394] as int)
      ,[E395] = Cast([E395] as int)
      ,[E396] = Cast([E396] as int)
      ,[E397] = Cast([E397] as int)
      ,[E398] = Cast([E398] as int)
      ,[E399] = Cast([E399] as int)
      ,[E401] = Cast([E401] as int)
      ,[E402] = Cast([E402] as int)
      ,[E403] = Cast([E403] as int)
      ,[E404] = Cast([E404] as int)
      ,[E405] = Cast([E405] as int)
      ,[E406] = Cast([E406] as int)
      ,[E407] = Cast([E407] as int)
      ,[E408] = Cast([E408] as int)
      ,[E409] = Cast([E409] as int)
      ,[E411] = Cast([E411] as int)
      ,[E412] = Cast([E412] as int)
      ,[E413] = Cast([E413] as int)
      ,[E414] = Cast([E414] as int)
      ,[E415] = Cast([E415] as int)
      ,[E416] = Cast([E416] as int)
      ,[E417] = Cast([E417] as int)
      ,[E418] = Cast([E418] as int)
      ,[E419] = Cast([E419] as int)
      ,[E421] = Cast([E421] as int)
      ,[E422] = Cast([E422] as int)
      ,[E423] = Cast([E423] as int)
      ,[E424] = Cast([E424] as int)
      ,[E425] = Cast([E425] as int)
      ,[E426] = Cast([E426] as int)
      ,[E427] = Cast([E427] as int)
      ,[E428] = Cast([E428] as int)
      ,[E429] = Cast([E429] as int)
      ,[E431] = Cast([E431] as int)
      ,[E432] = Cast([E432] as int)
      ,[E433] = Cast([E433] as int)
      ,[E434] = Cast([E434] as int)
      ,[E435] = Cast([E435] as int)
      ,[E436] = Cast([E436] as int)
      ,[E437] = Cast([E437] as int)
      ,[E438] = Cast([E438] as int)
      ,[E439] = Cast([E439] as int)
      ,[E441] = Cast([E441] as int)
      ,[E442] = Cast([E442] as int)
      ,[E443] = Cast([E443] as int)
      ,[E444] = Cast([E444] as int)
      ,[E445] = Cast([E445] as int)
      ,[E446] = Cast([E446] as int)
      ,[E447] = Cast([E447] as int)
      ,[E448] = Cast([E448] as int)
      ,[E449] = Cast([E449] as int)
      ,[E451] = Cast([E451] as int)
      ,[E452] = Cast([E452] as int)
      ,[E453] = Cast([E453] as int)
      ,[E454] = Cast([E454] as int)
      ,[E455] = Cast([E455] as int)
      ,[E456] = Cast([E456] as int)
      ,[E457] = Cast([E457] as int)
      ,[E458] = Cast([E458] as int)
      ,[E459] = Cast([E459] as int)
      ,[E461] = Cast([E461] as int)
      ,[E462] = Cast([E462] as int)
      ,[E463] = Cast([E463] as int)
      ,[E464] = Cast([E464] as int)
      ,[E465] = Cast([E465] as int)
      ,[E466] = Cast([E466] as int)
      ,[E467] = Cast([E467] as int)
      ,[E468] = Cast([E468] as int)
      ,[E469] = Cast([E469] as int)
      ,[E471] = Cast([E471] as int)
      ,[E472] = Cast([E472] as int)
      ,[E473] = Cast([E473] as int)
      ,[E474] = Cast([E474] as int)
      ,[E475] = Cast([E475] as int)
      ,[E476] = Cast([E476] as int)
      ,[E477] = Cast([E477] as int)
      ,[E478] = Cast([E478] as int)
      ,[E479] = Cast([E479] as int)
      ,[E481] = Cast([E481] as int)
      ,[E482] = Cast([E482] as int)
      ,[E483] = Cast([E483] as int)
      ,[E484] = Cast([E484] as int)
      ,[E485] = Cast([E485] as int)
      ,[E486] = Cast([E486] as int)
      ,[E487] = Cast([E487] as int)
      ,[E488] = Cast([E488] as int)
      ,[E489] = Cast([E489] as int)
      ,[E491] = Cast([E491] as int)
      ,[E492] = Cast([E492] as int)
      ,[E493] = Cast([E493] as int)
      ,[E494] = Cast([E494] as int)
      ,[E495] = Cast([E495] as int)
      ,[E496] = Cast([E496] as int)
      ,[E497] = Cast([E497] as int)
      ,[E498] = Cast([E498] as int)
      ,[E499] = Cast([E499] as int)
      ,[E501] = Cast([E501] as int)
      ,[E502] = Cast([E502] as int)
      ,[E503] = Cast([E503] as int)
      ,[E504] = Cast([E504] as int)
      ,[E505] = Cast([E505] as int)
      ,[E506] = Cast([E506] as int)
      ,[E507] = Cast([E507] as int)
      ,[E508] = Cast([E508] as int)
      ,[E509] = Cast([E509] as int)
      ,[E511] = Cast([E511] as int)
      ,[E512] = Cast([E512] as int)
      ,[E513] = Cast([E513] as int)
      ,[E514] = Cast([E514] as int)
      ,[E515] = Cast([E515] as int)
      ,[E516] = Cast([E516] as int)
      ,[E517] = Cast([E517] as int)
      ,[E518] = Cast([E518] as int)
      ,[E519] = Cast([E519] as int)
      ,[E521] = Cast([E521] as int)
      ,[E522] = Cast([E522] as int)
      ,[E523] = Cast([E523] as int)
      ,[E524] = Cast([E524] as int)
      ,[E525] = Cast([E525] as int)
      ,[E526] = Cast([E526] as int)
      ,[E527] = Cast([E527] as int)
      ,[E528] = Cast([E528] as int)
      ,[E529] = Cast([E529] as int)
      ,[E531] = Cast([E531] as int)
      ,[E532] = Cast([E532] as int)
      ,[E533] = Cast([E533] as int)
      ,[E534] = Cast([E534] as int)
      ,[E535] = Cast([E535] as int)
      ,[E536] = Cast([E536] as int)
      ,[E537] = Cast([E537] as int)
      ,[E538] = Cast([E538] as int)
      ,[E539] = Cast([E539] as int)
      ,[E541] = Cast([E541] as int)
      ,[E542] = Cast([E542] as int)
      ,[E543] = Cast([E543] as int)
      ,[E544] = Cast([E544] as int)
      ,[E545] = Cast([E545] as int)
      ,[E546] = Cast([E546] as int)
      ,[E547] = Cast([E547] as int)
      ,[E548] = Cast([E548] as int)
      ,[E549] = Cast([E549] as int)
      ,[E551] = Cast([E551] as int)
      ,[E552] = Cast([E552] as int)
      ,[E553] = Cast([E553] as int)
      ,[E554] = Cast([E554] as int)
      ,[E555] = Cast([E555] as int)
      ,[E556] = Cast([E556] as int)
      ,[E557] = Cast([E557] as int)
      ,[E558] = Cast([E558] as int)
      ,[E559] = Cast([E559] as int)
      ,[E561] = Cast([E561] as int)
      ,[E562] = Cast([E562] as int)
      ,[E563] = Cast([E563] as int)
      ,[E564] = Cast([E564] as int)
      ,[E565] = Cast([E565] as int)
      ,[E566] = Cast([E566] as int)
      ,[E567] = Cast([E567] as int)
      ,[E568] = Cast([E568] as int)
      ,[E569] = Cast([E569] as int)
      ,[E571] = Cast([E571] as int)
      ,[E572] = Cast([E572] as int)
      ,[E573] = Cast([E573] as int)
      ,[E574] = Cast([E574] as int)
      ,[E575] = Cast([E575] as int)
      ,[E576] = Cast([E576] as int)
      ,[E577] = Cast([E577] as int)
      ,[E578] = Cast([E578] as int)
      ,[E579] = Cast([E579] as int)
      ,[E581] = Cast([E581] as int)
      ,[E582] = Cast([E582] as int)
      ,[E583] = Cast([E583] as int)
      ,[E584] = Cast([E584] as int)
      ,[E585] = Cast([E585] as int)
      ,[E586] = Cast([E586] as int)
      ,[E587] = Cast([E587] as int)
      ,[E588] = Cast([E588] as int)
      ,[E589] = Cast([E589] as int)
      ,[E591] = Cast([E591] as int)
      ,[E592] = Cast([E592] as int)
      ,[E593] = Cast([E593] as int)
      ,[E594] = Cast([E594] as int)
      ,[E595] = Cast([E595] as int)
      ,[E596] = Cast([E596] as int)
      ,[E597] = Cast([E597] as int)
      ,[E598] = Cast([E598] as int)
      ,[E599] = Cast([E599] as int)
      ,[E601] = Cast([E601] as int)
      ,[E602] = Cast([E602] as int)
      ,[E603] = Cast([E603] as int)
      ,[E604] = Cast([E604] as int)
      ,[E605] = Cast([E605] as int)
      ,[E606] = Cast([E606] as int)
      ,[E607] = Cast([E607] as int)
      ,[E608] = Cast([E608] as int)
      ,[E609] = Cast([E609] as int)
      ,[E611] = Cast([E611] as int)
      ,[E612] = Cast([E612] as int)
      ,[E613] = Cast([E613] as int)
      ,[E614] = Cast([E614] as int)
      ,[E615] = Cast([E615] as int)
      ,[E616] = Cast([E616] as int)
      ,[E617] = Cast([E617] as int)
      ,[E618] = Cast([E618] as int)
      ,[E619] = Cast([E619] as int)
      ,[E621] = Cast([E621] as int)
      ,[E622] = Cast([E622] as int)
      ,[E623] = Cast([E623] as int)
      ,[E624] = Cast([E624] as int)
      ,[E625] = Cast([E625] as int)
      ,[E626] = Cast([E626] as int)
      ,[E627] = Cast([E627] as int)
      ,[E628] = Cast([E628] as int)
      ,[E629] = Cast([E629] as int)
      ,[E631] = Cast([E631] as int)
      ,[E632] = Cast([E632] as int)
      ,[E633] = Cast([E633] as int)
      ,[E634] = Cast([E634] as int)
      ,[E635] = Cast([E635] as int)
      ,[E636] = Cast([E636] as int)
      ,[E637] = Cast([E637] as int)
      ,[E638] = Cast([E638] as int)
      ,[E639] = Cast([E639] as int)
      ,[E641] = Cast([E641] as int)
      ,[E642] = Cast([E642] as int)
      ,[E643] = Cast([E643] as int)
      ,[E644] = Cast([E644] as int)
      ,[E645] = Cast([E645] as int)
      ,[E646] = Cast([E646] as int)
      ,[E647] = Cast([E647] as int)
      ,[E648] = Cast([E648] as int)
      ,[E649] = Cast([E649] as int)
      ,[E651] = Cast([E651] as int)
      ,[E652] = Cast([E652] as int)
      ,[E653] = Cast([E653] as int)
      ,[E654] = Cast([E654] as int)
      ,[E655] = Cast([E655] as int)
      ,[E656] = Cast([E656] as int)
      ,[E657] = Cast([E657] as int)
      ,[E658] = Cast([E658] as int)
      ,[E659] = Cast([E659] as int)
      ,[E661] = Cast([E661] as int)
      ,[E662] = Cast([E662] as int)
      ,[E663] = Cast([E663] as int)
      ,[E664] = Cast([E664] as int)
      ,[E665] = Cast([E665] as int)
      ,[E666] = Cast([E666] as int)
      ,[E667] = Cast([E667] as int)
      ,[E668] = Cast([E668] as int)
      ,[E669] = Cast([E669] as int)
      ,[E671] = Cast([E671] as int)
      ,[E672] = Cast([E672] as int)
      ,[E673] = Cast([E673] as int)
      ,[E674] = Cast([E674] as int)
      ,[E675] = Cast([E675] as int)
      ,[E676] = Cast([E676] as int)
      ,[E677] = Cast([E677] as int)
      ,[E678] = Cast([E678] as int)
      ,[E679] = Cast([E679] as int)
      ,[E681] = Cast([E681] as int)
      ,[E682] = Cast([E682] as int)
      ,[E683] = Cast([E683] as int)
      ,[E684] = Cast([E684] as int)
      ,[E685] = Cast([E685] as int)
      ,[E686] = Cast([E686] as int)
      ,[E687] = Cast([E687] as int)
      ,[E688] = Cast([E688] as int)
      ,[E689] = Cast([E689] as int)
      ,[E691] = Cast([E691] as int)
      ,[E692] = Cast([E692] as int)
      ,[E693] = Cast([E693] as int)
      ,[E694] = Cast([E694] as int)
      ,[E695] = Cast([E695] as int)
      ,[E696] = Cast([E696] as int)
      ,[E697] = Cast([E697] as int)
      ,[E698] = Cast([E698] as int)
      ,[E699] = Cast([E699] as int)
      ,[E701] = Cast([E701] as int)
      ,[E702] = Cast([E702] as int)
      ,[E703] = Cast([E703] as int)
      ,[E704] = Cast([E704] as int)
      ,[E705] = Cast([E705] as int)
      ,[E706] = Cast([E706] as int)
      ,[E707] = Cast([E707] as int)
      ,[E708] = Cast([E708] as int)
      ,[E709] = Cast([E709] as int)
      ,[E711] = Cast([E711] as int)
      ,[E712] = Cast([E712] as int)
      ,[E713] = Cast([E713] as int)
      ,[E714] = Cast([E714] as int)
      ,[E715] = Cast([E715] as int)
      ,[E716] = Cast([E716] as int)
      ,[E717] = Cast([E717] as int)
      ,[E718] = Cast([E718] as int)
      ,[E719] = Cast([E719] as int)
      ,[E721] = Cast([E721] as int)
      ,[E722] = Cast([E722] as int)
      ,[E723] = Cast([E723] as int)
      ,[E724] = Cast([E724] as int)
      ,[E725] = Cast([E725] as int)
      ,[E726] = Cast([E726] as int)
      ,[E727] = Cast([E727] as int)
      ,[E728] = Cast([E728] as int)
      ,[E729] = Cast([E729] as int)
      ,[E731] = Cast([E731] as int)
      ,[E732] = Cast([E732] as int)
      ,[E733] = Cast([E733] as int)
      ,[E734] = Cast([E734] as int)
      ,[E735] = Cast([E735] as int)
      ,[E736] = Cast([E736] as int)
      ,[E737] = Cast([E737] as int)
      ,[E738] = Cast([E738] as int)
      ,[E739] = Cast([E739] as int)
      ,[E741] = Cast([E741] as int)
      ,[E742] = Cast([E742] as int)
      ,[E743] = Cast([E743] as int)
      ,[E744] = Cast([E744] as int)
      ,[E745] = Cast([E745] as int)
      ,[E746] = Cast([E746] as int)
      ,[E747] = Cast([E747] as int)
      ,[E748] = Cast([E748] as int)
      ,[E749] = Cast([E749] as int)
      ,[E751] = Cast([E751] as int)
      ,[E752] = Cast([E752] as int)
      ,[E753] = Cast([E753] as int)
      ,[E754] = Cast([E754] as int)
      ,[E755] = Cast([E755] as int)
      ,[E756] = Cast([E756] as int)
      ,[E757] = Cast([E757] as int)
      ,[E758] = Cast([E758] as int)
      ,[E759] = Cast([E759] as int)
      ,[E1] = Cast([E1] as int)
      ,[E2] = Cast([E2] as int)
      ,[E3] = Cast([E3] as int)
      ,[E4] = Cast([E4] as int)
      ,[E5] = Cast([E5] as int)
      ,[E6] = Cast([E6] as int)
      ,[E7] = Cast([E7] as int)
      ,[E8] = Cast([E8] as int)
      ,[E9] = Cast([E9] as int)
      ,[osa15] = Cast([osa15] as int)
      ,[nai15] = Cast([nai15] as int)
      ,[osa16] = Cast([osa16] as int)
      ,[nai16] = Cast([nai16] as int)
      ,[tietolahde] = CAST(tietolahde as nvarchar(50))
      ,aineisto = CAST(''2.11'' as varchar(5))
      ,[rivinumero] = CAST(rivinumero as int)
FROM (
SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[osa1]
      ,[suo1]
      ,[osa2]
      ,[suo2]
      ,[osa3]
      ,[suo3]
      ,[kur4]
      ,[osa4]
      ,[nai4]
      ,[tun4]
      ,[kur5]
      ,[osa5]
      ,[nai5]
      ,[tun5]
      ,[kur6]
      ,[osa6]
      ,[nai6]
      ,[tun6]
      ,[kur7]
      ,[osa7]
      ,[nai7]
      ,[kur8]
      ,[osa8]
      ,[nai8]
      ,[kur9]
      ,[osa9]
      ,[nai9]
      ,[kur10]
      ,[osa10]
      ,[nai10]
      ,[kur11]
      ,[osa11]
      ,[nai11]
      ,[kur12]
      ,[osa12]
      ,[nai12]
      ,[kur13]
      ,[osa13]
      ,[nai13]
      ,[kur14]
      ,[osa14]
      ,[nai14]
      ,[kurd]
      ,[osad]
      ,[naid]
      ,[E11]
      ,[E12]
      ,[E13]
      ,[E14]
      ,[E15]
      ,[E16]
      ,[E17]
      ,[E18]
      ,[E19]
      ,[E21]
      ,[E22]
      ,[E23]
      ,[E24]
      ,[E25]
      ,[E26]
      ,[E27]
      ,[E28]
      ,[E29]
      ,[E31]
      ,[E32]
      ,[E33]
      ,[E34]
      ,[E35]
      ,[E36]
      ,[E37]
      ,[E38]
      ,[E39]
      ,[E41]
      ,[E42]
      ,[E43]
      ,[E44]
      ,[E45]
      ,[E46]
      ,[E47]
      ,[E48]
      ,[E49]
      ,[E51]
      ,[E52]
      ,[E53]
      ,[E54]
      ,[E55]
      ,[E56]
      ,[E57]
      ,[E58]
      ,[E59]
      ,[E61]
      ,[E62]
      ,[E63]
      ,[E64]
      ,[E65]
      ,[E66]
      ,[E67]
      ,[E68]
      ,[E69]
      ,[E71]
      ,[E72]
      ,[E73]
      ,[E74]
      ,[E75]
      ,[E76]
      ,[E77]
      ,[E78]
      ,[E79]
      ,[E81]
      ,[E82]
      ,[E83]
      ,[E84]
      ,[E85]
      ,[E86]
      ,[E87]
      ,[E88]
      ,[E89]
      ,[E91]
      ,[E92]
      ,[E93]
      ,[E94]
      ,[E95]
      ,[E96]
      ,[E97]
      ,[E98]
      ,[E99]
      ,[E101]
      ,[E102]
      ,[E103]
      ,[E104]
      ,[E105]
      ,[E106]
      ,[E107]
      ,[E108]
      ,[E109]
      ,[E111]
      ,[E112]
      ,[E113]
      ,[E114]
      ,[E115]
      ,[E116]
      ,[E117]
      ,[E118]
      ,[E119]
      ,[E121]
      ,[E122]
      ,[E123]
      ,[E124]
      ,[E125]
      ,[E126]
      ,[E127]
      ,[E128]
      ,[E129]
      ,[E131]
      ,[E132]
      ,[E133]
      ,[E134]
      ,[E135]
      ,[E136]
      ,[E137]
      ,[E138]
      ,[E139]
      ,[E141]
      ,[E142]
      ,[E143]
      ,[E144]
      ,[E145]
      ,[E146]
      ,[E147]
      ,[E148]
      ,[E149]
      ,[E151]
      ,[E152]
      ,[E153]
      ,[E154]
      ,[E155]
      ,[E156]
      ,[E157]
      ,[E158]
      ,[E159]
      ,[E161]
      ,[E162]
      ,[E163]
      ,[E164]
      ,[E165]
      ,[E166]
      ,[E167]
      ,[E168]
      ,[E169]
      ,[E171]
      ,[E172]
      ,[E173]
      ,[E174]
      ,[E175]
      ,[E176]
      ,[E177]
      ,[E178]
      ,[E179]
      ,[E181]
      ,[E182]
      ,[E183]
      ,[E184]
      ,[E185]
      ,[E186]
      ,[E187]
      ,[E188]
      ,[E189]
      ,[E191]
      ,[E192]
      ,[E193]
      ,[E194]
      ,[E195]
      ,[E196]
      ,[E197]
      ,[E198]
      ,[E199]
      ,[E201]
      ,[E202]
      ,[E203]
      ,[E204]
      ,[E205]
      ,[E206]
      ,[E207]
      ,[E208]
      ,[E209]
      ,[E211]
      ,[E212]
      ,[E213]
      ,[E214]
      ,[E215]
      ,[E216]
      ,[E217]
      ,[E218]
      ,[E219]
      ,[E221]
      ,[E222]
      ,[E223]
      ,[E224]
      ,[E225]
      ,[E226]
      ,[E227]
      ,[E228]
      ,[E229]
      ,[E231]
      ,[E232]
      ,[E233]
      ,[E234]
      ,[E235]
      ,[E236]
      ,[E237]
      ,[E238]
      ,[E239]
      ,[E241]
      ,[E242]
      ,[E243]
      ,[E244]
      ,[E245]
      ,[E246]
      ,[E247]
      ,[E248]
      ,[E249]
      ,[E251]
      ,[E252]
      ,[E253]
      ,[E254]
      ,[E255]
      ,[E256]
      ,[E257]
      ,[E258]
      ,[E259]
      ,[E261]
      ,[E262]
      ,[E263]
      ,[E264]
      ,[E265]
      ,[E266]
      ,[E267]
      ,[E268]
      ,[E269]
      ,[E271]
      ,[E272]
      ,[E273]
      ,[E274]
      ,[E275]
      ,[E276]
      ,[E277]
      ,[E278]
      ,[E279]
      ,[E281]
      ,[E282]
      ,[E283]
      ,[E284]
      ,[E285]
      ,[E286]
      ,[E287]
      ,[E288]
      ,[E289]
      ,[E291]
      ,[E292]
      ,[E293]
      ,[E294]
      ,[E295]
      ,[E296]
      ,[E297]
      ,[E298]
      ,[E299]
      ,[E301]
      ,[E302]
      ,[E303]
      ,[E304]
      ,[E305]
      ,[E306]
      ,[E307]
      ,[E308]
      ,[E309]
      ,[E311]
      ,[E312]
      ,[E313]
      ,[E314]
      ,[E315]
      ,[E316]
      ,[E317]
      ,[E318]
      ,[E319]
      ,[E321]
      ,[E322]
      ,[E323]
      ,[E324]
      ,[E325]
      ,[E326]
      ,[E327]
      ,[E328]
      ,[E329]
      ,[E331]
      ,[E332]
      ,[E333]
      ,[E334]
      ,[E335]
      ,[E336]
      ,[E337]
      ,[E338]
      ,[E339]
      ,[E341]
      ,[E342]
      ,[E343]
      ,[E344]
      ,[E345]
      ,[E346]
      ,[E347]
      ,[E348]
      ,[E349]
      ,[E351]
      ,[E352]
      ,[E353]
      ,[E354]
      ,[E355]
      ,[E356]
      ,[E357]
      ,[E358]
      ,[E359]
      ,[E361]
      ,[E362]
      ,[E363]
      ,[E364]
      ,[E365]
      ,[E366]
      ,[E367]
      ,[E368]
      ,[E369]
      ,[E371]
      ,[E372]
      ,[E373]
      ,[E374]
      ,[E375]
      ,[E376]
      ,[E377]
      ,[E378]
      ,[E379]
      ,[E381]
      ,[E382]
      ,[E383]
      ,[E384]
      ,[E385]
      ,[E386]
      ,[E387]
      ,[E388]
      ,[E389]
      ,[E391]
      ,[E392]
      ,[E393]
      ,[E394]
      ,[E395]
      ,[E396]
      ,[E397]
      ,[E398]
      ,[E399]
      ,[E401]
      ,[E402]
      ,[E403]
      ,[E404]
      ,[E405]
      ,[E406]
      ,[E407]
      ,[E408]
      ,[E409]
      ,[E411]
      ,[E412]
      ,[E413]
      ,[E414]
      ,[E415]
      ,[E416]
      ,[E417]
      ,[E418]
      ,[E419]
      ,[E421]
      ,[E422]
      ,[E423]
      ,[E424]
      ,[E425]
      ,[E426]
      ,[E427]
      ,[E428]
      ,[E429]
      ,[E431]
      ,[E432]
      ,[E433]
      ,[E434]
      ,[E435]
      ,[E436]
      ,[E437]
      ,[E438]
      ,[E439]
      ,[E441]
      ,[E442]
      ,[E443]
      ,[E444]
      ,[E445]
      ,[E446]
      ,[E447]
      ,[E448]
      ,[E449]
      ,[E451]
      ,[E452]
      ,[E453]
      ,[E454]
      ,[E455]
      ,[E456]
      ,[E457]
      ,[E458]
      ,[E459]
      ,[E461]
      ,[E462]
      ,[E463]
      ,[E464]
      ,[E465]
      ,[E466]
      ,[E467]
      ,[E468]
      ,[E469]
      ,[E471]
      ,[E472]
      ,[E473]
      ,[E474]
      ,[E475]
      ,[E476]
      ,[E477]
      ,[E478]
      ,[E479]
      ,[E481]
      ,[E482]
      ,[E483]
      ,[E484]
      ,[E485]
      ,[E486]
      ,[E487]
      ,[E488]
      ,[E489]
      ,[E491]
      ,[E492]
      ,[E493]
      ,[E494]
      ,[E495]
      ,[E496]
      ,[E497]
      ,[E498]
      ,[E499]
      ,[E501]
      ,[E502]
      ,[E503]
      ,[E504]
      ,[E505]
      ,[E506]
      ,[E507]
      ,[E508]
      ,[E509]
      ,[E511]
      ,[E512]
      ,[E513]
      ,[E514]
      ,[E515]
      ,[E516]
      ,[E517]
      ,[E518]
      ,[E519]
      ,[E521]
      ,[E522]
      ,[E523]
      ,[E524]
      ,[E525]
      ,[E526]
      ,[E527]
      ,[E528]
      ,[E529]
      ,[E531]
      ,[E532]
      ,[E533]
      ,[E534]
      ,[E535]
      ,[E536]
      ,[E537]
      ,[E538]
      ,[E539]
      ,[E541]
      ,[E542]
      ,[E543]
      ,[E544]
      ,[E545]
      ,[E546]
      ,[E547]
      ,[E548]
      ,[E549]
      ,[E551]
      ,[E552]
      ,[E553]
      ,[E554]
      ,[E555]
      ,[E556]
      ,[E557]
      ,[E558]
      ,[E559]
      ,[E561]
      ,[E562]
      ,[E563]
      ,[E564]
      ,[E565]
      ,[E566]
      ,[E567]
      ,[E568]
      ,[E569]
      ,[E571]
      ,[E572]
      ,[E573]
      ,[E574]
      ,[E575]
      ,[E576]
      ,[E577]
      ,[E578]
      ,[E579]
      ,[E581]
      ,[E582]
      ,[E583]
      ,[E584]
      ,[E585]
      ,[E586]
      ,[E587]
      ,[E588]
      ,[E589]
      ,[E591]
      ,[E592]
      ,[E593]
      ,[E594]
      ,[E595]
      ,[E596]
      ,[E597]
      ,[E598]
      ,[E599]
      ,[E601]
      ,[E602]
      ,[E603]
      ,[E604]
      ,[E605]
      ,[E606]
      ,[E607]
      ,[E608]
      ,[E609]
      ,[E611]
      ,[E612]
      ,[E613]
      ,[E614]
      ,[E615]
      ,[E616]
      ,[E617]
      ,[E618]
      ,[E619]
      ,[E621]
      ,[E622]
      ,[E623]
      ,[E624]
      ,[E625]
      ,[E626]
      ,[E627]
      ,[E628]
      ,[E629]
      ,[E631]
      ,[E632]
      ,[E633]
      ,[E634]
      ,[E635]
      ,[E636]
      ,[E637]
      ,[E638]
      ,[E639]
      ,[E641]
      ,[E642]
      ,[E643]
      ,[E644]
      ,[E645]
      ,[E646]
      ,[E647]
      ,[E648]
      ,[E649]
      ,[E651]
      ,[E652]
      ,[E653]
      ,[E654]
      ,[E655]
      ,[E656]
      ,[E657]
      ,[E658]
      ,[E659]
      ,[E661]
      ,[E662]
      ,[E663]
      ,[E664]
      ,[E665]
      ,[E666]
      ,[E667]
      ,[E668]
      ,[E669]
      ,[E671]
      ,[E672]
      ,[E673]
      ,[E674]
      ,[E675]
      ,[E676]
      ,[E677]
      ,[E678]
      ,[E679]
      ,[E681]
      ,[E682]
      ,[E683]
      ,[E684]
      ,[E685]
      ,[E686]
      ,[E687]
      ,[E688]
      ,[E689]
      ,[E691]
      ,[E692]
      ,[E693]
      ,[E694]
      ,[E695]
      ,[E696]
      ,[E697]
      ,[E698]
      ,[E699]
      ,[E701]
      ,[E702]
      ,[E703]
      ,[E704]
      ,[E705]
      ,[E706]
      ,[E707]
      ,[E708]
      ,[E709]
      ,[E711]
      ,[E712]
      ,[E713]
      ,[E714]
      ,[E715]
      ,[E716]
      ,[E717]
      ,[E718]
      ,[E719]
      ,[E721]
      ,[E722]
      ,[E723]
      ,[E724]
      ,[E725]
      ,[E726]
      ,[E727]
      ,[E728]
      ,[E729]
      ,[E731]
      ,[E732]
      ,[E733]
      ,[E734]
      ,[E735]
      ,[E736]
      ,[E737]
      ,[E738]
      ,[E739]
      ,[E741]
      ,[E742]
      ,[E743]
      ,[E744]
      ,[E745]
      ,[E746]
      ,[E747]
      ,[E748]
      ,[E749]
      ,[E751]
      ,[E752]
      ,[E753]
      ,[E754]
      ,[E755]
      ,[E756]
      ,[E757]
      ,[E758]
      ,[E759]
      ,[E1]
      ,[E2]
      ,[E3]
      ,[E4]
      ,[E5]
      ,[E6]
      ,[E7]
      ,[E8]
      ,[E9]
      ,[osa15]
      ,[nai15]
      ,[osa16]
      ,[nai16]
      ,[tietolahde] = ''2_11_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
  FROM [TK_H9098_CSC].[dbo].[TK_2_11_sopv_11]
 -- FROM okm.okm_ktpo_tiedontuotanto_in.[sa_2.11_Oppilaitosten_tutkintoon_johtamaton_11]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[osa1]
      ,[suo1]
      ,[osa2]
      ,[suo2]
      ,[osa3]
      ,[suo3]
      ,[kur4]
      ,[osa4]
      ,[nai4]
      ,[tun4]
      ,[kur5]
      ,[osa5]
      ,[nai5]
      ,[tun5]
      ,[kur6]
      ,[osa6]
      ,[nai6]
      ,[tun6]
      ,[kur7]
      ,[osa7]
      ,[nai7]
      ,[kur8]
      ,[osa8]
      ,[nai8]
      ,[kur9]
      ,[osa9]
      ,[nai9]
      ,[kur10]
      ,[osa10]
      ,[nai10]
      ,[kur11]
      ,[osa11]
      ,[nai11]
      ,[kur12]
      ,[osa12]
      ,[nai12]
      ,[kur13]
      ,[osa13]
      ,[nai13]
      ,[kur14]
      ,[osa14]
      ,[nai14]
      ,[kurd]
      ,[osad]
      ,[naid]
      ,[E11]
      ,[E12]
      ,[E13]
      ,[E14]
      ,[E15]
      ,[E16]
      ,[E17]
      ,[E18]
      ,[E19]
      ,[E21]
      ,[E22]
      ,[E23]
      ,[E24]
      ,[E25]
      ,[E26]
      ,[E27]
      ,[E28]
      ,[E29]
      ,[E31]
      ,[E32]
      ,[E33]
      ,[E34]
      ,[E35]
      ,[E36]
      ,[E37]
      ,[E38]
      ,[E39]
      ,[E41]
      ,[E42]
      ,[E43]
      ,[E44]
      ,[E45]
      ,[E46]
      ,[E47]
      ,[E48]
      ,[E49]
      ,[E51]
      ,[E52]
      ,[E53]
      ,[E54]
      ,[E55]
      ,[E56]
      ,[E57]
      ,[E58]
      ,[E59]
      ,[E61]
      ,[E62]
      ,[E63]
      ,[E64]
      ,[E65]
      ,[E66]
      ,[E67]
      ,[E68]
      ,[E69]
      ,[E71]
      ,[E72]
      ,[E73]
      ,[E74]
      ,[E75]
      ,[E76]
      ,[E77]
      ,[E78]
      ,[E79]
      ,[E81]
      ,[E82]
      ,[E83]
      ,[E84]
      ,[E85]
      ,[E86]
      ,[E87]
      ,[E88]
      ,[E89]
      ,[E91]
      ,[E92]
      ,[E93]
      ,[E94]
      ,[E95]
      ,[E96]
      ,[E97]
      ,[E98]
      ,[E99]
      ,[E101]
      ,[E102]
      ,[E103]
      ,[E104]
      ,[E105]
      ,[E106]
      ,[E107]
      ,[E108]
      ,[E109]
      ,[E111]
      ,[E112]
      ,[E113]
      ,[E114]
      ,[E115]
      ,[E116]
      ,[E117]
      ,[E118]
      ,[E119]
      ,[E121]
      ,[E122]
      ,[E123]
      ,[E124]
      ,[E125]
      ,[E126]
      ,[E127]
      ,[E128]
      ,[E129]
      ,[E131]
      ,[E132]
      ,[E133]
      ,[E134]
      ,[E135]
      ,[E136]
      ,[E137]
      ,[E138]
      ,[E139]
      ,[E141]
      ,[E142]
      ,[E143]
      ,[E144]
      ,[E145]
      ,[E146]
      ,[E147]
      ,[E148]
      ,[E149]
      ,[E151]
      ,[E152]
      ,[E153]
      ,[E154]
      ,[E155]
      ,[E156]
      ,[E157]
      ,[E158]
      ,[E159]
      ,[E161]
      ,[E162]
      ,[E163]
      ,[E164]
      ,[E165]
      ,[E166]
      ,[E167]
      ,[E168]
      ,[E169]
      ,[E171]
      ,[E172]
      ,[E173]
      ,[E174]
      ,[E175]
      ,[E176]
      ,[E177]
      ,[E178]
      ,[E179]
      ,[E181]
      ,[E182]
      ,[E183]
      ,[E184]
      ,[E185]
      ,[E186]
      ,[E187]
      ,[E188]
      ,[E189]
      ,[E191]
      ,[E192]
      ,[E193]
      ,[E194]
      ,[E195]
      ,[E196]
      ,[E197]
      ,[E198]
      ,[E199]
      ,[E201]
      ,[E202]
      ,[E203]
      ,[E204]
      ,[E205]
      ,[E206]
      ,[E207]
      ,[E208]
      ,[E209]
      ,[E211]
      ,[E212]
      ,[E213]
      ,[E214]
      ,[E215]
      ,[E216]
      ,[E217]
      ,[E218]
      ,[E219]
      ,[E221]
      ,[E222]
      ,[E223]
      ,[E224]
      ,[E225]
      ,[E226]
      ,[E227]
      ,[E228]
      ,[E229]
      ,[E231]
      ,[E232]
      ,[E233]
      ,[E234]
      ,[E235]
      ,[E236]
      ,[E237]
      ,[E238]
      ,[E239]
      ,[E241]
      ,[E242]
      ,[E243]
      ,[E244]
      ,[E245]
      ,[E246]
      ,[E247]
      ,[E248]
      ,[E249]
      ,[E251]
      ,[E252]
      ,[E253]
      ,[E254]
      ,[E255]
      ,[E256]
      ,[E257]
      ,[E258]
      ,[E259]
      ,[E261]
      ,[E262]
      ,[E263]
      ,[E264]
      ,[E265]
      ,[E266]
      ,[E267]
      ,[E268]
      ,[E269]
      ,[E271]
      ,[E272]
      ,[E273]
      ,[E274]
      ,[E275]
      ,[E276]
      ,[E277]
      ,[E278]
      ,[E279]
      ,[E281]
      ,[E282]
      ,[E283]
      ,[E284]
      ,[E285]
      ,[E286]
      ,[E287]
      ,[E288]
      ,[E289]
      ,[E291]
      ,[E292]
      ,[E293]
      ,[E294]
      ,[E295]
      ,[E296]
      ,[E297]
      ,[E298]
      ,[E299]
      ,[E301]
      ,[E302]
      ,[E303]
      ,[E304]
      ,[E305]
      ,[E306]
      ,[E307]
      ,[E308]
      ,[E309]
      ,[E311]
      ,[E312]
      ,[E313]
      ,[E314]
      ,[E315]
      ,[E316]
      ,[E317]
      ,[E318]
      ,[E319]
      ,[E321]
      ,[E322]
      ,[E323]
      ,[E324]
      ,[E325]
      ,[E326]
      ,[E327]
      ,[E328]
      ,[E329]
      ,[E331]
      ,[E332]
      ,[E333]
      ,[E334]
      ,[E335]
      ,[E336]
      ,[E337]
      ,[E338]
      ,[E339]
      ,[E341]
      ,[E342]
      ,[E343]
      ,[E344]
      ,[E345]
      ,[E346]
      ,[E347]
      ,[E348]
      ,[E349]
      ,[E351]
      ,[E352]
      ,[E353]
      ,[E354]
      ,[E355]
      ,[E356]
      ,[E357]
      ,[E358]
      ,[E359]
      ,[E361]
      ,[E362]
      ,[E363]
      ,[E364]
      ,[E365]
      ,[E366]
      ,[E367]
      ,[E368]
      ,[E369]
      ,[E371]
      ,[E372]
      ,[E373]
      ,[E374]
      ,[E375]
      ,[E376]
      ,[E377]
      ,[E378]
      ,[E379]
      ,[E381]
      ,[E382]
      ,[E383]
      ,[E384]
      ,[E385]
      ,[E386]
      ,[E387]
      ,[E388]
      ,[E389]
      ,[E391]
      ,[E392]
      ,[E393]
      ,[E394]
      ,[E395]
      ,[E396]
      ,[E397]
      ,[E398]
      ,[E399]
      ,[E401]
      ,[E402]
      ,[E403]
      ,[E404]
      ,[E405]
      ,[E406]
      ,[E407]
      ,[E408]
      ,[E409]
      ,[E411]
      ,[E412]
      ,[E413]
      ,[E414]
      ,[E415]
      ,[E416]
      ,[E417]
      ,[E418]
      ,[E419]
      ,[E421]
      ,[E422]
      ,[E423]
      ,[E424]
      ,[E425]
      ,[E426]
      ,[E427]
      ,[E428]
      ,[E429]
      ,[E431]
      ,[E432]
      ,[E433]
      ,[E434]
      ,[E435]
      ,[E436]
      ,[E437]
      ,[E438]
      ,[E439]
      ,[E441]
      ,[E442]
      ,[E443]
      ,[E444]
      ,[E445]
      ,[E446]
      ,[E447]
      ,[E448]
      ,[E449]
      ,[E451]
      ,[E452]
      ,[E453]
      ,[E454]
      ,[E455]
      ,[E456]
      ,[E457]
      ,[E458]
      ,[E459]
      ,[E461]
      ,[E462]
      ,[E463]
      ,[E464]
      ,[E465]
      ,[E466]
      ,[E467]
      ,[E468]
      ,[E469]
      ,[E471]
      ,[E472]
      ,[E473]
      ,[E474]
      ,[E475]
      ,[E476]
      ,[E477]
      ,[E478]
      ,[E479]
      ,[E481]
      ,[E482]
      ,[E483]
      ,[E484]
      ,[E485]
      ,[E486]
      ,[E487]
      ,[E488]
      ,[E489]
      ,[E491]
      ,[E492]
      ,[E493]
      ,[E494]
      ,[E495]
      ,[E496]
      ,[E497]
      ,[E498]
      ,[E499]
      ,[E501]
      ,[E502]
      ,[E503]
      ,[E504]
      ,[E505]
      ,[E506]
      ,[E507]
      ,[E508]
      ,[E509]
      ,[E511]
      ,[E512]
      ,[E513]
      ,[E514]
      ,[E515]
      ,[E516]
      ,[E517]
      ,[E518]
      ,[E519]
      ,[E521]
      ,[E522]
      ,[E523]
      ,[E524]
      ,[E525]
      ,[E526]
      ,[E527]
      ,[E528]
      ,[E529]
      ,[E531]
      ,[E532]
      ,[E533]
      ,[E534]
      ,[E535]
      ,[E536]
      ,[E537]
      ,[E538]
      ,[E539]
      ,[E541]
      ,[E542]
      ,[E543]
      ,[E544]
      ,[E545]
      ,[E546]
      ,[E547]
      ,[E548]
      ,[E549]
      ,[E551]
      ,[E552]
      ,[E553]
      ,[E554]
      ,[E555]
      ,[E556]
      ,[E557]
      ,[E558]
      ,[E559]
      ,[E561]
      ,[E562]
      ,[E563]
      ,[E564]
      ,[E565]
      ,[E566]
      ,[E567]
      ,[E568]
      ,[E569]
      ,[E571]
      ,[E572]
      ,[E573]
      ,[E574]
      ,[E575]
      ,[E576]
      ,[E577]
      ,[E578]
      ,[E579]
      ,[E581]
      ,[E582]
      ,[E583]
      ,[E584]
      ,[E585]
      ,[E586]
      ,[E587]
      ,[E588]
      ,[E589]
      ,[E591]
      ,[E592]
      ,[E593]
      ,[E594]
      ,[E595]
      ,[E596]
      ,[E597]
      ,[E598]
      ,[E599]
      ,[E601]
      ,[E602]
      ,[E603]
      ,[E604]
      ,[E605]
      ,[E606]
      ,[E607]
      ,[E608]
      ,[E609]
      ,[E611]
      ,[E612]
      ,[E613]
      ,[E614]
      ,[E615]
      ,[E616]
      ,[E617]
      ,[E618]
      ,[E619]
      ,[E621]
      ,[E622]
      ,[E623]
      ,[E624]
      ,[E625]
      ,[E626]
      ,[E627]
      ,[E628]
      ,[E629]
      ,[E631]
      ,[E632]
      ,[E633]
      ,[E634]
      ,[E635]
      ,[E636]
      ,[E637]
      ,[E638]
      ,[E639]
      ,[E641]
      ,[E642]
      ,[E643]
      ,[E644]
      ,[E645]
      ,[E646]
      ,[E647]
      ,[E648]
      ,[E649]
      ,[E651]
      ,[E652]
      ,[E653]
      ,[E654]
      ,[E655]
      ,[E656]
      ,[E657]
      ,[E658]
      ,[E659]
      ,[E661]
      ,[E662]
      ,[E663]
      ,[E664]
      ,[E665]
      ,[E666]
      ,[E667]
      ,[E668]
      ,[E669]
      ,[E671]
      ,[E672]
      ,[E673]
      ,[E674]
      ,[E675]
      ,[E676]
      ,[E677]
      ,[E678]
      ,[E679]
      ,[E681]
      ,[E682]
      ,[E683]
      ,[E684]
      ,[E685]
      ,[E686]
      ,[E687]
      ,[E688]
      ,[E689]
      ,[E691]
      ,[E692]
      ,[E693]
      ,[E694]
      ,[E695]
      ,[E696]
      ,[E697]
      ,[E698]
      ,[E699]
      ,[E701]
      ,[E702]
      ,[E703]
      ,[E704]
      ,[E705]
      ,[E706]
      ,[E707]
      ,[E708]
      ,[E709]
      ,[E711]
      ,[E712]
      ,[E713]
      ,[E714]
      ,[E715]
      ,[E716]
      ,[E717]
      ,[E718]
      ,[E719]
      ,[E721]
      ,[E722]
      ,[E723]
      ,[E724]
      ,[E725]
      ,[E726]
      ,[E727]
      ,[E728]
      ,[E729]
      ,[E731]
      ,[E732]
      ,[E733]
      ,[E734]
      ,[E735]
      ,[E736]
      ,[E737]
      ,[E738]
      ,[E739]
      ,[E741]
      ,[E742]
      ,[E743]
      ,[E744]
      ,[E745]
      ,[E746]
      ,[E747]
      ,[E748]
      ,[E749]
      ,[E751]
      ,[E752]
      ,[E753]
      ,[E754]
      ,[E755]
      ,[E756]
      ,[E757]
      ,[E758]
      ,[E759]
      ,[E1]
      ,[E2]
      ,[E3]
      ,[E4]
      ,[E5]
      ,[E6]
      ,[E7]
      ,[E8]
      ,[E9]
      ,[osa15]
      ,[nai15]
      ,[osa16]
      ,[nai16]
      ,[tietolahde] = ''2_11_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
  FROM [TK_H9098_CSC].[dbo].[TK_2_11_sopv_12]
  --FROM okm.okm_ktpo_tiedontuotanto_in.[sa_2.11_Oppilaitosten_tutkintoon_johtamaton_12]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[osa1]
      ,[suo1]
      ,[osa2]
      ,[suo2]
      ,[osa3]
      ,[suo3]
      ,[kur4]
      ,[osa4]
      ,[nai4]
      ,[tun4]
      ,[kur5]
      ,[osa5]
      ,[nai5]
      ,[tun5]
      ,[kur6]
      ,[osa6]
      ,[nai6]
      ,[tun6]
      ,[kur7]
      ,[osa7]
      ,[nai7]
      ,[kur8]
      ,[osa8]
      ,[nai8]
      ,[kur9]
      ,[osa9]
      ,[nai9]
      ,[kur10]
      ,[osa10]
      ,[nai10]
      ,[kur11]
      ,[osa11]
      ,[nai11]
      ,[kur12]
      ,[osa12]
      ,[nai12]
      ,[kur13]
      ,[osa13]
      ,[nai13]
      ,[kur14]
      ,[osa14]
      ,[nai14]
      ,[kurd]
      ,[osad]
      ,[naid]
      ,[E11]
      ,[E12]
      ,[E13]
      ,[E14]
      ,[E15]
      ,[E16]
      ,[E17]
      ,[E18]
      ,[E19]
      ,[E21]
      ,[E22]
      ,[E23]
      ,[E24]
      ,[E25]
      ,[E26]
      ,[E27]
      ,[E28]
      ,[E29]
      ,[E31]
      ,[E32]
      ,[E33]
      ,[E34]
      ,[E35]
      ,[E36]
      ,[E37]
      ,[E38]
      ,[E39]
      ,[E41]
      ,[E42]
      ,[E43]
      ,[E44]
      ,[E45]
      ,[E46]
      ,[E47]
      ,[E48]
      ,[E49]
      ,[E51]
      ,[E52]
      ,[E53]
      ,[E54]
      ,[E55]
      ,[E56]
      ,[E57]
      ,[E58]
      ,[E59]
      ,[E61]
      ,[E62]
      ,[E63]
      ,[E64]
      ,[E65]
      ,[E66]
      ,[E67]
      ,[E68]
      ,[E69]
      ,[E71]
      ,[E72]
      ,[E73]
      ,[E74]
      ,[E75]
      ,[E76]
      ,[E77]
      ,[E78]
      ,[E79]
      ,[E81]
      ,[E82]
      ,[E83]
      ,[E84]
      ,[E85]
      ,[E86]
      ,[E87]
      ,[E88]
      ,[E89]
      ,[E91]
      ,[E92]
      ,[E93]
      ,[E94]
      ,[E95]
      ,[E96]
      ,[E97]
      ,[E98]
      ,[E99]
      ,[E101]
      ,[E102]
      ,[E103]
      ,[E104]
      ,[E105]
      ,[E106]
      ,[E107]
      ,[E108]
      ,[E109]
      ,[E111]
      ,[E112]
      ,[E113]
      ,[E114]
      ,[E115]
      ,[E116]
      ,[E117]
      ,[E118]
      ,[E119]
      ,[E121]
      ,[E122]
      ,[E123]
      ,[E124]
      ,[E125]
      ,[E126]
      ,[E127]
      ,[E128]
      ,[E129]
      ,[E131]
      ,[E132]
      ,[E133]
      ,[E134]
      ,[E135]
      ,[E136]
      ,[E137]
      ,[E138]
      ,[E139]
      ,[E141]
      ,[E142]
      ,[E143]
      ,[E144]
      ,[E145]
      ,[E146]
      ,[E147]
      ,[E148]
      ,[E149]
      ,[E151]
      ,[E152]
      ,[E153]
      ,[E154]
      ,[E155]
      ,[E156]
      ,[E157]
      ,[E158]
      ,[E159]
      ,[E161]
      ,[E162]
      ,[E163]
      ,[E164]
      ,[E165]
      ,[E166]
      ,[E167]
      ,[E168]
      ,[E169]
      ,[E171]
      ,[E172]
      ,[E173]
      ,[E174]
      ,[E175]
      ,[E176]
      ,[E177]
      ,[E178]
      ,[E179]
      ,[E181]
      ,[E182]
      ,[E183]
      ,[E184]
      ,[E185]
      ,[E186]
      ,[E187]
      ,[E188]
      ,[E189]
      ,[E191]
      ,[E192]
      ,[E193]
      ,[E194]
      ,[E195]
      ,[E196]
      ,[E197]
      ,[E198]
      ,[E199]
      ,[E201]
      ,[E202]
      ,[E203]
      ,[E204]
      ,[E205]
      ,[E206]
      ,[E207]
      ,[E208]
      ,[E209]
      ,[E211]
      ,[E212]
      ,[E213]
      ,[E214]
      ,[E215]
      ,[E216]
      ,[E217]
      ,[E218]
      ,[E219]
      ,[E221]
      ,[E222]
      ,[E223]
      ,[E224]
      ,[E225]
      ,[E226]
      ,[E227]
      ,[E228]
      ,[E229]
      ,[E231]
      ,[E232]
      ,[E233]
      ,[E234]
      ,[E235]
      ,[E236]
      ,[E237]
      ,[E238]
      ,[E239]
      ,[E241]
      ,[E242]
      ,[E243]
      ,[E244]
      ,[E245]
      ,[E246]
      ,[E247]
      ,[E248]
      ,[E249]
      ,[E251]
      ,[E252]
      ,[E253]
      ,[E254]
      ,[E255]
      ,[E256]
      ,[E257]
      ,[E258]
      ,[E259]
      ,[E261]
      ,[E262]
      ,[E263]
      ,[E264]
      ,[E265]
      ,[E266]
      ,[E267]
      ,[E268]
      ,[E269]
      ,[E271]
      ,[E272]
      ,[E273]
      ,[E274]
      ,[E275]
      ,[E276]
      ,[E277]
      ,[E278]
      ,[E279]
      ,[E281]
      ,[E282]
      ,[E283]
      ,[E284]
      ,[E285]
      ,[E286]
      ,[E287]
      ,[E288]
      ,[E289]
      ,[E291]
      ,[E292]
      ,[E293]
      ,[E294]
      ,[E295]
      ,[E296]
      ,[E297]
      ,[E298]
      ,[E299]
      ,[E301]
      ,[E302]
      ,[E303]
      ,[E304]
      ,[E305]
      ,[E306]
      ,[E307]
      ,[E308]
      ,[E309]
      ,[E311]
      ,[E312]
      ,[E313]
      ,[E314]
      ,[E315]
      ,[E316]
      ,[E317]
      ,[E318]
      ,[E319]
      ,[E321]
      ,[E322]
      ,[E323]
      ,[E324]
      ,[E325]
      ,[E326]
      ,[E327]
      ,[E328]
      ,[E329]
      ,[E331]
      ,[E332]
      ,[E333]
      ,[E334]
      ,[E335]
      ,[E336]
      ,[E337]
      ,[E338]
      ,[E339]
      ,[E341]
      ,[E342]
      ,[E343]
      ,[E344]
      ,[E345]
      ,[E346]
      ,[E347]
      ,[E348]
      ,[E349]
      ,[E351]
      ,[E352]
      ,[E353]
      ,[E354]
      ,[E355]
      ,[E356]
      ,[E357]
      ,[E358]
      ,[E359]
      ,[E361]
      ,[E362]
      ,[E363]
      ,[E364]
      ,[E365]
      ,[E366]
      ,[E367]
      ,[E368]
      ,[E369]
      ,[E371]
      ,[E372]
      ,[E373]
      ,[E374]
      ,[E375]
      ,[E376]
      ,[E377]
      ,[E378]
      ,[E379]
      ,[E381]
      ,[E382]
      ,[E383]
      ,[E384]
      ,[E385]
      ,[E386]
      ,[E387]
      ,[E388]
      ,[E389]
      ,[E391]
      ,[E392]
      ,[E393]
      ,[E394]
      ,[E395]
      ,[E396]
      ,[E397]
      ,[E398]
      ,[E399]
      ,[E401]
      ,[E402]
      ,[E403]
      ,[E404]
      ,[E405]
      ,[E406]
      ,[E407]
      ,[E408]
      ,[E409]
      ,[E411]
      ,[E412]
      ,[E413]
      ,[E414]
      ,[E415]
      ,[E416]
      ,[E417]
      ,[E418]
      ,[E419]
      ,[E421]
      ,[E422]
      ,[E423]
      ,[E424]
      ,[E425]
      ,[E426]
      ,[E427]
      ,[E428]
      ,[E429]
      ,[E431]
      ,[E432]
      ,[E433]
      ,[E434]
      ,[E435]
      ,[E436]
      ,[E437]
      ,[E438]
      ,[E439]
      ,[E441]
      ,[E442]
      ,[E443]
      ,[E444]
      ,[E445]
      ,[E446]
      ,[E447]
      ,[E448]
      ,[E449]
      ,[E451]
      ,[E452]
      ,[E453]
      ,[E454]
      ,[E455]
      ,[E456]
      ,[E457]
      ,[E458]
      ,[E459]
      ,[E461]
      ,[E462]
      ,[E463]
      ,[E464]
      ,[E465]
      ,[E466]
      ,[E467]
      ,[E468]
      ,[E469]
      ,[E471]
      ,[E472]
      ,[E473]
      ,[E474]
      ,[E475]
      ,[E476]
      ,[E477]
      ,[E478]
      ,[E479]
      ,[E481]
      ,[E482]
      ,[E483]
      ,[E484]
      ,[E485]
      ,[E486]
      ,[E487]
      ,[E488]
      ,[E489]
      ,[E491]
      ,[E492]
      ,[E493]
      ,[E494]
      ,[E495]
      ,[E496]
      ,[E497]
      ,[E498]
      ,[E499]
      ,[E501]
      ,[E502]
      ,[E503]
      ,[E504]
      ,[E505]
      ,[E506]
      ,[E507]
      ,[E508]
      ,[E509]
      ,[E511]
      ,[E512]
      ,[E513]
      ,[E514]
      ,[E515]
      ,[E516]
      ,[E517]
      ,[E518]
      ,[E519]
      ,[E521]
      ,[E522]
      ,[E523]
      ,[E524]
      ,[E525]
      ,[E526]
      ,[E527]
      ,[E528]
      ,[E529]
      ,[E531]
      ,[E532]
      ,[E533]
      ,[E534]
      ,[E535]
      ,[E536]
      ,[E537]
      ,[E538]
      ,[E539]
      ,[E541]
      ,[E542]
      ,[E543]
      ,[E544]
      ,[E545]
      ,[E546]
      ,[E547]
      ,[E548]
      ,[E549]
      ,[E551]
      ,[E552]
      ,[E553]
      ,[E554]
      ,[E555]
      ,[E556]
      ,[E557]
      ,[E558]
      ,[E559]
      ,[E561]
      ,[E562]
      ,[E563]
      ,[E564]
      ,[E565]
      ,[E566]
      ,[E567]
      ,[E568]
      ,[E569]
      ,[E571]
      ,[E572]
      ,[E573]
      ,[E574]
      ,[E575]
      ,[E576]
      ,[E577]
      ,[E578]
      ,[E579]
      ,[E581]
      ,[E582]
      ,[E583]
      ,[E584]
      ,[E585]
      ,[E586]
      ,[E587]
      ,[E588]
      ,[E589]
      ,[E591]
      ,[E592]
      ,[E593]
      ,[E594]
      ,[E595]
      ,[E596]
      ,[E597]
      ,[E598]
      ,[E599]
      ,[E601]
      ,[E602]
      ,[E603]
      ,[E604]
      ,[E605]
      ,[E606]
      ,[E607]
      ,[E608]
      ,[E609]
      ,[E611]
      ,[E612]
      ,[E613]
      ,[E614]
      ,[E615]
      ,[E616]
      ,[E617]
      ,[E618]
      ,[E619]
      ,[E621]
      ,[E622]
      ,[E623]
      ,[E624]
      ,[E625]
      ,[E626]
      ,[E627]
      ,[E628]
      ,[E629]
      ,[E631]
      ,[E632]
      ,[E633]
      ,[E634]
      ,[E635]
      ,[E636]
      ,[E637]
      ,[E638]
      ,[E639]
      ,[E641]
      ,[E642]
      ,[E643]
      ,[E644]
      ,[E645]
      ,[E646]
      ,[E647]
      ,[E648]
      ,[E649]
      ,[E651]
      ,[E652]
      ,[E653]
      ,[E654]
      ,[E655]
      ,[E656]
      ,[E657]
      ,[E658]
      ,[E659]
      ,[E661]
      ,[E662]
      ,[E663]
      ,[E664]
      ,[E665]
      ,[E666]
      ,[E667]
      ,[E668]
      ,[E669]
      ,[E671]
      ,[E672]
      ,[E673]
      ,[E674]
      ,[E675]
      ,[E676]
      ,[E677]
      ,[E678]
      ,[E679]
      ,[E681]
      ,[E682]
      ,[E683]
      ,[E684]
      ,[E685]
      ,[E686]
      ,[E687]
      ,[E688]
      ,[E689]
      ,[E691]
      ,[E692]
      ,[E693]
      ,[E694]
      ,[E695]
      ,[E696]
      ,[E697]
      ,[E698]
      ,[E699]
      ,[E701]
      ,[E702]
      ,[E703]
      ,[E704]
      ,[E705]
      ,[E706]
      ,[E707]
      ,[E708]
      ,[E709]
      ,[E711]
      ,[E712]
      ,[E713]
      ,[E714]
      ,[E715]
      ,[E716]
      ,[E717]
      ,[E718]
      ,[E719]
      ,[E721]
      ,[E722]
      ,[E723]
      ,[E724]
      ,[E725]
      ,[E726]
      ,[E727]
      ,[E728]
      ,[E729]
      ,[E731]
      ,[E732]
      ,[E733]
      ,[E734]
      ,[E735]
      ,[E736]
      ,[E737]
      ,[E738]
      ,[E739]
      ,[E741]
      ,[E742]
      ,[E743]
      ,[E744]
      ,[E745]
      ,[E746]
      ,[E747]
      ,[E748]
      ,[E749]
      ,[E751]
      ,[E752]
      ,[E753]
      ,[E754]
      ,[E755]
      ,[E756]
      ,[E757]
      ,[E758]
      ,[E759]
      ,[E1]
      ,[E2]
      ,[E3]
      ,[E4]
      ,[E5]
      ,[E6]
      ,[E7]
      ,[E8]
      ,[E9]
      ,[osa15]
      ,[nai15]
      ,[osa16]
      ,[nai16]
      ,[tietolahde] = ''2_11_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
  FROM [TK_H9098_CSC].[dbo].[TK_2_11_sopv_13]
  
UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[osa1]
      ,[suo1]
      ,[osa2]
      ,[suo2]
      ,[osa3]
      ,[suo3]
      ,[kur4]
      ,[osa4]
      ,[nai4]
      ,[tun4]
      ,[kur5]
      ,[osa5]
      ,[nai5]
      ,[tun5]
      ,[kur6]
      ,[osa6]
      ,[nai6]
      ,[tun6]
      ,[kur7]
      ,[osa7]
      ,[nai7]
      ,[kur8]
      ,[osa8]
      ,[nai8]
      ,[kur9]
      ,[osa9]
      ,[nai9]
      ,[kur10]
      ,[osa10]
      ,[nai10]
      ,[kur11]
      ,[osa11]
      ,[nai11]
      ,[kur12]
      ,[osa12]
      ,[nai12]
      ,[kur13]
      ,[osa13]
      ,[nai13]
      ,[kur14]
      ,[osa14]
      ,[nai14]
      ,[kurd]
      ,[osad]
      ,[naid]
      ,[E11]
      ,[E12]
      ,[E13]
      ,[E14]
      ,[E15]
      ,[E16]
      ,[E17]
      ,[E18]
      ,[E19]
      ,[E21]
      ,[E22]
      ,[E23]
      ,[E24]
      ,[E25]
      ,[E26]
      ,[E27]
      ,[E28]
      ,[E29]
      ,[E31]
      ,[E32]
      ,[E33]
      ,[E34]
      ,[E35]
      ,[E36]
      ,[E37]
      ,[E38]
      ,[E39]
      ,[E41]
      ,[E42]
      ,[E43]
      ,[E44]
      ,[E45]
      ,[E46]
      ,[E47]
      ,[E48]
      ,[E49]
      ,[E51]
      ,[E52]
      ,[E53]
      ,[E54]
      ,[E55]
      ,[E56]
      ,[E57]
      ,[E58]
      ,[E59]
      ,[E61]
      ,[E62]
      ,[E63]
      ,[E64]
      ,[E65]
      ,[E66]
      ,[E67]
      ,[E68]
      ,[E69]
      ,[E71]
      ,[E72]
      ,[E73]
      ,[E74]
      ,[E75]
      ,[E76]
      ,[E77]
      ,[E78]
      ,[E79]
      ,[E81]
      ,[E82]
      ,[E83]
      ,[E84]
      ,[E85]
      ,[E86]
      ,[E87]
      ,[E88]
      ,[E89]
      ,[E91]
      ,[E92]
      ,[E93]
      ,[E94]
      ,[E95]
      ,[E96]
      ,[E97]
      ,[E98]
      ,[E99]
      ,[E101]
      ,[E102]
      ,[E103]
      ,[E104]
      ,[E105]
      ,[E106]
      ,[E107]
      ,[E108]
      ,[E109]
      ,[E111]
      ,[E112]
      ,[E113]
      ,[E114]
      ,[E115]
      ,[E116]
      ,[E117]
      ,[E118]
      ,[E119]
      ,[E121]
      ,[E122]
      ,[E123]
      ,[E124]
      ,[E125]
      ,[E126]
      ,[E127]
      ,[E128]
      ,[E129]
      ,[E131]
      ,[E132]
      ,[E133]
      ,[E134]
      ,[E135]
      ,[E136]
      ,[E137]
      ,[E138]
      ,[E139]
      ,[E141]
      ,[E142]
      ,[E143]
      ,[E144]
      ,[E145]
      ,[E146]
      ,[E147]
      ,[E148]
      ,[E149]
      ,[E151]
      ,[E152]
      ,[E153]
      ,[E154]
      ,[E155]
      ,[E156]
      ,[E157]
      ,[E158]
      ,[E159]
      ,[E161]
      ,[E162]
      ,[E163]
      ,[E164]
      ,[E165]
      ,[E166]
      ,[E167]
      ,[E168]
      ,[E169]
      ,[E171]
      ,[E172]
      ,[E173]
      ,[E174]
      ,[E175]
      ,[E176]
      ,[E177]
      ,[E178]
      ,[E179]
      ,[E181]
      ,[E182]
      ,[E183]
      ,[E184]
      ,[E185]
      ,[E186]
      ,[E187]
      ,[E188]
      ,[E189]
      ,[E191]
      ,[E192]
      ,[E193]
      ,[E194]
      ,[E195]
      ,[E196]
      ,[E197]
      ,[E198]
      ,[E199]
      ,[E201]
      ,[E202]
      ,[E203]
      ,[E204]
      ,[E205]
      ,[E206]
      ,[E207]
      ,[E208]
      ,[E209]
      ,[E211]
      ,[E212]
      ,[E213]
      ,[E214]
      ,[E215]
      ,[E216]
      ,[E217]
      ,[E218]
      ,[E219]
      ,[E221]
      ,[E222]
      ,[E223]
      ,[E224]
      ,[E225]
      ,[E226]
      ,[E227]
      ,[E228]
      ,[E229]
      ,[E231]
      ,[E232]
      ,[E233]
      ,[E234]
      ,[E235]
      ,[E236]
      ,[E237]
      ,[E238]
      ,[E239]
      ,[E241]
      ,[E242]
      ,[E243]
      ,[E244]
      ,[E245]
      ,[E246]
      ,[E247]
      ,[E248]
      ,[E249]
      ,[E251]
      ,[E252]
      ,[E253]
      ,[E254]
      ,[E255]
      ,[E256]
      ,[E257]
      ,[E258]
      ,[E259]
      ,[E261]
      ,[E262]
      ,[E263]
      ,[E264]
      ,[E265]
      ,[E266]
      ,[E267]
      ,[E268]
      ,[E269]
      ,[E271]
      ,[E272]
      ,[E273]
      ,[E274]
      ,[E275]
      ,[E276]
      ,[E277]
      ,[E278]
      ,[E279]
      ,[E281]
      ,[E282]
      ,[E283]
      ,[E284]
      ,[E285]
      ,[E286]
      ,[E287]
      ,[E288]
      ,[E289]
      ,[E291]
      ,[E292]
      ,[E293]
      ,[E294]
      ,[E295]
      ,[E296]
      ,[E297]
      ,[E298]
      ,[E299]
      ,[E301]
      ,[E302]
      ,[E303]
      ,[E304]
      ,[E305]
      ,[E306]
      ,[E307]
      ,[E308]
      ,[E309]
      ,[E311]
      ,[E312]
      ,[E313]
      ,[E314]
      ,[E315]
      ,[E316]
      ,[E317]
      ,[E318]
      ,[E319]
      ,[E321]
      ,[E322]
      ,[E323]
      ,[E324]
      ,[E325]
      ,[E326]
      ,[E327]
      ,[E328]
      ,[E329]
      ,[E331]
      ,[E332]
      ,[E333]
      ,[E334]
      ,[E335]
      ,[E336]
      ,[E337]
      ,[E338]
      ,[E339]
      ,[E341]
      ,[E342]
      ,[E343]
      ,[E344]
      ,[E345]
      ,[E346]
      ,[E347]
      ,[E348]
      ,[E349]
      ,[E351]
      ,[E352]
      ,[E353]
      ,[E354]
      ,[E355]
      ,[E356]
      ,[E357]
      ,[E358]
      ,[E359]
      ,[E361]
      ,[E362]
      ,[E363]
      ,[E364]
      ,[E365]
      ,[E366]
      ,[E367]
      ,[E368]
      ,[E369]
      ,[E371]
      ,[E372]
      ,[E373]
      ,[E374]
      ,[E375]
      ,[E376]
      ,[E377]
      ,[E378]
      ,[E379]
      ,[E381]
      ,[E382]
      ,[E383]
      ,[E384]
      ,[E385]
      ,[E386]
      ,[E387]
      ,[E388]
      ,[E389]
      ,[E391]
      ,[E392]
      ,[E393]
      ,[E394]
      ,[E395]
      ,[E396]
      ,[E397]
      ,[E398]
      ,[E399]
      ,[E401]
      ,[E402]
      ,[E403]
      ,[E404]
      ,[E405]
      ,[E406]
      ,[E407]
      ,[E408]
      ,[E409]
      ,[E411]
      ,[E412]
      ,[E413]
      ,[E414]
      ,[E415]
      ,[E416]
      ,[E417]
      ,[E418]
      ,[E419]
      ,[E421]
      ,[E422]
      ,[E423]
      ,[E424]
      ,[E425]
      ,[E426]
      ,[E427]
      ,[E428]
      ,[E429]
      ,[E431]
      ,[E432]
      ,[E433]
      ,[E434]
      ,[E435]
      ,[E436]
      ,[E437]
      ,[E438]
      ,[E439]
      ,[E441]
      ,[E442]
      ,[E443]
      ,[E444]
      ,[E445]
      ,[E446]
      ,[E447]
      ,[E448]
      ,[E449]
      ,[E451]
      ,[E452]
      ,[E453]
      ,[E454]
      ,[E455]
      ,[E456]
      ,[E457]
      ,[E458]
      ,[E459]
      ,[E461]
      ,[E462]
      ,[E463]
      ,[E464]
      ,[E465]
      ,[E466]
      ,[E467]
      ,[E468]
      ,[E469]
      ,[E471]
      ,[E472]
      ,[E473]
      ,[E474]
      ,[E475]
      ,[E476]
      ,[E477]
      ,[E478]
      ,[E479]
      ,[E481]
      ,[E482]
      ,[E483]
      ,[E484]
      ,[E485]
      ,[E486]
      ,[E487]
      ,[E488]
      ,[E489]
      ,[E491]
      ,[E492]
      ,[E493]
      ,[E494]
      ,[E495]
      ,[E496]
      ,[E497]
      ,[E498]
      ,[E499]
      ,[E501]
      ,[E502]
      ,[E503]
      ,[E504]
      ,[E505]
      ,[E506]
      ,[E507]
      ,[E508]
      ,[E509]
      ,[E511]
      ,[E512]
      ,[E513]
      ,[E514]
      ,[E515]
      ,[E516]
      ,[E517]
      ,[E518]
      ,[E519]
      ,[E521]
      ,[E522]
      ,[E523]
      ,[E524]
      ,[E525]
      ,[E526]
      ,[E527]
      ,[E528]
      ,[E529]
      ,[E531]
      ,[E532]
      ,[E533]
      ,[E534]
      ,[E535]
      ,[E536]
      ,[E537]
      ,[E538]
      ,[E539]
      ,[E541]
      ,[E542]
      ,[E543]
      ,[E544]
      ,[E545]
      ,[E546]
      ,[E547]
      ,[E548]
      ,[E549]
      ,[E551]
      ,[E552]
      ,[E553]
      ,[E554]
      ,[E555]
      ,[E556]
      ,[E557]
      ,[E558]
      ,[E559]
      ,[E561]
      ,[E562]
      ,[E563]
      ,[E564]
      ,[E565]
      ,[E566]
      ,[E567]
      ,[E568]
      ,[E569]
      ,[E571]
      ,[E572]
      ,[E573]
      ,[E574]
      ,[E575]
      ,[E576]
      ,[E577]
      ,[E578]
      ,[E579]
      ,[E581]
      ,[E582]
      ,[E583]
      ,[E584]
      ,[E585]
      ,[E586]
      ,[E587]
      ,[E588]
      ,[E589]
      ,[E591]
      ,[E592]
      ,[E593]
      ,[E594]
      ,[E595]
      ,[E596]
      ,[E597]
      ,[E598]
      ,[E599]
      ,[E601]
      ,[E602]
      ,[E603]
      ,[E604]
      ,[E605]
      ,[E606]
      ,[E607]
      ,[E608]
      ,[E609]
      ,[E611]
      ,[E612]
      ,[E613]
      ,[E614]
      ,[E615]
      ,[E616]
      ,[E617]
      ,[E618]
      ,[E619]
      ,[E621]
      ,[E622]
      ,[E623]
      ,[E624]
      ,[E625]
      ,[E626]
      ,[E627]
      ,[E628]
      ,[E629]
      ,[E631]
      ,[E632]
      ,[E633]
      ,[E634]
      ,[E635]
      ,[E636]
      ,[E637]
      ,[E638]
      ,[E639]
      ,[E641]
      ,[E642]
      ,[E643]
      ,[E644]
      ,[E645]
      ,[E646]
      ,[E647]
      ,[E648]
      ,[E649]
      ,[E651]
      ,[E652]
      ,[E653]
      ,[E654]
      ,[E655]
      ,[E656]
      ,[E657]
      ,[E658]
      ,[E659]
      ,[E661]
      ,[E662]
      ,[E663]
      ,[E664]
      ,[E665]
      ,[E666]
      ,[E667]
      ,[E668]
      ,[E669]
      ,[E671]
      ,[E672]
      ,[E673]
      ,[E674]
      ,[E675]
      ,[E676]
      ,[E677]
      ,[E678]
      ,[E679]
      ,[E681]
      ,[E682]
      ,[E683]
      ,[E684]
      ,[E685]
      ,[E686]
      ,[E687]
      ,[E688]
      ,[E689]
      ,[E691]
      ,[E692]
      ,[E693]
      ,[E694]
      ,[E695]
      ,[E696]
      ,[E697]
      ,[E698]
      ,[E699]
      ,[E701]
      ,[E702]
      ,[E703]
      ,[E704]
      ,[E705]
      ,[E706]
      ,[E707]
      ,[E708]
      ,[E709]
      ,[E711]
      ,[E712]
      ,[E713]
      ,[E714]
      ,[E715]
      ,[E716]
      ,[E717]
      ,[E718]
      ,[E719]
      ,[E721]
      ,[E722]
      ,[E723]
      ,[E724]
      ,[E725]
      ,[E726]
      ,[E727]
      ,[E728]
      ,[E729]
      ,[E731]
      ,[E732]
      ,[E733]
      ,[E734]
      ,[E735]
      ,[E736]
      ,[E737]
      ,[E738]
      ,[E739]
      ,[E741]
      ,[E742]
      ,[E743]
      ,[E744]
      ,[E745]
      ,[E746]
      ,[E747]
      ,[E748]
      ,[E749]
      ,[E751]
      ,[E752]
      ,[E753]
      ,[E754]
      ,[E755]
      ,[E756]
      ,[E757]
      ,[E758]
      ,[E759]
      ,[E1]
      ,[E2]
      ,[E3]
      ,[E4]
      ,[E5]
      ,[E6]
      ,[E7]
      ,[E8]
      ,[E9]
      ,[osa15]
      ,[nai15]
      ,[osa16]
      ,[nai16]
      ,[tietolahde] = ''2_11_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
  FROM [TK_H9098_CSC].[dbo].[TK_2_11_sopv_14]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[osa1]
      ,[suo1]
      ,[osa2]
      ,[suo2]
      ,[osa3]
      ,[suo3]
      ,[kur4]
      ,[osa4]
      ,[nai4]
      ,[tun4]
      ,[kur5]
      ,[osa5]
      ,[nai5]
      ,[tun5]
      ,[kur6]
      ,[osa6]
      ,[nai6]
      ,[tun6]
      ,[kur7]
      ,[osa7]
      ,[nai7]
      ,[kur8]
      ,[osa8]
      ,[nai8]
      ,[kur9]
      ,[osa9]
      ,[nai9]
      ,[kur10]
      ,[osa10]
      ,[nai10]
      ,[kur11]
      ,[osa11]
      ,[nai11]
      ,[kur12]
      ,[osa12]
      ,[nai12]
      ,[kur13]
      ,[osa13]
      ,[nai13]
      ,[kur14]
      ,[osa14]
      ,[nai14]
      ,[kurd]
      ,[osad]
      ,[naid]
      ,[E11]
      ,[E12]
      ,[E13]
      ,[E14]
      ,[E15]
      ,[E16]
      ,[E17]
      ,[E18]
      ,[E19]
      ,[E21]
      ,[E22]
      ,[E23]
      ,[E24]
      ,[E25]
      ,[E26]
      ,[E27]
      ,[E28]
      ,[E29]
      ,[E31]
      ,[E32]
      ,[E33]
      ,[E34]
      ,[E35]
      ,[E36]
      ,[E37]
      ,[E38]
      ,[E39]
      ,[E41]
      ,[E42]
      ,[E43]
      ,[E44]
      ,[E45]
      ,[E46]
      ,[E47]
      ,[E48]
      ,[E49]
      ,[E51]
      ,[E52]
      ,[E53]
      ,[E54]
      ,[E55]
      ,[E56]
      ,[E57]
      ,[E58]
      ,[E59]
      ,[E61]
      ,[E62]
      ,[E63]
      ,[E64]
      ,[E65]
      ,[E66]
      ,[E67]
      ,[E68]
      ,[E69]
      ,[E71]
      ,[E72]
      ,[E73]
      ,[E74]
      ,[E75]
      ,[E76]
      ,[E77]
      ,[E78]
      ,[E79]
      ,[E81]
      ,[E82]
      ,[E83]
      ,[E84]
      ,[E85]
      ,[E86]
      ,[E87]
      ,[E88]
      ,[E89]
      ,[E91]
      ,[E92]
      ,[E93]
      ,[E94]
      ,[E95]
      ,[E96]
      ,[E97]
      ,[E98]
      ,[E99]
      ,[E101]
      ,[E102]
      ,[E103]
      ,[E104]
      ,[E105]
      ,[E106]
      ,[E107]
      ,[E108]
      ,[E109]
      ,[E111]
      ,[E112]
      ,[E113]
      ,[E114]
      ,[E115]
      ,[E116]
      ,[E117]
      ,[E118]
      ,[E119]
      ,[E121]
      ,[E122]
      ,[E123]
      ,[E124]
      ,[E125]
      ,[E126]
      ,[E127]
      ,[E128]
      ,[E129]
      ,[E131]
      ,[E132]
      ,[E133]
      ,[E134]
      ,[E135]
      ,[E136]
      ,[E137]
      ,[E138]
      ,[E139]
      ,[E141]
      ,[E142]
      ,[E143]
      ,[E144]
      ,[E145]
      ,[E146]
      ,[E147]
      ,[E148]
      ,[E149]
      ,[E151]
      ,[E152]
      ,[E153]
      ,[E154]
      ,[E155]
      ,[E156]
      ,[E157]
      ,[E158]
      ,[E159]
      ,[E161]
      ,[E162]
      ,[E163]
      ,[E164]
      ,[E165]
      ,[E166]
      ,[E167]
      ,[E168]
      ,[E169]
      ,[E171]
      ,[E172]
      ,[E173]
      ,[E174]
      ,[E175]
      ,[E176]
      ,[E177]
      ,[E178]
      ,[E179]
      ,[E181]
      ,[E182]
      ,[E183]
      ,[E184]
      ,[E185]
      ,[E186]
      ,[E187]
      ,[E188]
      ,[E189]
      ,[E191]
      ,[E192]
      ,[E193]
      ,[E194]
      ,[E195]
      ,[E196]
      ,[E197]
      ,[E198]
      ,[E199]
      ,[E201]
      ,[E202]
      ,[E203]
      ,[E204]
      ,[E205]
      ,[E206]
      ,[E207]
      ,[E208]
      ,[E209]
      ,[E211]
      ,[E212]
      ,[E213]
      ,[E214]
      ,[E215]
      ,[E216]
      ,[E217]
      ,[E218]
      ,[E219]
      ,[E221]
      ,[E222]
      ,[E223]
      ,[E224]
      ,[E225]
      ,[E226]
      ,[E227]
      ,[E228]
      ,[E229]
      ,[E231]
      ,[E232]
      ,[E233]
      ,[E234]
      ,[E235]
      ,[E236]
      ,[E237]
      ,[E238]
      ,[E239]
      ,[E241]
      ,[E242]
      ,[E243]
      ,[E244]
      ,[E245]
      ,[E246]
      ,[E247]
      ,[E248]
      ,[E249]
      ,[E251]
      ,[E252]
      ,[E253]
      ,[E254]
      ,[E255]
      ,[E256]
      ,[E257]
      ,[E258]
      ,[E259]
      ,[E261]
      ,[E262]
      ,[E263]
      ,[E264]
      ,[E265]
      ,[E266]
      ,[E267]
      ,[E268]
      ,[E269]
      ,[E271]
      ,[E272]
      ,[E273]
      ,[E274]
      ,[E275]
      ,[E276]
      ,[E277]
      ,[E278]
      ,[E279]
      ,[E281]
      ,[E282]
      ,[E283]
      ,[E284]
      ,[E285]
      ,[E286]
      ,[E287]
      ,[E288]
      ,[E289]
      ,[E291]
      ,[E292]
      ,[E293]
      ,[E294]
      ,[E295]
      ,[E296]
      ,[E297]
      ,[E298]
      ,[E299]
      ,[E301]
      ,[E302]
      ,[E303]
      ,[E304]
      ,[E305]
      ,[E306]
      ,[E307]
      ,[E308]
      ,[E309]
      ,[E311]
      ,[E312]
      ,[E313]
      ,[E314]
      ,[E315]
      ,[E316]
      ,[E317]
      ,[E318]
      ,[E319]
      ,[E321]
      ,[E322]
      ,[E323]
      ,[E324]
      ,[E325]
      ,[E326]
      ,[E327]
      ,[E328]
      ,[E329]
      ,[E331]
      ,[E332]
      ,[E333]
      ,[E334]
      ,[E335]
      ,[E336]
      ,[E337]
      ,[E338]
      ,[E339]
      ,[E341]
      ,[E342]
      ,[E343]
      ,[E344]
      ,[E345]
      ,[E346]
      ,[E347]
      ,[E348]
      ,[E349]
      ,[E351]
      ,[E352]
      ,[E353]
      ,[E354]
      ,[E355]
      ,[E356]
      ,[E357]
      ,[E358]
      ,[E359]
      ,[E361]
      ,[E362]
      ,[E363]
      ,[E364]
      ,[E365]
      ,[E366]
      ,[E367]
      ,[E368]
      ,[E369]
      ,[E371]
      ,[E372]
      ,[E373]
      ,[E374]
      ,[E375]
      ,[E376]
      ,[E377]
      ,[E378]
      ,[E379]
      ,[E381]
      ,[E382]
      ,[E383]
      ,[E384]
      ,[E385]
      ,[E386]
      ,[E387]
      ,[E388]
      ,[E389]
      ,[E391]
      ,[E392]
      ,[E393]
      ,[E394]
      ,[E395]
      ,[E396]
      ,[E397]
      ,[E398]
      ,[E399]
      ,[E401]
      ,[E402]
      ,[E403]
      ,[E404]
      ,[E405]
      ,[E406]
      ,[E407]
      ,[E408]
      ,[E409]
      ,[E411]
      ,[E412]
      ,[E413]
      ,[E414]
      ,[E415]
      ,[E416]
      ,[E417]
      ,[E418]
      ,[E419]
      ,[E421]
      ,[E422]
      ,[E423]
      ,[E424]
      ,[E425]
      ,[E426]
      ,[E427]
      ,[E428]
      ,[E429]
      ,[E431]
      ,[E432]
      ,[E433]
      ,[E434]
      ,[E435]
      ,[E436]
      ,[E437]
      ,[E438]
      ,[E439]
      ,[E441]
      ,[E442]
      ,[E443]
      ,[E444]
      ,[E445]
      ,[E446]
      ,[E447]
      ,[E448]
      ,[E449]
      ,[E451]
      ,[E452]
      ,[E453]
      ,[E454]
      ,[E455]
      ,[E456]
      ,[E457]
      ,[E458]
      ,[E459]
      ,[E461]
      ,[E462]
      ,[E463]
      ,[E464]
      ,[E465]
      ,[E466]
      ,[E467]
      ,[E468]
      ,[E469]
      ,[E471]
      ,[E472]
      ,[E473]
      ,[E474]
      ,[E475]
      ,[E476]
      ,[E477]
      ,[E478]
      ,[E479]
      ,[E481]
      ,[E482]
      ,[E483]
      ,[E484]
      ,[E485]
      ,[E486]
      ,[E487]
      ,[E488]
      ,[E489]
      ,[E491]
      ,[E492]
      ,[E493]
      ,[E494]
      ,[E495]
      ,[E496]
      ,[E497]
      ,[E498]
      ,[E499]
      ,[E501]
      ,[E502]
      ,[E503]
      ,[E504]
      ,[E505]
      ,[E506]
      ,[E507]
      ,[E508]
      ,[E509]
      ,[E511]
      ,[E512]
      ,[E513]
      ,[E514]
      ,[E515]
      ,[E516]
      ,[E517]
      ,[E518]
      ,[E519]
      ,[E521]
      ,[E522]
      ,[E523]
      ,[E524]
      ,[E525]
      ,[E526]
      ,[E527]
      ,[E528]
      ,[E529]
      ,[E531]
      ,[E532]
      ,[E533]
      ,[E534]
      ,[E535]
      ,[E536]
      ,[E537]
      ,[E538]
      ,[E539]
      ,[E541]
      ,[E542]
      ,[E543]
      ,[E544]
      ,[E545]
      ,[E546]
      ,[E547]
      ,[E548]
      ,[E549]
      ,[E551]
      ,[E552]
      ,[E553]
      ,[E554]
      ,[E555]
      ,[E556]
      ,[E557]
      ,[E558]
      ,[E559]
      ,[E561]
      ,[E562]
      ,[E563]
      ,[E564]
      ,[E565]
      ,[E566]
      ,[E567]
      ,[E568]
      ,[E569]
      ,[E571]
      ,[E572]
      ,[E573]
      ,[E574]
      ,[E575]
      ,[E576]
      ,[E577]
      ,[E578]
      ,[E579]
      ,[E581]
      ,[E582]
      ,[E583]
      ,[E584]
      ,[E585]
      ,[E586]
      ,[E587]
      ,[E588]
      ,[E589]
      ,[E591]
      ,[E592]
      ,[E593]
      ,[E594]
      ,[E595]
      ,[E596]
      ,[E597]
      ,[E598]
      ,[E599]
      ,[E601]
      ,[E602]
      ,[E603]
      ,[E604]
      ,[E605]
      ,[E606]
      ,[E607]
      ,[E608]
      ,[E609]
      ,[E611]
      ,[E612]
      ,[E613]
      ,[E614]
      ,[E615]
      ,[E616]
      ,[E617]
      ,[E618]
      ,[E619]
      ,[E621]
      ,[E622]
      ,[E623]
      ,[E624]
      ,[E625]
      ,[E626]
      ,[E627]
      ,[E628]
      ,[E629]
      ,[E631]
      ,[E632]
      ,[E633]
      ,[E634]
      ,[E635]
      ,[E636]
      ,[E637]
      ,[E638]
      ,[E639]
      ,[E641]
      ,[E642]
      ,[E643]
      ,[E644]
      ,[E645]
      ,[E646]
      ,[E647]
      ,[E648]
      ,[E649]
      ,[E651]
      ,[E652]
      ,[E653]
      ,[E654]
      ,[E655]
      ,[E656]
      ,[E657]
      ,[E658]
      ,[E659]
      ,[E661]
      ,[E662]
      ,[E663]
      ,[E664]
      ,[E665]
      ,[E666]
      ,[E667]
      ,[E668]
      ,[E669]
      ,[E671]
      ,[E672]
      ,[E673]
      ,[E674]
      ,[E675]
      ,[E676]
      ,[E677]
      ,[E678]
      ,[E679]
      ,[E681]
      ,[E682]
      ,[E683]
      ,[E684]
      ,[E685]
      ,[E686]
      ,[E687]
      ,[E688]
      ,[E689]
      ,[E691]
      ,[E692]
      ,[E693]
      ,[E694]
      ,[E695]
      ,[E696]
      ,[E697]
      ,[E698]
      ,[E699]
      ,[E701]
      ,[E702]
      ,[E703]
      ,[E704]
      ,[E705]
      ,[E706]
      ,[E707]
      ,[E708]
      ,[E709]
      ,[E711]
      ,[E712]
      ,[E713]
      ,[E714]
      ,[E715]
      ,[E716]
      ,[E717]
      ,[E718]
      ,[E719]
      ,[E721]
      ,[E722]
      ,[E723]
      ,[E724]
      ,[E725]
      ,[E726]
      ,[E727]
      ,[E728]
      ,[E729]
      ,[E731]
      ,[E732]
      ,[E733]
      ,[E734]
      ,[E735]
      ,[E736]
      ,[E737]
      ,[E738]
      ,[E739]
      ,[E741]
      ,[E742]
      ,[E743]
      ,[E744]
      ,[E745]
      ,[E746]
      ,[E747]
      ,[E748]
      ,[E749]
      ,[E751]
      ,[E752]
      ,[E753]
      ,[E754]
      ,[E755]
      ,[E756]
      ,[E757]
      ,[E758]
      ,[E759]
      ,[E1]
      ,[E2]
      ,[E3]
      ,[E4]
      ,[E5]
      ,[E6]
      ,[E7]
      ,[E8]
      ,[E9]
      ,[osa15]
      ,[nai15]
      ,[osa16]
      ,[nai16]
      ,[tietolahde] = ''2_11_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
  FROM [TK_H9098_CSC].[dbo].[TK_2_11_sopv_15]

UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[osa1]
      ,[suo1]
      ,[osa2]
      ,[suo2]
      ,[osa3]
      ,[suo3]
      ,[kur4]
      ,[osa4]
      ,[nai4]
      ,[tun4]
      ,[kur5]
      ,[osa5]
      ,[nai5]
      ,[tun5]
      ,[kur6]
      ,[osa6]
      ,[nai6]
      ,[tun6]
      ,[kur7]
      ,[osa7]
      ,[nai7]
      ,[kur8]
      ,[osa8]
      ,[nai8]
      ,[kur9]
      ,[osa9]
      ,[nai9]
      ,[kur10]
      ,[osa10]
      ,[nai10]
      ,[kur11]
      ,[osa11]
      ,[nai11]
      ,[kur12]
      ,[osa12]
      ,[nai12]
      ,[kur13]
      ,[osa13]
      ,[nai13]
      ,[kur14]
      ,[osa14]
      ,[nai14]
      ,[kurd]
      ,[osad]
      ,[naid]
      ,[E11]
      ,[E12]
      ,[E13]
      ,[E14]
      ,[E15]
      ,[E16]
      ,[E17]
      ,[E18]
      ,[E19]
      ,[E21]
      ,[E22]
      ,[E23]
      ,[E24]
      ,[E25]
      ,[E26]
      ,[E27]
      ,[E28]
      ,[E29]
      ,[E31]
      ,[E32]
      ,[E33]
      ,[E34]
      ,[E35]
      ,[E36]
      ,[E37]
      ,[E38]
      ,[E39]
      ,[E41]
      ,[E42]
      ,[E43]
      ,[E44]
      ,[E45]
      ,[E46]
      ,[E47]
      ,[E48]
      ,[E49]
      ,[E51]
      ,[E52]
      ,[E53]
      ,[E54]
      ,[E55]
      ,[E56]
      ,[E57]
      ,[E58]
      ,[E59]
      ,[E61]
      ,[E62]
      ,[E63]
      ,[E64]
      ,[E65]
      ,[E66]
      ,[E67]
      ,[E68]
      ,[E69]
      ,[E71]
      ,[E72]
      ,[E73]
      ,[E74]
      ,[E75]
      ,[E76]
      ,[E77]
      ,[E78]
      ,[E79]
      ,[E81]
      ,[E82]
      ,[E83]
      ,[E84]
      ,[E85]
      ,[E86]
      ,[E87]
      ,[E88]
      ,[E89]
      ,[E91]
      ,[E92]
      ,[E93]
      ,[E94]
      ,[E95]
      ,[E96]
      ,[E97]
      ,[E98]
      ,[E99]
      ,[E101]
      ,[E102]
      ,[E103]
      ,[E104]
      ,[E105]
      ,[E106]
      ,[E107]
      ,[E108]
      ,[E109]
      ,[E111]
      ,[E112]
      ,[E113]
      ,[E114]
      ,[E115]
      ,[E116]
      ,[E117]
      ,[E118]
      ,[E119]
      ,[E121]
      ,[E122]
      ,[E123]
      ,[E124]
      ,[E125]
      ,[E126]
      ,[E127]
      ,[E128]
      ,[E129]
      ,[E131]
      ,[E132]
      ,[E133]
      ,[E134]
      ,[E135]
      ,[E136]
      ,[E137]
      ,[E138]
      ,[E139]
      ,[E141]
      ,[E142]
      ,[E143]
      ,[E144]
      ,[E145]
      ,[E146]
      ,[E147]
      ,[E148]
      ,[E149]
      ,[E151]
      ,[E152]
      ,[E153]
      ,[E154]
      ,[E155]
      ,[E156]
      ,[E157]
      ,[E158]
      ,[E159]
      ,[E161]
      ,[E162]
      ,[E163]
      ,[E164]
      ,[E165]
      ,[E166]
      ,[E167]
      ,[E168]
      ,[E169]
      ,[E171]
      ,[E172]
      ,[E173]
      ,[E174]
      ,[E175]
      ,[E176]
      ,[E177]
      ,[E178]
      ,[E179]
      ,[E181]
      ,[E182]
      ,[E183]
      ,[E184]
      ,[E185]
      ,[E186]
      ,[E187]
      ,[E188]
      ,[E189]
      ,[E191]
      ,[E192]
      ,[E193]
      ,[E194]
      ,[E195]
      ,[E196]
      ,[E197]
      ,[E198]
      ,[E199]
      ,[E201]
      ,[E202]
      ,[E203]
      ,[E204]
      ,[E205]
      ,[E206]
      ,[E207]
      ,[E208]
      ,[E209]
      ,[E211]
      ,[E212]
      ,[E213]
      ,[E214]
      ,[E215]
      ,[E216]
      ,[E217]
      ,[E218]
      ,[E219]
      ,[E221]
      ,[E222]
      ,[E223]
      ,[E224]
      ,[E225]
      ,[E226]
      ,[E227]
      ,[E228]
      ,[E229]
      ,[E231]
      ,[E232]
      ,[E233]
      ,[E234]
      ,[E235]
      ,[E236]
      ,[E237]
      ,[E238]
      ,[E239]
      ,[E241]
      ,[E242]
      ,[E243]
      ,[E244]
      ,[E245]
      ,[E246]
      ,[E247]
      ,[E248]
      ,[E249]
      ,[E251]
      ,[E252]
      ,[E253]
      ,[E254]
      ,[E255]
      ,[E256]
      ,[E257]
      ,[E258]
      ,[E259]
      ,[E261]
      ,[E262]
      ,[E263]
      ,[E264]
      ,[E265]
      ,[E266]
      ,[E267]
      ,[E268]
      ,[E269]
      ,[E271]
      ,[E272]
      ,[E273]
      ,[E274]
      ,[E275]
      ,[E276]
      ,[E277]
      ,[E278]
      ,[E279]
      ,[E281]
      ,[E282]
      ,[E283]
      ,[E284]
      ,[E285]
      ,[E286]
      ,[E287]
      ,[E288]
      ,[E289]
      ,[E291]
      ,[E292]
      ,[E293]
      ,[E294]
      ,[E295]
      ,[E296]
      ,[E297]
      ,[E298]
      ,[E299]
      ,[E301]
      ,[E302]
      ,[E303]
      ,[E304]
      ,[E305]
      ,[E306]
      ,[E307]
      ,[E308]
      ,[E309]
      ,[E311]
      ,[E312]
      ,[E313]
      ,[E314]
      ,[E315]
      ,[E316]
      ,[E317]
      ,[E318]
      ,[E319]
      ,[E321]
      ,[E322]
      ,[E323]
      ,[E324]
      ,[E325]
      ,[E326]
      ,[E327]
      ,[E328]
      ,[E329]
      ,[E331]
      ,[E332]
      ,[E333]
      ,[E334]
      ,[E335]
      ,[E336]
      ,[E337]
      ,[E338]
      ,[E339]
      ,[E341]
      ,[E342]
      ,[E343]
      ,[E344]
      ,[E345]
      ,[E346]
      ,[E347]
      ,[E348]
      ,[E349]
      ,[E351]
      ,[E352]
      ,[E353]
      ,[E354]
      ,[E355]
      ,[E356]
      ,[E357]
      ,[E358]
      ,[E359]
      ,[E361]
      ,[E362]
      ,[E363]
      ,[E364]
      ,[E365]
      ,[E366]
      ,[E367]
      ,[E368]
      ,[E369]
      ,[E371]
      ,[E372]
      ,[E373]
      ,[E374]
      ,[E375]
      ,[E376]
      ,[E377]
      ,[E378]
      ,[E379]
      ,[E381]
      ,[E382]
      ,[E383]
      ,[E384]
      ,[E385]
      ,[E386]
      ,[E387]
      ,[E388]
      ,[E389]
      ,[E391]
      ,[E392]
      ,[E393]
      ,[E394]
      ,[E395]
      ,[E396]
      ,[E397]
      ,[E398]
      ,[E399]
      ,[E401]
      ,[E402]
      ,[E403]
      ,[E404]
      ,[E405]
      ,[E406]
      ,[E407]
      ,[E408]
      ,[E409]
      ,[E411]
      ,[E412]
      ,[E413]
      ,[E414]
      ,[E415]
      ,[E416]
      ,[E417]
      ,[E418]
      ,[E419]
      ,[E421]
      ,[E422]
      ,[E423]
      ,[E424]
      ,[E425]
      ,[E426]
      ,[E427]
      ,[E428]
      ,[E429]
      ,[E431]
      ,[E432]
      ,[E433]
      ,[E434]
      ,[E435]
      ,[E436]
      ,[E437]
      ,[E438]
      ,[E439]
      ,[E441]
      ,[E442]
      ,[E443]
      ,[E444]
      ,[E445]
      ,[E446]
      ,[E447]
      ,[E448]
      ,[E449]
      ,[E451]
      ,[E452]
      ,[E453]
      ,[E454]
      ,[E455]
      ,[E456]
      ,[E457]
      ,[E458]
      ,[E459]
      ,[E461]
      ,[E462]
      ,[E463]
      ,[E464]
      ,[E465]
      ,[E466]
      ,[E467]
      ,[E468]
      ,[E469]
      ,[E471]
      ,[E472]
      ,[E473]
      ,[E474]
      ,[E475]
      ,[E476]
      ,[E477]
      ,[E478]
      ,[E479]
      ,[E481]
      ,[E482]
      ,[E483]
      ,[E484]
      ,[E485]
      ,[E486]
      ,[E487]
      ,[E488]
      ,[E489]
      ,[E491]
      ,[E492]
      ,[E493]
      ,[E494]
      ,[E495]
      ,[E496]
      ,[E497]
      ,[E498]
      ,[E499]
      ,[E501]
      ,[E502]
      ,[E503]
      ,[E504]
      ,[E505]
      ,[E506]
      ,[E507]
      ,[E508]
      ,[E509]
      ,[E511]
      ,[E512]
      ,[E513]
      ,[E514]
      ,[E515]
      ,[E516]
      ,[E517]
      ,[E518]
      ,[E519]
      ,[E521]
      ,[E522]
      ,[E523]
      ,[E524]
      ,[E525]
      ,[E526]
      ,[E527]
      ,[E528]
      ,[E529]
      ,[E531]
      ,[E532]
      ,[E533]
      ,[E534]
      ,[E535]
      ,[E536]
      ,[E537]
      ,[E538]
      ,[E539]
      ,[E541]
      ,[E542]
      ,[E543]
      ,[E544]
      ,[E545]
      ,[E546]
      ,[E547]
      ,[E548]
      ,[E549]
      ,[E551]
      ,[E552]
      ,[E553]
      ,[E554]
      ,[E555]
      ,[E556]
      ,[E557]
      ,[E558]
      ,[E559]
      ,[E561]
      ,[E562]
      ,[E563]
      ,[E564]
      ,[E565]
      ,[E566]
      ,[E567]
      ,[E568]
      ,[E569]
      ,[E571]
      ,[E572]
      ,[E573]
      ,[E574]
      ,[E575]
      ,[E576]
      ,[E577]
      ,[E578]
      ,[E579]
      ,[E581]
      ,[E582]
      ,[E583]
      ,[E584]
      ,[E585]
      ,[E586]
      ,[E587]
      ,[E588]
      ,[E589]
      ,[E591]
      ,[E592]
      ,[E593]
      ,[E594]
      ,[E595]
      ,[E596]
      ,[E597]
      ,[E598]
      ,[E599]
      ,[E601]
      ,[E602]
      ,[E603]
      ,[E604]
      ,[E605]
      ,[E606]
      ,[E607]
      ,[E608]
      ,[E609]
      ,[E611]
      ,[E612]
      ,[E613]
      ,[E614]
      ,[E615]
      ,[E616]
      ,[E617]
      ,[E618]
      ,[E619]
      ,[E621]
      ,[E622]
      ,[E623]
      ,[E624]
      ,[E625]
      ,[E626]
      ,[E627]
      ,[E628]
      ,[E629]
      ,[E631]
      ,[E632]
      ,[E633]
      ,[E634]
      ,[E635]
      ,[E636]
      ,[E637]
      ,[E638]
      ,[E639]
      ,[E641]
      ,[E642]
      ,[E643]
      ,[E644]
      ,[E645]
      ,[E646]
      ,[E647]
      ,[E648]
      ,[E649]
      ,[E651]
      ,[E652]
      ,[E653]
      ,[E654]
      ,[E655]
      ,[E656]
      ,[E657]
      ,[E658]
      ,[E659]
      ,[E661]
      ,[E662]
      ,[E663]
      ,[E664]
      ,[E665]
      ,[E666]
      ,[E667]
      ,[E668]
      ,[E669]
      ,[E671]
      ,[E672]
      ,[E673]
      ,[E674]
      ,[E675]
      ,[E676]
      ,[E677]
      ,[E678]
      ,[E679]
      ,[E681]
      ,[E682]
      ,[E683]
      ,[E684]
      ,[E685]
      ,[E686]
      ,[E687]
      ,[E688]
      ,[E689]
      ,[E691]
      ,[E692]
      ,[E693]
      ,[E694]
      ,[E695]
      ,[E696]
      ,[E697]
      ,[E698]
      ,[E699]
      ,[E701]
      ,[E702]
      ,[E703]
      ,[E704]
      ,[E705]
      ,[E706]
      ,[E707]
      ,[E708]
      ,[E709]
      ,[E711]
      ,[E712]
      ,[E713]
      ,[E714]
      ,[E715]
      ,[E716]
      ,[E717]
      ,[E718]
      ,[E719]
      ,[E721]
      ,[E722]
      ,[E723]
      ,[E724]
      ,[E725]
      ,[E726]
      ,[E727]
      ,[E728]
      ,[E729]
      ,[E731]
      ,[E732]
      ,[E733]
      ,[E734]
      ,[E735]
      ,[E736]
      ,[E737]
      ,[E738]
      ,[E739]
      ,[E741]
      ,[E742]
      ,[E743]
      ,[E744]
      ,[E745]
      ,[E746]
      ,[E747]
      ,[E748]
      ,[E749]
      ,[E751]
      ,[E752]
      ,[E753]
      ,[E754]
      ,[E755]
      ,[E756]
      ,[E757]
      ,[E758]
      ,[E759]
      ,[E1]
      ,[E2]
      ,[E3]
      ,[E4]
      ,[E5]
      ,[E6]
      ,[E7]
      ,[E8]
      ,[E9]
      ,osa15u AS [osa15]
      ,nai15u AS [nai15]
      ,osa16u AS [osa16]
      ,nai16u AS [nai16]
      ,[tietolahde] = ''2_11_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
  FROM [TK_H9098_CSC].[dbo].[TK_2_11_sopv_16]
  
UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[osa1] = null
      ,[suo1] = null
      ,[osa2] = null
      ,[suo2] = null
      ,[osa3] = null
      ,[suo3] = null
      ,[kur4]
      ,[osa4]
      ,[nai4]
      ,[tun4]
      ,[kur5]
      ,[osa5]
      ,[nai5]
      ,[tun5]
      ,[kur6]
      ,[osa6]
      ,[nai6]
      ,[tun6]
      ,[kur7]
      ,[osa7]
      ,[nai7]
      ,[kur8]
      ,[osa8]
      ,[nai8]
      ,[kur9]
      ,[osa9]
      ,[nai9]
      ,[kur10]
      ,[osa10]
      ,[nai10]
      ,[kur11]
      ,[osa11]
      ,[nai11]
      ,[kur12]
      ,[osa12]
      ,[nai12]
      ,[kur13]
      ,[osa13]
      ,[nai13]
      ,[kur14]
      ,[osa14]
      ,[nai14]
      ,[kurd]
      ,[osad]
      ,[naid]
      ,[E11]
      ,[E12]
      ,[E13]
      ,[E14]
      ,[E15]
      ,[E16]
      ,[E17]
      ,[E18]
      ,[E19]
      ,[E21]
      ,[E22]
      ,[E23]
      ,[E24]
      ,[E25]
      ,[E26]
      ,[E27]
      ,[E28]
      ,[E29]
      ,[E31]
      ,[E32]
      ,[E33]
      ,[E34]
      ,[E35]
      ,[E36]
      ,[E37]
      ,[E38]
      ,[E39]
      ,[E41]
      ,[E42]
      ,[E43]
      ,[E44]
      ,[E45]
      ,[E46]
      ,[E47]
      ,[E48]
      ,[E49]
      ,[E51]
      ,[E52]
      ,[E53]
      ,[E54]
      ,[E55]
      ,[E56]
      ,[E57]
      ,[E58]
      ,[E59]
      ,[E61]
      ,[E62]
      ,[E63]
      ,[E64]
      ,[E65]
      ,[E66]
      ,[E67]
      ,[E68]
      ,[E69]
      ,[E71]
      ,[E72]
      ,[E73]
      ,[E74]
      ,[E75]
      ,[E76]
      ,[E77]
      ,[E78]
      ,[E79]
      ,[E81]
      ,[E82]
      ,[E83]
      ,[E84]
      ,[E85]
      ,[E86]
      ,[E87]
      ,[E88]
      ,[E89]
      ,[E91]
      ,[E92]
      ,[E93]
      ,[E94]
      ,[E95]
      ,[E96]
      ,[E97]
      ,[E98]
      ,[E99]
      ,[E101]
      ,[E102]
      ,[E103]
      ,[E104]
      ,[E105]
      ,[E106]
      ,[E107]
      ,[E108]
      ,[E109]
      ,[E111]
      ,[E112]
      ,[E113]
      ,[E114]
      ,[E115]
      ,[E116]
      ,[E117]
      ,[E118]
      ,[E119]
      ,[E121]
      ,[E122]
      ,[E123]
      ,[E124]
      ,[E125]
      ,[E126]
      ,[E127]
      ,[E128]
      ,[E129]
      ,[E131]
      ,[E132]
      ,[E133]
      ,[E134]
      ,[E135]
      ,[E136]
      ,[E137]
      ,[E138]
      ,[E139]
      ,[E141]
      ,[E142]
      ,[E143]
      ,[E144]
      ,[E145]
      ,[E146]
      ,[E147]
      ,[E148]
      ,[E149]
      ,[E151]
      ,[E152]
      ,[E153]
      ,[E154]
      ,[E155]
      ,[E156]
      ,[E157]
      ,[E158]
      ,[E159]
      ,[E161]
      ,[E162]
      ,[E163]
      ,[E164]
      ,[E165]
      ,[E166]
      ,[E167]
      ,[E168]
      ,[E169]
      ,[E171]
      ,[E172]
      ,[E173]
      ,[E174]
      ,[E175]
      ,[E176]
      ,[E177]
      ,[E178]
      ,[E179]
      ,[E181]
      ,[E182]
      ,[E183]
      ,[E184]
      ,[E185]
      ,[E186]
      ,[E187]
      ,[E188]
      ,[E189]
      ,[E191]
      ,[E192]
      ,[E193]
      ,[E194]
      ,[E195]
      ,[E196]
      ,[E197]
      ,[E198]
      ,[E199]
      ,[E201]
      ,[E202]
      ,[E203]
      ,[E204]
      ,[E205]
      ,[E206]
      ,[E207]
      ,[E208]
      ,[E209]
      ,[E211]
      ,[E212]
      ,[E213]
      ,[E214]
      ,[E215]
      ,[E216]
      ,[E217]
      ,[E218]
      ,[E219]
      ,[E221]
      ,[E222]
      ,[E223]
      ,[E224]
      ,[E225]
      ,[E226]
      ,[E227]
      ,[E228]
      ,[E229]
      ,[E231]
      ,[E232]
      ,[E233]
      ,[E234]
      ,[E235]
      ,[E236]
      ,[E237]
      ,[E238]
      ,[E239]
      ,[E241]
      ,[E242]
      ,[E243]
      ,[E244]
      ,[E245]
      ,[E246]
      ,[E247]
      ,[E248]
      ,[E249]
      ,[E251]
      ,[E252]
      ,[E253]
      ,[E254]
      ,[E255]
      ,[E256]
      ,[E257]
      ,[E258]
      ,[E259]
      ,[E261]
      ,[E262]
      ,[E263]
      ,[E264]
      ,[E265]
      ,[E266]
      ,[E267]
      ,[E268]
      ,[E269]
      ,[E271]
      ,[E272]
      ,[E273]
      ,[E274]
      ,[E275]
      ,[E276]
      ,[E277]
      ,[E278]
      ,[E279]
      ,[E281]
      ,[E282]
      ,[E283]
      ,[E284]
      ,[E285]
      ,[E286]
      ,[E287]
      ,[E288]
      ,[E289]
      ,[E291]
      ,[E292]
      ,[E293]
      ,[E294]
      ,[E295]
      ,[E296]
      ,[E297]
      ,[E298]
      ,[E299]
      ,[E301]
      ,[E302]
      ,[E303]
      ,[E304]
      ,[E305]
      ,[E306]
      ,[E307]
      ,[E308]
      ,[E309]
      ,[E311]
      ,[E312]
      ,[E313]
      ,[E314]
      ,[E315]
      ,[E316]
      ,[E317]
      ,[E318]
      ,[E319]
      ,[E321]
      ,[E322]
      ,[E323]
      ,[E324]
      ,[E325]
      ,[E326]
      ,[E327]
      ,[E328]
      ,[E329]
      ,[E331]
      ,[E332]
      ,[E333]
      ,[E334]
      ,[E335]
      ,[E336]
      ,[E337]
      ,[E338]
      ,[E339]
      ,[E341]
      ,[E342]
      ,[E343]
      ,[E344]
      ,[E345]
      ,[E346]
      ,[E347]
      ,[E348]
      ,[E349]
      ,[E351]
      ,[E352]
      ,[E353]
      ,[E354]
      ,[E355]
      ,[E356]
      ,[E357]
      ,[E358]
      ,[E359]
      ,[E361]
      ,[E362]
      ,[E363]
      ,[E364]
      ,[E365]
      ,[E366]
      ,[E367]
      ,[E368]
      ,[E369]
      ,[E371]
      ,[E372]
      ,[E373]
      ,[E374]
      ,[E375]
      ,[E376]
      ,[E377]
      ,[E378]
      ,[E379]
      ,[E381]
      ,[E382]
      ,[E383]
      ,[E384]
      ,[E385]
      ,[E386]
      ,[E387]
      ,[E388]
      ,[E389]
      ,[E391]
      ,[E392]
      ,[E393]
      ,[E394]
      ,[E395]
      ,[E396]
      ,[E397]
      ,[E398]
      ,[E399]
      ,[E401]
      ,[E402]
      ,[E403]
      ,[E404]
      ,[E405]
      ,[E406]
      ,[E407]
      ,[E408]
      ,[E409]
      ,[E411]
      ,[E412]
      ,[E413]
      ,[E414]
      ,[E415]
      ,[E416]
      ,[E417]
      ,[E418]
      ,[E419]
      ,[E421]
      ,[E422]
      ,[E423]
      ,[E424]
      ,[E425]
      ,[E426]
      ,[E427]
      ,[E428]
      ,[E429]
      ,[E431]
      ,[E432]
      ,[E433]
      ,[E434]
      ,[E435]
      ,[E436]
      ,[E437]
      ,[E438]
      ,[E439]
      ,[E441]
      ,[E442]
      ,[E443]
      ,[E444]
      ,[E445]
      ,[E446]
      ,[E447]
      ,[E448]
      ,[E449]
      ,[E451]
      ,[E452]
      ,[E453]
      ,[E454]
      ,[E455]
      ,[E456]
      ,[E457]
      ,[E458]
      ,[E459]
      ,[E461]
      ,[E462]
      ,[E463]
      ,[E464]
      ,[E465]
      ,[E466]
      ,[E467]
      ,[E468]
      ,[E469]
      ,[E471]
      ,[E472]
      ,[E473]
      ,[E474]
      ,[E475]
      ,[E476]
      ,[E477]
      ,[E478]
      ,[E479]
      ,[E481]
      ,[E482]
      ,[E483]
      ,[E484]
      ,[E485]
      ,[E486]
      ,[E487]
      ,[E488]
      ,[E489]
      ,[E491]
      ,[E492]
      ,[E493]
      ,[E494]
      ,[E495]
      ,[E496]
      ,[E497]
      ,[E498]
      ,[E499]
      ,[E501]
      ,[E502]
      ,[E503]
      ,[E504]
      ,[E505]
      ,[E506]
      ,[E507]
      ,[E508]
      ,[E509]
      ,[E511]
      ,[E512]
      ,[E513]
      ,[E514]
      ,[E515]
      ,[E516]
      ,[E517]
      ,[E518]
      ,[E519]
      ,[E521]
      ,[E522]
      ,[E523]
      ,[E524]
      ,[E525]
      ,[E526]
      ,[E527]
      ,[E528]
      ,[E529]
      ,[E531]
      ,[E532]
      ,[E533]
      ,[E534]
      ,[E535]
      ,[E536]
      ,[E537]
      ,[E538]
      ,[E539]
      ,[E541]
      ,[E542]
      ,[E543]
      ,[E544]
      ,[E545]
      ,[E546]
      ,[E547]
      ,[E548]
      ,[E549]
      ,[E551]
      ,[E552]
      ,[E553]
      ,[E554]
      ,[E555]
      ,[E556]
      ,[E557]
      ,[E558]
      ,[E559]
      ,[E561]
      ,[E562]
      ,[E563]
      ,[E564]
      ,[E565]
      ,[E566]
      ,[E567]
      ,[E568]
      ,[E569]
      ,[E571]
      ,[E572]
      ,[E573]
      ,[E574]
      ,[E575]
      ,[E576]
      ,[E577]
      ,[E578]
      ,[E579]
      ,[E581]
      ,[E582]
      ,[E583]
      ,[E584]
      ,[E585]
      ,[E586]
      ,[E587]
      ,[E588]
      ,[E589]
      ,[E591]
      ,[E592]
      ,[E593]
      ,[E594]
      ,[E595]
      ,[E596]
      ,[E597]
      ,[E598]
      ,[E599]
      ,[E601]
      ,[E602]
      ,[E603]
      ,[E604]
      ,[E605]
      ,[E606]
      ,[E607]
      ,[E608]
      ,[E609]
      ,[E611]
      ,[E612]
      ,[E613]
      ,[E614]
      ,[E615]
      ,[E616]
      ,[E617]
      ,[E618]
      ,[E619]
      ,[E621]
      ,[E622]
      ,[E623]
      ,[E624]
      ,[E625]
      ,[E626]
      ,[E627]
      ,[E628]
      ,[E629]
      ,[E631]
      ,[E632]
      ,[E633]
      ,[E634]
      ,[E635]
      ,[E636]
      ,[E637]
      ,[E638]
      ,[E639]
      ,[E641]
      ,[E642]
      ,[E643]
      ,[E644]
      ,[E645]
      ,[E646]
      ,[E647]
      ,[E648]
      ,[E649]
      ,[E651]
      ,[E652]
      ,[E653]
      ,[E654]
      ,[E655]
      ,[E656]
      ,[E657]
      ,[E658]
      ,[E659]
      ,[E661]
      ,[E662]
      ,[E663]
      ,[E664]
      ,[E665]
      ,[E666]
      ,[E667]
      ,[E668]
      ,[E669]
      ,[E671]
      ,[E672]
      ,[E673]
      ,[E674]
      ,[E675]
      ,[E676]
      ,[E677]
      ,[E678]
      ,[E679]
      ,[E681]
      ,[E682]
      ,[E683]
      ,[E684]
      ,[E685]
      ,[E686]
      ,[E687]
      ,[E688]
      ,[E689]
      ,[E691]
      ,[E692]
      ,[E693]
      ,[E694]
      ,[E695]
      ,[E696]
      ,[E697]
      ,[E698]
      ,[E699]
      ,[E701]
      ,[E702]
      ,[E703]
      ,[E704]
      ,[E705]
      ,[E706]
      ,[E707]
      ,[E708]
      ,[E709]
      ,[E711]
      ,[E712]
      ,[E713]
      ,[E714]
      ,[E715]
      ,[E716]
      ,[E717]
      ,[E718]
      ,[E719]
      ,[E721]
      ,[E722]
      ,[E723]
      ,[E724]
      ,[E725]
      ,[E726]
      ,[E727]
      ,[E728]
      ,[E729]
      ,[E731]
      ,[E732]
      ,[E733]
      ,[E734]
      ,[E735]
      ,[E736]
      ,[E737]
      ,[E738]
      ,[E739]
      ,[E741]
      ,[E742]
      ,[E743]
      ,[E744]
      ,[E745]
      ,[E746]
      ,[E747]
      ,[E748]
      ,[E749]
      ,[E751]
      ,[E752]
      ,[E753]
      ,[E754]
      ,[E755]
      ,[E756]
      ,[E757]
      ,[E758]
      ,[E759]
      ,[E1]
      ,[E2]
      ,[E3]
      ,[E4]
      ,[E5]
      ,[E6]
      ,[E7]
      ,[E8]
      ,[E9]
      ,osa15u AS [osa15]
      ,nai15u AS [nai15]
      ,osa16u AS [osa16]
      ,nai16u AS [nai16]
      ,[tietolahde] = ''2_11_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
  FROM [TK_H9098_CSC].[dbo].[TK_2_11_sopv_17]
    
UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[osa1] = null
      ,[suo1] = null
      ,[osa2] = null
      ,[suo2] = null
      ,[osa3] = null
      ,[suo3] = null
      ,[kur4]
      ,[osa4]
      ,[nai4]
      ,[tun4]
      ,[kur5]
      ,[osa5]
      ,[nai5]
      ,[tun5]
      ,[kur6]
      ,[osa6]
      ,[nai6]
      ,[tun6]
      ,[kur7]
      ,[osa7]
      ,[nai7]
      ,[kur8]
      ,[osa8]
      ,[nai8]
      ,[kur9]
      ,[osa9]
      ,[nai9]
      ,[kur10]
      ,[osa10]
      ,[nai10]
      ,[kur11]
      ,[osa11]
      ,[nai11]
      ,[kur12]
      ,[osa12]
      ,[nai12]
      ,[kur13]
      ,[osa13]
      ,[nai13]
      ,[kur14]
      ,[osa14]
      ,[nai14]
      ,[kurd]
      ,[osad]
      ,[naid]
      ,[E11]
      ,[E12]
      ,[E13]
      ,[E14]
      ,[E15]
      ,[E16]
      ,[E17]
      ,[E18]
      ,[E19]
      ,[E21]
      ,[E22]
      ,[E23]
      ,[E24]
      ,[E25]
      ,[E26]
      ,[E27]
      ,[E28]
      ,[E29]
      ,[E31]
      ,[E32]
      ,[E33]
      ,[E34]
      ,[E35]
      ,[E36]
      ,[E37]
      ,[E38]
      ,[E39]
      ,[E41]
      ,[E42]
      ,[E43]
      ,[E44]
      ,[E45]
      ,[E46]
      ,[E47]
      ,[E48]
      ,[E49]
      ,[E51]
      ,[E52]
      ,[E53]
      ,[E54]
      ,[E55]
      ,[E56]
      ,[E57]
      ,[E58]
      ,[E59]
      ,[E61]
      ,[E62]
      ,[E63]
      ,[E64]
      ,[E65]
      ,[E66]
      ,[E67]
      ,[E68]
      ,[E69]
      ,[E71]
      ,[E72]
      ,[E73]
      ,[E74]
      ,[E75]
      ,[E76]
      ,[E77]
      ,[E78]
      ,[E79]
      ,[E81]
      ,[E82]
      ,[E83]
      ,[E84]
      ,[E85]
      ,[E86]
      ,[E87]
      ,[E88]
      ,[E89]
      ,[E91]
      ,[E92]
      ,[E93]
      ,[E94]
      ,[E95]
      ,[E96]
      ,[E97]
      ,[E98]
      ,[E99]
      ,[E101]
      ,[E102]
      ,[E103]
      ,[E104]
      ,[E105]
      ,[E106]
      ,[E107]
      ,[E108]
      ,[E109]
      ,[E111]
      ,[E112]
      ,[E113]
      ,[E114]
      ,[E115]
      ,[E116]
      ,[E117]
      ,[E118]
      ,[E119]
      ,[E121]
      ,[E122]
      ,[E123]
      ,[E124]
      ,[E125]
      ,[E126]
      ,[E127]
      ,[E128]
      ,[E129]
      ,[E131]
      ,[E132]
      ,[E133]
      ,[E134]
      ,[E135]
      ,[E136]
      ,[E137]
      ,[E138]
      ,[E139]
      ,[E141]
      ,[E142]
      ,[E143]
      ,[E144]
      ,[E145]
      ,[E146]
      ,[E147]
      ,[E148]
      ,[E149]
      ,[E151]
      ,[E152]
      ,[E153]
      ,[E154]
      ,[E155]
      ,[E156]
      ,[E157]
      ,[E158]
      ,[E159]
      ,[E161]
      ,[E162]
      ,[E163]
      ,[E164]
      ,[E165]
      ,[E166]
      ,[E167]
      ,[E168]
      ,[E169]
      ,[E171]
      ,[E172]
      ,[E173]
      ,[E174]
      ,[E175]
      ,[E176]
      ,[E177]
      ,[E178]
      ,[E179]
      ,[E181]
      ,[E182]
      ,[E183]
      ,[E184]
      ,[E185]
      ,[E186]
      ,[E187]
      ,[E188]
      ,[E189]
      ,[E191]
      ,[E192]
      ,[E193]
      ,[E194]
      ,[E195]
      ,[E196]
      ,[E197]
      ,[E198]
      ,[E199]
      ,[E201]
      ,[E202]
      ,[E203]
      ,[E204]
      ,[E205]
      ,[E206]
      ,[E207]
      ,[E208]
      ,[E209]
      ,[E211]
      ,[E212]
      ,[E213]
      ,[E214]
      ,[E215]
      ,[E216]
      ,[E217]
      ,[E218]
      ,[E219]
      ,[E221]
      ,[E222]
      ,[E223]
      ,[E224]
      ,[E225]
      ,[E226]
      ,[E227]
      ,[E228]
      ,[E229]
      ,[E231]
      ,[E232]
      ,[E233]
      ,[E234]
      ,[E235]
      ,[E236]
      ,[E237]
      ,[E238]
      ,[E239]
      ,[E241]
      ,[E242]
      ,[E243]
      ,[E244]
      ,[E245]
      ,[E246]
      ,[E247]
      ,[E248]
      ,[E249]
      ,[E251]
      ,[E252]
      ,[E253]
      ,[E254]
      ,[E255]
      ,[E256]
      ,[E257]
      ,[E258]
      ,[E259]
      ,[E261]
      ,[E262]
      ,[E263]
      ,[E264]
      ,[E265]
      ,[E266]
      ,[E267]
      ,[E268]
      ,[E269]
      ,[E271]
      ,[E272]
      ,[E273]
      ,[E274]
      ,[E275]
      ,[E276]
      ,[E277]
      ,[E278]
      ,[E279]
      ,[E281]
      ,[E282]
      ,[E283]
      ,[E284]
      ,[E285]
      ,[E286]
      ,[E287]
      ,[E288]
      ,[E289]
      ,[E291]
      ,[E292]
      ,[E293]
      ,[E294]
      ,[E295]
      ,[E296]
      ,[E297]
      ,[E298]
      ,[E299]
      ,[E301]
      ,[E302]
      ,[E303]
      ,[E304]
      ,[E305]
      ,[E306]
      ,[E307]
      ,[E308]
      ,[E309]
      ,[E311]
      ,[E312]
      ,[E313]
      ,[E314]
      ,[E315]
      ,[E316]
      ,[E317]
      ,[E318]
      ,[E319]
      ,[E321]
      ,[E322]
      ,[E323]
      ,[E324]
      ,[E325]
      ,[E326]
      ,[E327]
      ,[E328]
      ,[E329]
      ,[E331]
      ,[E332]
      ,[E333]
      ,[E334]
      ,[E335]
      ,[E336]
      ,[E337]
      ,[E338]
      ,[E339]
      ,[E341]
      ,[E342]
      ,[E343]
      ,[E344]
      ,[E345]
      ,[E346]
      ,[E347]
      ,[E348]
      ,[E349]
      ,[E351]
      ,[E352]
      ,[E353]
      ,[E354]
      ,[E355]
      ,[E356]
      ,[E357]
      ,[E358]
      ,[E359]
      ,[E361]
      ,[E362]
      ,[E363]
      ,[E364]
      ,[E365]
      ,[E366]
      ,[E367]
      ,[E368]
      ,[E369]
      ,[E371]
      ,[E372]
      ,[E373]
      ,[E374]
      ,[E375]
      ,[E376]
      ,[E377]
      ,[E378]
      ,[E379]
      ,[E381]
      ,[E382]
      ,[E383]
      ,[E384]
      ,[E385]
      ,[E386]
      ,[E387]
      ,[E388]
      ,[E389]
      ,[E391]
      ,[E392]
      ,[E393]
      ,[E394]
      ,[E395]
      ,[E396]
      ,[E397]
      ,[E398]
      ,[E399]
      ,[E401]
      ,[E402]
      ,[E403]
      ,[E404]
      ,[E405]
      ,[E406]
      ,[E407]
      ,[E408]
      ,[E409]
      ,[E411]
      ,[E412]
      ,[E413]
      ,[E414]
      ,[E415]
      ,[E416]
      ,[E417]
      ,[E418]
      ,[E419]
      ,[E421]
      ,[E422]
      ,[E423]
      ,[E424]
      ,[E425]
      ,[E426]
      ,[E427]
      ,[E428]
      ,[E429]
      ,[E431]
      ,[E432]
      ,[E433]
      ,[E434]
      ,[E435]
      ,[E436]
      ,[E437]
      ,[E438]
      ,[E439]
      ,[E441]
      ,[E442]
      ,[E443]
      ,[E444]
      ,[E445]
      ,[E446]
      ,[E447]
      ,[E448]
      ,[E449]
      ,[E451]
      ,[E452]
      ,[E453]
      ,[E454]
      ,[E455]
      ,[E456]
      ,[E457]
      ,[E458]
      ,[E459]
      ,[E461]
      ,[E462]
      ,[E463]
      ,[E464]
      ,[E465]
      ,[E466]
      ,[E467]
      ,[E468]
      ,[E469]
      ,[E471]
      ,[E472]
      ,[E473]
      ,[E474]
      ,[E475]
      ,[E476]
      ,[E477]
      ,[E478]
      ,[E479]
      ,[E481]
      ,[E482]
      ,[E483]
      ,[E484]
      ,[E485]
      ,[E486]
      ,[E487]
      ,[E488]
      ,[E489]
      ,[E491]
      ,[E492]
      ,[E493]
      ,[E494]
      ,[E495]
      ,[E496]
      ,[E497]
      ,[E498]
      ,[E499]
      ,[E501]
      ,[E502]
      ,[E503]
      ,[E504]
      ,[E505]
      ,[E506]
      ,[E507]
      ,[E508]
      ,[E509]
      ,[E511]
      ,[E512]
      ,[E513]
      ,[E514]
      ,[E515]
      ,[E516]
      ,[E517]
      ,[E518]
      ,[E519]
      ,[E521]
      ,[E522]
      ,[E523]
      ,[E524]
      ,[E525]
      ,[E526]
      ,[E527]
      ,[E528]
      ,[E529]
      ,[E531]
      ,[E532]
      ,[E533]
      ,[E534]
      ,[E535]
      ,[E536]
      ,[E537]
      ,[E538]
      ,[E539]
      ,[E541]
      ,[E542]
      ,[E543]
      ,[E544]
      ,[E545]
      ,[E546]
      ,[E547]
      ,[E548]
      ,[E549]
      ,[E551]
      ,[E552]
      ,[E553]
      ,[E554]
      ,[E555]
      ,[E556]
      ,[E557]
      ,[E558]
      ,[E559]
      ,[E561]
      ,[E562]
      ,[E563]
      ,[E564]
      ,[E565]
      ,[E566]
      ,[E567]
      ,[E568]
      ,[E569]
      ,[E571]
      ,[E572]
      ,[E573]
      ,[E574]
      ,[E575]
      ,[E576]
      ,[E577]
      ,[E578]
      ,[E579]
      ,[E581]
      ,[E582]
      ,[E583]
      ,[E584]
      ,[E585]
      ,[E586]
      ,[E587]
      ,[E588]
      ,[E589]
      ,[E591]
      ,[E592]
      ,[E593]
      ,[E594]
      ,[E595]
      ,[E596]
      ,[E597]
      ,[E598]
      ,[E599]
      ,[E601]
      ,[E602]
      ,[E603]
      ,[E604]
      ,[E605]
      ,[E606]
      ,[E607]
      ,[E608]
      ,[E609]
      ,[E611]
      ,[E612]
      ,[E613]
      ,[E614]
      ,[E615]
      ,[E616]
      ,[E617]
      ,[E618]
      ,[E619]
      ,[E621]
      ,[E622]
      ,[E623]
      ,[E624]
      ,[E625]
      ,[E626]
      ,[E627]
      ,[E628]
      ,[E629]
      ,[E631]
      ,[E632]
      ,[E633]
      ,[E634]
      ,[E635]
      ,[E636]
      ,[E637]
      ,[E638]
      ,[E639]
      ,[E641]
      ,[E642]
      ,[E643]
      ,[E644]
      ,[E645]
      ,[E646]
      ,[E647]
      ,[E648]
      ,[E649]
      ,[E651]
      ,[E652]
      ,[E653]
      ,[E654]
      ,[E655]
      ,[E656]
      ,[E657]
      ,[E658]
      ,[E659]
      ,[E661]
      ,[E662]
      ,[E663]
      ,[E664]
      ,[E665]
      ,[E666]
      ,[E667]
      ,[E668]
      ,[E669]
      ,[E671]
      ,[E672]
      ,[E673]
      ,[E674]
      ,[E675]
      ,[E676]
      ,[E677]
      ,[E678]
      ,[E679]
      ,[E681]
      ,[E682]
      ,[E683]
      ,[E684]
      ,[E685]
      ,[E686]
      ,[E687]
      ,[E688]
      ,[E689]
      ,[E691]
      ,[E692]
      ,[E693]
      ,[E694]
      ,[E695]
      ,[E696]
      ,[E697]
      ,[E698]
      ,[E699]
      ,[E701]
      ,[E702]
      ,[E703]
      ,[E704]
      ,[E705]
      ,[E706]
      ,[E707]
      ,[E708]
      ,[E709]
      ,[E711]
      ,[E712]
      ,[E713]
      ,[E714]
      ,[E715]
      ,[E716]
      ,[E717]
      ,[E718]
      ,[E719]
      ,[E721]
      ,[E722]
      ,[E723]
      ,[E724]
      ,[E725]
      ,[E726]
      ,[E727]
      ,[E728]
      ,[E729]
      ,[E731]
      ,[E732]
      ,[E733]
      ,[E734]
      ,[E735]
      ,[E736]
      ,[E737]
      ,[E738]
      ,[E739]
      ,[E741]
      ,[E742]
      ,[E743]
      ,[E744]
      ,[E745]
      ,[E746]
      ,[E747]
      ,[E748]
      ,[E749]
      ,[E751]
      ,[E752]
      ,[E753]
      ,[E754]
      ,[E755]
      ,[E756]
      ,[E757]
      ,[E758]
      ,[E759]
      ,[E1]
      ,[E2]
      ,[E3]
      ,[E4]
      ,[E5]
      ,[E6]
      ,[E7]
      ,[E8]
      ,[E9]
      ,osa15u AS [osa15]
      ,nai15u AS [nai15]
      ,osa16u AS [osa16]
      ,nai16u AS [nai16]
      ,[tietolahde] = ''2_11_sopv_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
  FROM [TK_H9098_CSC].[dbo].[TK_2_11_sopv_18]
    
UNION ALL

SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[osa1] = null
      ,[suo1] = null
      ,[osa2] = null
      ,[suo2] = null
      ,[osa3] = null
      ,[suo3] = null
      ,[kur4]
      ,[osa4]
      ,[nai4]
      ,[tun4]
      ,[kur5]
      ,[osa5]
      ,[nai5]
      ,[tun5]
      ,[kur6]
      ,[osa6]
      ,[nai6]
      ,[tun6]
      ,[kur7]
      ,[osa7]
      ,[nai7]
      ,[kur8]
      ,[osa8]
      ,[nai8]
      ,[kur9]
      ,[osa9]
      ,[nai9]
      ,[kur10]
      ,[osa10]
      ,[nai10]
      ,[kur11]
      ,[osa11]
      ,[nai11]
      ,[kur12]
      ,[osa12]
      ,[nai12]
      ,[kur13]
      ,[osa13]
      ,[nai13]
      ,[kur14]
      ,[osa14]
      ,[nai14]
      ,[kurd]
      ,[osad]
      ,[naid]
      ,[E11]
      ,[E12]
      ,[E13]
      ,[E14]
      ,[E15]
      ,[E16]
      ,[E17]
      ,[E18]
      ,[E19]
      ,[E21]
      ,[E22]
      ,[E23]
      ,[E24]
      ,[E25]
      ,[E26]
      ,[E27]
      ,[E28]
      ,[E29]
      ,[E31]
      ,[E32]
      ,[E33]
      ,[E34]
      ,[E35]
      ,[E36]
      ,[E37]
      ,[E38]
      ,[E39]
      ,[E41]
      ,[E42]
      ,[E43]
      ,[E44]
      ,[E45]
      ,[E46]
      ,[E47]
      ,[E48]
      ,[E49]
      ,[E51]
      ,[E52]
      ,[E53]
      ,[E54]
      ,[E55]
      ,[E56]
      ,[E57]
      ,[E58]
      ,[E59]
      ,[E61]
      ,[E62]
      ,[E63]
      ,[E64]
      ,[E65]
      ,[E66]
      ,[E67]
      ,[E68]
      ,[E69]
      ,[E71]
      ,[E72]
      ,[E73]
      ,[E74]
      ,[E75]
      ,[E76]
      ,[E77]
      ,[E78]
      ,[E79]
      ,[E81]
      ,[E82]
      ,[E83]
      ,[E84]
      ,[E85]
      ,[E86]
      ,[E87]
      ,[E88]
      ,[E89]
      ,[E91]
      ,[E92]
      ,[E93]
      ,[E94]
      ,[E95]
      ,[E96]
      ,[E97]
      ,[E98]
      ,[E99]
      ,[E101]
      ,[E102]
      ,[E103]
      ,[E104]
      ,[E105]
      ,[E106]
      ,[E107]
      ,[E108]
      ,[E109]
      ,[E111]
      ,[E112]
      ,[E113]
      ,[E114]
      ,[E115]
      ,[E116]
      ,[E117]
      ,[E118]
      ,[E119]
      ,[E121]
      ,[E122]
      ,[E123]
      ,[E124]
      ,[E125]
      ,[E126]
      ,[E127]
      ,[E128]
      ,[E129]
      ,[E131]
      ,[E132]
      ,[E133]
      ,[E134]
      ,[E135]
      ,[E136]
      ,[E137]
      ,[E138]
      ,[E139]
      ,[E141]
      ,[E142]
      ,[E143]
      ,[E144]
      ,[E145]
      ,[E146]
      ,[E147]
      ,[E148]
      ,[E149]
      ,[E151]
      ,[E152]
      ,[E153]
      ,[E154]
      ,[E155]
      ,[E156]
      ,[E157]
      ,[E158]
      ,[E159]
      ,[E161]
      ,[E162]
      ,[E163]
      ,[E164]
      ,[E165]
      ,[E166]
      ,[E167]
      ,[E168]
      ,[E169]
      ,[E171]
      ,[E172]
      ,[E173]
      ,[E174]
      ,[E175]
      ,[E176]
      ,[E177]
      ,[E178]
      ,[E179]
      ,[E181]
      ,[E182]
      ,[E183]
      ,[E184]
      ,[E185]
      ,[E186]
      ,[E187]
      ,[E188]
      ,[E189]
      ,[E191]
      ,[E192]
      ,[E193]
      ,[E194]
      ,[E195]
      ,[E196]
      ,[E197]
      ,[E198]
      ,[E199]
      ,[E201]
      ,[E202]
      ,[E203]
      ,[E204]
      ,[E205]
      ,[E206]
      ,[E207]
      ,[E208]
      ,[E209]
      ,[E211]
      ,[E212]
      ,[E213]
      ,[E214]
      ,[E215]
      ,[E216]
      ,[E217]
      ,[E218]
      ,[E219]
      ,[E221]
      ,[E222]
      ,[E223]
      ,[E224]
      ,[E225]
      ,[E226]
      ,[E227]
      ,[E228]
      ,[E229]
      ,[E231]
      ,[E232]
      ,[E233]
      ,[E234]
      ,[E235]
      ,[E236]
      ,[E237]
      ,[E238]
      ,[E239]
      ,[E241]
      ,[E242]
      ,[E243]
      ,[E244]
      ,[E245]
      ,[E246]
      ,[E247]
      ,[E248]
      ,[E249]
      ,[E251]
      ,[E252]
      ,[E253]
      ,[E254]
      ,[E255]
      ,[E256]
      ,[E257]
      ,[E258]
      ,[E259]
      ,[E261]
      ,[E262]
      ,[E263]
      ,[E264]
      ,[E265]
      ,[E266]
      ,[E267]
      ,[E268]
      ,[E269]
      ,[E271]
      ,[E272]
      ,[E273]
      ,[E274]
      ,[E275]
      ,[E276]
      ,[E277]
      ,[E278]
      ,[E279]
      ,[E281]
      ,[E282]
      ,[E283]
      ,[E284]
      ,[E285]
      ,[E286]
      ,[E287]
      ,[E288]
      ,[E289]
      ,[E291]
      ,[E292]
      ,[E293]
      ,[E294]
      ,[E295]
      ,[E296]
      ,[E297]
      ,[E298]
      ,[E299]
      ,[E301]
      ,[E302]
      ,[E303]
      ,[E304]
      ,[E305]
      ,[E306]
      ,[E307]
      ,[E308]
      ,[E309]
      ,[E311]
      ,[E312]
      ,[E313]
      ,[E314]
      ,[E315]
      ,[E316]
      ,[E317]
      ,[E318]
      ,[E319]
      ,[E321]
      ,[E322]
      ,[E323]
      ,[E324]
      ,[E325]
      ,[E326]
      ,[E327]
      ,[E328]
      ,[E329]
      ,[E331]
      ,[E332]
      ,[E333]
      ,[E334]
      ,[E335]
      ,[E336]
      ,[E337]
      ,[E338]
      ,[E339]
      ,[E341]
      ,[E342]
      ,[E343]
      ,[E344]
      ,[E345]
      ,[E346]
      ,[E347]
      ,[E348]
      ,[E349]
      ,[E351]
      ,[E352]
      ,[E353]
      ,[E354]
      ,[E355]
      ,[E356]
      ,[E357]
      ,[E358]
      ,[E359]
      ,[E361]
      ,[E362]
      ,[E363]
      ,[E364]
      ,[E365]
      ,[E366]
      ,[E367]
      ,[E368]
      ,[E369]
      ,[E371]
      ,[E372]
      ,[E373]
      ,[E374]
      ,[E375]
      ,[E376]
      ,[E377]
      ,[E378]
      ,[E379]
      ,[E381]
      ,[E382]
      ,[E383]
      ,[E384]
      ,[E385]
      ,[E386]
      ,[E387]
      ,[E388]
      ,[E389]
      ,[E391]
      ,[E392]
      ,[E393]
      ,[E394]
      ,[E395]
      ,[E396]
      ,[E397]
      ,[E398]
      ,[E399]
      ,[E401]
      ,[E402]
      ,[E403]
      ,[E404]
      ,[E405]
      ,[E406]
      ,[E407]
      ,[E408]
      ,[E409]
      ,[E411]
      ,[E412]
      ,[E413]
      ,[E414]
      ,[E415]
      ,[E416]
      ,[E417]
      ,[E418]
      ,[E419]
      ,[E421]
      ,[E422]
      ,[E423]
      ,[E424]
      ,[E425]
      ,[E426]
      ,[E427]
      ,[E428]
      ,[E429]
      ,[E431]
      ,[E432]
      ,[E433]
      ,[E434]
      ,[E435]
      ,[E436]
      ,[E437]
      ,[E438]
      ,[E439]
      ,[E441]
      ,[E442]
      ,[E443]
      ,[E444]
      ,[E445]
      ,[E446]
      ,[E447]
      ,[E448]
      ,[E449]
      ,[E451]
      ,[E452]
      ,[E453]
      ,[E454]
      ,[E455]
      ,[E456]
      ,[E457]
      ,[E458]
      ,[E459]
      ,[E461]
      ,[E462]
      ,[E463]
      ,[E464]
      ,[E465]
      ,[E466]
      ,[E467]
      ,[E468]
      ,[E469]
      ,[E471]
      ,[E472]
      ,[E473]
      ,[E474]
      ,[E475]
      ,[E476]
      ,[E477]
      ,[E478]
      ,[E479]
      ,[E481]
      ,[E482]
      ,[E483]
      ,[E484]
      ,[E485]
      ,[E486]
      ,[E487]
      ,[E488]
      ,[E489]
      ,[E491]
      ,[E492]
      ,[E493]
      ,[E494]
      ,[E495]
      ,[E496]
      ,[E497]
      ,[E498]
      ,[E499]
      ,[E501]
      ,[E502]
      ,[E503]
      ,[E504]
      ,[E505]
      ,[E506]
      ,[E507]
      ,[E508]
      ,[E509]
      ,[E511]
      ,[E512]
      ,[E513]
      ,[E514]
      ,[E515]
      ,[E516]
      ,[E517]
      ,[E518]
      ,[E519]
      ,[E521]
      ,[E522]
      ,[E523]
      ,[E524]
      ,[E525]
      ,[E526]
      ,[E527]
      ,[E528]
      ,[E529]
      ,[E531]
      ,[E532]
      ,[E533]
      ,[E534]
      ,[E535]
      ,[E536]
      ,[E537]
      ,[E538]
      ,[E539]
      ,[E541]
      ,[E542]
      ,[E543]
      ,[E544]
      ,[E545]
      ,[E546]
      ,[E547]
      ,[E548]
      ,[E549]
      ,[E551]
      ,[E552]
      ,[E553]
      ,[E554]
      ,[E555]
      ,[E556]
      ,[E557]
      ,[E558]
      ,[E559]
      ,[E561]
      ,[E562]
      ,[E563]
      ,[E564]
      ,[E565]
      ,[E566]
      ,[E567]
      ,[E568]
      ,[E569]
      ,[E571]
      ,[E572]
      ,[E573]
      ,[E574]
      ,[E575]
      ,[E576]
      ,[E577]
      ,[E578]
      ,[E579]
      ,[E581]
      ,[E582]
      ,[E583]
      ,[E584]
      ,[E585]
      ,[E586]
      ,[E587]
      ,[E588]
      ,[E589]
      ,[E591]
      ,[E592]
      ,[E593]
      ,[E594]
      ,[E595]
      ,[E596]
      ,[E597]
      ,[E598]
      ,[E599]
      ,[E601]
      ,[E602]
      ,[E603]
      ,[E604]
      ,[E605]
      ,[E606]
      ,[E607]
      ,[E608]
      ,[E609]
      ,[E611]
      ,[E612]
      ,[E613]
      ,[E614]
      ,[E615]
      ,[E616]
      ,[E617]
      ,[E618]
      ,[E619]
      ,[E621]
      ,[E622]
      ,[E623]
      ,[E624]
      ,[E625]
      ,[E626]
      ,[E627]
      ,[E628]
      ,[E629]
      ,[E631]
      ,[E632]
      ,[E633]
      ,[E634]
      ,[E635]
      ,[E636]
      ,[E637]
      ,[E638]
      ,[E639]
      ,[E641]
      ,[E642]
      ,[E643]
      ,[E644]
      ,[E645]
      ,[E646]
      ,[E647]
      ,[E648]
      ,[E649]
      ,[E651]
      ,[E652]
      ,[E653]
      ,[E654]
      ,[E655]
      ,[E656]
      ,[E657]
      ,[E658]
      ,[E659]
      ,[E661]
      ,[E662]
      ,[E663]
      ,[E664]
      ,[E665]
      ,[E666]
      ,[E667]
      ,[E668]
      ,[E669]
      ,[E671]
      ,[E672]
      ,[E673]
      ,[E674]
      ,[E675]
      ,[E676]
      ,[E677]
      ,[E678]
      ,[E679]
      ,[E681]
      ,[E682]
      ,[E683]
      ,[E684]
      ,[E685]
      ,[E686]
      ,[E687]
      ,[E688]
      ,[E689]
      ,[E691]
      ,[E692]
      ,[E693]
      ,[E694]
      ,[E695]
      ,[E696]
      ,[E697]
      ,[E698]
      ,[E699]
      ,[E701]
      ,[E702]
      ,[E703]
      ,[E704]
      ,[E705]
      ,[E706]
      ,[E707]
      ,[E708]
      ,[E709]
      ,[E711]
      ,[E712]
      ,[E713]
      ,[E714]
      ,[E715]
      ,[E716]
      ,[E717]
      ,[E718]
      ,[E719]
      ,[E721]
      ,[E722]
      ,[E723]
      ,[E724]
      ,[E725]
      ,[E726]
      ,[E727]
      ,[E728]
      ,[E729]
      ,[E731]
      ,[E732]
      ,[E733]
      ,[E734]
      ,[E735]
      ,[E736]
      ,[E737]
      ,[E738]
      ,[E739]
      ,[E741]
      ,[E742]
      ,[E743]
      ,[E744]
      ,[E745]
      ,[E746]
      ,[E747]
      ,[E748]
      ,[E749]
      ,[E751]
      ,[E752]
      ,[E753]
      ,[E754]
      ,[E755]
      ,[E756]
      ,[E757]
      ,[E758]
      ,[E759]
      ,[E1]
      ,[E2]
      ,[E3]
      ,[E4]
      ,[E5]
      ,[E6]
      ,[E7]
      ,[E8]
      ,[E9]
      ,osa15u AS [osa15]
      ,nai15u AS [nai15]
      ,osa16u AS [osa16]
      ,nai16u AS [nai16]
      ,[tietolahde] = ''2_11_sopv_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
  FROM [TK_H9098_CSC].[dbo].[TK_2_11_sopv_19]
) kaikkivuodet




' 
GO
/****** Object:  View [dbo].[v_sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan]'))
EXEC dbo.sp_executesql @statement = N'











CREATE VIEW [dbo].[v_sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan] AS
/*
Drop table [VipunenTK_DW].[dbo].[sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan]
Select * into [VipunenTK_DW].[dbo].[sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan] FROM VipunenTK_SA.[dbo].[v_sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan]

Truncate table [VipunenTK_DW].[dbo].[sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan]
Insert into [VipunenTK_DW].[dbo].[sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal] = Case when ophal in ('''', ''9'') then ''1'' else ophal end
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)

FROM ( --kaikkivuodet

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak] = case kmaak when ''20'' then ''01'' else kmaak end
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_13_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY kansal, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_13_sopv_11]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_13_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY kansal, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_13_sopv_12]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_13_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY kansal, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_13_sopv_13]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_13_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY kansal, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_13_sopv_14]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_13_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY kansal, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_13_sopv_15]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_13_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY kansal, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_13_sopv_16]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_13_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY kansal, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_13_sopv_17]

  UNION ALL
  
SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_13_sopv_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY kansal, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_13_sopv_18]

  UNION ALL
  
SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[kansal]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_13_sopv_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY kansal, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_K2_13_sopv_19]


) kaikkivuodet




' 
GO
/****** Object:  View [dbo].[v_sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan]'))
EXEC dbo.sp_executesql @statement = N'












CREATE VIEW [dbo].[v_sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan] AS
/*
Drop table [VipunenTK_DW].[dbo].[sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan]
Select * into [VipunenTK_DW].[dbo].[sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan] FROM VipunenTK_SA.[dbo].[v_sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan]

Truncate table [VipunenTK_DW].[dbo].[sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan]
Insert into [VipunenTK_DW].[dbo].[sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal] = Case when ophal in ('''', ''9'') then ''1'' else ophal end
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)

FROM ( --kaikkivuodet

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak] = case kmaak when ''20'' then ''01'' else kmaak end
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_14_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY svalt, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_14_sopv_11]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_14_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY svalt, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_14_sopv_12]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_14_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY svalt, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_14_sopv_13]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_14_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY svalt, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_14_sopv_14]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_14_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY svalt, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_14_sopv_15]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_14_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY svalt, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_14_sopv_16]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_14_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY svalt, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_14_sopv_17]

  UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_14_sopv_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY svalt, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_14_sopv_18]

  UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[svalt]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_14_sopv_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY svalt, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_K2_14_sopv_19]

) kaikkivuodet




' 
GO
/****** Object:  View [dbo].[v_sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan]'))
EXEC dbo.sp_executesql @statement = N'












CREATE VIEW [dbo].[v_sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan] AS
/*
Drop table [VipunenTK_DW].[dbo].[sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan]
Select * into [VipunenTK_DW].[dbo].[sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan] FROM VipunenTK_SA.[dbo].[v_sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan]

Truncate table [VipunenTK_DW].[dbo].[sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan]
Insert into [VipunenTK_DW].[dbo].[sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan]
*/

SELECT [tilv] = CAST(kaikkivuodet.tilv as nvarchar(4))
	  ,[tilv_date] = Cast(kaikkivuodet.tilv+''0101'' as date)
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal] = Case when ophal in ('''', ''9'') then ''1'' else ophal end
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde] = CAST(kaikkivuodet.tietolahde as nvarchar(50))
      ,[rivinumero] = CAST(kaikkivuodet.rivinumero as int)

FROM ( --kaikkivuodet

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak] = case kmaak when ''20'' then ''01'' else kmaak end
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_15_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY aikieli, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_15_sopv_11]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_15_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY aikieli, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_15_sopv_12]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_15_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY aikieli, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_15_sopv_13]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_15_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY aikieli, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_15_sopv_14]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_15_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY aikieli, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_15_sopv_15]
  
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_15_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY aikieli, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_15_sopv_16]
    
UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_15_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY aikieli, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_15_sopv_17]

  UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_15_sopv_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY aikieli, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_15_sopv_18]

  UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[koulk]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkieli]
      ,[aikoul]
      ,[kmaak]
      ,[sp]
      ,[aiopis]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[tilvaskunryh]
      ,[klajir2]
      ,[aikieli]
      ,[lkm]
      ,[luontipvm]
      ,[tietolahde]=''TK_2_15_sopv_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY aikieli, koulk, alvv)
  FROM [TK_H9098_CSC].[dbo].[TK_K2_15_sopv_19]

) kaikkivuodet




' 
GO
/****** Object:  View [dbo].[v_sa_2_18_Paivahoidossa_jarjestettava_esiopetus]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_18_Paivahoidossa_jarjestettava_esiopetus]'))
EXEC dbo.sp_executesql @statement = N'






CREATE VIEW [dbo].[v_sa_2_18_Paivahoidossa_jarjestettava_esiopetus] AS
SELECT [tilv]
      ,[jarjnim]
      ,[jarj]
      ,[tiedtype]
      ,[popy]
	  ,[popyn] = NULL
      ,[jmamu]
      ,[psisa]
      ,[jmamusisa]
      ,[pteho]
      ,[pertu]
      ,[pertuv]
      ,[pertum]
      ,[ptehoerop]
      ,[pviertu]
      ,[pviertuv]
      ,[pviertum]
      ,[pvimuut]
      ,[pviop]
      ,[pkuertu]
      ,[pkuertuv]
      ,[pkuertum]
      ,[pkumuut]
      ,[pkuop]
      ,[ppid5v]
      ,[pmuu5v]
      ,[pop5v]
      ,[apip1]
      ,[apip2]
      ,[apip39]
      ,[apipy]
      ,[oma3s]
      ,[osto3s]
      ,[avust3s]
      ,[syk3s]
      ,[oma4s]
      ,[osto4s]
      ,[avust4s]
      ,[syk4s]
      ,[omams]
      ,[ostoms]
      ,[avustms]
      ,[sykms]
      ,[omays]
      ,[ostoys]
      ,[avustys]
      ,[sykys]
      ,[oma3k]
      ,[osto3k]
      ,[avust3k]
      ,[kev3k]
      ,[oma4k]
      ,[osto4k]
      ,[avust4k]
      ,[kev4k]
      ,[omamk]
      ,[ostomk]
      ,[avustmk]
      ,[kevmk]
      ,[omayk]
      ,[ostoyk]
      ,[avustyk]
      ,[kevyk]
      ,[pesis]
      ,[pesisjarjnim]
      ,[pesisjarj]
      ,[kesis]
      ,[kesisjarjnim]
      ,[kesisjarj]
      ,[perops]
      ,[peropsjarjnim]
      ,[peropsjarj]
      ,[apips]
      ,[apipsjarjnim]
      ,[apipsjarj]
      ,[luontipvm]
      ,[jmamun] = NULL
      ,[jmamuy] = NULL
      ,[jmamuyn] = NULL
      ,[jmamusisay] = NULL
      ,[jmamueo8] = NULL
      ,[jmamueo8n] = NULL
      ,[jmamueo4] = NULL
      ,[jmamueo4n] = NULL
FROM [TK_H9098_CSC]..[TK_2_18_sopv_12]
UNION ALL
SELECT [tilv]
      ,[jarjnim]
      ,[jarj]
      ,[tiedtype]
      ,[popy]
	  ,[popyn] = NULL
      ,[jmamu]
      ,[psisa]
      ,[jmamusisa]
      ,[pteho]
      ,[pertu]
      ,[pertuv]
      ,[pertum]
      ,[ptehoerop]
      ,[pviertu]
      ,[pviertuv]
      ,[pviertum]
      ,[pvimuut]
      ,[pviop]
      ,[pkuertu]
      ,[pkuertuv]
      ,[pkuertum]
      ,[pkumuut]
      ,[pkuop]
      ,[ppid5v]
      ,[pmuu5v]
      ,[pop5v]
      ,[apip1]
      ,[apip2]
      ,[apip39]
      ,[apipy]
      ,[oma3s]
      ,[osto3s]
      ,[avust3s]
      ,[syk3s]
      ,[oma4s]
      ,[osto4s]
      ,[avust4s]
      ,[syk4s]
      ,[omams]
      ,[ostoms]
      ,[avustms]
      ,[sykms]
      ,[omays]
      ,[ostoys]
      ,[avustys]
      ,[sykys]
      ,[oma3k]
      ,[osto3k]
      ,[avust3k]
      ,[kev3k]
      ,[oma4k]
      ,[osto4k]
      ,[avust4k]
      ,[kev4k]
      ,[omamk]
      ,[ostomk]
      ,[avustmk]
      ,[kevmk]
      ,[omayk]
      ,[ostoyk]
      ,[avustyk]
      ,[kevyk]
      ,[pesis]
      ,[pesisjarjnim]
      ,[pesisjarj]
      ,[kesis]
      ,[kesisjarjnim]
      ,[kesisjarj]
      ,[perops]
      ,[peropsjarjnim]
      ,[peropsjarj]
      ,[apips]
      ,[apipsjarjnim]
      ,[apipsjarj]
      ,[luontipvm]
      ,[jmamun] = NULL
      ,[jmamuy] = NULL
      ,[jmamuyn] = NULL
      ,[jmamusisay] = NULL
      ,[jmamueo8] = NULL
      ,[jmamueo8n] = NULL
      ,[jmamueo4] = NULL
      ,[jmamueo4n] = NULL
FROM [TK_H9098_CSC]..[TK_2_18_sopv_13]
UNION ALL
SELECT [tilv]
      ,[jarjnim]
      ,[jarj]
      ,[tiedtype]
      ,[popy]
	  ,[popyn] = NULL
      ,[jmamu]
      ,[psisa]
      ,[jmamusisa]
      ,[pteho]
      ,[pertu]
      ,[pertuv]
      ,[pertum]
      ,[ptehoerop]
      ,[pviertu]
      ,[pviertuv]
      ,[pviertum]
      ,[pvimuut]
      ,[pviop]
      ,[pkuertu]
      ,[pkuertuv]
      ,[pkuertum]
      ,[pkumuut]
      ,[pkuop]
      ,[ppid5v]
      ,[pmuu5v]
      ,[pop5v]
      ,[apip1]
      ,[apip2]
      ,[apip39]
      ,[apipy]
      ,[oma3s]
      ,[osto3s]
      ,[avust3s]
      ,[syk3s]
      ,[oma4s]
      ,[osto4s]
      ,[avust4s]
      ,[syk4s]
      ,[omams]
      ,[ostoms]
      ,[avustms]
      ,[sykms]
      ,[omays]
      ,[ostoys]
      ,[avustys]
      ,[sykys]
      ,[oma3k]
      ,[osto3k]
      ,[avust3k]
      ,[kev3k]
      ,[oma4k]
      ,[osto4k]
      ,[avust4k]
      ,[kev4k]
      ,[omamk]
      ,[ostomk]
      ,[avustmk]
      ,[kevmk]
      ,[omayk]
      ,[ostoyk]
      ,[avustyk]
      ,[kevyk]
      ,[pesis]
      ,[pesisjarjnim]
      ,[pesisjarj]
      ,[kesis]
      ,[kesisjarjnim]
      ,[kesisjarj]
      ,[perops]
      ,[peropsjarjnim]
      ,[peropsjarj]
      ,[apips]
      ,[apipsjarjnim]
      ,[apipsjarj]
      ,[luontipvm]
      ,[jmamun] = NULL
      ,[jmamuy] = NULL
      ,[jmamuyn] = NULL
      ,[jmamusisay] = NULL
      ,[jmamueo8] = NULL
      ,[jmamueo8n] = NULL
      ,[jmamueo4] = NULL
      ,[jmamueo4n] = NULL
FROM [TK_H9098_CSC]..[TK_2_18_sopv_14]
UNION ALL
SELECT [tilv]
      ,[jarjnim]
      ,[jarj]
      ,[tiedtype]
      ,[popy]
	  ,[popyn] = NULL
      ,[jmamu]
      ,[psisa]
      ,[jmamusisa]
      ,[pteho]
      ,[pertu]
      ,[pertuv]
      ,[pertum]
      ,[ptehoerop]
      ,[pviertu]
      ,[pviertuv]
      ,[pviertum]
      ,[pvimuut]
      ,[pviop]
      ,[pkuertu]
      ,[pkuertuv]
      ,[pkuertum]
      ,[pkumuut]
      ,[pkuop]
      ,[ppid5v]
      ,[pmuu5v]
      ,[pop5v]
      ,[apip1]
      ,[apip2]
      ,[apip39]
      ,[apipy]
      ,[oma3s]
      ,[osto3s]
      ,[avust3s]
      ,[syk3s]
      ,[oma4s]
      ,[osto4s]
      ,[avust4s]
      ,[syk4s]
      ,[omams]
      ,[ostoms]
      ,[avustms]
      ,[sykms]
      ,[omays]
      ,[ostoys]
      ,[avustys]
      ,[sykys]
      ,[oma3k]
      ,[osto3k]
      ,[avust3k]
      ,[kev3k]
      ,[oma4k]
      ,[osto4k]
      ,[avust4k]
      ,[kev4k]
      ,[omamk]
      ,[ostomk]
      ,[avustmk]
      ,[kevmk]
      ,[omayk]
      ,[ostoyk]
      ,[avustyk]
      ,[kevyk]
      ,[pesis]
      ,[pesisjarjnim]
      ,[pesisjarj]
      ,[kesis]
      ,[kesisjarjnim]
      ,[kesisjarj]
      ,[perops]
      ,[peropsjarjnim]
      ,[peropsjarj]
      ,[apips]
      ,[apipsjarjnim]
      ,[apipsjarj]
      ,[luontipvm]
      ,[jmamun] = NULL
      ,[jmamuy] = NULL
      ,[jmamuyn] = NULL
      ,[jmamusisay] = NULL
      ,[jmamueo8] = NULL
      ,[jmamueo8n] = NULL
      ,[jmamueo4] = NULL
      ,[jmamueo4n] = NULL
FROM [TK_H9098_CSC]..[TK_2_18_sopv_15]
UNION ALL
SELECT [tilv]
      ,[jarjnim]
      ,[jarj]
      ,[tiedtype]
      ,[popy]
	  ,[popyn]
      ,[jmamu]
      ,[psisa]
      ,[jmamusisa]
      ,[pteho]
      ,[pertu]
      ,[pertuv]
      ,[pertum]
      ,[ptehoerop]
      ,[pviertu]
      ,[pviertuv]
      ,[pviertum]
      ,[pvimuut]
      ,[pviop]
      ,[pkuertu]
      ,[pkuertuv]
      ,[pkuertum]
      ,[pkumuut]
      ,[pkuop]
      ,[ppid5v]
      ,[pmuu5v]
      ,[pop5v]
      ,[apip1]
      ,[apip2]
      ,[apip39]
      ,[apipy]
      ,[oma3s]
      ,[osto3s]
      ,[avust3s]
      ,[syk3s]
      ,[oma4s]
      ,[osto4s]
      ,[avust4s]
      ,[syk4s]
      ,[omams]
      ,[ostoms]
      ,[avustms]
      ,[sykms]
      ,[omays]
      ,[ostoys]
      ,[avustys]
      ,[sykys]
      ,[oma3k]
      ,[osto3k]
      ,[avust3k]
      ,[kev3k]
      ,[oma4k]
      ,[osto4k]
      ,[avust4k]
      ,[kev4k]
      ,[omamk]
      ,[ostomk]
      ,[avustmk]
      ,[kevmk]
      ,[omayk]
      ,[ostoyk]
      ,[avustyk]
      ,[kevyk]
      ,[pesis]
      ,[pesisjarjnim]
      ,[pesisjarj]
      ,[kesis]
      ,[kesisjarjnim]
      ,[kesisjarj]
      ,[perops]
      ,[peropsjarjnim]
      ,[peropsjarj]
      ,[apips]
      ,[apipsjarjnim]
      ,[apipsjarj]
      ,[luontipvm]
      ,[jmamun]
      ,[jmamuy]
      ,[jmamuyn]
      ,[jmamusisay]
      ,[jmamueo8]
      ,[jmamueo8n]
      ,[jmamueo4]
      ,[jmamueo4n]
FROM [TK_H9098_CSC]..[TK_2_18_sopv_16]
UNION ALL
SELECT [tilv]
      ,[jarjnim]
      ,[jarj]
      ,[tiedtype]
      ,[popy]
	  ,[popyn]
      ,[jmamu]
      ,[psisa]
      ,[jmamusisa]
      ,[pteho]
      ,[pertu]
      ,[pertuv]
      ,[pertum]
      ,[ptehoerop]
      ,[pviertu]
      ,[pviertuv]
      ,[pviertum]
      ,[pvimuut]
      ,[pviop]
      ,[pkuertu]
      ,[pkuertuv]
      ,[pkuertum]
      ,[pkumuut]
      ,[pkuop]
      ,[ppid5v]
      ,[pmuu5v]
      ,[pop5v]
      ,[apip1]
      ,[apip2]
      ,[apip39]
      ,[apipy]
      ,[oma3s]
      ,[osto3s]
      ,[avust3s]
      ,[syk3s]
      ,[oma4s]
      ,[osto4s]
      ,[avust4s]
      ,[syk4s]
      ,[omams]
      ,[ostoms]
      ,[avustms]
      ,[sykms]
      ,[omays]
      ,[ostoys]
      ,[avustys]
      ,[sykys]
      ,[oma3k]
      ,[osto3k]
      ,[avust3k]
      ,[kev3k]
      ,[oma4k]
      ,[osto4k]
      ,[avust4k]
      ,[kev4k]
      ,[omamk]
      ,[ostomk]
      ,[avustmk]
      ,[kevmk]
      ,[omayk]
      ,[ostoyk]
      ,[avustyk]
      ,[kevyk]
      ,[pesis]
      ,[pesisjarjnim]
      ,[pesisjarj]
      ,[kesis]
      ,[kesisjarjnim]
      ,[kesisjarj]
      ,[perops]
      ,[peropsjarjnim]
      ,[peropsjarj]
      ,[apips]
      ,[apipsjarjnim]
      ,[apipsjarj]
      ,[luontipvm]
      ,[jmamun] = NULL
      ,[jmamuy] = NULL
      ,[jmamuyn] = NULL
      ,[jmamusisay] = NULL
      ,[jmamueo8] = NULL
      ,[jmamueo8n] = NULL
      ,[jmamueo4] = NULL
      ,[jmamueo4n] = NULL
FROM [TK_H9098_CSC]..[TK_2_18_sopv_17]

UNION ALL

SELECT [tilv]
      ,[jarjnim]
      ,[jarj]
      ,[tiedtype]
      ,[popy]
	  ,[popyn]
      ,[jmamu] = NULL
      ,[psisa]
      ,[jmamusisa] = NULL
      ,[pteho]
      ,[pertu]
      ,[pertuv]
      ,[pertum]
      ,[ptehoerop]
      ,[pviertu]
      ,[pviertuv]
      ,[pviertum]
      ,[pvimuut]
      ,[pviop]
      ,[pkuertu]
      ,[pkuertuv]
      ,[pkuertum]
      ,[pkumuut]
      ,[pkuop]
      ,[ppid5v]
      ,[pmuu5v]
      ,[pop5v]
      ,[apip1]
      ,[apip2]
      ,[apip39]
      ,[apipy]
      ,[oma3s]
      ,[osto3s]
      ,[avust3s]
      ,[syk3s]
      ,[oma4s]
      ,[osto4s]
      ,[avust4s]
      ,[syk4s]
      ,[omams]
      ,[ostoms]
      ,[avustms]
      ,[sykms]
      ,[omays]
      ,[ostoys]
      ,[avustys]
      ,[sykys]
      ,[oma3k]
      ,[osto3k]
      ,[avust3k]
      ,[kev3k]
      ,[oma4k]
      ,[osto4k]
      ,[avust4k]
      ,[kev4k]
      ,[omamk]
      ,[ostomk]
      ,[avustmk]
      ,[kevmk]
      ,[omayk]
      ,[ostoyk]
      ,[avustyk]
      ,[kevyk]
      ,[pesis]
      ,[pesisjarjnim]
      ,[pesisjarj]
      ,[kesis]
      ,[kesisjarjnim]
      ,[kesisjarj]
      ,[perops]
      ,[peropsjarjnim]
      ,[peropsjarj]
      ,[apips]
      ,[apipsjarjnim]
      ,[apipsjarj]
      ,[luontipvm]
      ,[jmamun] = NULL
      ,[jmamuy] = NULL
      ,[jmamuyn] = NULL
      ,[jmamusisay] = NULL
      ,[jmamueo8] = NULL
      ,[jmamueo8n] = NULL
      ,[jmamueo4] = NULL
      ,[jmamueo4n] = NULL
FROM [TK_H9098_CSC]..[TK_2_18_sopv_18]

UNION ALL

SELECT [tilv]
      ,[jarjnim]
      ,[jarj]
      ,[tiedtype]
      ,[popy]
	  ,[popyn]
      ,[jmamu] = NULL
      ,[psisa]
      ,[jmamusisa] = NULL
      ,[pteho]
      ,[pertu]
      ,[pertuv]
      ,[pertum]
      ,[ptehoerop]
      ,[pviertu]
      ,[pviertuv]
      ,[pviertum]
      ,[pvimuut]
      ,[pviop]
      ,[pkuertu]
      ,[pkuertuv]
      ,[pkuertum]
      ,[pkumuut]
      ,[pkuop]
      ,[ppid5v]
      ,[pmuu5v]
      ,[pop5v]
      ,[apip1]
      ,[apip2]
      ,[apip39]
      ,[apipy]
      ,[oma3s]
      ,[osto3s]
      ,[avust3s]
      ,[syk3s]
      ,[oma4s]
      ,[osto4s]
      ,[avust4s]
      ,[syk4s]
      ,[omams]
      ,[ostoms]
      ,[avustms]
      ,[sykms]
      ,[omays]
      ,[ostoys]
      ,[avustys]
      ,[sykys]
      ,[oma3k]
      ,[osto3k]
      ,[avust3k]
      ,[kev3k]
      ,[oma4k]
      ,[osto4k]
      ,[avust4k]
      ,[kev4k]
      ,[omamk]
      ,[ostomk]
      ,[avustmk]
      ,[kevmk]
      ,[omayk]
      ,[ostoyk]
      ,[avustyk]
      ,[kevyk]
      ,[pesis]
      ,[pesisjarjnim]
      ,[pesisjarj]
      ,[kesis]
      ,[kesisjarjnim]
      ,[kesisjarj]
      ,[perops]
      ,[peropsjarjnim]
      ,[peropsjarj]
      ,[apips]
      ,[apipsjarjnim]
      ,[apipsjarj]
      ,[luontipvm]
      ,[jmamun] = NULL
      ,[jmamuy] = NULL
      ,[jmamuyn] = NULL
      ,[jmamusisay] = NULL
      ,[jmamueo8] = NULL
      ,[jmamueo8n] = NULL
      ,[jmamueo4] = NULL
      ,[jmamueo4n] = NULL
FROM [TK_H9098_CSC]..[TK_K2_18_sopv_19]



' 
GO
/****** Object:  View [dbo].[v_sa_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan]'))
EXEC dbo.sp_executesql @statement = N'



CREATE VIEW [dbo].[v_sa_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan] AS

SELECT
	   [tilv]= cast(kaikkivuodet.tilv as nvarchar(4))
	  ,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[lahde] = CAST(kaikkivuodet.lahde as nvarchar (2))
	  ,[oltyp] = CAST(kaikkivuodet.oltyp as nvarchar (2))
	  ,[koulk] = CAST(kaikkivuodet.koulk as nvarchar (6))
	  ,[koulk_opintoala] = CAST(kaikkivuodet.koulk_opintoala as nvarchar (6))
	  ,[koulk_koulutusala] = CAST(kaikkivuodet.koulk_koulutusala as nvarchar (6))
	  ,[koulk_koulutusaste] = CAST(kaikkivuodet.koulk_koulutusaste as nvarchar (6))
	  ,[koulk_koulutusala_taso2] = CAST(kaikkivuodet.koulk_koulutusala_taso2 as nvarchar (6))
	  ,[koulk_koulutusala_taso1] = CAST(kaikkivuodet.koulk_koulutusala_taso1 as nvarchar (6))
	  ,[koulk_koulutusaste_taso2] = CAST(kaikkivuodet.koulk_koulutusaste_taso2 as nvarchar (6))
	  ,[koulk_koulutusaste_taso1] = CAST(kaikkivuodet.koulk_koulutusaste_taso1 as nvarchar (6))
      ,[aikoul] = CAST(kaikkivuodet.aikoul as nvarchar (1))
      ,[tutktav]= CAST(kaikkivuodet.tutktav as nvarchar (1))
      ,[tutklaja]= CAST(kaikkivuodet.tutklaja as nvarchar (1))
      ,[ophal]= CAST(kaikkivuodet.ophal as nvarchar (1))
      ,[kkun]= CAST(kaikkivuodet.kkun as nvarchar (3))
      ,[rahoitus]= CAST(kaikkivuodet.rahoitus as nvarchar (1))
      ,[sp]= CAST(kaikkivuodet.sp as nvarchar (1))
      ,[aikielir1]= CAST(kaikkivuodet.aikielir1 as nvarchar (2))
      ,[alvv]= CAST(kaikkivuodet.alvv as nvarchar (4))
      ,[allk]= CAST(kaikkivuodet.allk as nvarchar (1))
      ,[olosyys]= CAST(kaikkivuodet.olosyys as nvarchar (1))
      ,[ylsivx]= CAST(kaikkivuodet.ylsivx as nvarchar (1))
      ,[peruskx]= CAST(kaikkivuodet.peruskx as nvarchar (1))
      ,[oalapex]= CAST(kaikkivuodet.oalapex as nvarchar (2))
      ,[oastepex]= CAST(kaikkivuodet.oastepex as nvarchar (1))
      ,[oalapeux]= CAST(kaikkivuodet.oalapeux as nvarchar (3))
      ,[oalapeux_koulutusala]= CAST(kaikkivuodet.oalapeux_koulutusala as nvarchar (3))
      ,[oastpeux]= CAST(kaikkivuodet.oastpeux  as nvarchar (2))
	  ,[iscfinarrow_pex] = CAST(kaikkivuodet.iscfinarrow_pex  as nvarchar (3))
	  ,[kaste_t2_pex] = CAST(kaikkivuodet.kaste_t2_pex  as nvarchar (2))
      ,[ammvupe]= CAST(kaikkivuodet.ammvupe as nvarchar (4))
      ,[nayttox]= CAST(kaikkivuodet.nayttox as nvarchar (1))
      ,[oppispex]= CAST(kaikkivuodet.oppispex as nvarchar (1))
      ,[lisakx]= CAST(kaikkivuodet.lisakx as nvarchar (1))
      ,[oalalix]= CAST(kaikkivuodet.oalalix as nvarchar (2))
      ,[oastelix]= CAST(kaikkivuodet.oastelix as nvarchar (1))
      ,[oalaliux]= CAST(kaikkivuodet.oalaliux as nvarchar (3))
      ,[oalaliux_koulutusala]= CAST(kaikkivuodet.oalaliux_koulutusala as nvarchar (3))
      ,[oastliux]= CAST(kaikkivuodet.oastliux as nvarchar (2))
	  ,[iscfinarrow_lix] = CAST(kaikkivuodet.iscfinarrow_lix  as nvarchar (3))
	  ,[kaste_t2_lix] = CAST(kaikkivuodet.kaste_t2_lix  as nvarchar (2))
      ,[ammvuli]= CAST(kaikkivuodet.ammvuli as nvarchar (4))
      ,[oppislix]= CAST(kaikkivuodet.oppislix as nvarchar (1))
      ,[alempikax]= CAST(kaikkivuodet.alempikax as nvarchar (1))
      ,[oalaakx]= CAST(kaikkivuodet.oalaakx as nvarchar (2))
      ,[oasteakx]= CAST(kaikkivuodet.oasteakx as nvarchar (1))
      ,[oalauakx]= CAST(kaikkivuodet.oalauakx as nvarchar (3))
      ,[oalauakx_koulutusala]= CAST(kaikkivuodet.oalauakx_koulutusala as nvarchar (3))
      ,[oasteuakx]= CAST(kaikkivuodet.oasteuakx as nvarchar (2))
	  ,[iscfinarrow_akx] = CAST(kaikkivuodet.iscfinarrow_akx  as nvarchar (3))
	  ,[kaste_t2_akx] = CAST(kaikkivuodet.kaste_t2_akx  as nvarchar (2))
      ,[svuosiak]= CAST(kaikkivuodet.svuosiak as nvarchar (4))
      ,[ylempikax]= CAST(kaikkivuodet.ylempikax as nvarchar (1))
      ,[oalaykx]= CAST(kaikkivuodet.oalaykx as nvarchar (2))
      ,[oasteykx]= CAST(kaikkivuodet.oasteykx as nvarchar (1))
      ,[oalauykx]= CAST(kaikkivuodet.oalauykx as nvarchar (3))
      ,[oalauykx_koulutusala]= CAST(kaikkivuodet.oalauykx_koulutusala as nvarchar (3))
      ,[oasteuykx]= CAST(kaikkivuodet.oasteuykx as nvarchar (2))
	  ,[iscfinarrow_ykx] = CAST(kaikkivuodet.iscfinarrow_ykx  as nvarchar (3))
	  ,[kaste_t2_ykx] = CAST(kaikkivuodet.kaste_t2_ykx  as nvarchar (2))
      ,[svuosiyk]= CAST(kaikkivuodet.svuosiyk as nvarchar (4))
      ,[askun]= CAST(kaikkivuodet.askun as nvarchar (3))
      ,[syntv]= CAST(kaikkivuodet.syntv as nvarchar (4))
      ,[lkm]
   	  ,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(50))
	  ,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (

  SELECT [tilv]
      ,[lahde]
      ,[oltyp]
      ,[koulk]
      ,[koulk_opintoala]			=	(select distinct opintoala2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusala]			=	(select distinct koulutusala2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusaste]			=	(select distinct koulutusaste2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala_taso2]	=	(select distinct iscfinarrow2013_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala_taso1]	=	(select distinct iscfibroad2013_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste_taso2]	=	(select distinct Koulutusaste_taso2_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste_taso1]	=	(select distinct iscle2011_koodi			from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[aikoul]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkun]
      ,[rahoitus]
      ,[sp]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[olosyys]
      ,[ylsivx]
      ,[peruskx]
      ,[oalapex]
      ,[oastepex]
      ,[oalapeux]
      ,[oalapeux_koulutusala] = LEFT ([oalapeux],1)
      ,[oastpeux]
	  ,[iscfinarrow_pex] = null
	  ,[kaste_t2_pex] = null
      ,[ammvupe]
      ,[nayttox]
      ,[oppispex]
      ,[lisakx]
      ,[oalalix]
      ,[oastelix]
      ,[oalaliux]
      ,[oalaliux_koulutusala] = LEFT([oalaliux],1)
      ,[oastliux]
	  ,[iscfinarrow_lix] = null
	  ,[kaste_t2_lix] = null
      ,[ammvuli]
      ,[oppislix]
      ,[alempikax]
      ,[oalaakx]
      ,[oasteakx]
      ,[oalauakx]
       ,[oalauakx_koulutusala] = left([oalauakx],1)
      ,[oasteuakx]
	  ,[iscfinarrow_akx] = null
	  ,[kaste_t2_akx] = null
      ,[svuosiak]
      ,[ylempikax]
      ,[oalaykx]
      ,[oasteykx]
      ,[oalauykx]
      ,[oalauykx_koulutusala] = left([oalauykx],1)
      ,[oasteuykx]
	  ,[iscfinarrow_ykx] = null
	  ,[kaste_t2_ykx] = null
      ,[svuosiyk]
      ,[askun]
      ,[syntv]
      ,[lkm]
      ,[tietolahde]=''TK_2_20_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_20_sopv_13]
  UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[oltyp]
      ,[koulk]
      ,[koulk_opintoala]			=	(select distinct opintoala2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusala]			=	(select distinct koulutusala2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusaste]			=	(select distinct koulutusaste2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala_taso2]	=	(select distinct iscfinarrow2013_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala_taso1]	=	(select distinct iscfibroad2013_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste_taso2]	=	(select distinct Koulutusaste_taso2_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste_taso1]	=	(select distinct iscle2011_koodi			from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[aikoul]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkun]
      ,[rahoitus]
      ,[sp]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[olosyys]
      ,[ylsivx]
      ,[peruskx]
      ,[oalapex]
      ,[oastepex]
      ,[oalapeux]
      ,[oalapeux_koulutusala] = LEFT ([oalapeux],1)
      ,[oastpeux]
	  ,[iscfinarrow_pex] = null
	  ,[kaste_t2_pex] = null
      ,[ammvupe]
      ,[nayttox]
      ,[oppispex]
      ,[lisakx]
      ,[oalalix]
      ,[oastelix]
      ,[oalaliux]
      ,[oalaliux_koulutusala] = LEFT([oalaliux],1)
      ,[oastliux]
	  ,[iscfinarrow_lix] = null
	  ,[kaste_t2_lix] = null
      ,[ammvuli]
      ,[oppislix]
      ,[alempikax]
      ,[oalaakx]
      ,[oasteakx]
      ,[oalauakx]
       ,[oalauakx_koulutusala] = left([oalauakx],1)
      ,[oasteuakx]
	  ,[iscfinarrow_akx] = null
	  ,[kaste_t2_akx] = null
      ,[svuosiak]
      ,[ylempikax]
      ,[oalaykx]
      ,[oasteykx]
      ,[oalauykx]
      ,[oalauykx_koulutusala] = left([oalauykx],1)
      ,[oasteuykx]
	  ,[iscfinarrow_ykx] = null
	  ,[kaste_t2_ykx] = null
      ,[svuosiyk]
      ,[askun]
      ,[syntv]
      ,[lkm]
      ,[tietolahde]=''TK_2_20_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_20_sopv_14]
   UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[oltyp]
      ,[koulk]
      ,[koulk_opintoala]			=	(select distinct opintoala2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusala]			=	(select distinct koulutusala2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusaste]			=	(select distinct koulutusaste2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala_taso2]	=	(select distinct iscfinarrow2013_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala_taso1]	=	(select distinct iscfibroad2013_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste_taso2]	=	(select distinct Koulutusaste_taso2_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste_taso1]	=	(select distinct iscle2011_koodi			from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[aikoul]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkun]
      ,[rahoitus]
      ,[sp]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[olosyys]
      ,[ylsivx]
      ,[peruskx]
      ,[oalapex]
      ,[oastepex]
      ,[oalapeux]
      ,[oalapeux_koulutusala] = LEFT ([oalapeux],1)
      ,[oastpeux]
	  ,[iscfinarrow_pex] = null
	  ,[kaste_t2_pex] = null
      ,[ammvupe]
      ,[nayttox]
      ,[oppispex]
      ,[lisakx]
      ,[oalalix]
      ,[oastelix]
      ,[oalaliux]
      ,[oalaliux_koulutusala] = LEFT([oalaliux],1)
      ,[oastliux]
	  ,[iscfinarrow_lix] = null
	  ,[kaste_t2_lix] = null
      ,[ammvuli]
      ,[oppislix]
      ,[alempikax]
      ,[oalaakx]
      ,[oasteakx]
      ,[oalauakx]
       ,[oalauakx_koulutusala] = left([oalauakx],1)
      ,[oasteuakx]
	  ,[iscfinarrow_akx] = null
	  ,[kaste_t2_akx] = null
      ,[svuosiak]
      ,[ylempikax]
      ,[oalaykx]
      ,[oasteykx]
      ,[oalauykx]
      ,[oalauykx_koulutusala] = left([oalauykx],1)
      ,[oasteuykx]
	  ,[iscfinarrow_ykx] = null
	  ,[kaste_t2_ykx] = null
      ,[svuosiyk]
      ,[askun]
      ,[syntv]
      ,[lkm]
      ,[tietolahde]=''TK_2_20_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_20_sopv_15]
   UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[oltyp]
      ,[koulk]
      ,[koulk_opintoala]			=	(select distinct opintoala2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusala]			=	(select distinct koulutusala2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusaste]			=	(select distinct koulutusaste2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala_taso2]	=	(select distinct iscfinarrow2013_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala_taso1]	=	(select distinct iscfibroad2013_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste_taso2]	=	(select distinct Koulutusaste_taso2_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste_taso1]	=	(select distinct iscle2011_koodi			from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[aikoul]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkun]
      ,[rahoitus]
      ,[sp]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[olosyys]
      ,[ylsivx]
      ,[peruskx]
      ,[oalapex]
      ,[oastepex]
      ,[oalapeux]
      ,[oalapeux_koulutusala] = LEFT ([oalapeux],1)
      ,[oastpeux]
	  ,[iscfinarrow_pex] = null
	  ,[kaste_t2_pex] = null
      ,[ammvupe]
      ,[nayttox]
      ,[oppispex]
      ,[lisakx]
      ,[oalalix]
      ,[oastelix]
      ,[oalaliux]
      ,[oalaliux_koulutusala] = LEFT([oalaliux],1)
      ,[oastliux]
	  ,[iscfinarrow_lix] = null
	  ,[kaste_t2_lix] = null
      ,[ammvuli]
      ,[oppislix]
      ,[alempikax]
      ,[oalaakx]
      ,[oasteakx]
      ,[oalauakx]
       ,[oalauakx_koulutusala] = left([oalauakx],1)
      ,[oasteuakx]
	  ,[iscfinarrow_akx] = null
	  ,[kaste_t2_akx] = null
      ,[svuosiak]
      ,[ylempikax]
      ,[oalaykx]
      ,[oasteykx]
      ,[oalauykx]
      ,[oalauykx_koulutusala] = left([oalauykx],1)
      ,[oasteuykx]
	  ,[iscfinarrow_ykx] = null
	  ,[kaste_t2_ykx] = null
      ,[svuosiyk]
      ,[askun]
      ,[syntv]
      ,[lkm]
      ,[tietolahde]=''TK_2_20_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_20_sopv_16]
   UNION ALL
  SELECT [tilv]
      ,[lahde]
      ,[oltyp]
      ,[koulk]
      ,[koulk_opintoala]			=	(select distinct opintoala2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusala]			=	(select distinct koulutusala2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusaste]			=	(select distinct koulutusaste2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala_taso2]	=	(select distinct iscfinarrow2013_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala_taso1]	=	(select distinct iscfibroad2013_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste_taso2]	=	(select distinct Koulutusaste_taso2_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste_taso1]	=	(select distinct iscle2011_koodi			from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[aikoul]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkun]
      ,[rahoitus]
      ,[sp]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[olosyys]
      ,[ylsivx]
      ,[peruskx]
      ,[oalapex]
      ,[oastepex]
      ,[oalapeux]
      ,[oalapeux_koulutusala] = LEFT ([oalapeux],1)
      ,[oastpeux]
	  ,[iscfinarrow_pex] = null
	  ,[kaste_t2_pex] = null
      ,[ammvupe]
      ,[nayttox]
      ,[oppispex]
      ,[lisakx]
      ,[oalalix]
      ,[oastelix]
      ,[oalaliux]
      ,[oalaliux_koulutusala] = LEFT([oalaliux],1)
      ,[oastliux]
	  ,[iscfinarrow_lix] = null
	  ,[kaste_t2_lix] = null
      ,[ammvuli]
      ,[oppislix]
      ,[alempikax]
      ,[oalaakx]
      ,[oasteakx]
      ,[oalauakx]
       ,[oalauakx_koulutusala] = left([oalauakx],1)
      ,[oasteuakx]
	  ,[iscfinarrow_akx] = null
	  ,[kaste_t2_akx] = null
      ,[svuosiak]
      ,[ylempikax]
      ,[oalaykx]
      ,[oasteykx]
      ,[oalauykx]
      ,[oalauykx_koulutusala] = left([oalauykx],1)
      ,[oasteuykx]
	  ,[iscfinarrow_ykx] = null
	  ,[kaste_t2_ykx] = null
      ,[svuosiyk]
      ,[askun]
      ,[syntv]
      ,[lkm]
      ,[tietolahde]=''TK_2_20_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_20_sopv_17]

UNION ALL

  SELECT [tilv]
      ,[lahde]
      ,[oltyp]
      ,[koulk]
      ,[koulk_opintoala]			=	(select distinct opintoala2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusala]			=	(select distinct koulutusala2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusaste]			=	(select distinct koulutusaste2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala_taso2]	=	(select distinct iscfinarrow2013_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala_taso1]	=	(select distinct iscfibroad2013_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste_taso2]	=	(select distinct Koulutusaste_taso2_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste_taso1]	=	(select distinct iscle2011_koodi			from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[aikoul]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkun]
      ,[rahoitus]
      ,[sp]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[olosyys]
      ,[ylsivx]
      ,[peruskx]
      ,[oalapex] = NULL
      ,[oastepex] = NULL
      ,[oalapeux] = NULL
      ,[oalapeux_koulutusala] = NULL
      ,[oastpeux] = NULL
	  ,[iscfinarrow_pex]
	  ,[kaste_t2_pex]
      ,[ammvupe]
      ,[nayttox]
      ,[oppispex]
      ,[lisakx]
      ,[oalalix] = NULL
      ,[oastelix] = NULL
      ,[oalaliux] = NULL
      ,[oalaliux_koulutusala] = NULL
      ,[oastliux] = NULL
	  ,[iscfinarrow_lix]
	  ,[kaste_t2_lix]
      ,[ammvuli]
      ,[oppislix]
      ,[alempikax]
      ,[oalaakx] = NULL
      ,[oasteakx] = NULL
      ,[oalauakx] = NULL
      ,[oalauakx_koulutusala] = NULL
      ,[oasteuakx] = NULL
	  ,[iscfinarrow_akx]
	  ,[kaste_t2_akx]
      ,[svuosiak]
      ,[ylempikax]
      ,[oalaykx] = NULL
      ,[oasteykx] = NULL
      ,[oalauykx] = NULL
      ,[oalauykx_koulutusala] = NULL
      ,[oasteuykx] = NULL
	  ,[iscfinarrow_ykx]
	  ,[kaste_t2_ykx]
      ,[svuosiyk]
      ,[askun]
      ,[syntv]
      ,[lkm]
      ,[tietolahde]=''TK_2_20_sopv_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_20_sopv_18]

UNION ALL

  SELECT [tilv]
      ,[lahde]
      ,[oltyp]
      ,[koulk]
      ,[koulk_opintoala]			=	(select distinct opintoala2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusala]			=	(select distinct koulutusala2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[koulk_koulutusaste]			=	(select distinct koulutusaste2002_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala_taso2]	=	(select distinct iscfinarrow2013_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusala_taso1]	=	(select distinct iscfibroad2013_koodi		from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste_taso2]	=	(select distinct Koulutusaste_taso2_koodi   from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
	  ,[koulk_koulutusaste_taso1]	=	(select distinct iscle2011_koodi			from [VipunenTK].[dbo].[d_koulutusluokitus] where koulutusluokitus_avain = [koulk])
      ,[aikoul]
      ,[tutktav]
      ,[tutklaja]
      ,[ophal]
      ,[kkun]
      ,[rahoitus]
      ,[sp]
      ,[aikielir1]
      ,[alvv]
      ,[allk]
      ,[olosyys]
      ,[ylsivx]
      ,[peruskx]
      ,[oalapex] = NULL
      ,[oastepex] = NULL
      ,[oalapeux] = NULL
      ,[oalapeux_koulutusala] = NULL
      ,[oastpeux] = NULL
	  ,[iscfinarrow_pex]
	  ,[kaste_t2_pex]
      ,[ammvupe]
      ,[nayttox]
      ,[oppispex]
      ,[lisakx]
      ,[oalalix] = NULL
      ,[oastelix] = NULL
      ,[oalaliux] = NULL
      ,[oalaliux_koulutusala] = NULL
      ,[oastliux] = NULL
	  ,[iscfinarrow_lix]
	  ,[kaste_t2_lix]
      ,[ammvuli]
      ,[oppislix]
      ,[alempikax]
      ,[oalaakx] = NULL
      ,[oasteakx] = NULL
      ,[oalauakx] = NULL
      ,[oalauakx_koulutusala] = NULL
      ,[oasteuakx] = NULL
	  ,[iscfinarrow_akx]
	  ,[kaste_t2_akx]
      ,[svuosiak]
      ,[ylempikax]
      ,[oalaykx] = NULL
      ,[oasteykx] = NULL
      ,[oalauykx] = NULL
      ,[oalauykx_koulutusala] = NULL
      ,[oasteuykx] = NULL
	  ,[iscfinarrow_ykx]
	  ,[kaste_t2_ykx]
      ,[svuosiyk]
      ,[askun]
      ,[syntv]
      ,[lkm]
      ,[tietolahde]=''TK_2_20_sopv_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K2_20_sopv_19]


  ) as kaikkivuodet


' 
GO
/****** Object:  View [dbo].[v_sa_2_21_Lukio_ammpk_opisk_tutk]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_21_Lukio_ammpk_opisk_tutk]'))
EXEC dbo.sp_executesql @statement = N'



/*
select * into vipunentk_dw..sa_2_21_Lukio_ammpk_opisk_tutk from [dbo].[v_sa_2_21_Lukio_ammpk_opisk_tutk]

*/

CREATE VIEW [dbo].[v_sa_2_21_Lukio_ammpk_opisk_tutk] AS

SELECT
	   [tilv]= cast(kaikkivuodet.tilv as nvarchar(4))
	  ,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
      ,[perusjoukko] = cast(kaikkivuodet.perusjoukko as nvarchar(2))
      ,[aikielir1] = cast(kaikkivuodet.aikielir1 as nvarchar(2))
      ,[koulk] = cast(kaikkivuodet.koulk as nvarchar(6))
      ,[kmaak] = cast(kaikkivuodet.kmaak as nvarchar(2))
      ,[lkm] = cast(kaikkivuodet.lkm as int)
   	  ,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(20))
	  ,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (

  SELECT [tilv]
      ,[perusjoukko]
      ,[aikielir1]
      ,[koulk]
      ,[kmaak] = case 
					  when kmaak=''20'' then ''01''
					  when left(kmaak,1)<>0 and len(kmaak)=1 then ''0''+kmaak	
					  else kmaak
				 end
      ,[lkm]
	  ,[tietolahde] = ''TK_2_21_sopv_12''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_21_sopv_12]
     
UNION ALL

  SELECT [tilv]
      ,[perusjoukko]
      ,[aikielir1]
      ,[koulk]
      ,[kmaak] = case 
					  when kmaak=''20'' then ''01''
					  when left(kmaak,1)<>0 and len(kmaak)=1 then ''0''+kmaak	
					  else kmaak
				 end
      ,[lkm]
	  ,[tietolahde] = ''TK_2_21_sopv_13''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_21_sopv_13]

UNION ALL

  SELECT [tilv]
      ,[perusjoukko]
      ,[aikielir1]
      ,[koulk]
      ,[kmaak]
      ,[lkm]
	  ,[tietolahde] = ''TK_2_21_sopv_14''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_21_sopv_14]

UNION ALL

  SELECT [tilv]
      ,[perusjoukko]
      ,[aikielir1]
      ,[koulk]
      ,[kmaak]
      ,[lkm]
	  ,[tietolahde] = ''TK_2_21_sopv_15''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_21_sopv_15]

UNION ALL

  SELECT [tilv]
      ,[perusjoukko]
      ,[aikielir1]
      ,[koulk]
      ,[kmaak]
      ,[lkm]
	  ,[tietolahde] = ''TK_2_21_sopv_16''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_21_sopv_16]

UNION ALL

  SELECT [tilv]
      ,[perusjoukko]
      ,[aikielir1]
      ,[koulk]
      ,[kmaak]
      ,[lkm]
	  ,[tietolahde] = ''TK_2_21_sopv_17''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_21_sopv_17]

UNION ALL

  SELECT [tilv]
      ,[perusjoukko]
      ,[aikielir1]
      ,[koulk]
      ,[kmaak]
      ,[lkm]
	  ,[tietolahde] = ''TK_2_21_sopv_18''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_21_sopv_18]

UNION ALL

  SELECT [tilv]
      ,[perusjoukko]
      ,[aikielir1]
      ,[koulk]
      ,[kmaak]
      ,[lkm]
	  ,[tietolahde] = ''TK_2_21_sopv_19''
	  ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_21_sopv_19]







  
  ) as kaikkivuodet



' 
GO
/****** Object:  View [dbo].[v_sa_2_23_Opisk_ja_tutksuor_vanh_aseman_muk]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_23_Opisk_ja_tutksuor_vanh_aseman_muk]'))
EXEC dbo.sp_executesql @statement = N'



CREATE VIEW [dbo].[v_sa_2_23_Opisk_ja_tutksuor_vanh_aseman_muk] AS
SELECT
	   [tilv]= cast(kaikkivuodet.tilv as nvarchar(4))
	  ,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	  ,[sp]= CAST(kaikkivuodet.sp as nvarchar (1))
      ,[syntv]= cast(kaikkivuodet.syntv as nvarchar(4))
      ,[aikielir1x]= cast (kaikkivuodet.aikielir1x as nvarchar(2))
      ,[tilvaskun]= cast (kaikkivuodet.tilvaskun as nvarchar(3))
      ,[tilvaskunx]= cast (kaikkivuodet.tilvaskunx as nvarchar(3))
      ,[sose_isa1]= cast (kaikkivuodet.sose_isa1 as nvarchar(1))
      ,[sose_aiti1]= cast (kaikkivuodet.sose_aiti1 as nvarchar(1))
      ,[sose_isa2]= cast (kaikkivuodet.sose_isa2 as nvarchar(2))
      ,[sose_aiti2]= cast (kaikkivuodet.sose_aiti2 as nvarchar(2))
      ,[koulk_isa]= cast (kaikkivuodet.koulk_isa as nvarchar(6))
      ,[koulk_aiti]= cast (kaikkivuodet.koulk_aiti as nvarchar(6))
      ,[tulo_isa]= cast (kaikkivuodet.tulo_isa as nvarchar(2))
      ,[tulo_aiti]= cast (kaikkivuodet.tulo_aiti as nvarchar(2))
      ,[klaji]= cast (kaikkivuodet.klaji as nvarchar(2))
      ,[ophal]= cast (kaikkivuodet.ophal as nvarchar(1))
      ,[koulk]= cast (kaikkivuodet.koulk as nvarchar(6))
      ,[kkieli]= cast (kaikkivuodet.kkieli as nvarchar(2))
      ,[kmaak]= cast (kaikkivuodet.kmaak as nvarchar(2))
      ,[alvv]= cast (kaikkivuodet.alvv as nvarchar(4))
      ,[olosyys]= cast (kaikkivuodet.olosyys as nvarchar(1))
      ,[uusi]= cast(kaikkivuodet.uusi as int)
      ,[opisk]= cast(kaikkivuodet.opisk as int)
      ,[tutk]= cast(kaikkivuodet.tutk as int)
   	  ,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(50))
	  ,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (

SELECT [tilv]
      ,[sp]
      ,(CASE WHEN [syntv] = ''XXXX'' THEN '''' else [syntv] end )as syntv
      ,[aikielir1x]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[sose_isa1]
      ,[sose_aiti1]
      ,[sose_isa2]
      ,[sose_aiti2]
      ,[koulk_isa]
      ,[koulk_aiti]
      ,[tulo_isa]
      ,[tulo_aiti]
      ,[klaji]
      ,[ophal]
      ,[koulk]
      ,[kkieli]
      ,[kmaak]
      ,[alvv]
      ,[olosyys]
      ,(CASE WHEN [uusi]= ''''THEN NULL else [uusi] end )as uusi
      ,(CASE WHEN [opisk] = '''' THEN NULL else [opisk] end )as opisk
      ,(CASE WHEN [tutk] = '''' THEN NULL else [tutk] end )as tutk
      ,[tietolahde]=''2_23_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_23_sopv_12]
union all
SELECT [tilv]
      ,[sp]
      ,(CASE WHEN [syntv] = ''XXXX'' THEN '''' else [syntv] end )as syntv
      ,[aikielir1x]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[sose_isa1]
      ,[sose_aiti1]
      ,[sose_isa2]
      ,[sose_aiti2]
      ,[koulk_isa]
      ,[koulk_aiti]
      ,[tulo_isa]
      ,[tulo_aiti]
      ,[klaji]
      ,[ophal]
      ,[koulk]
      ,[kkieli]
      ,[kmaak]
      ,[alvv]
      ,[olosyys]
      ,(CASE WHEN [uusi] = '''' THEN NULL else [uusi] end )as uusi
      ,(CASE WHEN [opisk] = '''' THEN NULL else [opisk] end )as opisk
      ,(CASE WHEN [tutk] = '''' THEN NULL else [tutk] end )as tutk
      ,[tietolahde]=''2_23_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_23_sopv_13]
union all
SELECT [tilv]
      ,[sp]
      ,(CASE WHEN [syntv] = ''XXXX'' THEN '''' else [syntv] end )as syntv
      ,[aikielir1x]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[sose_isa1]
      ,[sose_aiti1]
      ,[sose_isa2]
      ,[sose_aiti2]
      ,[koulk_isa]
      ,[koulk_aiti]
      ,[tulo_isa]
      ,[tulo_aiti]
      ,[klaji]
      ,[ophal]
      ,[koulk]
      ,[kkieli]
      ,[kmaak]
      ,[alvv]
      ,[olosyys]
       ,(CASE WHEN [uusi] = '''' THEN NULL else [uusi] end )as uusi
      ,(CASE WHEN [opisk] = '''' THEN NULL else [opisk] end )as opisk
      ,(CASE WHEN [tutk] = '''' THEN NULL else [tutk] end )as tutk
      ,[tietolahde]=''2_23_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_23_sopv_14]
  union all
 SELECT [tilv]
      ,[sp]
      ,(CASE WHEN [syntv] = ''XXXX'' THEN '''' else [syntv] end )as syntv
      ,[aikielir1x]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[sose_isa1]
      ,[sose_aiti1]
      ,[sose_isa2]
      ,[sose_aiti2]
      ,[koulk_isa]
      ,[koulk_aiti]
      ,[tulo_isa]
      ,[tulo_aiti]
      ,[klaji]
      ,[ophal]
      ,[koulk]
      ,[kkieli]
      ,[kmaak]
      ,[alvv]
      ,[olosyys]
       ,(CASE WHEN [uusi] = '''' THEN NULL else [uusi] end )as uusi
      ,(CASE WHEN [opisk] = '''' THEN NULL else [opisk] end )as opisk
      ,(CASE WHEN [tutk] = '''' THEN NULL else [tutk] end )as tutk
      ,[tietolahde]=''2_23_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_23_sopv_15]

   union all
 SELECT [tilv]
      ,[sp]
      ,(CASE WHEN [syntv] = ''XXXX'' THEN '''' else [syntv] end )as syntv
      ,[aikielir1x]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[sose_isa1]
      ,[sose_aiti1]
      ,[sose_isa2]
      ,[sose_aiti2]
      ,[koulk_isa]
      ,[koulk_aiti]
      ,[tulo_isa]
      ,[tulo_aiti]
      ,[klaji]
      ,[ophal]
      ,[koulk]
      ,[kkieli]
      ,[kmaak]
      ,[alvv]
      ,[olosyys]
       ,(CASE WHEN [uusi] = '''' THEN NULL else [uusi] end )as uusi
      ,(CASE WHEN [opisk] = '''' THEN NULL else [opisk] end )as opisk
      ,(CASE WHEN [tutk] = '''' THEN NULL else [tutk] end )as tutk
      ,[tietolahde]=''2_23_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_23_sopv_16]

   union all
 SELECT [tilv]
      ,[sp]
      ,(CASE WHEN [syntv] = ''XXXX'' THEN '''' else [syntv] end )as syntv
      ,[aikielir1x]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[sose_isa1]
      ,[sose_aiti1]
      ,[sose_isa2]
      ,[sose_aiti2]
      ,[koulk_isa]
      ,[koulk_aiti]
      ,[tulo_isa]
      ,[tulo_aiti]
      ,[klaji]
      ,[ophal]
      ,[koulk]
      ,[kkieli]
      ,[kmaak]
      ,[alvv]
      ,[olosyys]
       ,(CASE WHEN [uusi] = '''' THEN NULL else [uusi] end )as uusi
      ,(CASE WHEN [opisk] = '''' THEN NULL else [opisk] end )as opisk
      ,(CASE WHEN [tutk] = '''' THEN NULL else [tutk] end )as tutk
      ,[tietolahde]=''2_23_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_23_sopv_17]

 UNION ALL

 SELECT [tilv]
      ,[sp]
      ,(CASE WHEN [syntv] = ''XXXX'' THEN '''' else [syntv] end )as syntv
      ,[aikielir1x]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[sose_isa1]
      ,[sose_aiti1]
      ,[sose_isa2]
      ,[sose_aiti2]
      ,[koulk_isa]
      ,[koulk_aiti]
      ,[tulo_isa]
      ,[tulo_aiti]
      ,[klaji]
      ,[ophal]
      ,[koulk]
      ,[kkieli]
      ,[kmaak]
      ,[alvv]
      ,[olosyys]
       ,(CASE WHEN [uusi] = '''' THEN NULL else [uusi] end )as uusi
      ,(CASE WHEN [opisk] = '''' THEN NULL else [opisk] end )as opisk
      ,(CASE WHEN [tutk] = '''' THEN NULL else [tutk] end )as tutk
      ,[tietolahde]=''2_23_sopv_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_2_23_sopv_18]
 
 UNION ALL

 SELECT [tilv]
      ,[sp]
      ,(CASE WHEN [syntv] = ''XXXX'' THEN '''' else [syntv] end )as syntv
      ,[aikielir1x]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[sose_isa1]
      ,[sose_aiti1]
      ,[sose_isa2]
      ,[sose_aiti2]
      ,[koulk_isa]
      ,[koulk_aiti]
      ,[tulo_isa]
      ,[tulo_aiti]
      ,[klaji]
      ,[ophal]
      ,[koulk]
      ,[kkieli]
      ,[kmaak]
      ,[alvv]
      ,[olosyys]
       ,(CASE WHEN [uusi] = '''' THEN NULL else [uusi] end )as uusi
      ,(CASE WHEN [opisk] = '''' THEN NULL else [opisk] end )as opisk
      ,(CASE WHEN [tutk] = '''' THEN NULL else [tutk] end )as tutk
      ,[tietolahde]=''2_23_sopv_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
  FROM [TK_H9098_CSC].[dbo].[TK_K2_23_sopv_19] 


) as kaikkivuodet





' 
GO
/****** Object:  View [dbo].[v_sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat] AS


-- truncate table vipunentk_dw..sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat
-- insert into vipunentk_dw..sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat select * from v_sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat


SELECT
	tilv = CAST(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = Cast(kaikkivuodet.tilv+''0101'' as date)
	,lahde = cast(coalesce(nullif(kaikkivuodet.lahde , ''''), ''-1'') as nvarchar(2))
	,tunn = cast(coalesce(nullif(kaikkivuodet.tunn , ''''), ''-1'') as nvarchar(5))
	/* vanha
	CASE WHEN lahde = 34 and tunn = '''' THEN cast(coalesce(nullif(kaikkivuodet.opjarj, ''''), ''-1'')  as nvarchar(10))
			ELSE cast(coalesce(nullif(kaikkivuodet.tunn , ''''), ''-1'') as nvarchar(5))
			END   -- Ohjataan oppisopimuskoulutuksen lähteellä opjarj-muuttujan avain tyhjien arvojen tilalle - Lasse 26.5.2014

	*/
	,jarj = cast(coalesce(nullif(kaikkivuodet.jarj, ''''), ''-1'') as nvarchar(10))
	,opjarj = cast(coalesce(nullif(kaikkivuodet.opjarj, ''''), ''-1'')  as nvarchar(10))
	,koulk = cast(coalesce(nullif(kaikkivuodet.koulk , ''''), ''-1'') as nvarchar(6))
	,kkieli = cast(coalesce(nullif(kaikkivuodet.kkieli , ''''), ''-1'') as nvarchar(2))
	,kkun = cast(coalesce(nullif(kaikkivuodet.kkun , ''''), ''-1'') as nvarchar(3))
	,ophal = cast(coalesce(nullif(kaikkivuodet.ophal , ''''), ''-1'') as nvarchar(2))
	,sp = cast(coalesce(nullif(kaikkivuodet.sp , ''''), ''-1'') as nvarchar(2))
	,aikielir1 = cast(coalesce(nullif(kaikkivuodet.aikielir1 , ''''), ''-1'') as nvarchar(2))
	,alvv = cast(kaikkivuodet.alvv as nvarchar(4))
	,allk = cast(kaikkivuodet.allk as nvarchar(1))
	,olotamm = cast(kaikkivuodet.olotamm as nvarchar(1))
	,olosyys = cast(kaikkivuodet.olosyys as nvarchar(1))
	,aiopis = cast(coalesce(nullif(kaikkivuodet.aiopis , ''''), ''-1'') as nvarchar(2))
	,kirikar1 = cast(coalesce(nullif(nullif(kaikkivuodet.kirikar1 , '''') , ''XX''), ''-1'') as nvarchar(2))
	,lkm = cast(kaikkivuodet.lkm as int)
	,tutklajl = cast(coalesce(nullif(kaikkivuodet.tutklajl , ''''), ''-1'') as nvarchar(2))
	,aikoul = cast(coalesce(nullif(kaikkivuodet.aikoul , ''''), ''-1'') as nvarchar(2))
	,tutalv = cast(coalesce(nullif(kaikkivuodet.tutalv , ''''), ''-1'') as nvarchar(4))
	,tutalk = cast(coalesce(nullif(kaikkivuodet.tutalk , ''''), ''-1'') as nvarchar(2))
	,tutklaja = cast(coalesce(nullif(kaikkivuodet.tutklaja , ''''), ''-1'') as nvarchar(2))
	,tunim = cast(coalesce(nullif(kaikkivuodet.tunim , ''''), ''-1'') as nvarchar(5))
	,sutunim = cast(coalesce(nullif(kaikkivuodet.sutunim , ''''), ''-1'') as nvarchar(30))
	,rutunim = cast(coalesce(nullif(kaikkivuodet.rutunim , ''''), ''-1'') as nvarchar(30))
	,koohj = cast(coalesce(nullif(kaikkivuodet.koohj , ''''), ''-1'') as nvarchar(4))
	,sukoohj = cast(coalesce(nullif(kaikkivuodet.sukoohj , ''''), ''-1'') as nvarchar(60))
	,rukoohj = cast(coalesce(nullif(kaikkivuodet.rukoohj , ''''), ''-1'') as nvarchar(60))
	,tutktav = cast(coalesce(nullif(kaikkivuodet.tutktav , ''''), ''-1'') as nvarchar(2))
	,tyov = cast(coalesce(nullif(kaikkivuodet.tyov , ''''), ''-1'') as nvarchar(2))
	,rahoitus = cast(coalesce(nullif(kaikkivuodet.rahoitus , ''''), ''-1'') as nvarchar(2))
	,alaika = cast(VipunenTK_SA.[dbo].RefineDateBegin(kaikkivuodet.alaika) as nvarchar(8))
	,loaika = cast(VipunenTK_SA.[dbo].RefineDateEnd(kaikkivuodet.loaika) as nvarchar(8))
	,tavoite =  cast(coalesce(nullif(kaikkivuodet.tavoite,''''),''1'')  as nvarchar(2))   -- HUOM! tässä aineistossa tulkitaan tyhjät tutkinnon tavoitteet tarkoituksella arvoon "1 - koko tutkinnon suorittaminen" kuutiomääritelmän mukaan -- Lasse
	,yrit = cast(coalesce(nullif(kaikkivuodet.yrit , ''''), ''-1'') as nvarchar(2))
	,purku = cast(coalesce(nullif(kaikkivuodet.purku , ''''), ''-1'') as nvarchar(2))
	,todis = cast(coalesce(nullif(kaikkivuodet.todis , ''''), ''-1'') as nvarchar(2))
	,tol2008 = cast(coalesce(nullif(kaikkivuodet.tol2008 , ''''), ''-1'') as nvarchar(5))
	,koko = cast(coalesce(nullif(kaikkivuodet.koko , ''''), ''-1'') as nvarchar(2))
	,tyansek = cast(coalesce(nullif(kaikkivuodet.tyansek , ''''), ''-1'') as nvarchar(2))
	,tilvasmaak = case	when len(tilvasmaak) = 1 then ''0'' + cast(kaikkivuodet.tilvasmaak as nvarchar(2))
						else cast(coalesce(nullif(kaikkivuodet.tilvasmaak , ''''), ''-1'') as nvarchar(2))
				  end

	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as nvarchar(10))
FROM (

--Historia-aineisto
SELECT
	tilv
	, lahde = 
		case 
			when lahde=1 then ''21''
			when lahde=2 and oppis=2 then ''35''
			when lahde=2 and oppis=1 then ''34''
			else ''-1''
		end
	, tunn
	, jarj = op.koulutuksen_jarjestajakoodi
	, opjarj
	, koulk
	, kkieli = case kkielir1 when ''fs'' then ''fi'' else kkielir1 end
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis = 
		case 
			when ltrim(ika)=''.'' or alvv=''9999'' then ''9''
			else
				case
					when cast(ika as int)-(cast(tilv as int)-cast(alvv as int))<25 then ''1''
					else ''2''
				end
		end
	, kirikar1 = 
		case 
			when ltrim(ika)=''.'' then ''-1''
			else 
				case
					when cast(ika as int) between 15 and 19 then ''15''
					when cast(ika as int) between 20 and 24 then ''20''
					when cast(ika as int) between 25 and 29 then ''25''
					when cast(ika as int) between 30 and 34 then ''30''
					when cast(ika as int) between 35 and 39 then ''35''
					when cast(ika as int) between 40 and 44 then ''40''
					when cast(ika as int) between 45 and 49 then ''45''
					when cast(ika as int) between 50 and 54 then ''50''
					when cast(ika as int) between 55 and 59 then ''55''
					when cast(ika as int) > 60 then ''60''
					else ''-1''
				end
		end
	, lkm
	, tutklajl = 
		case 
			when koulk = ''301101'' then ''1''
			when koulk = ''301102'' then ''2''--IB
			when koulk = ''301103'' then ''3''--Reifeprüfung
			when koulk = ''309901'' then ''4''--Gymnasieexamen
			when koulk = ''301104'' then ''5''--EB
			else ''-1''
		end
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim = null
	, sutunim = null
	, rutunim = null
	, koohj = null
	, sukoohj = null
	, rukoohj = null
	, tutktav
	, tyov
	, rahoitus
	, alaika = null
	, loaika = null
	, tavoite
	, yrit = null
	, purku = null
	, todis = null
	, tol2008 = null
	, koko = null
	, tyansek = null
	, tilvasmaak = asmaak
	,[tietolahde]=''8_2_Historia_aineisto_opiskelijat''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_8_2_sopv_16] tk
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot op on op.oppilaitos_avain=tk.tunn
where lahde in (1,2) and tilv<2010

UNION ALL

SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika 
	, loaika 
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3a_Lukio_ja_amm_koulutuksen_opiskelijat_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3a_sopv_11]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun =
		CASE 
			WHEN len(kkun) = 1 THEN ''00'' + kkun
			WHEN len(kkun) = 2 THEN ''0'' + kkun
			ELSE kkun
		END
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3b_Lukio_ja_amm_koulutuksen_opiskelijat_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3b_sopv_11]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3c_Lukio_ja_amm_koulutuksen_opiskelijat_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3c_sopv_11]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3d_Lukio_ja_amm_koulutuksen_opiskelijat_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3d_sopv_11]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3a_Lukio_ja_amm_koulutuksen_opiskelijat_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3a_sopv_12]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3b_Lukio_ja_amm_koulutuksen_opiskelijat_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3b_sopv_12]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3c_Lukio_ja_amm_koulutuksen_opiskelijat_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3c_sopv_12]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3d_Lukio_ja_amm_koulutuksen_opiskelijat_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3d_sopv_12]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3a_Lukio_ja_amm_koulutuksen_opiskelijat_113''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3a_sopv_13]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3b_Lukio_ja_amm_koulutuksen_opiskelijat_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3b_sopv_13]

union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3c_Lukio_ja_amm_koulutuksen_opiskelijat_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3c_sopv_13]

union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3d_Lukio_ja_amm_koulutuksen_opiskelijat_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3d_sopv_13]

union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3a_Lukio_ja_amm_koulutuksen_opiskelijat_14''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3a_sopv_14]

/* aineistot 14b, 14c rikki vielä -- Lasse 27.11.2014 
Otettu mukaan 20.1.2015 / Jarmo */
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3b_Lukio_ja_amm_koulutuksen_opiskelijat_14''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3b_sopv_14]

union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3c_Lukio_ja_amm_koulutuksen_opiskelijat_14''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3c_sopv_14]
/* Otettu mukaan 20.1.2015 / Jarmo 
*/

union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3a_Lukio_ja_amm_koulutuksen_opiskelijat_15''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3a_sopv_15]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3b_Lukio_ja_amm_koulutuksen_opiskelijat_15''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3b_sopv_15]

union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3c_Lukio_ja_amm_koulutuksen_opiskelijat_15''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3c_sopv_15]
union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3a_Lukio_ja_amm_koulutuksen_opiskelijat_16''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3a_sopv_16]
-- Tarjolla on myös TK_2_3e_sopv_15 mutta e-aineistoja ei ole aiempiakaan, joten sitä ei oteta mukaan. / CSC Jarmo 3.8.2015



union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3b_Lukio_ja_amm_koulutuksen_opiskelijat_16''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3b_sopv_16]


union all
SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3c_Lukio_ja_amm_koulutuksen_opiskelijat_16''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3c_sopv_16]

union all


SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3a_Lukio_ja_amm_koulutuksen_opiskelijat_17''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3a_sopv_17]

union all


SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3b_Lukio_ja_amm_koulutuksen_opiskelijat_17''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3b_sopv_17]


union all


SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3c_Lukio_ja_amm_koulutuksen_opiskelijat_17''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3c_sopv_17]

union all

SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3a_Lukio_ja_amm_koulutuksen_opiskelijat_18''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3a_sopv_18]

union all


SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3b_Lukio_ja_amm_koulutuksen_opiskelijat_18''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3b_sopv_18]


union all


SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3c_Lukio_ja_amm_koulutuksen_opiskelijat_18''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3c_sopv_18]

union all

SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit = NULL
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3a_Lukio_ja_amm_koulutuksen_opiskelijat_19''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_K2_3a_sopv_19]

union all

SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit = NULL
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3b_Lukio_ja_amm_koulutuksen_opiskelijat_19''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_K2_3b_sopv_19]

union all

SELECT
	tilv
	, lahde
	, tunn
	, jarj
	, opjarj
	, koulk
	, kkieli
	, kkun
	, ophal
	, sp
	, aikielir1
	, alvv
	, allk
	, olotamm
	, olosyys
	, aiopis
	, kirikar1
	, lkm
	, tutklajl
	, aikoul
	, tutalv
	, tutalk
	, tutklaja
	, tunim
	, sutunim
	, rutunim
	, koohj
	, sukoohj
	, rukoohj
	, tutktav
	, tyov
	, rahoitus
	, alaika
	, loaika
	, tavoite
	, yrit = NULL
	, purku
	, todis
	, tol2008
	, koko
	, tyansek
	, tilvasmaak
	,[tietolahde]=''2_3c_Lukio_ja_amm_koulutuksen_opiskelijat_19''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_K2_3c_sopv_19]

) kaikkivuodet




' 
GO
/****** Object:  View [dbo].[v_sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat] AS


-- truncate table vipunentk_dw..sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat
-- insert into vipunentk_dw..sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat select * from v_sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat




SELECT
	tilv = CAST(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = Cast(kaikkivuodet.tilv+''0101'' as date)
	,lahde = cast(coalesce(nullif(kaikkivuodet.lahde , ''''), ''-1'') as nvarchar(2))
	,jarj = cast(coalesce(nullif(kaikkivuodet.jarj, ''''), ''-1'') as nvarchar(10))
	,opjarj = cast(coalesce(nullif(kaikkivuodet.opjarj, ''''), ''-1'')  as nvarchar(10))
	,kkieli = cast(coalesce(nullif(kaikkivuodet.kkieli , ''''), ''-1'') as nvarchar(2))
	,koulk = cast(coalesce(nullif(kaikkivuodet.koulk , ''''), ''-1'') as nvarchar(6))
	,kkun = cast(coalesce(nullif(kaikkivuodet.kkun , ''''), ''-1'') as nvarchar(3))
	,ophal = cast(coalesce(nullif(kaikkivuodet.ophal , ''''), ''-1'') as nvarchar(2))
	,sp = cast(coalesce(nullif(kaikkivuodet.sp , ''''), ''-1'') as nvarchar(2))
	,aikielir1 = cast(coalesce(nullif(kaikkivuodet.aikielir1 , ''''), ''-1'') as nvarchar(2))
	,tilvasmaak = cast(coalesce(nullif(kaikkivuodet.tilvasmaak , ''''), ''-1'') as nvarchar(2))
	,alvv = cast(kaikkivuodet.alvv as nvarchar(4))	
	,aiopis = cast(coalesce(nullif(kaikkivuodet.aiopis , ''''), ''-1'') as nvarchar(2))
	,ika2 = cast(coalesce(nullif(kaikkivuodet.ika2, ''''), ''-1'') as nvarchar(2))
	,lkm = cast(kaikkivuodet.lkm as int)
	,aikoul = cast(coalesce(nullif(kaikkivuodet.aikoul , ''''), ''-1'') as nvarchar(2))
	,tutalv = cast(coalesce(nullif(kaikkivuodet.tutalv , ''''), ''-1'') as nvarchar(4))
	,tutklaja = cast(coalesce(nullif(kaikkivuodet.tutklaja , ''''), ''-1'') as nvarchar(2))
	,tunim = cast(coalesce(nullif(kaikkivuodet.tunim , ''''), ''-1'') as nvarchar(255))
	,sutunim = cast(coalesce(nullif(kaikkivuodet.sutunim , ''''), ''-1'') as nvarchar(255))
	,rutunim = cast(coalesce(nullif(kaikkivuodet.rutunim , ''''), ''-1'') as nvarchar(255))
	,koohj = cast(coalesce(nullif(kaikkivuodet.koohj , ''''), ''-1'') as nvarchar(100))
	,sukoohj = cast(coalesce(nullif(kaikkivuodet.sukoohj , ''''), ''-1'') as nvarchar(100))
	,rukoohj = cast(coalesce(nullif(kaikkivuodet.rukoohj , ''''), ''-1'') as nvarchar(100))
	,tutktav = cast(coalesce(nullif(kaikkivuodet.tutktav , ''''), ''-1'') as nvarchar(2))
	,rahoitus = cast(coalesce(nullif(kaikkivuodet.rahoitus , ''''), ''-1'') as nvarchar(2))
	,tavoite =  cast(coalesce(nullif(kaikkivuodet.tavoite,''''),''-1'')  as nvarchar(2))   -- HUOM! tässä aineistossa tulkitaan tyhjät tutkinnon tavoitteet tarkoituksella arvoon "1 - koko tutkinnon suorittaminen" kuutiomääritelmän mukaan -- Lasse
	,olosyys = cast(kaikkivuodet.olosyys as nvarchar(1))
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as nvarchar(10))
FROM (
/* Ei oteta historiatietoja mukaan koska vuosilta 2011-2012 ei ole dataa
--Historia-aineisto
SELECT
	  [tilv]
      ,[lahde] = 
		case
			when lahde = ''1'' then ''21''
			when lahde = ''2'' and oppis = ''2'' then ''35''
			when lahde = ''2'' and oppis = ''1'' then ''34''
			else ''-1''
		end
      ,[jarj] = ot.koulutuksen_jarjestajakoodi
      ,[opjarj]
      ,[koulk]
      ,kkieli = case [kkielir1] when ''fs'' then ''fi'' else kkielir1 end
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak] = asmaak
      ,[alvv]
      ,[aiopis] = null
      ,ika2 = --ikä kirjoihintulovuonna
		case  
			when ltrim([ika])=''.'' or alvv=''9999'' then ''XX'' 
			else 
				case 
					when cast(ltrim([ika]) as int)-(cast(tilv as int)-cast(alvv as int))>=60 then ''60''
					else cast(cast(ltrim([ika]) as int)-(cast(tilv as int)-cast(alvv as int)) as varchar)
				end
		end
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim] = null
      ,[sutunim] = null
      ,[rutunim] = null
      ,[koohj] = null
      ,[sukoohj] = null
      ,[rukoohj] = null
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''8_2_Historia_opiskelijat''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_8_2_sopv_16] tk
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot ot on ot.oppilaitos_avain=tk.tunn
where lahde in (1,2) and tilv<2013

UNION ALL
*/
SELECT
	  [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3e_Lukio_ja_amm_koulutuksen_opiskelijat_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3e_sopv_14]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3f_Lukio_ja_amm_koulutuksen_opiskelijat_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3f_sopv_14]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3g_Lukio_ja_amm_koulutuksen_opiskelijat_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3g_sopv_14]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3e_Lukio_ja_amm_koulutuksen_opiskelijat_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3e_sopv_15]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3f_Lukio_ja_amm_koulutuksen_opiskelijat_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3f_sopv_15]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3g_Lukio_ja_amm_koulutuksen_opiskelijat_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3g_sopv_15]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3e_Lukio_ja_amm_koulutuksen_opiskelijat_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3e_sopv_16]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3f_Lukio_ja_amm_koulutuksen_opiskelijat_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3f_sopv_16]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3g_Lukio_ja_amm_koulutuksen_opiskelijat_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3g_sopv_16]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3e_Lukio_ja_amm_koulutuksen_opiskelijat_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3e_sopv_17]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3f_Lukio_ja_amm_koulutuksen_opiskelijat_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3f_sopv_17]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3g_Lukio_ja_amm_koulutuksen_opiskelijat_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3g_sopv_17]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3e_Lukio_ja_amm_koulutuksen_opiskelijat_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3e_sopv_18]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3f_Lukio_ja_amm_koulutuksen_opiskelijat_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3f_sopv_18]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3g_Lukio_ja_amm_koulutuksen_opiskelijat_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3g_sopv_18]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3e_Lukio_ja_amm_koulutuksen_opiskelijat_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_K2_3e_sopv_19]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3f_Lukio_ja_amm_koulutuksen_opiskelijat_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_K2_3f_sopv_19]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[tilvasmaak]
      ,[alvv]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
      ,[olosyys]
	  ,[tietolahde]=''2_3g_Lukio_ja_amm_koulutuksen_opiskelijat_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_K2_3g_sopv_19]
) kaikkivuodet


' 
GO
/****** Object:  View [dbo].[v_sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat]'))
EXEC dbo.sp_executesql @statement = N'





CREATE VIEW [dbo].[v_sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat] AS


-- truncate table vipunentk_dw..sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat
-- insert into vipunentk_dw..sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat select * from v_sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat


SELECT
	tilv = CAST(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = Cast(kaikkivuodet.tilv+''0101'' as date)
	,lahde = cast(coalesce(nullif(kaikkivuodet.lahde , ''''), ''-1'') as nvarchar(2))
	,tunn = cast(coalesce(nullif(kaikkivuodet.tunn , ''''), ''-1'') as nvarchar(5))
	,jarj = cast(coalesce(nullif(kaikkivuodet.jarj, ''''), ''-1'') as nvarchar(10))
	,opjarj = cast(coalesce(nullif(kaikkivuodet.opjarj, ''''), ''-1'')  as nvarchar(10))
	,opmast = cast(coalesce(nullif(kaikkivuodet.opmast , ''''), ''-1'') as nvarchar(6))
	,kaste_t2 = cast(coalesce(nullif(kaikkivuodet.kaste_t2 , ''''), ''-1'') as nvarchar(6))
	,opmala = cast(coalesce(nullif(kaikkivuodet.opmala , ''''), ''-1'') as nvarchar(6))
	,iscfibroad2013 = cast(coalesce(nullif(kaikkivuodet.iscfibroad2013 , ''''), ''-1'') as nvarchar(6))
	,kkieli = cast(coalesce(nullif(kaikkivuodet.kkieli , ''''), ''-1'') as nvarchar(2))
	,kkun = cast(coalesce(nullif(kaikkivuodet.kkun , ''''), ''-1'') as nvarchar(3))
	,ophal = cast(coalesce(nullif(kaikkivuodet.ophal , ''''), ''-1'') as nvarchar(2))
	,tilvaskun = cast(coalesce(nullif(kaikkivuodet.tilvaskun , ''''), ''-1'') as nvarchar(3))
	,tilvaskunx = cast(coalesce(nullif(kaikkivuodet.tilvaskunx , ''''), ''-1'') as nvarchar(3))
	,alvv = cast(kaikkivuodet.alvv as nvarchar(4))	
	,kirikar1 = cast(coalesce(nullif(kaikkivuodet.kirikar1 , ''''), ''-1'') as nvarchar(2))
	,lkm = cast(kaikkivuodet.lkm as int)
	,tutklajl = cast(coalesce(nullif(kaikkivuodet.tutklajl , ''''), ''-1'') as nvarchar(2))
	,aikoul = cast(coalesce(nullif(kaikkivuodet.aikoul , ''''), ''-1'') as nvarchar(2))
	,tutklaja = cast(coalesce(nullif(kaikkivuodet.tutklaja , ''''), ''-1'') as nvarchar(2))
	,tutktav = cast(coalesce(nullif(kaikkivuodet.tutktav , ''''), ''-1'') as nvarchar(2))
	,tyov = cast(coalesce(nullif(kaikkivuodet.tyov , ''''), ''-1'') as nvarchar(2))
	,rahoitus = cast(coalesce(nullif(kaikkivuodet.rahoitus , ''''), ''-1'') as nvarchar(2))
	,tavoite =  cast(coalesce(nullif(kaikkivuodet.tavoite,''''),''1'')  as nvarchar(2))   -- HUOM! tässä aineistossa tulkitaan tyhjät tutkinnon tavoitteet tarkoituksella arvoon "1 - koko tutkinnon suorittaminen" kuutiomääritelmän mukaan -- Lasse
	,yrit = cast(coalesce(nullif(kaikkivuodet.yrit , ''''), ''-1'') as nvarchar(2))
	,olosyys = cast(kaikkivuodet.olosyys as nvarchar(1))
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as nvarchar(10))
FROM (
SELECT
	   [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[opmast]
	  ,[kaste_t2] 
      ,[opmala]
	  ,[iscfibroad2013]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[alvv]
      ,[kirikar1]
      ,[lkm]
      ,[tutklajl]
      ,[aikoul]
      ,[tutklaja]
      ,[tutktav]
      ,[tyov]
      ,[rahoitus]
      ,[tavoite]
      ,[yrit]
      ,[olosyys]
	  ,[tietolahde]=''2_3h_Lukio_ja_amm_koulutuksen_opiskelijat_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3h_2013_sopv_15_H]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[opmast]
	  ,[kaste_t2] 
      ,[opmala]
	  ,[iscfibroad2013] 
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[alvv]
      ,[kirikar1]
      ,[lkm]
      ,[tutklajl]
      ,[aikoul]
      ,[tutklaja]
      ,[tutktav]
      ,[tyov]
      ,[rahoitus]
      ,[tavoite]
      ,[yrit]
      ,[olosyys]
	  ,[tietolahde]=''2_3h_Lukio_ja_amm_koulutuksen_opiskelijat_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3h_2014_sopv_15_H]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[opmast]
	  ,[kaste_t2]
      ,[opmala]
	  ,[iscfibroad2013] 
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[alvv]
      ,[kirikar1]
      ,[lkm]
      ,[tutklajl]
      ,[aikoul]
      ,[tutklaja]
      ,[tutktav]
      ,[tyov]
      ,[rahoitus]
      ,[tavoite]
      ,[yrit]
      ,[olosyys]
	  ,[tietolahde]=''2_3h_Lukio_ja_amm_koulutuksen_opiskelijat_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3h_sopv_16_H]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[opmast]
	  ,[kaste_t2] 
      ,[opmala]
	  ,[iscfibroad2013] 
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[alvv]
      ,[kirikar1]
      ,[lkm]
      ,[tutklajl]
      ,[aikoul]
      ,[tutklaja]
      ,[tutktav]
      ,[tyov]
      ,[rahoitus]
      ,[tavoite]
      ,[yrit]
      ,[olosyys]
	  ,[tietolahde]=''2_3h_Lukio_ja_amm_koulutuksen_opiskelijat_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3h_sopv_17_H]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[opmast] = NULL
	  ,[kaste_t2]
      ,[opmala] = NULL
	  ,[iscfibroad2013]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[alvv]
      ,[kirikar1]
      ,[lkm]
      ,[tutklajl]
      ,[aikoul]
      ,[tutklaja]
      ,[tutktav]
      ,[tyov]
      ,[rahoitus]
      ,[tavoite]
      ,[yrit]
      ,[olosyys]
	  ,[tietolahde]=''2_3h_Lukio_ja_amm_koulutuksen_opiskelijat_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3h_sopv_18]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[opmast] = NULL
	  ,[kaste_t2]
      ,[opmala] = NULL
	  ,[iscfibroad2013]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[tilvaskun]
      ,[tilvaskunx]
      ,[alvv]
      ,[kirikar1]
      ,[lkm]
      ,[tutklajl]
      ,[aikoul]
      ,[tutklaja]
      ,[tutktav]
      ,[tyov]
      ,[rahoitus]
      ,[tavoite]
      ,[yrit] = NULL
      ,[olosyys]
	  ,[tietolahde]=''2_3h_Lukio_ja_amm_koulutuksen_opiskelijat_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_3h_sopv_19]

) kaikkivuodet






' 
GO
/****** Object:  View [dbo].[v_sa_2_4_Amm_koulutuksen_tutkinnot]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_4_Amm_koulutuksen_tutkinnot]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_sa_2_4_Amm_koulutuksen_tutkinnot] AS

-- truncate table vipunentk_dw..sa_2_4_Amm_koulutuksen_tutkinnot
-- insert into vipunentk_dw..sa_2_4_Amm_koulutuksen_tutkinnot select * from v_sa_2_4_Amm_koulutuksen_tutkinnot

SELECT
	 tilv = CAST(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = Cast(kaikkivuodet.tilv+''0101'' as date)
	,lahde = CAST(kaikkivuodet.lahde as nvarchar(2))
	,tunn = cast(coalesce(nullif(kaikkivuodet.tunn , ''''), ''-1'') as nvarchar(5))
	
	/* vanha
	CASE WHEN lahde = 34 and tunn = '''' THEN cast(coalesce(nullif(kaikkivuodet.opjarj, ''''), ''-1'')  as nvarchar(10))
			ELSE cast(coalesce(nullif(kaikkivuodet.tunn , ''''), ''-1'') as nvarchar(5))
			END   -- Ohjataan oppisopimuskoulutuksen lähteellä opjarj-muuttujan avain tyhjien arvojen tilalle - Lasse 26.5.2014
			*/
--	,tunn = CAST(kaikkivuodet.tunn as nvarchar(5))
	,jarj = CAST(kaikkivuodet.jarj as nvarchar(10))
	,opjarj = CAST(kaikkivuodet.opjarj as nvarchar(10))
	,koulk = CAST(kaikkivuodet.koulk as nvarchar(6))
	,tunim = CAST(kaikkivuodet.tunim as nvarchar(5))
	,sutunim = CAST(kaikkivuodet.sutunim as nvarchar(30))
	,rutunim = CAST(kaikkivuodet.rutunim as nvarchar(30))
	,koohj = CAST(kaikkivuodet.koohj as nvarchar(4))
	,sukoohj = CAST(kaikkivuodet.sukoohj as nvarchar(60))
	,rukoohj = CAST(kaikkivuodet.rukoohj as nvarchar(60))
	,tutklaja = CAST(kaikkivuodet.tutklaja as nvarchar(1))
	,tutktav = CAST(kaikkivuodet.tutktav as nvarchar(1))
	,kkieli = CAST(kaikkivuodet.kkieli as nvarchar(2))
	,kkun = CAST(kaikkivuodet.kkun as nvarchar(3))
	,ophal = CAST(coalesce(nullif(kaikkivuodet.ophal,''''),''1'') as nvarchar(2))
	,sp = CAST(kaikkivuodet.sp as nvarchar(1))
	,aikielir1 = CAST(kaikkivuodet.aikielir1 as nvarchar(2))
	,alvv = CAST(kaikkivuodet.alvv as nvarchar(4))
	,allk = CAST(kaikkivuodet.allk as nvarchar(1))
	,aiopis = CAST(kaikkivuodet.aiopis as nvarchar(1))
	,aikoul = CAST(kaikkivuodet.aikoul as nvarchar(1)) -- uusi sarake 2012

	--,kirikar1 = CAST(kaikkivuodet.kirikar1 as nvarchar(2))
	,kirikar1 = cast(coalesce(nullif(nullif(kaikkivuodet.kirikar1 , '''') , ''XX''), ''-1'') as nvarchar(2))

	,suorpvm = CAST(kaikkivuodet.suorpvm as nvarchar(8))
	,lkm = CAST(kaikkivuodet.lkm as int)
	,tutalv = CAST(kaikkivuodet.tutalv as nvarchar(4))
	,tutalk = CAST(kaikkivuodet.tutalk as nvarchar(1))
	,hyvennen = CAST(kaikkivuodet.hyvennen as int)
	,hyvaik = CAST(kaikkivuodet.hyvaik as int)
	,suorkouaik = CAST(kaikkivuodet.suorkouaik as int) -- nimi muuttunut 2012
	,ovyht = CAST(kaikkivuodet.ovyht as int)
	,tyop = CAST(kaikkivuodet.tyop as int)
	,ammos = CAST(kaikkivuodet.ammos as int)
	,opintokok = CAST(kaikkivuodet.opintokok as int)
	,tyov = CAST(kaikkivuodet.tyov as nvarchar(1))
	,rahoitus = CAST(kaikkivuodet.rahoitus as nvarchar(1))
	,vayla = CAST(kaikkivuodet.vayla as nvarchar(1))
	,alaika = CAST(VipunenTK_SA.[dbo].RefineDateBegin(kaikkivuodet.alaika) as nvarchar(8))
	,loaika = CAST(VipunenTK_SA.[dbo].RefineDateEnd(kaikkivuodet.loaika) as nvarchar(8))
	,tavoite =  cast(coalesce(nullif(kaikkivuodet.tavoite,''''),''1'')  as nvarchar(2))   -- HUOM! tässä aineistossa tulkitaan tyhjät tutkinnon tavoitteet tarkoituksella arvoon "1 - koko tutkinnon suorittaminen" kuutiomääritelmän mukaan -- Lasse	

	--,toteuma_tutk  = CAST(kaikkivuodet.toteuma_tutk as nvarchar(1)) -- nimi muuttunut 2012
	
	,toteuma_tutk = 
	CASE 
		WHEN lahde = 32 THEN 1
		ELSE CAST(kaikkivuodet.toteuma_tutk as nvarchar(1))
	END        -- Opetussuunnitelmaperusteisen ammatillisen tutkinnon suorittaneet tulkitaan "suorittanut koko tutkinnon" -- 26.6.2014 Lasse

	,yrit = CAST(kaikkivuodet.yrit as nvarchar(1))
	,purku = CAST(kaikkivuodet.purku as nvarchar(1))
	,todis = CAST(kaikkivuodet.todis as nvarchar(1))
	,tol2008 = CAST(kaikkivuodet.tol2008 as nvarchar(5))
	,koko = CAST(kaikkivuodet.koko as nvarchar(1))
	,tyansek = CAST(kaikkivuodet.tyansek as nvarchar(1))
	,suorosat   = CAST(kaikkivuodet.suorosat as int)
	,tunn_opisk = cast(coalesce(nullif(kaikkivuodet.tunn_opisk , ''''), ''-1'') as nvarchar(5))
	,jarj_opisk = cast(coalesce(nullif(kaikkivuodet.jarj_opisk , ''''), ''-1'') as nvarchar(10))
	,kkun_opisk = cast(coalesce(nullif(kaikkivuodet.kkun_opisk , ''''), ''-1'') as nvarchar(3))
	,tietolahde = CAST(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = CAST(kaikkivuodet.rivinumero as nvarchar(10))


  FROM (
  
--Historia-aineisto
select
	tilv = left(suoraika,4)
	,lahde = 
		case 
			when lahde=1 then ''22''
			when lahde=2 and oppis=2 then ''35''
			when lahde=2 and oppis=1 then ''34''
			else ''-1''
		end
	,tunn = oltunnus
	,jarj = op.koulutuksen_jarjestajakoodi
	,opjarj
	,koulk
	,tunim = null
	,sutunim = null
	,rutunim = null
	,koohj = null
	,sukoohj = null
	,rukoohj = null
	,tutklaja
	,tutktav = case when kouljat=1 and lahde=2 then ''1'' when kouljat=8 and lahde=2 then ''2'' when kouljat not in (1,8) and lahde=2 then ''9'' else ''-1'' end
	,kkieli = case kkielir1 when ''fs'' then ''fi'' else kkielir1 end
	,kkun
	,ophal = null
	,sp
	,aikielir1
	,alvv = case alvv when ''BBBB'' then ''9999'' else alvv end
	,allk
	,aiopis = 
		case 
			when syntv=''19XX'' or alvv=''BBBB'' then ''9''
			else
				case
					when cast(cast(left(suoraika,4) as int)-syntv as int)-(cast(left(suoraika,4) as int)-cast(alvv as int))<25 then ''1''
					else ''2''
				end
		end
	,aikoul = case when kouljat=1 and lahde=1 then ''1'' when kouljat=3 and lahde=1 then ''2'' else ''-1'' end
	,kirikar1 =
		case 
			when syntv=''19XX'' then ''-1''
			else 
				case
					when cast(left(suoraika,4) as int)-syntv between 15 and 19 then ''15''
					when cast(left(suoraika,4) as int)-syntv between 20 and 24 then ''20''
					when cast(left(suoraika,4) as int)-syntv between 25 and 29 then ''25''
					when cast(left(suoraika,4) as int)-syntv between 30 and 34 then ''30''
					when cast(left(suoraika,4) as int)-syntv between 35 and 39 then ''35''
					when cast(left(suoraika,4) as int)-syntv between 40 and 44 then ''40''
					when cast(left(suoraika,4) as int)-syntv between 45 and 49 then ''45''
					when cast(left(suoraika,4) as int)-syntv between 50 and 54 then ''50''
					when cast(left(suoraika,4) as int)-syntv between 55 and 59 then ''55''
					when cast(left(suoraika,4) as int)-syntv > 60 then ''60''
					else ''-1''
				end
		end
	,suorpvm = CONVERT (VARCHAR(8), suoraika, 112)
	,lkm
	,tutalv = null
	,tutalk = null
	,hyvennen = null
	,hyvaik = null
	,suorkouaik = null
	,ovyht = null
	,tyop = null
	,ammos = null
	,opintokok = null
	,tyov = null
	,rahoitus = null
	,vayla = null
	,alaika = null
	,loaika = null
	,tavoite = null
	,toteuma_tutk = 1 --aineistossa vain koko tutkinnon suorittaneet
	,yrit = null
	,purku = null
	,todis = null
	,tol2008 = null
	,koko = null
	,tyansek = null
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''8_1_Historia_aineisto_tutkinnot''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_8_1_sopv_16] tk
left join VipunenTK.dbo.d_oppilaitoksen_taustatiedot op on op.oppilaitos_avain=tk.oltunnus
WHERE lahde IN (1,2)

UNION ALL

select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	,null as aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4a_sopv_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4a_sopv_11]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	,null as aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4b_sopv_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4b_sopv_11]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	,null as aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4c_sopv_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4c_sopv_11]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4a_sopv_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4a_sopv_12]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4b_sopv_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4b_sopv_12]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4c_sopv_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4c_sopv_12]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	, suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	, toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4d_sopv_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4d_sopv_12]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul = NULL -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4a_sopv_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4a_sopv_13]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
    ,[alaika]-- = CONVERT (VARCHAR(8), cast([alaika]+''01'' as date), 112)
    ,[loaika]-- = CONVERT (VARCHAR(8), cast([loaika]+''01'' as date), 112)
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4b_sopv_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4b_sopv_13]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4c_sopv_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4c_sopv_13]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm = CONVERT (VARCHAR(8), suorpvm, 112)
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	, suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika-- = CONVERT(VARCHAR(8), alaika, 112)
	,loaika-- = CONVERT(VARCHAR(8), loaika, 112)
	,tavoite
	, toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,NULL AS suorosat
	,''-1'' AS tunn_opisk
	,''-1'' AS jarj_opisk
	,''-1'' AS kkun_opisk
	,[tietolahde]=''2_4d_sopv_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4d_sopv_13]

/* 14a, 14b ja 14c aineistot vielä rikki -- Lasse 27.11.2014
Otettu mukaan 20.1.2015 / Jarmo */

union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul = NULL -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4a_sopv_14''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4a_sopv_14]

union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
    ,[alaika]-- = CONVERT (VARCHAR(10), [alaika], 112)
    ,[loaika]-- = CONVERT (VARCHAR(10), [loaika], 112)
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4b_sopv_14''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4b_sopv_14]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4c_sopv_14''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4c_sopv_14]
/* Otettu mukaan 20.1.2015 / Jarmo 
*/

union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul = NULL -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4a_sopv_15''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4a_sopv_15]

union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
    ,[alaika]-- = CONVERT (VARCHAR(10), [alaika], 112)
    ,[loaika]-- = CONVERT (VARCHAR(10), [loaika], 112)
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4b_sopv_15''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4b_sopv_15]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4c_sopv_15''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4c_sopv_15]

union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul = NULL -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4a_sopv_16''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4a_sopv_16]

union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
    ,[alaika]-- = CONVERT (VARCHAR(10), [alaika], 112)
    ,[loaika]-- = CONVERT (VARCHAR(10), [loaika], 112)
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4b_sopv_16''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4b_sopv_16]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen
	,hyvaik
	,suorkouaik -- nimi muuttunut 2012
	,ovyht
	,tyop
	,ammos
	,opintokok
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4c_sopv_16''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4c_sopv_16]






union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul = NULL -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen = NULL
	,hyvaik = NULL
	,suorkouaik = NULL
	,ovyht = NULL
	,tyop = NULL
	,ammos = NULL
	,opintokok = NULL
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4a_sopv_17''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4a_sopv_17]

union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen = NULL
	,hyvaik = NULL
	,suorkouaik = NULL
	,ovyht = NULL
	,tyop = NULL
	,ammos = NULL
	,opintokok = NULL
	,tyov
	,rahoitus
	,vayla
    ,[alaika]-- = CONVERT (VARCHAR(10), [alaika], 112)
    ,[loaika]-- = CONVERT (VARCHAR(10), [loaika], 112)
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4b_sopv_17''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4b_sopv_17]
union all
select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen = NULL
	,hyvaik = NULL
	,suorkouaik = NULL
	,ovyht = NULL
	,tyop = NULL
	,ammos = NULL
	,opintokok = NULL
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4c_sopv_17''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4c_sopv_17]

union all

select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul = NULL -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen = NULL
	,hyvaik = NULL
	,suorkouaik = NULL
	,ovyht = NULL
	,tyop = NULL
	,ammos = NULL
	,opintokok = NULL
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4a_sopv_18''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4a_sopv_18]

union all

select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen = NULL
	,hyvaik = NULL
	,suorkouaik = NULL
	,ovyht = NULL
	,tyop = NULL
	,ammos = NULL
	,opintokok = NULL
	,tyov
	,rahoitus
	,vayla
    ,[alaika]-- = CONVERT (VARCHAR(10), [alaika], 112)
    ,[loaika]-- = CONVERT (VARCHAR(10), [loaika], 112)
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4b_sopv_18''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4b_sopv_18]

union all

select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen = NULL
	,hyvaik = NULL
	,suorkouaik = NULL
	,ovyht = NULL
	,tyop = NULL
	,ammos = NULL
	,opintokok = NULL
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4c_sopv_18''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4c_sopv_18]

union all

select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul = NULL -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen = NULL
	,hyvaik = NULL
	,suorkouaik = NULL
	,ovyht = NULL
	,tyop = NULL
	,ammos = NULL
	,opintokok = NULL
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit = NULL
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4a_sopv_19''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_K2_4a_sopv_19]

union all

select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen = NULL
	,hyvaik = NULL
	,suorkouaik = NULL
	,ovyht = NULL
	,tyop = NULL
	,ammos = NULL
	,opintokok = NULL
	,tyov
	,rahoitus
	,vayla
    ,[alaika]-- = CONVERT (VARCHAR(10), [alaika], 112)
    ,[loaika]-- = CONVERT (VARCHAR(10), [loaika], 112)
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit = NULL
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4b_sopv_19''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_K2_4b_sopv_19]

union all

select
	tilv
	,lahde
	,tunn
	,jarj
	,opjarj
	,koulk
	,tunim
	,sutunim
	,rutunim
	,koohj
	,sukoohj
	,rukoohj
	,tutklaja
	,tutktav
	,kkieli
	,kkun
	,ophal
	,sp
	,aikielir1
	,alvv
	,allk
	,aiopis
	, aikoul -- uusi sarake 2012
	,kirikar1
	,suorpvm
	,lkm
	,tutalv
	,tutalk
	,hyvennen = NULL
	,hyvaik = NULL
	,suorkouaik = NULL
	,ovyht = NULL
	,tyop = NULL
	,ammos = NULL
	,opintokok = NULL
	,tyov
	,rahoitus
	,vayla
	,alaika
	,loaika
	,tavoite
	,toteuma_tutk -- nimi muuttunut 2012
	,yrit = NULL
	,purku
	,todis
	,tol2008
	,koko
	,tyansek
	,suorosat
	,tunn_opisk
	,jarj_opisk
	,kkun_opisk
	,[tietolahde]=''2_4c_sopv_19''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_K2_4c_sopv_19]
) kaikkivuodet


' 
GO
/****** Object:  View [dbo].[v_sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot]'))
EXEC dbo.sp_executesql @statement = N'











CREATE VIEW [dbo].[v_sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot] AS


-- truncate table vipunentk_dw.dbo.sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot
-- insert into vipunentk_dw.dbo.sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot select * from vipunentk_sa.[dbo].[v_sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot]
-- select * into vipunentk_dw.dbo.sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot from vipunentk_sa.[dbo].[v_sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot]



SELECT
	tilv = CAST(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = Cast(kaikkivuodet.tilv+''0101'' as date)
	,lahde = cast(coalesce(nullif(kaikkivuodet.lahde , ''''), ''-1'') as nvarchar(2))
	,jarj = cast(coalesce(nullif(kaikkivuodet.jarj, ''''), ''-1'') as nvarchar(10))
	,opjarj = cast(coalesce(nullif(kaikkivuodet.opjarj, ''''), ''-1'')  as nvarchar(10))
	,kkieli = cast(coalesce(nullif(kaikkivuodet.kkieli , ''''), ''-1'') as nvarchar(2))
	,koulk = cast(coalesce(nullif(kaikkivuodet.koulk , ''''), ''-1'') as nvarchar(6))
	,kkun = cast(coalesce(nullif(kaikkivuodet.kkun , ''''), ''-1'') as nvarchar(3))
	,ophal = cast(coalesce(nullif(kaikkivuodet.ophal , ''''), ''-1'') as nvarchar(2))
	,sp = cast(coalesce(nullif(kaikkivuodet.sp , ''''), ''-1'') as nvarchar(2))
	,aikielir1 = cast(coalesce(nullif(kaikkivuodet.aikielir1 , ''''), ''-1'') as nvarchar(2))
	,aiopis = cast(coalesce(nullif(kaikkivuodet.aiopis , ''''), ''-1'') as nvarchar(2))
	,ika2 = cast(coalesce(nullif(kaikkivuodet.ika2, ''''), ''-1'') as nvarchar(15))
	,lkm = cast(kaikkivuodet.lkm as int)
	,aikoul = cast(coalesce(nullif(kaikkivuodet.aikoul , ''''), ''-1'') as nvarchar(2))
	,tutalv = cast(coalesce(nullif(kaikkivuodet.tutalv , ''''), ''-1'') as nvarchar(4))
	,tutklaja = cast(coalesce(nullif(kaikkivuodet.tutklaja , ''''), ''-1'') as nvarchar(2))
	,tunim = cast(coalesce(nullif(kaikkivuodet.tunim , ''''), ''-1'') as nvarchar(255))
	,sutunim = cast(coalesce(nullif(kaikkivuodet.sutunim , ''''), ''-1'') as nvarchar(255))
	,rutunim = cast(coalesce(nullif(kaikkivuodet.rutunim , ''''), ''-1'') as nvarchar(255))
	,koohj = cast(coalesce(nullif(kaikkivuodet.koohj , ''''), ''-1'') as nvarchar(100))
	,sukoohj = cast(coalesce(nullif(kaikkivuodet.sukoohj , ''''), ''-1'') as nvarchar(100))
	,rukoohj = cast(coalesce(nullif(kaikkivuodet.rukoohj , ''''), ''-1'') as nvarchar(100))
	,tutktav = cast(coalesce(nullif(kaikkivuodet.tutktav , ''''), ''-1'') as nvarchar(2))
	,rahoitus = cast(coalesce(nullif(kaikkivuodet.rahoitus , ''''), ''-1'') as nvarchar(2))
	,tavoite =  cast(coalesce(nullif(kaikkivuodet.tavoite,''''),''-1'')  as nvarchar(2))   -- HUOM! tässä aineistossa tulkitaan tyhjät tutkinnon tavoitteet tarkoituksella arvoon "1 - koko tutkinnon suorittaminen" kuutiomääritelmän mukaan -- Lasse
	,tutalk =  cast(coalesce(nullif(kaikkivuodet.tutalk,''''),''-1'')  as nvarchar(2))
	,hyvennen =  cast(kaikkivuodet.hyvennen AS int)
	,hyvaik =  cast(kaikkivuodet.hyvaik AS int)
	,suorkouaik =  cast(kaikkivuodet.suorkouaik AS int)
	,ovyht =  cast(kaikkivuodet.ovyht AS int)
	,tyop =  cast(kaikkivuodet.tyop AS int)
	,ammos =  cast(kaikkivuodet.ammos AS int)
	,opintokok =  cast(kaikkivuodet.opintokok AS int)
	,vayla =  cast(coalesce(nullif(kaikkivuodet.vayla,''''),''-1'')  as nvarchar(2))
	,toteuma_tutk =  cast(coalesce(nullif(kaikkivuodet.toteuma_tutk,''''),''-1'')  as nvarchar(2))
	,suorosat =  cast(kaikkivuodet.suorosat AS int)
	,jarj_opisk =  cast(coalesce(nullif(kaikkivuodet.jarj_opisk,''''),''-1'')  as nvarchar(10))
	,kkun_opisk =  cast(coalesce(nullif(kaikkivuodet.kkun_opisk,''''),''-1'')  as nvarchar(3))
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as nvarchar(10))
FROM (
/*
--Historia-aineisto
SELECT
	  [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''8_1_Historia_tutkinnot''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].TK_8_1_sopv_16

UNION ALL
*/
SELECT
	  [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4e_Lukio_ja_amm_koulutuksen_opiskelijat_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4e_sopv_14]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4f_Lukio_ja_amm_koulutuksen_opiskelijat_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4f_sopv_14]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4g_Lukio_ja_amm_koulutuksen_opiskelijat_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4g_sopv_14]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4e_Lukio_ja_amm_koulutuksen_opiskelijat_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4e_sopv_15]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4f_Lukio_ja_amm_koulutuksen_opiskelijat_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4f_sopv_15]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4g_Lukio_ja_amm_koulutuksen_opiskelijat_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4g_sopv_15]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4e_Lukio_ja_amm_koulutuksen_opiskelijat_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4e_sopv_16]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4f_Lukio_ja_amm_koulutuksen_opiskelijat_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4f_sopv_16]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen]
	  ,[hyvaik]
	  ,[suorkouaik]
	  ,[ovyht]
	  ,[tyop]
	  ,[ammos]
	  ,[opintokok]
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4g_Lukio_ja_amm_koulutuksen_opiskelijat_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4g_sopv_16]


union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen] = NULL
	  ,[hyvaik] = NULL
	  ,[suorkouaik] = NULL
	  ,[ovyht] = NULL
	  ,[tyop] = NULL
	  ,[ammos] = NULL
	  ,[opintokok] = NULL
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4e_Lukio_ja_amm_koulutuksen_opiskelijat_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4e_sopv_17]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen] = NULL
	  ,[hyvaik] = NULL
	  ,[suorkouaik] = NULL
	  ,[ovyht] = NULL
	  ,[tyop] = NULL
	  ,[ammos] = NULL
	  ,[opintokok] = NULL
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4f_Lukio_ja_amm_koulutuksen_opiskelijat_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4f_sopv_17]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen] = NULL
	  ,[hyvaik] = NULL
	  ,[suorkouaik] = NULL
	  ,[ovyht] = NULL
	  ,[tyop] = NULL
	  ,[ammos] = NULL
	  ,[opintokok] = NULL
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4g_Lukio_ja_amm_koulutuksen_opiskelijat_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4g_sopv_17]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen] = NULL
	  ,[hyvaik] = NULL
	  ,[suorkouaik] = NULL
	  ,[ovyht] = NULL
	  ,[tyop] = NULL
	  ,[ammos] = NULL
	  ,[opintokok] = NULL
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4e_Lukio_ja_amm_koulutuksen_opiskelijat_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4e_sopv_18]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen] = NULL
	  ,[hyvaik] = NULL
	  ,[suorkouaik] = NULL
	  ,[ovyht] = NULL
	  ,[tyop] = NULL
	  ,[ammos] = NULL
	  ,[opintokok] = NULL
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4f_Lukio_ja_amm_koulutuksen_opiskelijat_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4f_sopv_18]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen] = NULL
	  ,[hyvaik] = NULL
	  ,[suorkouaik] = NULL
	  ,[ovyht] = NULL
	  ,[tyop] = NULL
	  ,[ammos] = NULL
	  ,[opintokok] = NULL
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4g_Lukio_ja_amm_koulutuksen_opiskelijat_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_2_4g_sopv_18]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen] = NULL
	  ,[hyvaik] = NULL
	  ,[suorkouaik] = NULL
	  ,[ovyht] = NULL
	  ,[tyop] = NULL
	  ,[ammos] = NULL
	  ,[opintokok] = NULL
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4e_Lukio_ja_amm_koulutuksen_opiskelijat_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_K2_4e_sopv_19]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen] = NULL
	  ,[hyvaik] = NULL
	  ,[suorkouaik] = NULL
	  ,[ovyht] = NULL
	  ,[tyop] = NULL
	  ,[ammos] = NULL
	  ,[opintokok] = NULL
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4f_Lukio_ja_amm_koulutuksen_opiskelijat_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_K2_4f_sopv_19]

union all

SELECT
	   [tilv]
      ,[lahde]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[kkieli]
      ,[kkun]
      ,[ophal]
      ,[sp]
      ,[aikielir1]
      ,[aiopis]
      ,[ika2]
      ,[lkm]
      ,[aikoul]
      ,[tutalv]
      ,[tutklaja]
      ,[tunim]
      ,[sutunim]
      ,[rutunim]
      ,[koohj]
      ,[sukoohj]
      ,[rukoohj]
      ,[tutktav]
      ,[rahoitus]
      ,[tavoite]
	  ,[tutalk]
	  ,[hyvennen] = NULL
	  ,[hyvaik] = NULL
	  ,[suorkouaik] = NULL
	  ,[ovyht] = NULL
	  ,[tyop] = NULL
	  ,[ammos] = NULL
	  ,[opintokok] = NULL
	  ,[vayla]
	  ,[toteuma_tutk]
	  ,[suorosat]
	  ,[jarj_opisk]
	  ,[kkun_opisk]
	  ,[tietolahde]=''2_4g_Lukio_ja_amm_koulutuksen_opiskelijat_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
from [TK_H9098_CSC].[dbo].[TK_K2_4g_sopv_19]
) kaikkivuodet






' 
GO
/****** Object:  View [dbo].[v_sa_2_5_Lukiokoulutuksen_ainevalinnat]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_5_Lukiokoulutuksen_ainevalinnat]'))
EXEC dbo.sp_executesql @statement = N'


CREATE VIEW [dbo].[v_sa_2_5_Lukiokoulutuksen_ainevalinnat] AS
--Select * from v_sa_2_5_Lukiokoulutuksen_ainevalinnat
/*
Drop table VipunenTK_DW.[dbo].sa_2_5_Lukiokoulutuksen_ainevalinnat
Select * into VipunenTK_DW.[dbo].sa_2_5_Lukiokoulutuksen_ainevalinnat from v_sa_2_5_Lukiokoulutuksen_ainevalinnat

truncate table VipunenTK_DW.[dbo].sa_2_5_Lukiokoulutuksen_ainevalinnat
insert into VipunenTK_DW.[dbo].sa_2_5_Lukiokoulutuksen_ainevalinnat select * from v_sa_2_5_Lukiokoulutuksen_ainevalinnat
*/

SELECT
       [tilv] = Cast(tilv as nvarchar(4))
      ,[tunn] = Cast(tunn as nvarchar(5))
      ,[jarj] = Cast(jarj as nvarchar(10))
      ,[nukevy] = Nullif(Cast(nukevy as int), 0)
      ,[aikevy] = Nullif(Cast(aikevy as int), 0)
      ,[kev] = Nullif(Cast(kev as int), 0)
      ,[nukevyn] = Nullif(Cast(nukevyn as int), 0)
      ,[aikevyn] = Nullif(Cast(aikevyn as int), 0)
      ,[kevn] = Nullif(Cast(kevn as int), 0)
      ,[nukev1] = Nullif(Cast(nukev1 as int), 0)
      ,[nukev2] = Nullif(Cast(nukev2 as int), 0)
      ,[nukev3] = Nullif(Cast(nukev3 as int), 0)
      ,[nukev4] = Nullif(Cast(nukev4 as int), 0)
      ,[nukev] = Nullif(Cast(nukev as int), 0)
      ,[nukev1n] = Nullif(Cast(nukev1n as int), 0)
      ,[nukev2n] = Nullif(Cast(nukev2n as int), 0)
      ,[nukev3n] = Nullif(Cast(nukev3n as int), 0)
      ,[nukev4n] = Nullif(Cast(nukev4n as int), 0)
      ,[nukevn] = Nullif(Cast(nukevn as int), 0)
      ,[aikev1] = Nullif(Cast(aikev1 as int), 0)
      ,[aikev2] = Nullif(Cast(aikev2 as int), 0)
      ,[aikev3] = Nullif(Cast(aikev3 as int), 0)
      ,[aikev4] = Nullif(Cast(aikev4 as int), 0)
      ,[aikev] = Nullif(Cast(aikev as int), 0)
      ,[aikev1n] = Nullif(Cast(aikev1n as int), 0)
      ,[aikev2n] = Nullif(Cast(aikev2n as int), 0)
      ,[aikev3n] = Nullif(Cast(aikev3n as int), 0)
      ,[aikev4n] = Nullif(Cast(aikev4n as int), 0)
      ,[aikevn] = Nullif(Cast(aikevn as int), 0)
      ,[nuvary] = Nullif(Cast(nuvary as int), 0)
      ,[aivary] = Nullif(Cast(aivary as int), 0)
      ,[var] = Nullif(Cast(var as int), 0)
      ,[nuvaryn] = Nullif(Cast(nuvaryn as int), 0)
      ,[aivaryn] = Nullif(Cast(aivaryn as int), 0)
      ,[varn] = Nullif(Cast(varn as int), 0)
      ,[nuyks] = Nullif(Cast(nuyks as int), 0)
      ,[aiyks] = Nullif(Cast(aiyks as int), 0)
      ,[yksy] = Nullif(Cast(yksy as int), 0)
      ,[nuvar2] = Nullif(Cast(nuvar2 as int), 0)
      ,[nuvar25] = Nullif(Cast(nuvar25 as int), 0)
      ,[nuvar3] = Nullif(Cast(nuvar3 as int), 0)
      ,[nuvar35] = Nullif(Cast(nuvar35 as int), 0)
      ,[nuvar4] = Nullif(Cast(nuvar4 as int), 0)
      ,[nuvar45] = Nullif(Cast(nuvar45 as int), 0)
      ,[nuvar5] = Nullif(Cast(nuvar5 as int), 0)
      ,[nuvar] = Nullif(Cast(nuvar as int), 0)
      ,[nuvar2n] = Nullif(Cast(nuvar2n as int), 0)
      ,[nuvar25n] = Nullif(Cast(nuvar25n as int), 0)
      ,[nuvar3n] = Nullif(Cast(nuvar3n as int), 0)
      ,[nuvar35n] = Nullif(Cast(nuvar35n as int), 0)
      ,[nuvar4n] = Nullif(Cast(nuvar4n as int), 0)
      ,[nuvar45n] = Nullif(Cast(nuvar45n as int), 0)
      ,[nuvar5n] = Nullif(Cast(nuvar5n as int), 0)
      ,[nuvarn] = Nullif(Cast(nuvarn as int), 0)
      ,[aivar2] = Nullif(Cast(aivar2 as int), 0)
      ,[aivar25] = Nullif(Cast(aivar25 as int), 0)
      ,[aivar3] = Nullif(Cast(aivar3 as int), 0)
      ,[aivar35] = Nullif(Cast(aivar35 as int), 0)
      ,[aivar4] = Nullif(Cast(aivar4 as int), 0)
      ,[aivar45] = Nullif(Cast(aivar45 as int), 0)
      ,[aivar5] = Nullif(Cast(aivar5 as int), 0)
      ,[aivar] = Nullif(Cast(aivar as int), 0)
      ,[aivar2n] = Nullif(Cast(aivar2n as int), 0)
      ,[aivar25n] = Nullif(Cast(aivar25n as int), 0)
      ,[aivar3n] = Nullif(Cast(aivar3n as int), 0)
      ,[aivar35n] = Nullif(Cast(aivar35n as int), 0)
      ,[aivar4n] = Nullif(Cast(aivar4n as int), 0)
      ,[aivar45n] = Nullif(Cast(aivar45n as int), 0)
      ,[aivar5n] = Nullif(Cast(aivar5n as int), 0)
      ,[aivarn] = Nullif(Cast(aivarn as int), 0)
      ,[ev] = Nullif(Cast(ev as int), 0)
      ,[ort] = Nullif(Cast(ort as int), 0)
      ,[et] = Nullif(Cast(et as int), 0)
      ,[mu] = Nullif(Cast(mu as int), 0)
      ,[eos] = Nullif(Cast(eos as int), 0)
      ,[kay] = Nullif(Cast(kay as int), 0)
      ,[kieli1] = Nullif(Cast(kieli1 as int), 0)
      ,[kieli2] = Nullif(Cast(kieli2 as int), 0)
      ,[kieli3] = Nullif(Cast(kieli3 as int), 0)
      ,[kieli4] = Nullif(Cast(kieli4 as int), 0)
      ,[kieli5] = Nullif(Cast(kieli5 as int), 0)
      ,[kieli6] = Nullif(Cast(kieli6 as int), 0)
      ,[kieliy] = Nullif(Cast(kieliy as int), 0)
      ,[sv] = Nullif(Cast(sv as int), 0)
      ,[rv] = Nullif(Cast(rv as int), 0)
      ,[svrv] = Nullif(Cast(svrv as int), 0)
      ,[svnn] = Nullif(Cast(svnn as int), 0)
      ,[rvnn] = Nullif(Cast(rvnn as int), 0)
      ,[svrvn] = Nullif(Cast(svrvn as int), 0)
      ,[yaenm] = Nullif(Cast(yaenm as int), 0)
      ,[yyenm] = Nullif(Cast(yyenm as int), 0)
      ,[yen6m] = Nullif(Cast(yen6m as int), 0)
      ,[len6m] = Nullif(Cast(len6m as int), 0)
      ,[alen6m] = Nullif(Cast(alen6m as int), 0)
      ,[enmm] = Nullif(Cast(enmm as int), 0)
      ,[yaenn] = Nullif(Cast(yaenn as int), 0)
      ,[yyenn] = Nullif(Cast(yyenn as int), 0)
      ,[yen6n] = Nullif(Cast(yen6n as int), 0)
      ,[len6n] = Nullif(Cast(len6n as int), 0)
      ,[alen6n] = Nullif(Cast(alen6n as int), 0)
      ,[ennn] = Nullif(Cast(ennn as int), 0)
      ,[yarum] = Nullif(Cast(yarum as int), 0)
      ,[yyrum] = Nullif(Cast(yyrum as int), 0)
      ,[yru6m] = Nullif(Cast(yru6m as int), 0)
      ,[lru6m] = Nullif(Cast(lru6m as int), 0)
      ,[alru6m] = Nullif(Cast(alru6m as int), 0)
      ,[rumm] = Nullif(Cast(rumm as int), 0)
      ,[yarun] = Nullif(Cast(yarun as int), 0)
      ,[yyrun] = Nullif(Cast(yyrun as int), 0)
      ,[yru6n] = Nullif(Cast(yru6n as int), 0)
      ,[lru6n] = Nullif(Cast(lru6n as int), 0)
      ,[alru6n] = Nullif(Cast(alru6n as int), 0)
      ,[runn] = Nullif(Cast(runn as int), 0)
      ,[yasum] = Nullif(Cast(yasum as int), 0)
      ,[yysum] = Nullif(Cast(yysum as int), 0)
      ,[ysu6m] = Nullif(Cast(ysu6m as int), 0)
      ,[lsu6m] = Nullif(Cast(lsu6m as int), 0)
      ,[alsu6m] = Nullif(Cast(alsu6m as int), 0)
      ,[summ] = Nullif(Cast(summ as int), 0)
      ,[yasun] = Nullif(Cast(yasun as int), 0)
      ,[yysun] = Nullif(Cast(yysun as int), 0)
      ,[ysu6n] = Nullif(Cast(ysu6n as int), 0)
      ,[lsu6n] = Nullif(Cast(lsu6n as int), 0)
      ,[alsu6n] = Nullif(Cast(alsu6n as int), 0)
      ,[sunn] = Nullif(Cast(sunn as int), 0)
      ,[yaram] = Nullif(Cast(yaram as int), 0)
      ,[yyram] = Nullif(Cast(yyram as int), 0)
      ,[yra6m] = Nullif(Cast(yra6m as int), 0)
      ,[lra6m] = Nullif(Cast(lra6m as int), 0)
      ,[alra6m] = Nullif(Cast(alra6m as int), 0)
      ,[ramm] = Nullif(Cast(ramm as int), 0)
      ,[yaran] = Nullif(Cast(yaran as int), 0)
      ,[yyran] = Nullif(Cast(yyran as int), 0)
      ,[yra6n] = Nullif(Cast(yra6n as int), 0)
      ,[lra6n] = Nullif(Cast(lra6n as int), 0)
      ,[alra6n] = Nullif(Cast(alra6n as int), 0)
      ,[rann] = Nullif(Cast(rann as int), 0)
      ,[yasam] = Nullif(Cast(yasam as int), 0)
      ,[yysam] = Nullif(Cast(yysam as int), 0)
      ,[ysa6m] = Nullif(Cast(ysa6m as int), 0)
      ,[lsa6m] = Nullif(Cast(lsa6m as int), 0)
      ,[alsa6m] = Nullif(Cast(alsa6m as int), 0)
      ,[samm] = Nullif(Cast(samm as int), 0)
      ,[yasan] = Nullif(Cast(yasan as int), 0)
      ,[yysan] = Nullif(Cast(yysan as int), 0)
      ,[ysa6n] = Nullif(Cast(ysa6n as int), 0)
      ,[lsa6n] = Nullif(Cast(lsa6n as int), 0)
      ,[alsa6n] = Nullif(Cast(alsa6n as int), 0)
      ,[sann] = Nullif(Cast(sann as int), 0)
      ,[yavem] = Nullif(Cast(yavem as int), 0)
      ,[yyvem] = Nullif(Cast(yyvem as int), 0)
      ,[yve6m] = Nullif(Cast(yve6m as int), 0)
      ,[lve6m] = Nullif(Cast(lve6m as int), 0)
      ,[alve6m] = Nullif(Cast(alve6m as int), 0)
      ,[vemm] = Nullif(Cast(vemm as int), 0)
      ,[yaven] = Nullif(Cast(yaven as int), 0)
      ,[yyven] = Nullif(Cast(yyven as int), 0)
      ,[yve6n] = Nullif(Cast(yve6n as int), 0)
      ,[lve6n] = Nullif(Cast(lve6n as int), 0)
      ,[alve6n] = Nullif(Cast(alve6n as int), 0)
      ,[vennn] = Nullif(Cast(vennn as int), 0)
      ,[yasaam] = Nullif(Cast(yasaam as int), 0)
      ,[ysaa6m] = Nullif(Cast(ysaa6m as int), 0)
      ,[lsaa6m] = Nullif(Cast(lsaa6m as int), 0)
      ,[alsaa6m] = Nullif(Cast(alsaa6m as int), 0)
      ,[saamm] = Nullif(Cast(saamm as int), 0)
      ,[yasaan] = Nullif(Cast(yasaan as int), 0)
      ,[ysaa6n] = Nullif(Cast(ysaa6n as int), 0)
      ,[lsaa6n] = Nullif(Cast(lsaa6n as int), 0)
      ,[alsaa6n] = Nullif(Cast(alsaa6n as int), 0)
      ,[saann] = Nullif(Cast(saann as int), 0)
      ,[yalatm] = Nullif(Cast(yalatm as int), 0)
      ,[ylat6m] = Nullif(Cast(ylat6m as int), 0)
      ,[lla6m] = Nullif(Cast(lla6m as int), 0)
      ,[alla6m] = Nullif(Cast(alla6m as int), 0)
      ,[lamm] = Nullif(Cast(lamm as int), 0)
      ,[yalan] = Nullif(Cast(yalan as int), 0)
      ,[ylat6n] = Nullif(Cast(ylat6n as int), 0)
      ,[lla6n] = Nullif(Cast(lla6n as int), 0)
      ,[alla6n] = Nullif(Cast(alla6n as int), 0)
      ,[lann] = Nullif(Cast(lann as int), 0)
      ,[yaesm] = Nullif(Cast(yaesm as int), 0)
      ,[yes6m] = Nullif(Cast(yes6m as int), 0)
      ,[les6m] = Nullif(Cast(les6m as int), 0)
      ,[ales6m] = Nullif(Cast(ales6m as int), 0)
      ,[esmm] = Nullif(Cast(esmm as int), 0)
      ,[yaesn] = Nullif(Cast(yaesn as int), 0)
      ,[yes6n] = Nullif(Cast(yes6n as int), 0)
      ,[les6n] = Nullif(Cast(les6n as int), 0)
      ,[ales6n] = Nullif(Cast(ales6n as int), 0)
      ,[esnn] = Nullif(Cast(esnn as int), 0)
      ,[yaitm] = Nullif(Cast(yaitm as int), 0)
      ,[yit6m] = Nullif(Cast(yit6m as int), 0)
      ,[lit6m] = Nullif(Cast(lit6m as int), 0)
      ,[alit6m] = Nullif(Cast(alit6m as int), 0)
      ,[itmm] = Nullif(Cast(itmm as int), 0)
      ,[yaitn] = Nullif(Cast(yaitn as int), 0)
      ,[yit6n] = Nullif(Cast(yit6n as int), 0)
      ,[lit6n] = Nullif(Cast(lit6n as int), 0)
      ,[alit6n] = Nullif(Cast(alit6n as int), 0)
      ,[itnn] = Nullif(Cast(itnn as int), 0)
      ,[yamum] = Nullif(Cast(yamum as int), 0)
      ,[yymum] = Nullif(Cast(yymum as int), 0)
      ,[ymu6m] = Nullif(Cast(ymu6m as int), 0)
      ,[lmu6m] = Nullif(Cast(lmu6m as int), 0)
      ,[almu6m] = Nullif(Cast(almu6m as int), 0)
      ,[mumm] = Nullif(Cast(mumm as int), 0)
      ,[yamun] = Nullif(Cast(yamun as int), 0)
      ,[yymun] = Nullif(Cast(yymun as int), 0)
      ,[ymu6n] = Nullif(Cast(ymu6n as int), 0)
      ,[lmu6n] = Nullif(Cast(lmu6n as int), 0)
      ,[almu6n] = Nullif(Cast(almu6n as int), 0)
      ,[munn] = Nullif(Cast(munn as int), 0)
      ,[yyvam] = Nullif(Cast(yyvam as int), 0)
      ,[vamm] = Nullif(Cast(vamm as int), 0)
      ,[yyvan] = Nullif(Cast(yyvan as int), 0)
      ,[vann] = Nullif(Cast(vann as int), 0)
      ,[pmatm] = Nullif(Cast(pmatm as int), 0)
      ,[pmatn] = Nullif(Cast(pmatn as int), 0)
      ,[pmaty] = Nullif(Cast(pmaty as int), 0)
      ,[lmatm] = Nullif(Cast(lmatm as int), 0)
      ,[lmatn] = Nullif(Cast(lmatn as int), 0)
      ,[lmaty] = Nullif(Cast(lmaty as int), 0)
      ,[matm] = Nullif(Cast(matm as int), 0)
      ,[matn] = Nullif(Cast(matn as int), 0)
      ,[maty] = Nullif(Cast(maty as int), 0)
      ,[pma1m] = Nullif(Cast(pma1m as int), 0)
      ,[pma1n] = Nullif(Cast(pma1n as int), 0)
      ,[pma2m] = Nullif(Cast(pma2m as int), 0)
      ,[pma2n] = Nullif(Cast(pma2n as int), 0)
      ,[pma3m] = Nullif(Cast(pma3m as int), 0)
      ,[pma3n] = Nullif(Cast(pma3n as int), 0)
      ,[pma45m] = Nullif(Cast(pma45m as int), 0)
      ,[pma45n] = Nullif(Cast(pma45n as int), 0)
      ,[pma6m] = Nullif(Cast(pma6m as int), 0)
      ,[pma6n] = Nullif(Cast(pma6n as int), 0)
      ,[pma7m] = Nullif(Cast(pma7m as int), 0)
      ,[pma7n] = Nullif(Cast(pma7n as int), 0)
      ,[lma1m] = Nullif(Cast(lma1m as int), 0)
      ,[lma1n] = Nullif(Cast(lma1n as int), 0)
      ,[lma2m] = Nullif(Cast(lma2m as int), 0)
      ,[lma2n] = Nullif(Cast(lma2n as int), 0)
      ,[lma3m] = Nullif(Cast(lma3m as int), 0)
      ,[lma3n] = Nullif(Cast(lma3n as int), 0)
      ,[lma45m] = Nullif(Cast(lma45m as int), 0)
      ,[lma45n] = Nullif(Cast(lma45n as int), 0)
      ,[lma6m] = Nullif(Cast(lma6m as int), 0)
      ,[lma6n] = Nullif(Cast(lma6n as int), 0)
      ,[lma7m] = Nullif(Cast(lma7m as int), 0)
      ,[lma7n] = Nullif(Cast(lma7n as int), 0)
      ,[fy1m] = Nullif(Cast(fy1m as int), 0)
      ,[fy1n] = Nullif(Cast(fy1n as int), 0)
      ,[fy2m] = Nullif(Cast(fy2m as int), 0)
      ,[fy2n] = Nullif(Cast(fy2n as int), 0)
      ,[fy3m] = Nullif(Cast(fy3m as int), 0)
      ,[fy3n] = Nullif(Cast(fy3n as int), 0)
      ,[fy45m] = Nullif(Cast(fy45m as int), 0)
      ,[fy45n] = Nullif(Cast(fy45n as int), 0)
      ,[fy6m] = Nullif(Cast(fy6m as int), 0)
      ,[fy6n] = Nullif(Cast(fy6n as int), 0)
      ,[fy7m] = Nullif(Cast(fy7m as int), 0)
      ,[fy7n] = Nullif(Cast(fy7n as int), 0)
      ,[ke1m] = Nullif(Cast(ke1m as int), 0)
      ,[ke1n] = Nullif(Cast(ke1n as int), 0)
      ,[ke2m] = Nullif(Cast(ke2m as int), 0)
      ,[ke2n] = Nullif(Cast(ke2n as int), 0)
      ,[ke3m] = Nullif(Cast(ke3m as int), 0)
      ,[ke3n] = Nullif(Cast(ke3n as int), 0)
      ,[ke45m] = Nullif(Cast(ke45m as int), 0)
      ,[ke45n] = Nullif(Cast(ke45n as int), 0)
      ,[ke6m] = Nullif(Cast(ke6m as int), 0)
      ,[ke6n] = Nullif(Cast(ke6n as int), 0)
      ,[ke7m] = Nullif(Cast(ke7m as int), 0)
      ,[ke7n] = Nullif(Cast(ke7n as int), 0)
      ,[bi1m] = Nullif(Cast(bi1m as int), 0)
      ,[bi1n] = Nullif(Cast(bi1n as int), 0)
      ,[bi2m] = Nullif(Cast(bi2m as int), 0)
      ,[bi2n] = Nullif(Cast(bi2n as int), 0)
      ,[bi3m] = Nullif(Cast(bi3m as int), 0)
      ,[bi3n] = Nullif(Cast(bi3n as int), 0)
      ,[bi45m] = Nullif(Cast(bi45m as int), 0)
      ,[bi45n] = Nullif(Cast(bi45n as int), 0)
      ,[bi6m] = Nullif(Cast(bi6m as int), 0)
      ,[bi6n] = Nullif(Cast(bi6n as int), 0)
      ,[bi7m] = Nullif(Cast(bi7m as int), 0)
      ,[bi7n] = Nullif(Cast(bi7n as int), 0)
      ,[mt1m] = Nullif(Cast(mt1m as int), 0)
      ,[mt1n] = Nullif(Cast(mt1n as int), 0)
      ,[mt2m] = Nullif(Cast(mt2m as int), 0)
      ,[mt2n] = Nullif(Cast(mt2n as int), 0)
      ,[mt3m] = Nullif(Cast(mt3m as int), 0)
      ,[mt3n] = Nullif(Cast(mt3n as int), 0)
      ,[mt45m] = Nullif(Cast(mt45m as int), 0)
      ,[mt45n] = Nullif(Cast(mt45n as int), 0)
      ,[mt6m] = Nullif(Cast(mt6m as int), 0)
      ,[mt6n] = Nullif(Cast(mt6n as int), 0)
      ,[mt7m] = Nullif(Cast(mt7m as int), 0)
      ,[mt7n] = Nullif(Cast(mt7n as int), 0)
      ,[soma2m] = Nullif(Cast(soma2m as int), 0)
      ,[soma2n] = Nullif(Cast(soma2n as int), 0)
      ,[soma3m] = Nullif(Cast(soma3m as int), 0)
      ,[soma3n] = Nullif(Cast(soma3n as int), 0)
      ,[sofy2m] = Nullif(Cast(sofy2m as int), 0)
      ,[sofy2n] = Nullif(Cast(sofy2n as int), 0)
      ,[sofy3m] = Nullif(Cast(sofy3m as int), 0)
      ,[sofy3n] = Nullif(Cast(sofy3n as int), 0)
      ,[soke2m] = Nullif(Cast(soke2m as int), 0)
      ,[soke2n] = Nullif(Cast(soke2n as int), 0)
      ,[soke3m] = Nullif(Cast(soke3m as int), 0)
      ,[soke3n] = Nullif(Cast(soke3n as int), 0)
      ,[sobi2m] = Nullif(Cast(sobi2m as int), 0)
      ,[sobi2n] = Nullif(Cast(sobi2n as int), 0)
      ,[sobi3m] = Nullif(Cast(sobi3m as int), 0)
      ,[sobi3n] = Nullif(Cast(sobi3n as int), 0)
      ,[somt2m] = Nullif(Cast(somt2m as int), 0)
      ,[somt2n] = Nullif(Cast(somt2n as int), 0)
      ,[somt3m] = Nullif(Cast(somt3m as int), 0)
      ,[somt3n] = Nullif(Cast(somt3n as int), 0)
      ,[sotek2m] = Nullif(Cast(sotek2m as int), 0)
      ,[sotek2n] = Nullif(Cast(sotek2n as int), 0)
      ,[sotek3m] = Nullif(Cast(sotek3m as int), 0)
      ,[sotek3n] = Nullif(Cast(sotek3n as int), 0)
      ,[tietolahde] = Cast(tietolahde as nvarchar(250))
      ,[rivinumero] = Cast(rivinumero as int)
FROM (
SELECT [tilv]
      ,[tunn]
      ,[jarj]
      ,[nukevy]
      ,[aikevy]
      ,[kev]
      ,[nukevyn]
      ,[aikevyn]
      ,[kevn]
      ,[nukev1]
      ,[nukev2]
      ,[nukev3]
      ,[nukev4]
      ,[nukev]
      ,[nukev1n]
      ,[nukev2n]
      ,[nukev3n]
      ,[nukev4n]
      ,[nukevn]
      ,[aikev1]
      ,[aikev2]
      ,[aikev3]
      ,[aikev4]
      ,[aikev]
      ,[aikev1n]
      ,[aikev2n]
      ,[aikev3n]
      ,[aikev4n]
      ,[aikevn]
      ,[nuvary]
      ,[aivary]
      ,[var]
      ,[nuvaryn]
      ,[aivaryn]
      ,[varn]
      ,[nuyks]
      ,[aiyks]
      ,[yksy]
      ,[nuvar2]
      ,[nuvar25]
      ,[nuvar3]
      ,[nuvar35]
      ,[nuvar4]
      ,[nuvar45]
      ,[nuvar5]
      ,[nuvar]
      ,[nuvar2n]
      ,[nuvar25n]
      ,[nuvar3n]
      ,[nuvar35n]
      ,[nuvar4n]
      ,[nuvar45n]
      ,[nuvar5n]
      ,[nuvarn]
      ,[aivar2]
      ,[aivar25]
      ,[aivar3]
      ,[aivar35]
      ,[aivar4]
      ,[aivar45]
      ,[aivar5]
      ,[aivar]
      ,[aivar2n]
      ,[aivar25n]
      ,[aivar3n]
      ,[aivar35n]
      ,[aivar4n]
      ,[aivar45n]
      ,[aivar5n]
      ,[aivarn]
      ,[ev]
      ,[ort]
      ,[et]
      ,[mu]
      ,[eos]
      ,[kay]
      ,[kieli1]
      ,[kieli2]
      ,[kieli3]
      ,[kieli4]
      ,[kieli5]
      ,[kieli6]
      ,[kieliy]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[svnn]
      ,[rvnn]
      ,[svrvn]
      ,[yaenm]
      ,[yyenm]
      ,[yen6m]
      ,[len6m]
      ,[alen6m]
      ,[enmm]
      ,[yaenn]
      ,[yyenn]
      ,[yen6n]
      ,[len6n]
      ,[alen6n]
      ,[ennn]
      ,[yarum]
      ,[yyrum]
      ,[yru6m]
      ,[lru6m]
      ,[alru6m]
      ,[rumm]
      ,[yarun]
      ,[yyrun]
      ,[yru6n]
      ,[lru6n]
      ,[alru6n]
      ,[runn]
      ,[yasum]
      ,[yysum]
      ,[ysu6m]
      ,[lsu6m]
      ,[alsu6m]
      ,[summ]
      ,[yasun]
      ,[yysun]
      ,[ysu6n]
      ,[lsu6n]
      ,[alsu6n]
      ,[sunn]
      ,[yaram]
      ,[yyram]
      ,[yra6m]
      ,[lra6m]
      ,[alra6m]
      ,[ramm]
      ,[yaran]
      ,[yyran]
      ,[yra6n]
      ,[lra6n]
      ,[alra6n]
      ,[rann]
      ,[yasam]
      ,[yysam]
      ,[ysa6m]
      ,[lsa6m]
      ,[alsa6m]
      ,[samm]
      ,[yasan]
      ,[yysan]
      ,[ysa6n]
      ,[lsa6n]
      ,[alsa6n]
      ,[sann]
      ,[yavem]
      ,[yyvem]
      ,[yve6m]
      ,[lve6m]
      ,[alve6m]
      ,[vemm]
      ,[yaven]
      ,[yyven]
      ,[yve6n]
      ,[lve6n]
      ,[alve6n]
      ,[vennn]
      ,[yasaam]
      ,[ysaa6m]
      ,[lsaa6m]
      ,[alsaa6m]
      ,[saamm]
      ,[yasaan]
      ,[ysaa6n]
      ,[lsaa6n]
      ,[alsaa6n]
      ,[saann]
      ,[yalatm]
      ,[ylat6m]
      ,[lla6m]
      ,[alla6m]
      ,[lamm]
      ,[yalan]
      ,[ylat6n]
      ,[lla6n]
      ,[alla6n]
      ,[lann]
      ,[yaesm]
      ,[yes6m]
      ,[les6m]
      ,[ales6m]
      ,[esmm]
      ,[yaesn]
      ,[yes6n]
      ,[les6n]
      ,[ales6n]
      ,[esnn]
      ,[yaitm]
      ,[yit6m]
      ,[lit6m]
      ,[alit6m]
      ,[itmm]
      ,[yaitn]
      ,[yit6n]
      ,[lit6n]
      ,[alit6n]
      ,[itnn]
      ,[yamum]
      ,[yymum]
      ,[ymu6m]
      ,[lmu6m]
      ,[almu6m]
      ,[mumm]
      ,[yamun]
      ,[yymun]
      ,[ymu6n]
      ,[lmu6n]
      ,[almu6n]
      ,[munn]
      ,[yyvam]
      ,[vamm]
      ,[yyvan]
      ,[vann]
      ,[pmatm]
      ,[pmatn]
      ,[pmaty]
      ,[lmatm]
      ,[lmatn]
      ,[lmaty]
      ,[matm]
      ,[matn]
      ,[maty]
      ,[pma1m]
      ,[pma1n]
      ,[pma2m]
      ,[pma2n]
      ,[pma3m]
      ,[pma3n]
      ,[pma45m]
      ,[pma45n]
      ,[pma6m]
      ,[pma6n]
      ,[pma7m]
      ,[pma7n]
      ,[lma1m]
      ,[lma1n]
      ,[lma2m]
      ,[lma2n]
      ,[lma3m]
      ,[lma3n]
      ,[lma45m]
      ,[lma45n]
      ,[lma6m]
      ,[lma6n]
      ,[lma7m]
      ,[lma7n]
      ,[fy1m]
      ,[fy1n]
      ,[fy2m]
      ,[fy2n]
      ,[fy3m]
      ,[fy3n]
      ,[fy45m]
      ,[fy45n]
      ,[fy6m]
      ,[fy6n]
      ,[fy7m]
      ,[fy7n]
      ,[ke1m]
      ,[ke1n]
      ,[ke2m]
      ,[ke2n]
      ,[ke3m]
      ,[ke3n]
      ,[ke45m]
      ,[ke45n]
      ,[ke6m]
      ,[ke6n]
      ,[ke7m]
      ,[ke7n]
      ,[bi1m]
      ,[bi1n]
      ,[bi2m]
      ,[bi2n]
      ,[bi3m]
      ,[bi3n]
      ,[bi45m]
      ,[bi45n]
      ,[bi6m]
      ,[bi6n]
      ,[bi7m]
      ,[bi7n]
      ,[mt1m]
      ,[mt1n]
      ,[mt2m]
      ,[mt2n]
      ,[mt3m]
      ,[mt3n]
      ,[mt45m]
      ,[mt45n]
      ,[mt6m]
      ,[mt6n]
      ,[mt7m]
      ,[mt7n]
      ,[soma2m]
      ,[soma2n]
      ,[soma3m]
      ,[soma3n]
      ,[sofy2m]
      ,[sofy2n]
      ,[sofy3m]
      ,[sofy3n]
      ,[soke2m]
      ,[soke2n]
      ,[soke3m]
      ,[soke3n]
      ,[sobi2m]
      ,[sobi2n]
      ,[sobi3m]
      ,[sobi3n]
      ,[somt2m]
      ,[somt2n]
      ,[somt3m]
      ,[somt3n]
      ,[sotek2m]
      ,[sotek2n]
      ,[sotek3m]
      ,[sotek3n]
      ,[tietolahde]=''2_5_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
      --,[rivinumero]
  FROM [TK_H9098_CSC].[dbo].[TK_2_5_sopv_11]

  UNION ALL

SELECT
	   [tilv]
      ,[tunn]
      ,[jarj]
      ,[nukevy]
      ,[aikevy]
      ,[kev]
      ,[nukevyn]
      ,[aikevyn]
      ,[kevn]
      ,[nukev1]
      ,[nukev2]
      ,[nukev3]
      ,[nukev4]
      ,[nukev]
      ,[nukev1n]
      ,[nukev2n]
      ,[nukev3n]
      ,[nukev4n]
      ,[nukevn]
      ,[aikev1]
      ,[aikev2]
      ,[aikev3]
      ,[aikev4]
      ,[aikev]
      ,[aikev1n]
      ,[aikev2n]
      ,[aikev3n]
      ,[aikev4n]
      ,[aikevn]
      ,[nuvary]
      ,[aivary]
      ,[var]
      ,[nuvaryn]
      ,[aivaryn]
      ,[varn]
      ,[nuyks]
      ,[aiyks]
      ,[yksy]
      ,[nuvar2]
      ,[nuvar25]
      ,[nuvar3]
      ,[nuvar35]
      ,[nuvar4]
      ,[nuvar45]
      ,[nuvar5]
      ,[nuvar]
      ,[nuvar2n]
      ,[nuvar25n]
      ,[nuvar3n]
      ,[nuvar35n]
      ,[nuvar4n]
      ,[nuvar45n]
      ,[nuvar5n]
      ,[nuvarn]
      ,[aivar2]
      ,[aivar25]
      ,[aivar3]
      ,[aivar35]
      ,[aivar4]
      ,[aivar45]
      ,[aivar5]
      ,[aivar]
      ,[aivar2n]
      ,[aivar25n]
      ,[aivar3n]
      ,[aivar35n]
      ,[aivar4n]
      ,[aivar45n]
      ,[aivar5n]
      ,[aivarn]
      ,[ev]
      ,[ort]
      ,[et]
      ,[mu]
      ,[eos]
      ,[kay]
      ,[kieli1]
      ,[kieli2]
      ,[kieli3]
      ,[kieli4]
      ,[kieli5]
      ,[kieli6]
      ,[kieliy]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[svnn]
      ,[rvnn]
      ,[svrvn]
      ,[yaenm]
      ,[yyenm]
      ,[yen6m]
      ,[len6m]
      ,[alen6m]
      ,[enmm]
      ,[yaenn]
      ,[yyenn]
      ,[yen6n]
      ,[len6n]
      ,[alen6n]
      ,[ennn]
      ,[yarum]
      ,[yyrum]
      ,[yru6m]
      ,[lru6m]
      ,[alru6m]
      ,[rumm]
      ,[yarun]
      ,[yyrun]
      ,[yru6n]
      ,[lru6n]
      ,[alru6n]
      ,[runn]
      ,[yasum]
      ,[yysum]
      ,[ysu6m]
      ,[lsu6m]
      ,[alsu6m]
      ,[summ]
      ,[yasun]
      ,[yysun]
      ,[ysu6n]
      ,[lsu6n]
      ,[alsu6n]
      ,[sunn]
      ,[yaram]
      ,[yyram]
      ,[yra6m]
      ,[lra6m]
      ,[alra6m]
      ,[ramm]
      ,[yaran]
      ,[yyran]
      ,[yra6n]
      ,[lra6n]
      ,[alra6n]
      ,[rann]
      ,[yasam]
      ,[yysam]
      ,[ysa6m]
      ,[lsa6m]
      ,[alsa6m]
      ,[samm]
      ,[yasan]
      ,[yysan]
      ,[ysa6n]
      ,[lsa6n]
      ,[alsa6n]
      ,[sann]
      ,[yavem]
      ,[yyvem]
      ,[yve6m]
      ,[lve6m]
      ,[alve6m]
      ,[vemm]
      ,[yaven]
      ,[yyven]
      ,[yve6n]
      ,[lve6n]
      ,[alve6n]
      ,[vennn]
      ,[yasaam]
      ,[ysaa6m]
      ,[lsaa6m]
      ,[alsaa6m]
      ,[saamm]
      ,[yasaan]
      ,[ysaa6n]
      ,[lsaa6n]
      ,[alsaa6n]
      ,[saann]
      ,[yalatm]
      ,[ylat6m]
      ,[lla6m]
      ,[alla6m]
      ,[lamm]
      ,[yalan]
      ,[ylat6n]
      ,[lla6n]
      ,[alla6n]
      ,[lann]
      ,[yaesm]
      ,[yes6m]
      ,[les6m]
      ,[ales6m]
      ,[esmm]
      ,[yaesn]
      ,[yes6n]
      ,[les6n]
      ,[ales6n]
      ,[esnn]
      ,[yaitm]
      ,[yit6m]
      ,[lit6m]
      ,[alit6m]
      ,[itmm]
      ,[yaitn]
      ,[yit6n]
      ,[lit6n]
      ,[alit6n]
      ,[itnn]
      ,[yamum]
      ,[yymum]
      ,[ymu6m]
      ,[lmu6m]
      ,[almu6m]
      ,[mumm]
      ,[yamun]
      ,[yymun]
      ,[ymu6n]
      ,[lmu6n]
      ,[almu6n]
      ,[munn]
      ,[yyvam]
      ,[vamm]
      ,[yyvan]
      ,[vann]
      ,[pmatm]
      ,[pmatn]
      ,[pmaty]
      ,[lmatm]
      ,[lmatn]
      ,[lmaty]
      ,[matm]
      ,[matn]
      ,[maty]
      ,[pma1m]
      ,[pma1n]
      ,[pma2m]
      ,[pma2n]
      ,[pma3m]
      ,[pma3n]
      ,[pma45m]
      ,[pma45n]
      ,[pma6m]
      ,[pma6n]
      ,[pma7m]
      ,[pma7n]
      ,[lma1m]
      ,[lma1n]
      ,[lma2m]
      ,[lma2n]
      ,[lma3m]
      ,[lma3n]
      ,[lma45m]
      ,[lma45n]
      ,[lma6m]
      ,[lma6n]
      ,[lma7m]
      ,[lma7n]
      ,[fy1m]
      ,[fy1n]
      ,[fy2m]
      ,[fy2n]
      ,[fy3m]
      ,[fy3n]
      ,[fy45m]
      ,[fy45n]
      ,[fy6m]
      ,[fy6n]
      ,[fy7m]
      ,[fy7n]
      ,[ke1m]
      ,[ke1n]
      ,[ke2m]
      ,[ke2n]
      ,[ke3m]
      ,[ke3n]
      ,[ke45m]
      ,[ke45n]
      ,[ke6m]
      ,[ke6n]
      ,[ke7m]
      ,[ke7n]
      ,[bi1m]
      ,[bi1n]
      ,[bi2m]
      ,[bi2n]
      ,[bi3m]
      ,[bi3n]
      ,[bi45m]
      ,[bi45n]
      ,[bi6m]
      ,[bi6n]
      ,[bi7m]
      ,[bi7n]
      ,[mt1m]
      ,[mt1n]
      ,[mt2m]
      ,[mt2n]
      ,[mt3m]
      ,[mt3n]
      ,[mt45m]
      ,[mt45n]
      ,[mt6m]
      ,[mt6n]
      ,[mt7m]
      ,[mt7n]
      ,[soma2m]
      ,[soma2n]
      ,[soma3m]
      ,[soma3n]
      ,[sofy2m]
      ,[sofy2n]
      ,[sofy3m]
      ,[sofy3n]
      ,[soke2m]
      ,[soke2n]
      ,[soke3m]
      ,[soke3n]
      ,[sobi2m]
      ,[sobi2n]
      ,[sobi3m]
      ,[sobi3n]
      ,[somt2m]
      ,[somt2n]
      ,[somt3m]
      ,[somt3n]
      ,[sotek2m]
      ,[sotek2n]
      ,[sotek3m]
      ,[sotek3n]
      ,[tietolahde]=''2_5_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
      --,[rivinumero]
  FROM [TK_H9098_CSC].[dbo].[TK_2_5_sopv_12]
  
  UNION ALL

SELECT
	   [tilv]
      ,[tunn]
      ,[jarj]
      ,[nukevy]
      ,[aikevy]
      ,[kev]
      ,[nukevyn]
      ,[aikevyn]
      ,[kevn]
      ,[nukev1]
      ,[nukev2]
      ,[nukev3]
      ,[nukev4]
      ,[nukev]
      ,[nukev1n]
      ,[nukev2n]
      ,[nukev3n]
      ,[nukev4n]
      ,[nukevn]
      ,[aikev1]
      ,[aikev2]
      ,[aikev3]
      ,[aikev4]
      ,[aikev]
      ,[aikev1n]
      ,[aikev2n]
      ,[aikev3n]
      ,[aikev4n]
      ,[aikevn]
      ,[nuvary]
      ,[aivary]
      ,[var]
      ,[nuvaryn]
      ,[aivaryn]
      ,[varn]
      ,[nuyks]
      ,[aiyks]
      ,[yksy]
      ,[nuvar2]
      ,[nuvar25]
      ,[nuvar3]
      ,[nuvar35]
      ,[nuvar4]
      ,[nuvar45]
      ,[nuvar5]
      ,[nuvar]
      ,[nuvar2n]
      ,[nuvar25n]
      ,[nuvar3n]
      ,[nuvar35n]
      ,[nuvar4n]
      ,[nuvar45n]
      ,[nuvar5n]
      ,[nuvarn]
      ,[aivar2]
      ,[aivar25]
      ,[aivar3]
      ,[aivar35]
      ,[aivar4]
      ,[aivar45]
      ,[aivar5]
      ,[aivar]
      ,[aivar2n]
      ,[aivar25n]
      ,[aivar3n]
      ,[aivar35n]
      ,[aivar4n]
      ,[aivar45n]
      ,[aivar5n]
      ,[aivarn]
      ,[ev]
      ,[ort]
      ,[et]
      ,[mu]
      ,[eos]
      ,[kay]
      ,[kieli1]
      ,[kieli2]
      ,[kieli3]
      ,[kieli4]
      ,[kieli5]
      ,[kieli6]
      ,[kieliy]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[svnn]
      ,[rvnn]
      ,[svrvn]
      ,[yaenm]
      ,[yyenm]
      ,[yen6m]
      ,[len6m]
      ,[alen6m]
      ,[enmm]
      ,[yaenn]
      ,[yyenn]
      ,[yen6n]
      ,[len6n]
      ,[alen6n]
      ,[ennn]
      ,[yarum]
      ,[yyrum]
      ,[yru6m]
      ,[lru6m]
      ,[alru6m]
      ,[rumm]
      ,[yarun]
      ,[yyrun]
      ,[yru6n]
      ,[lru6n]
      ,[alru6n]
      ,[runn]
      ,[yasum]
      ,[yysum]
      ,[ysu6m]
      ,[lsu6m]
      ,[alsu6m]
      ,[summ]
      ,[yasun]
      ,[yysun]
      ,[ysu6n]
      ,[lsu6n]
      ,[alsu6n]
      ,[sunn]
      ,[yaram]
      ,[yyram]
      ,[yra6m]
      ,[lra6m]
      ,[alra6m]
      ,[ramm]
      ,[yaran]
      ,[yyran]
      ,[yra6n]
      ,[lra6n]
      ,[alra6n]
      ,[rann]
      ,[yasam]
      ,[yysam]
      ,[ysa6m]
      ,[lsa6m]
      ,[alsa6m]
      ,[samm]
      ,[yasan]
      ,[yysan]
      ,[ysa6n]
      ,[lsa6n]
      ,[alsa6n]
      ,[sann]
      ,[yavem]
      ,[yyvem]
      ,[yve6m]
      ,[lve6m]
      ,[alve6m]
      ,[vemm]
      ,[yaven]
      ,[yyven]
      ,[yve6n]
      ,[lve6n]
      ,[alve6n]
      ,[vennn]
      ,[yasaam]
      ,[ysaa6m]
      ,[lsaa6m]
      ,[alsaa6m]
      ,[saamm]
      ,[yasaan]
      ,[ysaa6n]
      ,[lsaa6n]
      ,[alsaa6n]
      ,[saann]
      ,[yalatm]
      ,[ylat6m]
      ,[lla6m]
      ,[alla6m]
      ,[lamm]
      ,[yalan]
      ,[ylat6n]
      ,[lla6n]
      ,[alla6n]
      ,[lann]
      ,[yaesm]
      ,[yes6m]
      ,[les6m]
      ,[ales6m]
      ,[esmm]
      ,[yaesn]
      ,[yes6n]
      ,[les6n]
      ,[ales6n]
      ,[esnn]
      ,[yaitm]
      ,[yit6m]
      ,[lit6m]
      ,[alit6m]
      ,[itmm]
      ,[yaitn]
      ,[yit6n]
      ,[lit6n]
      ,[alit6n]
      ,[itnn]
      ,[yamum]
      ,[yymum]
      ,[ymu6m]
      ,[lmu6m]
      ,[almu6m]
      ,[mumm]
      ,[yamun]
      ,[yymun]
      ,[ymu6n]
      ,[lmu6n]
      ,[almu6n]
      ,[munn]
      ,[yyvam]
      ,[vamm]
      ,[yyvan]
      ,[vann]
      ,[pmatm]
      ,[pmatn]
      ,[pmaty]
      ,[lmatm]
      ,[lmatn]
      ,[lmaty]
      ,[matm]
      ,[matn]
      ,[maty]
      ,[pma1m]
      ,[pma1n]
      ,[pma2m]
      ,[pma2n]
      ,[pma3m]
      ,[pma3n]
      ,[pma45m]
      ,[pma45n]
      ,[pma6m]
      ,[pma6n]
      ,[pma7m]
      ,[pma7n]
      ,[lma1m]
      ,[lma1n]
      ,[lma2m]
      ,[lma2n]
      ,[lma3m]
      ,[lma3n]
      ,[lma45m]
      ,[lma45n]
      ,[lma6m]
      ,[lma6n]
      ,[lma7m]
      ,[lma7n]
      ,[fy1m]
      ,[fy1n]
      ,[fy2m]
      ,[fy2n]
      ,[fy3m]
      ,[fy3n]
      ,[fy45m]
      ,[fy45n]
      ,[fy6m]
      ,[fy6n]
      ,[fy7m]
      ,[fy7n]
      ,[ke1m]
      ,[ke1n]
      ,[ke2m]
      ,[ke2n]
      ,[ke3m]
      ,[ke3n]
      ,[ke45m]
      ,[ke45n]
      ,[ke6m]
      ,[ke6n]
      ,[ke7m]
      ,[ke7n]
      ,[bi1m]
      ,[bi1n]
      ,[bi2m]
      ,[bi2n]
      ,[bi3m]
      ,[bi3n]
      ,[bi45m]
      ,[bi45n]
      ,[bi6m]
      ,[bi6n]
      ,[bi7m]
      ,[bi7n]
      ,[mt1m]
      ,[mt1n]
      ,[mt2m]
      ,[mt2n]
      ,[mt3m]
      ,[mt3n]
      ,[mt45m]
      ,[mt45n]
      ,[mt6m]
      ,[mt6n]
      ,[mt7m]
      ,[mt7n]
      ,[soma2m]
      ,[soma2n]
      ,[soma3m]
      ,[soma3n]
      ,[sofy2m]
      ,[sofy2n]
      ,[sofy3m]
      ,[sofy3n]
      ,[soke2m]
      ,[soke2n]
      ,[soke3m]
      ,[soke3n]
      ,[sobi2m]
      ,[sobi2n]
      ,[sobi3m]
      ,[sobi3n]
      ,[somt2m]
      ,[somt2n]
      ,[somt3m]
      ,[somt3n]
      ,[sotek2m]
      ,[sotek2n]
      ,[sotek3m]
      ,[sotek3n]
      ,[tietolahde]=''2_5_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
      --,[rivinumero]
  FROM [TK_H9098_CSC].[dbo].[TK_2_5_sopv_14]
  
  UNION ALL

SELECT
	   [tilv]
      ,[tunn]
      ,[jarj]
      ,[nukevy]
      ,[aikevy]
      ,[kev]
      ,[nukevyn]
      ,[aikevyn]
      ,[kevn]
      ,[nukev1]
      ,[nukev2]
      ,[nukev3]
      ,[nukev4]
      ,[nukev]
      ,[nukev1n]
      ,[nukev2n]
      ,[nukev3n]
      ,[nukev4n]
      ,[nukevn]
      ,[aikev1]
      ,[aikev2]
      ,[aikev3]
      ,[aikev4]
      ,[aikev]
      ,[aikev1n]
      ,[aikev2n]
      ,[aikev3n]
      ,[aikev4n]
      ,[aikevn]
      ,[nuvary]
      ,[aivary]
      ,[var]
      ,[nuvaryn]
      ,[aivaryn]
      ,[varn]
      ,[nuyks]
      ,[aiyks]
      ,[yksy]
      ,[nuvar2]
      ,[nuvar25]
      ,[nuvar3]
      ,[nuvar35]
      ,[nuvar4]
      ,[nuvar45]
      ,[nuvar5]
      ,[nuvar]
      ,[nuvar2n]
      ,[nuvar25n]
      ,[nuvar3n]
      ,[nuvar35n]
      ,[nuvar4n]
      ,[nuvar45n]
      ,[nuvar5n]
      ,[nuvarn]
      ,[aivar2]
      ,[aivar25]
      ,[aivar3]
      ,[aivar35]
      ,[aivar4]
      ,[aivar45]
      ,[aivar5]
      ,[aivar]
      ,[aivar2n]
      ,[aivar25n]
      ,[aivar3n]
      ,[aivar35n]
      ,[aivar4n]
      ,[aivar45n]
      ,[aivar5n]
      ,[aivarn]
      ,[ev]
      ,[ort]
      ,[et]
      ,[mu]
      ,[eos]
      ,[kay]
      ,[kieli1]
      ,[kieli2]
      ,[kieli3]
      ,[kieli4]
      ,[kieli5]
      ,[kieli6]
      ,[kieliy]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[svnn]
      ,[rvnn]
      ,[svrvn]
      ,[yaenm]
      ,[yyenm]
      ,[yen6m]
      ,[len6m]
      ,[alen6m]
      ,[enmm]
      ,[yaenn]
      ,[yyenn]
      ,[yen6n]
      ,[len6n]
      ,[alen6n]
      ,[ennn]
      ,[yarum]
      ,[yyrum]
      ,[yru6m]
      ,[lru6m]
      ,[alru6m]
      ,[rumm]
      ,[yarun]
      ,[yyrun]
      ,[yru6n]
      ,[lru6n]
      ,[alru6n]
      ,[runn]
      ,[yasum]
      ,[yysum]
      ,[ysu6m]
      ,[lsu6m]
      ,[alsu6m]
      ,[summ]
      ,[yasun]
      ,[yysun]
      ,[ysu6n]
      ,[lsu6n]
      ,[alsu6n]
      ,[sunn]
      ,[yaram]
      ,[yyram]
      ,[yra6m]
      ,[lra6m]
      ,[alra6m]
      ,[ramm]
      ,[yaran]
      ,[yyran]
      ,[yra6n]
      ,[lra6n]
      ,[alra6n]
      ,[rann]
      ,[yasam]
      ,[yysam]
      ,[ysa6m]
      ,[lsa6m]
      ,[alsa6m]
      ,[samm]
      ,[yasan]
      ,[yysan]
      ,[ysa6n]
      ,[lsa6n]
      ,[alsa6n]
      ,[sann]
      ,[yavem]
      ,[yyvem]
      ,[yve6m]
      ,[lve6m]
      ,[alve6m]
      ,[vemm]
      ,[yaven]
      ,[yyven]
      ,[yve6n]
      ,[lve6n]
      ,[alve6n]
      ,[vennn]
      ,[yasaam]
      ,[ysaa6m]
      ,[lsaa6m]
      ,[alsaa6m]
      ,[saamm]
      ,[yasaan]
      ,[ysaa6n]
      ,[lsaa6n]
      ,[alsaa6n]
      ,[saann]
      ,[yalatm]
      ,[ylat6m]
      ,[lla6m]
      ,[alla6m]
      ,[lamm]
      ,[yalan]
      ,[ylat6n]
      ,[lla6n]
      ,[alla6n]
      ,[lann]
      ,[yaesm]
      ,[yes6m]
      ,[les6m]
      ,[ales6m]
      ,[esmm]
      ,[yaesn]
      ,[yes6n]
      ,[les6n]
      ,[ales6n]
      ,[esnn]
      ,[yaitm]
      ,[yit6m]
      ,[lit6m]
      ,[alit6m]
      ,[itmm]
      ,[yaitn]
      ,[yit6n]
      ,[lit6n]
      ,[alit6n]
      ,[itnn]
      ,[yamum]
      ,[yymum]
      ,[ymu6m]
      ,[lmu6m]
      ,[almu6m]
      ,[mumm]
      ,[yamun]
      ,[yymun]
      ,[ymu6n]
      ,[lmu6n]
      ,[almu6n]
      ,[munn]
      ,[yyvam]
      ,[vamm]
      ,[yyvan]
      ,[vann]
      ,[pmatm]
      ,[pmatn]
      ,[pmaty]
      ,[lmatm]
      ,[lmatn]
      ,[lmaty]
      ,[matm]
      ,[matn]
      ,[maty]
      ,[pma1m]
      ,[pma1n]
      ,[pma2m]
      ,[pma2n]
      ,[pma3m]
      ,[pma3n]
      ,[pma45m]
      ,[pma45n]
      ,[pma6m]
      ,[pma6n]
      ,[pma7m]
      ,[pma7n]
      ,[lma1m]
      ,[lma1n]
      ,[lma2m]
      ,[lma2n]
      ,[lma3m]
      ,[lma3n]
      ,[lma45m]
      ,[lma45n]
      ,[lma6m]
      ,[lma6n]
      ,[lma7m]
      ,[lma7n]
      ,[fy1m]
      ,[fy1n]
      ,[fy2m]
      ,[fy2n]
      ,[fy3m]
      ,[fy3n]
      ,[fy45m]
      ,[fy45n]
      ,[fy6m]
      ,[fy6n]
      ,[fy7m]
      ,[fy7n]
      ,[ke1m]
      ,[ke1n]
      ,[ke2m]
      ,[ke2n]
      ,[ke3m]
      ,[ke3n]
      ,[ke45m]
      ,[ke45n]
      ,[ke6m]
      ,[ke6n]
      ,[ke7m]
      ,[ke7n]
      ,[bi1m]
      ,[bi1n]
      ,[bi2m]
      ,[bi2n]
      ,[bi3m]
      ,[bi3n]
      ,[bi45m]
      ,[bi45n]
      ,[bi6m]
      ,[bi6n]
      ,[bi7m]
      ,[bi7n]
      ,[mt1m]
      ,[mt1n]
      ,[mt2m]
      ,[mt2n]
      ,[mt3m]
      ,[mt3n]
      ,[mt45m]
      ,[mt45n]
      ,[mt6m]
      ,[mt6n]
      ,[mt7m]
      ,[mt7n]
      ,[soma2m]
      ,[soma2n]
      ,[soma3m]
      ,[soma3n]
      ,[sofy2m]
      ,[sofy2n]
      ,[sofy3m]
      ,[sofy3n]
      ,[soke2m]
      ,[soke2n]
      ,[soke3m]
      ,[soke3n]
      ,[sobi2m]
      ,[sobi2n]
      ,[sobi3m]
      ,[sobi3n]
      ,[somt2m]
      ,[somt2n]
      ,[somt3m]
      ,[somt3n]
      ,[sotek2m]
      ,[sotek2n]
      ,[sotek3m]
      ,[sotek3n]
      ,[tietolahde]=''2_5_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
      --,[rivinumero]
  FROM [TK_H9098_CSC].[dbo].[TK_2_5_sopv_16]

UNION ALL

SELECT
	   [tilv]
      ,[tunn]
      ,[jarj]
      ,[nukevy]
      ,[aikevy]
      ,[kev]
      ,[nukevyn]
      ,[aikevyn]
      ,[kevn]
      ,[nukev1]
      ,[nukev2]
      ,[nukev3]
      ,[nukev4]
      ,[nukev]
      ,[nukev1n]
      ,[nukev2n]
      ,[nukev3n]
      ,[nukev4n]
      ,[nukevn]
      ,[aikev1]
      ,[aikev2]
      ,[aikev3]
      ,[aikev4]
      ,[aikev]
      ,[aikev1n]
      ,[aikev2n]
      ,[aikev3n]
      ,[aikev4n]
      ,[aikevn]
      ,[nuvary]
      ,[aivary]
      ,[var]
      ,[nuvaryn]
      ,[aivaryn]
      ,[varn]
      ,[nuyks]
      ,[aiyks]
      ,[yksy]
      ,[nuvar2]
      ,[nuvar25]
      ,[nuvar3]
      ,[nuvar35]
      ,[nuvar4]
      ,[nuvar45]
      ,[nuvar5]
      ,[nuvar]
      ,[nuvar2n]
      ,[nuvar25n]
      ,[nuvar3n]
      ,[nuvar35n]
      ,[nuvar4n]
      ,[nuvar45n]
      ,[nuvar5n]
      ,[nuvarn]
      ,[aivar2]
      ,[aivar25]
      ,[aivar3]
      ,[aivar35]
      ,[aivar4]
      ,[aivar45]
      ,[aivar5]
      ,[aivar]
      ,[aivar2n]
      ,[aivar25n]
      ,[aivar3n]
      ,[aivar35n]
      ,[aivar4n]
      ,[aivar45n]
      ,[aivar5n]
      ,[aivarn]
      ,[ev]
      ,[ort]
      ,[et]
      ,[mu]
      ,[eos]
      ,[kay]
      ,[kieli1]
      ,[kieli2]
      ,[kieli3]
      ,[kieli4]
      ,[kieli5]
      ,[kieli6]
      ,[kieliy]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[svnn]
      ,[rvnn]
      ,[svrvn]
      ,[yaenm]
      ,[yyenm]
      ,[yen6m]
      ,[len6m]
      ,[alen6m]
      ,[enmm]
      ,[yaenn]
      ,[yyenn]
      ,[yen6n]
      ,[len6n]
      ,[alen6n]
      ,[ennn]
      ,[yarum]
      ,[yyrum]
      ,[yru6m]
      ,[lru6m]
      ,[alru6m]
      ,[rumm]
      ,[yarun]
      ,[yyrun]
      ,[yru6n]
      ,[lru6n]
      ,[alru6n]
      ,[runn]
      ,[yasum]
      ,[yysum]
      ,[ysu6m]
      ,[lsu6m]
      ,[alsu6m]
      ,[summ]
      ,[yasun]
      ,[yysun]
      ,[ysu6n]
      ,[lsu6n]
      ,[alsu6n]
      ,[sunn]
      ,[yaram]
      ,[yyram]
      ,[yra6m]
      ,[lra6m]
      ,[alra6m]
      ,[ramm]
      ,[yaran]
      ,[yyran]
      ,[yra6n]
      ,[lra6n]
      ,[alra6n]
      ,[rann]
      ,[yasam]
      ,[yysam]
      ,[ysa6m]
      ,[lsa6m]
      ,[alsa6m]
      ,[samm]
      ,[yasan]
      ,[yysan]
      ,[ysa6n]
      ,[lsa6n]
      ,[alsa6n]
      ,[sann]
      ,[yavem]
      ,[yyvem]
      ,[yve6m]
      ,[lve6m]
      ,[alve6m]
      ,[vemm]
      ,[yaven]
      ,[yyven]
      ,[yve6n]
      ,[lve6n]
      ,[alve6n]
      ,[vennn]
      ,[yasaam]
      ,[ysaa6m]
      ,[lsaa6m]
      ,[alsaa6m]
      ,[saamm]
      ,[yasaan]
      ,[ysaa6n]
      ,[lsaa6n]
      ,[alsaa6n]
      ,[saann]
      ,[yalatm]
      ,[ylat6m]
      ,[lla6m]
      ,[alla6m]
      ,[lamm]
      ,[yalan]
      ,[ylat6n]
      ,[lla6n]
      ,[alla6n]
      ,[lann]
      ,[yaesm]
      ,[yes6m]
      ,[les6m]
      ,[ales6m]
      ,[esmm]
      ,[yaesn]
      ,[yes6n]
      ,[les6n]
      ,[ales6n]
      ,[esnn]
      ,[yaitm]
      ,[yit6m]
      ,[lit6m]
      ,[alit6m]
      ,[itmm]
      ,[yaitn]
      ,[yit6n]
      ,[lit6n]
      ,[alit6n]
      ,[itnn]
      ,[yamum]
      ,[yymum]
      ,[ymu6m]
      ,[lmu6m]
      ,[almu6m]
      ,[mumm]
      ,[yamun]
      ,[yymun]
      ,[ymu6n]
      ,[lmu6n]
      ,[almu6n]
      ,[munn]
      ,[yyvam]
      ,[vamm]
      ,[yyvan]
      ,[vann]
      ,[pmatm]
      ,[pmatn]
      ,[pmaty]
      ,[lmatm]
      ,[lmatn]
      ,[lmaty]
      ,[matm]
      ,[matn]
      ,[maty]
      ,[pma1m]
      ,[pma1n]
      ,[pma2m]
      ,[pma2n]
      ,[pma3m]
      ,[pma3n]
      ,[pma45m]
      ,[pma45n]
      ,[pma6m]
      ,[pma6n]
      ,[pma7m]
      ,[pma7n]
      ,[lma1m]
      ,[lma1n]
      ,[lma2m]
      ,[lma2n]
      ,[lma3m]
      ,[lma3n]
      ,[lma45m]
      ,[lma45n]
      ,[lma6m]
      ,[lma6n]
      ,[lma7m]
      ,[lma7n]
      ,[fy1m]
      ,[fy1n]
      ,[fy2m]
      ,[fy2n]
      ,[fy3m]
      ,[fy3n]
      ,[fy45m]
      ,[fy45n]
      ,[fy6m]
      ,[fy6n]
      ,[fy7m]
      ,[fy7n]
      ,[ke1m]
      ,[ke1n]
      ,[ke2m]
      ,[ke2n]
      ,[ke3m]
      ,[ke3n]
      ,[ke45m]
      ,[ke45n]
      ,[ke6m]
      ,[ke6n]
      ,[ke7m]
      ,[ke7n]
      ,[bi1m]
      ,[bi1n]
      ,[bi2m]
      ,[bi2n]
      ,[bi3m]
      ,[bi3n]
      ,[bi45m]
      ,[bi45n]
      ,[bi6m]
      ,[bi6n]
      ,[bi7m]
      ,[bi7n]
      ,[mt1m]
      ,[mt1n]
      ,[mt2m]
      ,[mt2n]
      ,[mt3m]
      ,[mt3n]
      ,[mt45m]
      ,[mt45n]
      ,[mt6m]
      ,[mt6n]
      ,[mt7m]
      ,[mt7n]
      ,[soma2m]
      ,[soma2n]
      ,[soma3m]
      ,[soma3n]
      ,[sofy2m]
      ,[sofy2n]
      ,[sofy3m]
      ,[sofy3n]
      ,[soke2m]
      ,[soke2n]
      ,[soke3m]
      ,[soke3n]
      ,[sobi2m]
      ,[sobi2n]
      ,[sobi3m]
      ,[sobi3n]
      ,[somt2m]
      ,[somt2n]
      ,[somt3m]
      ,[somt3n]
      ,[sotek2m]
      ,[sotek2n]
      ,[sotek3m]
      ,[sotek3n]
      ,[tietolahde]=''2_5_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
      --,[rivinumero]
  FROM [TK_H9098_CSC].[dbo].[TK_2_5_sopv_17]

UNION ALL

SELECT
	   [tilv]
      ,[tunn]
      ,[jarj]
      ,[nukevy]
      ,[aikevy]
      ,[kev]
      ,[nukevyn]
      ,[aikevyn]
      ,[kevn]
      ,[nukev1]
      ,[nukev2]
      ,[nukev3]
      ,[nukev4]
      ,[nukev]
      ,[nukev1n]
      ,[nukev2n]
      ,[nukev3n]
      ,[nukev4n]
      ,[nukevn]
      ,[aikev1]
      ,[aikev2]
      ,[aikev3]
      ,[aikev4]
      ,[aikev]
      ,[aikev1n]
      ,[aikev2n]
      ,[aikev3n]
      ,[aikev4n]
      ,[aikevn]
      ,[nuvary]
      ,[aivary]
      ,[var]
      ,[nuvaryn]
      ,[aivaryn]
      ,[varn]
      ,[nuyks]
      ,[aiyks]
      ,[yksy]
      ,[nuvar2]
      ,[nuvar25]
      ,[nuvar3]
      ,[nuvar35]
      ,[nuvar4]
      ,[nuvar45]
      ,[nuvar5]
      ,[nuvar]
      ,[nuvar2n]
      ,[nuvar25n]
      ,[nuvar3n]
      ,[nuvar35n]
      ,[nuvar4n]
      ,[nuvar45n]
      ,[nuvar5n]
      ,[nuvarn]
      ,[aivar2]
      ,[aivar25]
      ,[aivar3]
      ,[aivar35]
      ,[aivar4]
      ,[aivar45]
      ,[aivar5]
      ,[aivar]
      ,[aivar2n]
      ,[aivar25n]
      ,[aivar3n]
      ,[aivar35n]
      ,[aivar4n]
      ,[aivar45n]
      ,[aivar5n]
      ,[aivarn]
      ,[ev]
      ,[ort]
      ,[et]
      ,[mu]
      ,[eos]
      ,[kay]
      ,[kieli1]
      ,[kieli2]
      ,[kieli3]
      ,[kieli4]
      ,[kieli5]
      ,[kieli6]
      ,[kieliy]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[svnn]
      ,[rvnn]
      ,[svrvn]
      ,[yaenm]
      ,[yyenm]
      ,[yen6m]
      ,[len6m]
      ,[alen6m]
      ,[enmm]
      ,[yaenn]
      ,[yyenn]
      ,[yen6n]
      ,[len6n]
      ,[alen6n]
      ,[ennn]
      ,[yarum]
      ,[yyrum]
      ,[yru6m]
      ,[lru6m]
      ,[alru6m]
      ,[rumm]
      ,[yarun]
      ,[yyrun]
      ,[yru6n]
      ,[lru6n]
      ,[alru6n]
      ,[runn]
      ,[yasum]
      ,[yysum]
      ,[ysu6m]
      ,[lsu6m]
      ,[alsu6m]
      ,[summ]
      ,[yasun]
      ,[yysun]
      ,[ysu6n]
      ,[lsu6n]
      ,[alsu6n]
      ,[sunn]
      ,[yaram]
      ,[yyram]
      ,[yra6m]
      ,[lra6m]
      ,[alra6m]
      ,[ramm]
      ,[yaran]
      ,[yyran]
      ,[yra6n]
      ,[lra6n]
      ,[alra6n]
      ,[rann]
      ,[yasam]
      ,[yysam]
      ,[ysa6m]
      ,[lsa6m]
      ,[alsa6m]
      ,[samm]
      ,[yasan]
      ,[yysan]
      ,[ysa6n]
      ,[lsa6n]
      ,[alsa6n]
      ,[sann]
      ,[yavem]
      ,[yyvem]
      ,[yve6m]
      ,[lve6m]
      ,[alve6m]
      ,[vemm]
      ,[yaven]
      ,[yyven]
      ,[yve6n]
      ,[lve6n]
      ,[alve6n]
      ,[vennn]
      ,[yasaam]
      ,[ysaa6m]
      ,[lsaa6m]
      ,[alsaa6m]
      ,[saamm]
      ,[yasaan]
      ,[ysaa6n]
      ,[lsaa6n]
      ,[alsaa6n]
      ,[saann]
      ,[yalatm]
      ,[ylat6m]
      ,[lla6m]
      ,[alla6m]
      ,[lamm]
      ,[yalan]
      ,[ylat6n]
      ,[lla6n]
      ,[alla6n]
      ,[lann]
      ,[yaesm]
      ,[yes6m]
      ,[les6m]
      ,[ales6m]
      ,[esmm]
      ,[yaesn]
      ,[yes6n]
      ,[les6n]
      ,[ales6n]
      ,[esnn]
      ,[yaitm]
      ,[yit6m]
      ,[lit6m]
      ,[alit6m]
      ,[itmm]
      ,[yaitn]
      ,[yit6n]
      ,[lit6n]
      ,[alit6n]
      ,[itnn]
      ,[yamum]
      ,[yymum]
      ,[ymu6m]
      ,[lmu6m]
      ,[almu6m]
      ,[mumm]
      ,[yamun]
      ,[yymun]
      ,[ymu6n]
      ,[lmu6n]
      ,[almu6n]
      ,[munn]
      ,[yyvam]
      ,[vamm]
      ,[yyvan]
      ,[vann]
      ,[pmatm]
      ,[pmatn]
      ,[pmaty]
      ,[lmatm]
      ,[lmatn]
      ,[lmaty]
      ,[matm]
      ,[matn]
      ,[maty]
      ,[pma1m]
      ,[pma1n]
      ,[pma2m]
      ,[pma2n]
      ,[pma3m]
      ,[pma3n]
      ,[pma45m]
      ,[pma45n]
      ,[pma6m]
      ,[pma6n]
      ,[pma7m]
      ,[pma7n]
      ,[lma1m]
      ,[lma1n]
      ,[lma2m]
      ,[lma2n]
      ,[lma3m]
      ,[lma3n]
      ,[lma45m]
      ,[lma45n]
      ,[lma6m]
      ,[lma6n]
      ,[lma7m]
      ,[lma7n]
      ,[fy1m]
      ,[fy1n]
      ,[fy2m]
      ,[fy2n]
      ,[fy3m]
      ,[fy3n]
      ,[fy45m]
      ,[fy45n]
      ,[fy6m]
      ,[fy6n]
      ,[fy7m]
      ,[fy7n]
      ,[ke1m]
      ,[ke1n]
      ,[ke2m]
      ,[ke2n]
      ,[ke3m]
      ,[ke3n]
      ,[ke45m]
      ,[ke45n]
      ,[ke6m]
      ,[ke6n]
      ,[ke7m]
      ,[ke7n]
      ,[bi1m]
      ,[bi1n]
      ,[bi2m]
      ,[bi2n]
      ,[bi3m]
      ,[bi3n]
      ,[bi45m]
      ,[bi45n]
      ,[bi6m]
      ,[bi6n]
      ,[bi7m]
      ,[bi7n]
      ,[mt1m]
      ,[mt1n]
      ,[mt2m]
      ,[mt2n]
      ,[mt3m]
      ,[mt3n]
      ,[mt45m]
      ,[mt45n]
      ,[mt6m]
      ,[mt6n]
      ,[mt7m]
      ,[mt7n]
      ,[soma2m]
      ,[soma2n]
      ,[soma3m]
      ,[soma3n]
      ,[sofy2m]
      ,[sofy2n]
      ,[sofy3m]
      ,[sofy3n]
      ,[soke2m]
      ,[soke2n]
      ,[soke3m]
      ,[soke3n]
      ,[sobi2m]
      ,[sobi2n]
      ,[sobi3m]
      ,[sobi3n]
      ,[somt2m]
      ,[somt2n]
      ,[somt3m]
      ,[somt3n]
      ,[sotek2m]
      ,[sotek2n]
      ,[sotek3m]
      ,[sotek3n]
      ,[tietolahde]=''2_5_sopv_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
      --,[rivinumero]
  FROM [TK_H9098_CSC].[dbo].[TK_2_5_sopv_18]

UNION ALL

SELECT
	   [tilv]
      ,[tunn]
      ,[jarj]
      ,[nukevy]
      ,[aikevy]
      ,[kev]
      ,[nukevyn]
      ,[aikevyn]
      ,[kevn]
      ,[nukev1]
      ,[nukev2]
      ,[nukev3]
      ,[nukev4]
      ,[nukev]
      ,[nukev1n]
      ,[nukev2n]
      ,[nukev3n]
      ,[nukev4n]
      ,[nukevn]
      ,[aikev1]
      ,[aikev2]
      ,[aikev3]
      ,[aikev4]
      ,[aikev]
      ,[aikev1n]
      ,[aikev2n]
      ,[aikev3n]
      ,[aikev4n]
      ,[aikevn]
      ,[nuvary]
      ,[aivary]
      ,[var]
      ,[nuvaryn]
      ,[aivaryn]
      ,[varn]
      ,[nuyks]
      ,[aiyks]
      ,[yksy]
      ,[nuvar2]
      ,[nuvar25]
      ,[nuvar3]
      ,[nuvar35]
      ,[nuvar4]
      ,[nuvar45]
      ,[nuvar5]
      ,[nuvar]
      ,[nuvar2n]
      ,[nuvar25n]
      ,[nuvar3n]
      ,[nuvar35n]
      ,[nuvar4n]
      ,[nuvar45n]
      ,[nuvar5n]
      ,[nuvarn]
      ,[aivar2]
      ,[aivar25]
      ,[aivar3]
      ,[aivar35]
      ,[aivar4]
      ,[aivar45]
      ,[aivar5]
      ,[aivar]
      ,[aivar2n]
      ,[aivar25n]
      ,[aivar3n]
      ,[aivar35n]
      ,[aivar4n]
      ,[aivar45n]
      ,[aivar5n]
      ,[aivarn]
      ,[ev]
      ,[ort]
      ,[et]
      ,[mu]
      ,[eos]
      ,[kay]
      ,[kieli1]
      ,[kieli2]
      ,[kieli3]
      ,[kieli4]
      ,[kieli5]
      ,[kieli6]
      ,[kieliy]
      ,[sv]
      ,[rv]
      ,[svrv]
      ,[svnn]
      ,[rvnn]
      ,[svrvn]
      ,[yaenm]
      ,[yyenm]
      ,[yen6m]
      ,[len6m]
      ,[alen6m]
      ,[enmm]
      ,[yaenn]
      ,[yyenn]
      ,[yen6n]
      ,[len6n]
      ,[alen6n]
      ,[ennn]
      ,[yarum]
      ,[yyrum]
      ,[yru6m]
      ,[lru6m]
      ,[alru6m]
      ,[rumm]
      ,[yarun]
      ,[yyrun]
      ,[yru6n]
      ,[lru6n]
      ,[alru6n]
      ,[runn]
      ,[yasum]
      ,[yysum]
      ,[ysu6m]
      ,[lsu6m]
      ,[alsu6m]
      ,[summ]
      ,[yasun]
      ,[yysun]
      ,[ysu6n]
      ,[lsu6n]
      ,[alsu6n]
      ,[sunn]
      ,[yaram]
      ,[yyram]
      ,[yra6m]
      ,[lra6m]
      ,[alra6m]
      ,[ramm]
      ,[yaran]
      ,[yyran]
      ,[yra6n]
      ,[lra6n]
      ,[alra6n]
      ,[rann]
      ,[yasam]
      ,[yysam]
      ,[ysa6m]
      ,[lsa6m]
      ,[alsa6m]
      ,[samm]
      ,[yasan]
      ,[yysan]
      ,[ysa6n]
      ,[lsa6n]
      ,[alsa6n]
      ,[sann]
      ,[yavem]
      ,[yyvem]
      ,[yve6m]
      ,[lve6m]
      ,[alve6m]
      ,[vemm]
      ,[yaven]
      ,[yyven]
      ,[yve6n]
      ,[lve6n]
      ,[alve6n]
      ,[vennn]
      ,[yasaam]
      ,[ysaa6m]
      ,[lsaa6m]
      ,[alsaa6m]
      ,[saamm]
      ,[yasaan]
      ,[ysaa6n]
      ,[lsaa6n]
      ,[alsaa6n]
      ,[saann]
      ,[yalatm]
      ,[ylat6m]
      ,[lla6m]
      ,[alla6m]
      ,[lamm]
      ,[yalan]
      ,[ylat6n]
      ,[lla6n]
      ,[alla6n]
      ,[lann]
      ,[yaesm]
      ,[yes6m]
      ,[les6m]
      ,[ales6m]
      ,[esmm]
      ,[yaesn]
      ,[yes6n]
      ,[les6n]
      ,[ales6n]
      ,[esnn]
      ,[yaitm]
      ,[yit6m]
      ,[lit6m]
      ,[alit6m]
      ,[itmm]
      ,[yaitn]
      ,[yit6n]
      ,[lit6n]
      ,[alit6n]
      ,[itnn]
      ,[yamum]
      ,[yymum]
      ,[ymu6m]
      ,[lmu6m]
      ,[almu6m]
      ,[mumm]
      ,[yamun]
      ,[yymun]
      ,[ymu6n]
      ,[lmu6n]
      ,[almu6n]
      ,[munn]
      ,[yyvam]
      ,[vamm]
      ,[yyvan]
      ,[vann]
      ,[pmatm]
      ,[pmatn]
      ,[pmaty]
      ,[lmatm]
      ,[lmatn]
      ,[lmaty]
      ,[matm]
      ,[matn]
      ,[maty]
      ,[pma1m]
      ,[pma1n]
      ,[pma2m]
      ,[pma2n]
      ,[pma3m]
      ,[pma3n]
      ,[pma45m]
      ,[pma45n]
      ,[pma6m]
      ,[pma6n]
      ,[pma7m]
      ,[pma7n]
      ,[lma1m]
      ,[lma1n]
      ,[lma2m]
      ,[lma2n]
      ,[lma3m]
      ,[lma3n]
      ,[lma45m]
      ,[lma45n]
      ,[lma6m]
      ,[lma6n]
      ,[lma7m]
      ,[lma7n]
      ,[fy1m]
      ,[fy1n]
      ,[fy2m]
      ,[fy2n]
      ,[fy3m]
      ,[fy3n]
      ,[fy45m]
      ,[fy45n]
      ,[fy6m]
      ,[fy6n]
      ,[fy7m]
      ,[fy7n]
      ,[ke1m]
      ,[ke1n]
      ,[ke2m]
      ,[ke2n]
      ,[ke3m]
      ,[ke3n]
      ,[ke45m]
      ,[ke45n]
      ,[ke6m]
      ,[ke6n]
      ,[ke7m]
      ,[ke7n]
      ,[bi1m]
      ,[bi1n]
      ,[bi2m]
      ,[bi2n]
      ,[bi3m]
      ,[bi3n]
      ,[bi45m]
      ,[bi45n]
      ,[bi6m]
      ,[bi6n]
      ,[bi7m]
      ,[bi7n]
      ,[mt1m]
      ,[mt1n]
      ,[mt2m]
      ,[mt2n]
      ,[mt3m]
      ,[mt3n]
      ,[mt45m]
      ,[mt45n]
      ,[mt6m]
      ,[mt6n]
      ,[mt7m]
      ,[mt7n]
      ,[soma2m]
      ,[soma2n]
      ,[soma3m]
      ,[soma3n]
      ,[sofy2m]
      ,[sofy2n]
      ,[sofy3m]
      ,[sofy3n]
      ,[soke2m]
      ,[soke2n]
      ,[soke3m]
      ,[soke3n]
      ,[sobi2m]
      ,[sobi2n]
      ,[sobi3m]
      ,[sobi3n]
      ,[somt2m]
      ,[somt2n]
      ,[somt3m]
      ,[somt3n]
      ,[sotek2m]
      ,[sotek2n]
      ,[sotek3m]
      ,[sotek3n]
      ,[tietolahde]=''2_5_sopv_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv, tunn)
      --,[rivinumero]
  FROM [TK_H9098_CSC].[dbo].[TK_2_5_sopv_19]

) Aineistot




' 
GO
/****** Object:  View [dbo].[v_sa_2_6_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_6_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_sa_2_6_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet] AS
SELECT [tilv] = CAST(tilv as nvarchar(4))
      ,[lahde] = CAST(COALESCE(NULLIF(lahde , ''''), ''-1'') as nvarchar(2))
      ,[perusjoukko] = CAST(COALESCE(NULLIF(perusjoukko, ''''), ''-1'') as nvarchar(2))
      ,[koulk] = CAST(COALESCE(NULLIF(koulk, ''''), ''-1'') as nvarchar(6))
      ,[tutklaja] = CAST(COALESCE(NULLIF(tutklaja , ''''), ''-1'') as nvarchar(2))
      ,[tutktav] = CAST(COALESCE(NULLIF(tutktav , ''''), ''-1'') as nvarchar(2))
      ,[kkieli] = CAST(COALESCE(NULLIF(kkieli , ''''), ''-1'') as nvarchar(2))
      ,[kmaak] = CAST(COALESCE(NULLIF((SELECT [maakunta_koodi_nykytila] FROM [VipunenTK_lisatiedot].[dbo].[alueluokitus_maakunta_korjaus] WHERE [maakunta_koodi] = kmaak), ''''), NULLIF(kmaak , ''''), ''-1'') as nvarchar(2))
      ,[knuts2u] = CAST(COALESCE(NULLIF(knuts2u , ''''), ''-1'') as nvarchar(2))
      ,[kkunryh] = CAST(COALESCE(NULLIF(kkunryh , ''''), ''-1'') as nvarchar(2))
      ,[kely] = CAST(COALESCE(NULLIF(kely , ''''), ''-1'') as nvarchar(2))
      ,[kavi] = CAST(COALESCE(NULLIF(kavi , ''''), ''-1'') as nvarchar(2))
      ,[sp] = CAST(COALESCE(NULLIF(sp , ''''), ''-1'') as nvarchar(2))
      ,[aikielir1] = CAST(COALESCE(NULLIF(aikielir1 , ''''), ''-1'') as nvarchar(2))
      ,[kansalr2] = CAST(COALESCE(NULLIF(kansalr2 , ''''), ''-1'') as nvarchar(2))
      ,[alvv] = CAST(alvv as nvarchar(4))
      ,[allk] = CAST(allk as nvarchar(1))
      ,[olotamm] = CAST(olotamm as nvarchar(1))
      ,[olosyys] = CAST(olosyys as nvarchar(1))
      ,[aiopis] = CAST(COALESCE(NULLIF(aiopis , ''''), ''-1'') as nvarchar(2))
      ,[erper] = CAST(COALESCE(NULLIF(erper , ''''), ''-1'') as nvarchar(2))
      ,[erryh] = CAST(COALESCE(NULLIF(erryh , ''''), ''-1'') as nvarchar(2))
      ,[ammos] = CAST(ammos as int)
      ,[opintokok] = CAST(opintokok as int)
      ,[lkm] = CAST(lkm as int)
	  ,tietolahde
FROM
(SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[knuts2u]
      ,[kkunryh]
      ,[kely]
      ,[kavi]
      ,[sp]
      ,[aikielir1]
      ,[kansalr2]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[aiopis]
      ,[erper]
      ,[erryh]
      ,[ammos]
      ,[opintokok]
      ,[lkm]
	  ,tietolahde = ''2_6_sopv_11''
FROM [TK_H9098_CSC].[dbo].[TK_2_6_sopv_11]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[knuts2u]
      ,[kkunryh]
      ,[kely]
      ,[kavi]
      ,[sp]
      ,[aikielir1]
      ,[kansalr2]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[aiopis]
      ,[erper]
      ,[erryh]
      ,[ammos]
      ,[opintokok]
      ,[lkm]
	  ,tietolahde = ''2_6_sopv_12''
FROM [TK_H9098_CSC].[dbo].[TK_2_6_sopv_12]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[knuts2u]
      ,[kkunryh]
      ,[kely]
      ,[kavi]
      ,[sp]
      ,[aikielir1]
      ,[kansalr2]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[aiopis]
      ,[erper]
      ,[erryh]
      ,[ammos]
      ,[opintokok]
      ,[lkm]
	  ,tietolahde = ''2_6_sopv_13''
FROM [TK_H9098_CSC].[dbo].[TK_2_6_sopv_13]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[knuts2u]
      ,[kkunryh]
      ,[kely]
      ,[kavi]
      ,[sp]
      ,[aikielir1]
      ,[kansalr2]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[aiopis]
      ,[erper]
      ,[erryh]
      ,[ammos]
      ,[opintokok]
      ,[lkm]
	  ,tietolahde = ''2_6_sopv_14''
FROM [TK_H9098_CSC].[dbo].[TK_2_6_sopv_14]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[knuts2u]
      ,[kkunryh]
      ,[kely]
      ,[kavi]
      ,[sp]
      ,[aikielir1]
      ,[kansalr2]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[aiopis]
      ,[erper]
      ,[erryh]
      ,[ammos]
      ,[opintokok]
      ,[lkm]
	  ,tietolahde = ''2_6_sopv_15''
FROM [TK_H9098_CSC].[dbo].[TK_2_6_sopv_15]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[knuts2u]
      ,[kkunryh]
      ,[kely]
      ,[kavi]
      ,[sp]
      ,[aikielir1]
      ,[kansalr2]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[aiopis]
      ,[erper]
      ,[erryh]
      ,[ammos]
      ,[opintokok]
      ,[lkm]
	  ,tietolahde = ''2_6_sopv_16''
FROM [TK_H9098_CSC].[dbo].[TK_2_6_sopv_16]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[knuts2u]
      ,[kkunryh]
      ,[kely]
      ,[kavi]
      ,[sp]
      ,[aikielir1]
      ,[kansalr2]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[aiopis]
      ,[erper]
      ,[erryh]
      ,[ammos] = NULL
      ,[opintokok] = NULL
      ,[lkm]
	  ,tietolahde = ''2_6_sopv_17''
FROM [TK_H9098_CSC].[dbo].[TK_2_6_sopv_17]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[knuts2u]
      ,[kkunryh]
      ,[kely]
      ,[kavi]
      ,[sp]
      ,[aikielir1]
      ,[kansalr2]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[aiopis]
      ,[erper] = NULL
      ,[erryh]
      ,[ammos] = NULL
      ,[opintokok] = NULL
      ,[lkm]
	  ,tietolahde = ''2_6_sopv_18''
FROM [TK_H9098_CSC].[dbo].[TK_2_6_sopv_18]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[knuts2u]
      ,[kkunryh]
      ,[kely]
      ,[kavi]
      ,[sp]
      ,[aikielir1]
      ,[kansalr2]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[aiopis]
      ,[erper] = NULL
      ,[erryh]
      ,[ammos] = NULL
      ,[opintokok] = NULL
      ,[lkm]
	  ,tietolahde = ''2_6_sopv_19''
FROM [TK_H9098_CSC].[dbo].[TK_K2_6_sopv_19]


) kaikkivuodet






' 
GO
/****** Object:  View [dbo].[v_sa_2_7_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet_jarjestajittain]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_7_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet_jarjestajittain]'))
EXEC dbo.sp_executesql @statement = N'









CREATE VIEW [dbo].[v_sa_2_7_ammatillisen_koulutuksen_erityisopetuksen_opiskelijat_ja_tutkinnon_suorittaneet_jarjestajittain] AS
SELECT [tilv] = CAST(tilv as nvarchar(4))
      ,[lahde] = CAST(COALESCE(NULLIF(lahde , ''''), ''-1'') as nvarchar(2))
      ,[perusjoukko] = CAST(COALESCE(NULLIF(perusjoukko, ''''), ''-1'') as nvarchar(2))
      ,[tunn] = CAST(COALESCE(NULLIF(tunn, ''''), ''-1'') as nvarchar(5))
      ,[jarj] = CAST(COALESCE(NULLIF(jarj, ''''), ''-1'') as nvarchar(10))
      ,[opjarj] = CAST(COALESCE(NULLIF(opjarj, ''''), ''-1'') as nvarchar(10))
      ,[koulk] = CAST(COALESCE(NULLIF(koulk, ''''), ''-1'') as nvarchar(6))
      ,[tutklaja] = CAST(COALESCE(NULLIF(tutklaja, ''''), ''-1'') as nvarchar(2))
      ,[tutktav] = CAST(COALESCE(NULLIF(tutktav, ''''), ''-1'') as nvarchar(2))
      ,[kkieli] = CAST(COALESCE(NULLIF(kkieli, ''''), ''-1'') as nvarchar(2))
      ,[kmaak] = CAST(COALESCE(NULLIF((SELECT [maakunta_koodi_nykytila] FROM [VipunenTK_lisatiedot].[dbo].[alueluokitus_maakunta_korjaus] WHERE [maakunta_koodi] = kmaak), ''''), NULLIF(kmaak , ''''), ''-1'') as nvarchar(2))
      ,[lkm] = CAST(lkm as int)
      ,[tunn_opisk] = CAST(COALESCE(NULLIF(tunn_opisk, ''''), ''-1'') as nvarchar(5))
      ,[jarj_opisk] = CAST(COALESCE(NULLIF(jarj_opisk, ''''), ''-1'') as nvarchar(10))
      ,[olosyys] = CAST(olosyys as nvarchar(1))
	  ,tietolahde
FROM
(SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[lkm]
      ,NULL AS [tunn_opisk]
      ,NULL AS [jarj_opisk]
      ,9 AS [olosyys]
      ,[luontipvm]
	  ,tietolahde = ''2_7_sopv_12''
  FROM [TK_H9098_CSC].[dbo].[TK_2_7_sopv_12]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[lkm]
      ,NULL AS [tunn_opisk]
      ,NULL AS [jarj_opisk]
      ,9 AS [olosyys]
      ,[luontipvm]
	  ,tietolahde = ''2_7_sopv_13''
  FROM [TK_H9098_CSC].[dbo].[TK_2_7_sopv_13]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[lkm]
      ,NULL AS [tunn_opisk]
      ,NULL AS [jarj_opisk]
      ,9 AS [olosyys]
      ,NULL AS [luontipvm]
	  ,tietolahde = ''2_7_2012_sopv_14''
  FROM [VipunenTK_SA].[dbo].[TK_2_7_2012_sopv_14]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[lkm]
      ,[tunn_opisk]
      ,[jarj_opisk]
      ,[olosyys]
      ,[luontipvm]
	  ,tietolahde = ''2_7_sopv_14''
  FROM [TK_H9098_CSC].[dbo].[TK_2_7_sopv_14]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[lkm]
      ,[tunn_opisk]
      ,[jarj_opisk]
      ,[olosyys]
      ,[luontipvm]
	  ,tietolahde = ''2_7_sopv_15''
  FROM [TK_H9098_CSC].[dbo].[TK_2_7_sopv_15]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[lkm]
      ,[tunn_opisk]
      ,[jarj_opisk]
      ,[olosyys]
      ,[luontipvm]
	  ,tietolahde = ''2_7_sopv_16''
  FROM [TK_H9098_CSC].[dbo].[TK_2_7_sopv_16]
UNION ALL
SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[lkm]
      ,[tunn_opisk]
      ,[jarj_opisk]
      ,[olosyys]
      ,[luontipvm]
	  ,tietolahde = ''2_7_sopv_17''
FROM [TK_H9098_CSC].[dbo].[TK_2_7_sopv_17]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[lkm]
      ,[tunn_opisk]
      ,[jarj_opisk]
      ,[olosyys]
      ,[luontipvm]
	  ,tietolahde = ''2_7_sopv_18''
FROM [TK_H9098_CSC].[dbo].[TK_2_7_sopv_18]

UNION ALL

SELECT [tilv]
      ,[lahde]
      ,[perusjoukko]
      ,[tunn]
      ,[jarj]
      ,[opjarj]
      ,[koulk]
      ,[tutklaja]
      ,[tutktav]
      ,[kkieli]
      ,[kmaak]
      ,[lkm]
      ,[tunn_opisk]
      ,[jarj_opisk]
      ,[olosyys]
      ,[luontipvm]
	  ,tietolahde = ''2_7_sopv_19''
FROM [TK_H9098_CSC].[dbo].[TK_K2_7_sopv_19]
  
 ) kaikkivuodet








' 
GO
/****** Object:  View [dbo].[v_sa_2_8_Korkeakoulut_opiskelijat]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_8_Korkeakoulut_opiskelijat]'))
EXEC dbo.sp_executesql @statement = N'











CREATE VIEW [dbo].[v_sa_2_8_Korkeakoulut_opiskelijat] AS

-- truncate table vipunentk_dw..sa_2_8_Korkeakoulut_opiskelijat
-- insert into vipunentk_dw..sa_2_8_Korkeakoulut_opiskelijat select * from v_sa_2_8_Korkeakoulut_opiskelijat


select
	tilv = cast(kaikkivuodet.tilv as varchar(4))
	,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	,aineisto = cast(kaikkivuodet.aineisto as varchar(1))
	,lahde = cast(kaikkivuodet.lahde as varchar(2))
	,tunn = cast(kaikkivuodet.tunn as varchar(5))
	,jarj = cast(kaikkivuodet.jarj as varchar(10))
	,koulk = cast(kaikkivuodet.koulk as varchar(6))
	,kkun = cast(kaikkivuodet.kkun as varchar(3))
	,sp = cast(kaikkivuodet.sp as varchar(1))
	,aikielir1x = cast(kaikkivuodet.aikielir1x as varchar(2))
	,syntv = cast(kaikkivuodet.syntv as varchar(4))
	,tilvaskun = cast(kaikkivuodet.tilvaskun as varchar(6))
	,tilvaskunx = cast(kaikkivuodet.tilvaskunx as varchar(3))
	,tilvaskun2x = cast(kaikkivuodet.tilvaskun2x as varchar(3))
	,kansalr2 = cast(kaikkivuodet.kansalr2 as varchar(1))
	,alvv = cast(kaikkivuodet.alvv as varchar(4))
	,allk = cast(kaikkivuodet.allk as varchar(1))
	,olotamm = cast(kaikkivuodet.olotamm as varchar(1))
	,olosyys = cast(kaikkivuodet.olosyys as varchar(1))
	,rahlahde = cast(kaikkivuodet.rahlahde as varchar(1))
	,fte = cast(kaikkivuodet.fte as varchar(1))
	,alvv_kksek = cast(kaikkivuodet.alvv_kksek as varchar(4))
	,alvv_kksek_lasna = cast(kaikkivuodet.alvv_kksek_lasna as varchar(4))
	,alvv_sek = cast(kaikkivuodet.alvv_sek as varchar(4))
	,alvv_sek_lasna = cast(kaikkivuodet.alvv_sek_lasna as varchar(4))
	,alvv_kk = cast(kaikkivuodet.alvv_kk as varchar(4))
	,alvv_kk_lasna = cast(kaikkivuodet.alvv_kk_lasna as varchar(4))
	,alvv_opa = cast(kaikkivuodet.alvv_opa as varchar(4))
	,alvv_opa_lasna = cast(kaikkivuodet.alvv_opa_lasna as varchar(4))
	,lkm = cast(kaikkivuodet.lkm as int)
	,opyht0 = cast(kaikkivuodet.opyht0 as int)
	,opyht14 = cast(kaikkivuodet.opyht14 as int)
	,opyht29 = cast(kaikkivuodet.opyht29 as int)
	,opyht44 = cast(kaikkivuodet.opyht44 as int)
	,opyht59 = cast(kaikkivuodet.opyht59 as int)
	,opyht74 = cast(kaikkivuodet.opyht74 as int)
	,opyht89 = cast(kaikkivuodet.opyht89 as int)
	,opyht104 = cast(kaikkivuodet.opyht104 as int)
	,opyht119 = cast(kaikkivuodet.opyht119 as int)
	,opyht120 = cast(kaikkivuodet.opyht120 as int)
	,op55 = cast(kaikkivuodet.op55 as varchar(1))
	,opes = cast(kaikkivuodet.opes as int)
	,opek = cast(kaikkivuodet.opek as int)
	,opker = cast(kaikkivuodet.opker as int)
	,tutkamk = cast(kaikkivuodet.tutkamk as varchar(3))
	,tunimamk = cast(kaikkivuodet.tunimamk as nvarchar(60))
	,koamk = cast(kaikkivuodet.koamk as varchar(4))
	,konimamk = cast(kaikkivuodet.konimamk as nvarchar(60))
	,suun_v = cast(kaikkivuodet.suun_v as varchar(5))
	,svnim = cast(kaikkivuodet.svnim as nvarchar(40))
	,koultyp = cast(kaikkivuodet.koultyp as varchar(1))
	,kkieli = cast(kaikkivuodet.kkieli as varchar(2))
	,lasnalk = cast(kaikkivuodet.lasnalk as int)
	,poissalk = cast(kaikkivuodet.poissalk as int)
	,oplaaj = cast(kaikkivuodet.oplaaj as int)
	,kirtu1v = cast(kaikkivuodet.kirtu1v as varchar(4))
	,kirtu1k = cast(kaikkivuodet.kirtu1k as varchar(1))
	,ensisop = cast(kaikkivuodet.ensisop as varchar(1))
	,tilmaa = cast(kaikkivuodet.tilmaa as varchar(1))
	,tutkyo = cast(kaikkivuodet.tutkyo as varchar(3))
	,tunimyo = cast(kaikkivuodet.tunimyo as nvarchar(40))
	,koyo = cast(kaikkivuodet.koyo as varchar(4))
	,konimyo = cast(kaikkivuodet.konimyo as nvarchar(50))
	,paine = cast(kaikkivuodet.paine as varchar(4))
	,painenim = cast(kaikkivuodet.painenim as nvarchar(60))
	,kk = cast(kaikkivuodet.kk as varchar(2))
	,tdk = cast(kaikkivuodet.tdk as varchar(2))
	,fuksi = cast(kaikkivuodet.fuksi as varchar(1))
	,opoikv = cast(kaikkivuodet.opoikv as varchar(4))
	,om = cast(kaikkivuodet.om as varchar(1))
	,opkelp = cast(kaikkivuodet.opkelp as varchar(1))
	,avo  = cast(kaikkivuodet.avo as varchar(1))
	,laak  = cast(kaikkivuodet.laak as varchar(1))
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as varchar(10))
FROM (

--Historia-aineisto
SELECT
	tilv
	, aineisto = ''L''
	, lahde =
		case 
			when lahde = 3 then 41
			when lahde = 4 then 51
			else -1
		end
	, tunn
	, jarj = op.koulutuksen_jarjestajakoodi
	, koulk
	, kkun
	, sp
	, aikielir1x = aikielir1
	, syntv = CASE WHEN LTRIM(ika) in (''.'','''') then null else cast(tilv as int)-cast(LTRIM(ika) as int) end
	, tilvaskun = case when asmaak is null or asmaak=99 then null else ''MAAK''+asmaak end
	, tilvaskunx = null
	, tilvaskun2x = null
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde = null
	, fte
	, alvv_kksek = null
	, alvv_kksek_lasna = null
	, alvv_sek = null
	, alvv_sek_lasna = null
	, alvv_kk = null
	, alvv_kk_lasna = null
	, alvv_opa = null
	, alvv_opa_lasna = null
	, lkm
	, opyht0 = null
	, opyht14 = null
	, opyht29 = null
	, opyht44 = null
	, opyht59 = null
	, opyht74 = null
	, opyht89 = null
	, opyht104 = null
	, opyht119 = null
	, opyht120 = null
	, null as op55 -- uusi 2012
	, opes
	, opek
	, opker
	, tutkamk = null
	, tunimamk = null
	, koamk = null
	, konimamk = null
	, suun_v = null
	, svnim = null
	, koultyp
	, kkieli = case kkielir1 when ''fs'' then ''fi'' else kkielir1 end
	, lasnalk = null
	, poissalk = null
	, oplaaj = null
	, kirtu1v = null
	, kirtu1k = null
	, ensisop = null
	, tilmaa = null
	, tutkyo = null
	, tunimyo = null
	, koyo = null
	, konimyo = null
	, paine = null
	, painenim = null
	, kk = null
	, tdk = null
	, fuksi = null
	, opoikv = null
	, om = null
	, opkelp = null
	, avo = NULL, laak = NULL
	,[tietolahde]=''8_2_Historia''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_8_2_sopv_16] tk
LEFT JOIN VipunenTK.dbo.d_oppilaitoksen_taustatiedot op on op.oppilaitos_avain=tk.tunn
WHERE lahde in (3,4) and tilv<2010

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, null as op55 -- uusi 2012
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo, laak= NULL
	,[tietolahde]=''2_8a_sopv_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8a_sopv_11]

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, null as op55 -- uusi 2012
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo, laak= NULL
	,[tietolahde]=''2_8b_sopv_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8b_sopv_11]

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, null as op55 -- uusi 2012
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo, laak= NULL
	,[tietolahde]=''2_8c_sopv_11''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8c_sopv_11]
/* 2.8d v2011? */
/* 2.8a v2012? */
UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55 -- uusi 2012
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo, laak= NULL
	,[tietolahde]=''2_8b_sopv_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8b_sopv_12]

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55 -- uusi 2012
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo, laak= NULL
	,[tietolahde]=''2_8c_sopv_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8c_sopv_12]

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55 -- uusi 2012
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo, laak= NULL
	,[tietolahde]=''2_8d_sopv_12''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8d_sopv_12]
/* 2.8a v2013? */
UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo, laak= NULL
	,[tietolahde]=''2_8b_sopv_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8b_sopv_13]

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo, laak= NULL
	,[tietolahde]=''2_8c_sopv_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8c_sopv_13]
/* 2.8d v2013? */

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo, laak= NULL
	,[tietolahde]=''2_8d_sopv_13''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8d_sopv_13]

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo, laak= NULL
	,[tietolahde]=''2_8b_sopv_14''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8b_sopv_14]

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo, laak= NULL
	,[tietolahde]=''2_8d_sopv_14''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_8d_sopv_14]


UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo, laak= NULL
	,[tietolahde]=''2_8b_sopv_15''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM TK_H9098_CSC.[dbo].[TK_2_8b_sopv_15]

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, NULL AS tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo, laak
	,[tietolahde]=''2_8b_sopv_16''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM TK_H9098_CSC.[dbo].[TK_2_8b_sopv_16]

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, NULL AS tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo, laak
	,[tietolahde]=''2_8b_sopv_17''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM TK_H9098_CSC.[dbo].[TK_2_8b_sopv_17]

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, NULL AS tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	, laak
	,[tietolahde]=''2_8b_sopv_18''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM TK_H9098_CSC.[dbo].[TK_2_8b_sopv_18]

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, case when koulk in (''775101'',''775201'') then ''999999''
	       else koulk
	  end as koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk = null
	, tunimamk = null
	, koamk = null
	, konimamk = null
	, suun_v = null
	, svnim = null
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, NULL AS tilmaa
	, tutkyo = null
	, tunimyo = null
	, koyo = null
	, konimyo = null
	, paine = null
	, painenim = null
	, kk
	, tdk = null
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo, laak= NULL
	,[tietolahde]=''antero sa_virta_otp_tkOpiskOKMEnnakko''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM Antero.sa.[sa_virta_otp_tkOPISKOKMEnnakko]

UNION ALL

SELECT
	tilv
	, aineisto
	, lahde
	, tunn
	, jarj
	, koulk
	, kkun
	, sp
	, aikielir1x
	, syntv
	, tilvaskun
	, tilvaskunx
	, tilvaskun2x
	, kansalr2
	, alvv
	, allk
	, olotamm
	, olosyys
	, rahlahde
	, fte
	, alvv_kksek
	, alvv_kksek_lasna
	, alvv_sek
	, alvv_sek_lasna
	, alvv_kk
	, alvv_kk_lasna
	, alvv_opa
	, alvv_opa_lasna
	, lkm
	, opyht0
	, opyht14
	, opyht29
	, opyht44
	, opyht59
	, opyht74
	, opyht89
	, opyht104
	, opyht119
	, opyht120
	, op55
	, opes
	, opek
	, opker
	, tutkamk
	, tunimamk
	, koamk
	, konimamk
	, suun_v
	, svnim
	, koultyp
	, kkieli
	, lasnalk
	, poissalk
	, oplaaj
	, kirtu1v
	, kirtu1k
	, ensisop
	, NULL AS tilmaa
	, tutkyo
	, tunimyo
	, koyo
	, konimyo
	, paine
	, painenim
	, kk
	, tdk
	, fuksi
	, opoikv
	, om
	, opkelp
	, avo
	, laak
	,[tietolahde]=''2_8b_sopv_19''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM TK_H9098_CSC.[dbo].[TK_K2_8b_sopv_19]

) kaikkivuodet




' 
GO
/****** Object:  View [dbo].[v_sa_2_8e_Korkeakoulut_opiskelijat]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_8e_Korkeakoulut_opiskelijat]'))
EXEC dbo.sp_executesql @statement = N'







CREATE VIEW [dbo].[v_sa_2_8e_Korkeakoulut_opiskelijat] AS

-- truncate table vipunentk_dw..sa_2_8e_Korkeakoulut_opiskelijat
-- insert into vipunentk_dw..sa_2_8e_Korkeakoulut_opiskelijat select * from v_sa_2_8e_Korkeakoulut_opiskelijat
-- select * into vipunentk_dw.dbo.sa_2_8e_Korkeakoulut_opiskelijat from v_sa_2_8e_Korkeakoulut_opiskelijat

SELECT
	 tilv = cast(kaikkivuodet.tilv as nvarchar(4))
	,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	,aineisto = cast(kaikkivuodet.aineisto as nvarchar(1))
	,lahde = cast(kaikkivuodet.lahde as nvarchar(2))
	,tunn = cast(kaikkivuodet.tunn as nvarchar(5))
	,jarj = cast(kaikkivuodet.jarj as nvarchar(10))
	,koulk = cast(kaikkivuodet.koulk as nvarchar(6))
	,koultyp = cast(kaikkivuodet.koultyp as nvarchar(1))
	,sp = cast(kaikkivuodet.sp as nvarchar(1))
	,aikielir1 = cast(kaikkivuodet.aikielir1x as nvarchar(2))
	,syntv = cast(kaikkivuodet.syntv as nvarchar(4))
	,synkk = cast(kaikkivuodet.synkk as nvarchar(2))
	,alvv = cast(kaikkivuodet.alvv as nvarchar(4))
	,allk = cast(kaikkivuodet.allk as nvarchar(1))
	,olotamm = cast(kaikkivuodet.olotamm as nvarchar(1))
	,olosyys = cast(kaikkivuodet.olosyys as nvarchar(1))
	,kkieli = cast(kaikkivuodet.kkieli as nvarchar(2))
	,ltop = cast(kaikkivuodet.ltop as nvarchar(1))
    ,laak = cast(kaikkivuodet.laak as nvarchar(1))
	,alvv_kksek = cast(kaikkivuodet.alvv_kksek as nvarchar(4))
    ,kansalr2 = cast(kaikkivuodet.kansalr2 as nvarchar(1))
    ,opoikv = cast(kaikkivuodet.opoikv as nvarchar(4))
	,lkm = cast(kaikkivuodet.lkm as int)
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(250))
	,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (

	SELECT
	   [tilv]
      ,[aineisto]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
      ,[sp]
      ,[aikielir1x]
      ,[syntv]
      ,[synkk]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[koultyp]
      ,[kkieli]
      ,[ltop]
      ,[laak]
      ,[lkm]
      ,[luontipvm]
      ,[alvv_kksek]
      ,[kansalr2]
      ,[opoikv]
	  ,[tietolahde]=''2_8e_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K2_8e_sopv_17]

UNION ALL

SELECT
	   [tilv]
      ,[aineisto]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
      ,[sp]
      ,[aikielir1x]
      ,[syntv]
      ,[synkk]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[koultyp]
      ,[kkieli]
      ,[ltop]
      ,[laak]
      ,[lkm]
      ,[luontipvm]
      ,[alvv_kksek]
      ,[kansalr2]
      ,[opoikv]
	  ,[tietolahde]=''2_8e_sopv_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K2_8e_sopv_18]

UNION ALL

SELECT
	   [tilv]
      ,[aineisto]
      ,[lahde]
      ,[tunn]
      ,[jarj]
      ,[koulk]
      ,[sp]
      ,[aikielir1x]
      ,[syntv]
      ,[synkk]
      ,[alvv]
      ,[allk]
      ,[olotamm]
      ,[olosyys]
      ,[koultyp]
      ,[kkieli]
      ,[ltop]
      ,[laak]
      ,[lkm]
      ,[luontipvm]
      ,[alvv_kksek]
      ,[kansalr2]
      ,[opoikv]
	  ,[tietolahde]=''2_8e_sopv_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K2_8e_sopv_19]


) as kaikkivuodet









' 
GO
/****** Object:  View [dbo].[v_sa_2_9_Korkeakoulut_tutkinnot]    Script Date: 4.4.2019 18:09:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[v_sa_2_9_Korkeakoulut_tutkinnot]'))
EXEC dbo.sp_executesql @statement = N'








CREATE VIEW [dbo].[v_sa_2_9_Korkeakoulut_tutkinnot] AS

-- truncate table vipunentk_dw sa_2_9_Korkeakoulut_tutkinnot
-- insert into vipunentk_dw sa_2_9_Korkeakoulut_tutkinnot select * from v_sa_2_9_Korkeakoulut_tutkinnot


SELECT
	 tilv = cast(kaikkivuodet.tilv as varchar(4))
	,tilv_date = cast(kaikkivuodet.tilv+''0101'' as date)
	,aineisto = cast(kaikkivuodet.aineisto as varchar(1))
	,lahde = cast(kaikkivuodet.lahde as varchar(2))
	,tunn = cast(kaikkivuodet.tunn as varchar(5))
	,jarj = cast(kaikkivuodet.jarj as varchar(10))
	,koulk = cast(kaikkivuodet.koulk as varchar(6))
	,opm95opa = cast(kaikkivuodet.opm95opa as varchar(2))
	,kkun = cast(kaikkivuodet.kkun as varchar(3))
	,sp = cast(kaikkivuodet.sp as varchar(1))
	,aikielir1x = cast(kaikkivuodet.aikielir1x as varchar(2))
	,syntv = cast(coalesce(nullif(kaikkivuodet.syntv,''''),''9999'') as varchar(4))
	,tilvaskun = cast(kaikkivuodet.tilvaskun as varchar(3))
	,tilvaskunx = cast(kaikkivuodet.tilvaskunx as varchar(3))
	,kansalr2 = cast(kaikkivuodet.kansalr2 as varchar(1))
	,alvv = cast(kaikkivuodet.alvv as varchar(4))
	,allk = cast(kaikkivuodet.allk as varchar(1))
	,suorv = cast(kaikkivuodet.suorv as varchar(4))
	,suorlk = cast(kaikkivuodet.suorlk as varchar(1))
	,rahlahde = cast(kaikkivuodet.rahlahde as varchar(1))
	,alvv_kksek = cast(kaikkivuodet.alvv_kksek as varchar(4))
	,alvv_kksek_lasna = cast(kaikkivuodet.alvv_kksek_lasna as varchar(4))
	,alvv_sek = cast(kaikkivuodet.alvv_sek as varchar(4))
	,alvv_sek_lasna = cast(kaikkivuodet.alvv_sek_lasna as varchar(4))
	,alvv_kk = cast(kaikkivuodet.alvv_kk as varchar(4))
	,alvv_kk_lasna = cast(kaikkivuodet.alvv_kk_lasna as varchar(4))
	,alvv_opa = cast(kaikkivuodet.alvv_opa as varchar(4))
	,alvv_opa_lasna = cast(kaikkivuodet.alvv_opa_lasna as varchar(4))
	,lkm = cast(kaikkivuodet.lkm as int)
	,tutkamk = cast(kaikkivuodet.tutkamk as varchar(3))
	,tunimamk = cast(kaikkivuodet.tunimamk as varchar(60))
	,koamk = cast(kaikkivuodet.koamk as varchar(4))
	,konimamk = cast(kaikkivuodet.konimamk as varchar(60))
	,suun_v = cast(kaikkivuodet.suun_v as varchar(5))
	,svnim = cast(kaikkivuodet.svnim as varchar(60))
	,koultyp = cast(kaikkivuodet.koultyp as varchar(1))
	,kkieli = cast(kaikkivuodet.kkieli as varchar(2))
	,lasnalk = cast(kaikkivuodet.lasnalk as int)
	,poissalk = cast(kaikkivuodet.poissalk as int)
	,oplaaj = cast(kaikkivuodet.oplaaj as int)
	,kirtu1v = cast(kaikkivuodet.kirtu1v as varchar(4))
	,kirtu1k = cast(kaikkivuodet.kirtu1k as varchar(1))
	,opyhtamk = cast(kaikkivuodet.opyhtamk as int)
	,opylamamk = cast(kaikkivuodet.opylamamk as int)
	,opmuuamk = cast(kaikkivuodet.opmuuamk as int)
	,opoamk = cast(kaikkivuodet.opoamk as int)
	,opmamk = cast(kaikkivuodet.opmamk as int)
	,opyliopamk = cast(kaikkivuodet.opyliopamk as int)
	,opulkomamk = cast(kaikkivuodet.opulkomamk as int)
	,tilmaa = cast(kaikkivuodet.tilmaa as varchar(1))
	,tutkyo = cast(kaikkivuodet.tutkyo as varchar(3))
	,tunimyo = cast(kaikkivuodet.tunimyo as varchar(60))
	,koyo = cast(kaikkivuodet.koyo as varchar(4))
	,konim = cast(kaikkivuodet.konimyo as varchar(60))
	,paine = cast(kaikkivuodet.paine as varchar(4))
	,painenim = cast(kaikkivuodet.painenim as varchar(60))
	,tdk = cast(kaikkivuodet.tdk as varchar(2))
	,om = cast(kaikkivuodet.om as varchar(1))
	,opkelp = cast(kaikkivuodet.opkelp as varchar(1))
	,opyhtyo = cast(kaikkivuodet.opyhtyo as int)
	,opulkyo = cast(kaikkivuodet.opulkyo as int)
	,opmuuyo = cast(kaikkivuodet.opmuuyo as int)
	,opoylio = cast(kaikkivuodet.opoylio as int)
	,opaylio = cast(kaikkivuodet.opaylio as int)
	,opmylio = cast(kaikkivuodet.opmylio as int)
	,opamkyo = cast(kaikkivuodet.opamkyo as int)
	,ltop  = cast(kaikkivuodet.opamkyo as int)
	,laak  = cast(kaikkivuodet.laak as int)
	,tietolahde = cast(kaikkivuodet.tietolahde as nvarchar(50))
	,rivinumero = cast(kaikkivuodet.rivinumero as int)
FROM (

--Historia-aineisto
	SELECT
	 tilv = left(suoraika,4)
	,aineisto = ''L''
	,lahde =
	case 
			when lahde = 3 then 42
			when lahde = 4 then 52
			else -1
		end
	,tunn = oltunnus
	,jarj = op.koulutuksen_jarjestajakoodi
	,koulk
	,opm95opa = null
	,kkun
	,sp
	,aikielir1x = aikielir1
	,syntv = case syntv when ''19XX'' then null else syntv end
	,tilvaskun = askun
	,tilvaskunx = null
	,kansalr2
	,alvv = case alvv when ''BBBB'' then null else alvv end
	,allk
	,suorv = left(suoraika,4)
	,suorlk = null
	,rahlahde = null
	,alvv_kksek = null
	,alvv_kksek_lasna = null
	,alvv_sek = null
	,alvv_sek_lasna = null
	,alvv_kk = null
	,alvv_kk_lasna = null
	,alvv_opa = null
	,alvv_opa_lasna = null
	,lkm
	,tutkamk = null
	,tunimamk = null
	,koamk = null
	,konimamk = null
	,suun_v = null
	,svnim = null
	,koultyp = null
	,kkieli = case kkielir1 when ''fs'' then ''fi'' else kkielir1 end
	,lasnalk = null
	,poissalk = null
	,oplaaj = null
	,kirtu1v = null
	,kirtu1k = null
	,opyhtamk = null
	,opylamamk = null
	,opmuuamk = null
	,opoamk = null
	,opmamk = null
	,opyliopamk = null
	,opulkomamk = null
	,tilmaa = null
	,tutkyo = null
	,tunimyo = null
	,koyo = null
	,konimyo = null
	,paine = null
	,painenim = null
	,tdk = null
	,om = null
	,opkelp = null
	,opyhtyo = null
	,opulkyo = null
	,opmuuyo = null
	,opoylio = null
	,opaylio = null
	,opmylio = null
	,opamkyo = null
	,ltop = NULL, laak = NULL
	,[tietolahde]=''8_1_historia''
    ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_8_1_sopv_16] tk
LEFT JOIN VipunenTK.dbo.d_oppilaitoksen_taustatiedot op on op.oppilaitos_avain=tk.oltunnus
where lahde in (3,4) and left(suoraika,4)<2010

UNION ALL

SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL, laak = NULL 
	,[tietolahde]=''2_9a_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9a_sopv_11]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL, laak = NULL
	,[tietolahde]=''2_9b_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9b_sopv_11]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL, laak = NULL
	,[tietolahde]=''2_9c_sopv_11''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9c_sopv_11]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL, laak = NULL
	,[tietolahde]=''2_9a_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9a_sopv_12]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL, laak = NULL
	,[tietolahde]=''2_9b_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9b_sopv_12]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL, laak = NULL
	,[tietolahde]=''2_9c_sopv_12''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9c_sopv_12]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL, laak = NULL
	,[tietolahde]=''2_9a_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9a_sopv_13]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL, laak = NULL
	,[tietolahde]=''2_9b_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9b_sopv_13]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop = NULL, laak = NULL
	,[tietolahde]=''2_9c_sopv_13''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9c_sopv_13]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop, laak = NULL
	,[tietolahde]=''2_9a_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9a_sopv_14]
UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop, laak = NULL
	,[tietolahde]=''2_9b_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9b_sopv_14]

UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop, laak = NULL
	,[tietolahde]=''2_9c_sopv_14''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9c_sopv_14] -- siirtokannan taulusta puuttuu 20k riviä

UNION ALL SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,tutkamk
	,tunimamk
	,koamk
	,konimamk
	,suun_v
	,svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,tilmaa
	,tutkyo
	,tunimyo
	,koyo
	,konimyo
	,paine
	,painenim
	,tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop, laak = NULL
	,[tietolahde]=''2_9c_sopv_15''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9c_sopv_15] 

UNION ALL 

SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,NULL AS opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,NULL AS tutkamk
	,NULL AS tunimamk
	,NULL AS koamk
	,NULL AS konimamk
	,NULL AS suun_v
	,NULL AS svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,NULL AS tilmaa
	,NULL AS tutkyo
	,NULL AS tunimyo
	,NULL AS koyo
	,NULL AS konimyo
	,NULL AS paine
	,NULL AS painenim
	,NULL AS tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop, laak
	,[tietolahde]=''2_9c_sopv_16''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9c_sopv_16]

UNION ALL 

SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,NULL AS opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,NULL AS tutkamk
	,NULL AS tunimamk
	,NULL AS koamk
	,NULL AS konimamk
	,NULL AS suun_v
	,NULL AS svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,NULL AS tilmaa
	,NULL AS tutkyo
	,NULL AS tunimyo
	,NULL AS koyo
	,NULL AS konimyo
	,NULL AS paine
	,NULL AS painenim
	,NULL AS tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop, laak
	,[tietolahde]=''2_9c_sopv_17''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9c_sopv_17]

UNION ALL 

SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,NULL AS opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,NULL AS tutkamk
	,NULL AS tunimamk
	,NULL AS koamk
	,NULL AS konimamk
	,NULL AS suun_v
	,NULL AS svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,NULL AS tilmaa
	,NULL AS tutkyo
	,NULL AS tunimyo
	,NULL AS koyo
	,NULL AS konimyo
	,NULL AS paine
	,NULL AS painenim
	,NULL AS tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop, laak
	,[tietolahde]=''2_9c_sopv_18''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_2_9c_sopv_18]

UNION ALL 

SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,NULL AS opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvvkksek as alvv_kksek
	,alvvkkseklasna as alvv_kksek_lasna
	,alvvsek as alvv_sek
	,alvvseklasna as alvv_sek_lasna
	,alvvkk as alvv_kk
	,alvvkklasna as alvv_kk_lasna
	,alvvopa as alvv_opa
	,alvvopalasna as alvv_opa_lasna
	,lkm
	,NULL AS tutkamk
	,NULL AS tunimamk
	,NULL AS koamk
	,NULL AS konimamk
	,NULL AS suun_v
	,NULL AS svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,NULL AS tilmaa
	,NULL AS tutkyo
	,NULL AS tunimyo
	,NULL AS koyo
	,NULL AS konimyo
	,NULL AS paine
	,NULL AS painenim
	,NULL AS tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop, laak = NULL
	,[tietolahde]=''Virta_otp''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [Antero].[sa].[sa_virta_otp_tkTUTKINTOOKMEnnakko]

UNION ALL 

SELECT
	 tilv
	,aineisto
	,lahde
	,tunn
	,jarj
	,koulk
	,NULL AS opm95opa
	,kkun
	,sp
	,aikielir1x
	,syntv
	,tilvaskun
	,tilvaskunx
	,kansalr2
	,alvv
	,allk
	,suorv
	,suorlk
	,rahlahde
	,alvv_kksek
	,alvv_kksek_lasna
	,alvv_sek
	,alvv_sek_lasna
	,alvv_kk
	,alvv_kk_lasna
	,alvv_opa
	,alvv_opa_lasna
	,lkm
	,NULL AS tutkamk
	,NULL AS tunimamk
	,NULL AS koamk
	,NULL AS konimamk
	,NULL AS suun_v
	,NULL AS svnim
	,koultyp
	,kkieli
	,lasnalk
	,poissalk
	,oplaaj
	,kirtu1v
	,kirtu1k
	,opyhtamk
	,opylamamk
	,opmuuamk
	,opoamk
	,opmamk
	,opyliopamk
	,opulkomamk
	,NULL AS tilmaa
	,NULL AS tutkyo
	,NULL AS tunimyo
	,NULL AS koyo
	,NULL AS konimyo
	,NULL AS paine
	,NULL AS painenim
	,NULL AS tdk
	,om
	,opkelp
	,opyhtyo
	,opulkyo
	,opmuuyo
	,opoylio
	,opaylio
	,opmylio
	,opamkyo
	,ltop, laak
	,[tietolahde]=''2_9c_sopv_19''
      ,[rivinumero] = ROW_NUMBER() OVER(ORDER BY tilv)
FROM [TK_H9098_CSC].[dbo].[TK_K2_9c_sopv_19]

) as kaikkivuodet


' 
GO
USE [ANTERO]