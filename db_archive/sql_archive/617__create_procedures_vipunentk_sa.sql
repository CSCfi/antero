USE [VipunenTK_SA]
GO
/****** Object:  StoredProcedure [dbo].[CreateNewSeq]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CreateNewSeq]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[CreateNewSeq] AS' 
END
GO
ALTER procedure [dbo].[CreateNewSeq]

      @SeqName nvarchar(255),

      @seed int = 0,

      @incr int = 1

as

begin

      declare @currval int

      if exists (

            select 1 from dbo.[AllSequences]

            where SeqName = @SeqName )

      begin

            print 'Sequence already exists.'

            return 1   

      end

 

      if @seed is null set @seed = 1

      if @incr is null set @incr = 1

      set @currval = @seed

 

      insert into VipunenTK_SA.dbo.AllSequences (SeqName, Seed, Incr, CurrVal)

      values (@SeqName, @Seed, @Incr, @CurrVal)

     

end

GO
/****** Object:  StoredProcedure [dbo].[ETL_tyhjenna_ja_lataa_VipunenTK_aineistot]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ETL_tyhjenna_ja_lataa_VipunenTK_aineistot]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[ETL_tyhjenna_ja_lataa_VipunenTK_aineistot] AS' 
END
GO

ALTER PROCEDURE [dbo].[ETL_tyhjenna_ja_lataa_VipunenTK_aineistot] AS
/*
Execute VipunenTK_SA.dbo.ETL_tyhjenna_ja_lataa_VipunenTK_aineistot

--Kesto noin 4 minuuttia

--Haetaan VipunenTK_SA-alueelle korjatut taulut erikseen
--Jarmo 30.3.2015
*/

  BEGIN 
  SET nocount  ON
    DECLARE  @imax INT, 
             @i    INT 
    DECLARE  	@Kanta [nvarchar](128),
	@Skeema [sysname],
	@Taulu [sysname],
	@Tyyppi [varchar](10),
	@Sarake [sysname]
-- The RowID identity column will be used for loop control
-- MSSQL declare table variable 
    DECLARE  @VanhatTaulut  TABLE( 
    RowID       INT    IDENTITY ( 1 , 1 ),	
	[TABLE_CATALOG] [nvarchar](128),
	[TABLE_SCHEMA] [sysname],
	[TABLE_NAME] [sysname],
	[TABLE_TYPE] [varchar](10)
     ) 
    DECLARE  @UudetTaulut  TABLE( 
    RowID       INT    IDENTITY ( 1 , 1 ),	
	[TABLE_CATALOG] [nvarchar](128),
	[TABLE_SCHEMA] [sysname],
	[TABLE_NAME] [sysname],
	[TABLE_TYPE] [varchar](10)
     ) 


--Droppaa kannan VipunenTK_aineistot kaikki taulut

    INSERT @VanhatTaulut 
    SELECT   TABLE_CATALOG, 
             TABLE_SCHEMA,
			 TABLE_NAME,
			 TABLE_TYPE 
    FROM     [VipunenTK_aineistot].information_schema.tables
    ORDER BY TABLE_NAME 
     
    SET @imax = @@ROWCOUNT 
    SET @i = 1 
     
    WHILE (@i <= @imax) 
      BEGIN 
        SELECT @Kanta = TABLE_CATALOG, 
               @Skeema = TABLE_SCHEMA,
			   @Taulu = TABLE_NAME,
			   @Tyyppi = TABLE_TYPE
        FROM   @VanhatTaulut 
        WHERE  RowID = @i 
         
        PRINT 'Drop table '+@Kanta+'.'+@Skeema+'.['+@Taulu+']'
        EXEC( 'Drop table '+@Kanta+'.'+@Skeema+'.['+@Taulu+']' )

        SET @i = @i + 1 
      END -- WHILE

--Luo ja täytä kantaan VipunenTK_aineistot kaikki siirtokannan luettavat taulut
-- Taulun pitää alkaa TK_
--  mutte ei TK_K

    INSERT @UudetTaulut 
    SELECT   TABLE_CATALOG, 
             TABLE_SCHEMA,
			 TABLE_NAME,
			 TABLE_TYPE 
    FROM     [TK_H9098_CSC].information_schema.tables
	WHERE LEFT(TABLE_NAME,4) <> 'TK_K'
      AND LEFT(TABLE_NAME,2) = 'TK'
    ORDER BY TABLE_NAME 
     
    SET @imax = @@ROWCOUNT 
    SET @i = 1 
     
    WHILE (@i <= @imax) 
      BEGIN 
        SELECT @Kanta = TABLE_CATALOG, 
               @Skeema = TABLE_SCHEMA,
			   @Taulu = TABLE_NAME,
			   @Tyyppi = TABLE_TYPE
        FROM   @UudetTaulut 
        WHERE  RowID = @i 
         
        PRINT 'Select * into VipunenTK_aineistot.'+@Skeema+'.['+@Taulu+'] from '+@Kanta+'.'+@Skeema+'.['+@Taulu+']'
        EXEC( 'Select * into VipunenTK_aineistot.'+@Skeema+'.['+@Taulu+'] from '+@Kanta+'.'+@Skeema+'.['+@Taulu+']' )

        SET @i = @i + 1 
      END -- WHILE

--Haetaan VipunenTK_SA-alueelle korjatut taulut erikseen
--Jarmo 30.3.2015


/****** Object:  Table [dbo].[TK_5_4_sopv_12_amk]    Script Date: 30.3.2015 16:46:57 ******/
IF  EXISTS (SELECT * FROM [VipunenTK_aineistot].sys.objects WHERE object_id = OBJECT_ID(N'[VipunenTK_aineistot].[dbo].[TK_2_7_2012_sopv_14]') AND type in (N'U'))
BEGIN
Print 'DROP TABLE [VipunenTK_aineistot].[dbo].[TK_2_7_2012_sopv_14]';
DROP TABLE [VipunenTK_aineistot].[dbo].[TK_2_7_2012_sopv_14];
END
Print 'Select * into [VipunenTK_aineistot].[dbo].[TK_2_7_2012_sopv_14] from [VipunenTK_SA].[dbo].[TK_2_7_2012_sopv_14]';
Select * into [VipunenTK_aineistot].[dbo].[TK_2_7_2012_sopv_14] from [VipunenTK_SA].[dbo].[TK_2_7_2012_sopv_14];

--IF  EXISTS (SELECT * FROM [VipunenTK_aineistot].sys.objects WHERE object_id = OBJECT_ID(N'[VipunenTK_aineistot].[dbo].[TK_2_8b_sopv_15]') AND type in (N'U'))
--BEGIN
--Print 'DROP TABLE [VipunenTK_aineistot].[dbo].[TK_2_8b_sopv_15]';
--DROP TABLE [VipunenTK_aineistot].[dbo].[TK_2_8b_sopv_15];
--END
--Print 'Select * into [VipunenTK_aineistot].[dbo].[TK_2_8b_sopv_15] from [VipunenTK_SA].[dbo].[TK_2_8b_sopv_15]';
--Select * into [VipunenTK_aineistot].[dbo].[TK_2_8b_sopv_15] from [VipunenTK_SA].[dbo].[TK_2_8b_sopv_15];

--IF  EXISTS (SELECT * FROM [VipunenTK_aineistot].sys.objects WHERE object_id = OBJECT_ID(N'[VipunenTK_aineistot].[dbo].[TK_2_9c_sopv_14]') AND type in (N'U'))
--BEGIN
--Print 'DROP TABLE [VipunenTK_aineistot].[dbo].[TK_2_9c_sopv_14]';
--DROP TABLE [VipunenTK_aineistot].[dbo].[TK_2_9c_sopv_14];
--END
--Print 'Select * into [VipunenTK_aineistot].[dbo].[TK_2_9c_sopv_14] from [VipunenTK_SA].[dbo].[TK_2_9c_sopv_14]';
--Select * into [VipunenTK_aineistot].[dbo].[TK_2_9c_sopv_14] from [VipunenTK_SA].[dbo].[TK_2_9c_sopv_14];

--IF  EXISTS (SELECT * FROM [VipunenTK_aineistot].sys.objects WHERE object_id = OBJECT_ID(N'[VipunenTK_aineistot].[dbo].[TK_5_2_sopv_12]') AND type in (N'U'))
--BEGIN
--Print 'DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_2_sopv_12]';
--DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_2_sopv_12];
--END
--Print 'Select * into [VipunenTK_aineistot].[dbo].[TK_5_2_sopv_12] from [VipunenTK_SA].[dbo].[TK_5_2_sopv_12]';
--Select * into [VipunenTK_aineistot].[dbo].[TK_5_2_sopv_12] from [VipunenTK_SA].[dbo].[TK_5_2_sopv_12];

--IF  EXISTS (SELECT * FROM [VipunenTK_aineistot].sys.objects WHERE object_id = OBJECT_ID(N'[VipunenTK_aineistot].[dbo].[TK_5_2_sopv_12]') AND type in (N'U'))
--BEGIN
--Print 'DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_2_sopv_14]';
--DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_2_sopv_14];
--END
--Print 'Select * into [VipunenTK_aineistot].[dbo].[TK_5_2_sopv_14] from [VipunenTK_SA].[dbo].[TK_5_2_sopv_14]';
--Select * into [VipunenTK_aineistot].[dbo].[TK_5_2_sopv_14] from [VipunenTK_SA].[dbo].[TK_5_2_sopv_14];

--IF  EXISTS (SELECT * FROM [VipunenTK_aineistot].sys.objects WHERE object_id = OBJECT_ID(N'[VipunenTK_aineistot].[dbo].[TK_5_3_sopv_12]') AND type in (N'U'))
--BEGIN
--Print 'DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_3_sopv_12]';
--DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_3_sopv_12];
--END
--Print 'Select * into [VipunenTK_aineistot].[dbo].[TK_5_3_sopv_12] from [VipunenTK_SA].[dbo].[TK_5_3_sopv_12]';
--Select * into [VipunenTK_aineistot].[dbo].[TK_5_3_sopv_12] from [VipunenTK_SA].[dbo].[TK_5_3_sopv_12];

--IF  EXISTS (SELECT * FROM [VipunenTK_aineistot].sys.objects WHERE object_id = OBJECT_ID(N'[VipunenTK_aineistot].[dbo].[TK_5_3_sopv_13]') AND type in (N'U'))
--BEGIN
--Print 'DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_3_sopv_13]';
--DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_3_sopv_13];
--END
--Print 'Select * into [VipunenTK_aineistot].[dbo].[TK_5_3_sopv_13] from [VipunenTK_SA].[dbo].[TK_5_3_sopv_13]';
--Select * into [VipunenTK_aineistot].[dbo].[TK_5_3_sopv_13] from [VipunenTK_SA].[dbo].[TK_5_3_sopv_13];

--IF  EXISTS (SELECT * FROM [VipunenTK_aineistot].sys.objects WHERE object_id = OBJECT_ID(N'[VipunenTK_aineistot].[dbo].[TK_5_3_sopv_14]') AND type in (N'U'))
--BEGIN
--Print 'DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_3_sopv_14]';
--DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_3_sopv_14];
--END
--Print 'Select * into [VipunenTK_aineistot].[dbo].[TK_5_3_sopv_14] from [VipunenTK_SA].[dbo].[TK_5_3_sopv_14]';
--Select * into [VipunenTK_aineistot].[dbo].[TK_5_3_sopv_14] from [VipunenTK_SA].[dbo].[TK_5_3_sopv_14];

--IF  EXISTS (SELECT * FROM [VipunenTK_aineistot].sys.objects WHERE object_id = OBJECT_ID(N'[VipunenTK_aineistot].[dbo].[TK_5_4_sopv_12_amk]') AND type in (N'U'))
--BEGIN
--Print 'DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_12_amk]';
--DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_12_amk];
--END
--Print 'Select * into [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_12_amk] from [VipunenTK_SA].[dbo].[TK_5_4_sopv_12_amk]';
--Select * into [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_12_amk] from [VipunenTK_SA].[dbo].[TK_5_4_sopv_12_amk];

--IF  EXISTS (SELECT * FROM [VipunenTK_aineistot].sys.objects WHERE object_id = OBJECT_ID(N'[VipunenTK_aineistot].[dbo].[TK_5_4_sopv_12_sekt]') AND type in (N'U'))
--BEGIN
--Print 'DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_12_sekt]';
--DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_12_sekt];
--END
--Print 'Select * into [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_12_sekt] from [VipunenTK_SA].[dbo].[TK_5_4_sopv_12_sekt]';
--Select * into [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_12_sekt] from [VipunenTK_SA].[dbo].[TK_5_4_sopv_12_sekt];

--IF  EXISTS (SELECT * FROM [VipunenTK_aineistot].sys.objects WHERE object_id = OBJECT_ID(N'[VipunenTK_aineistot].[dbo].[TK_5_4_sopv_13_amk]') AND type in (N'U'))
--BEGIN
--Print 'DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_13_amk]';
--DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_13_amk];
--END
--Print 'elect * into [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_13_amk] from [VipunenTK_SA].[dbo].[TK_5_4_sopv_13_amk]';
--Select * into [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_13_amk] from [VipunenTK_SA].[dbo].[TK_5_4_sopv_13_amk];

--IF  EXISTS (SELECT * FROM [VipunenTK_aineistot].sys.objects WHERE object_id = OBJECT_ID(N'[VipunenTK_aineistot].[dbo].[TK_5_4_sopv_13_sekt]') AND type in (N'U'))
--BEGIN
--Print 'DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_13_sekt]';
--DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_13_sekt];
--END
--Print 'Select * into [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_13_sekt] from [VipunenTK_SA].[dbo].[TK_5_4_sopv_13_sekt]';
--Select * into [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_13_sekt] from [VipunenTK_SA].[dbo].[TK_5_4_sopv_13_sekt];

--IF  EXISTS (SELECT * FROM [VipunenTK_aineistot].sys.objects WHERE object_id = OBJECT_ID(N'[VipunenTK_aineistot].[dbo].[TK_5_4_sopv_14_amk]') AND type in (N'U'))
--BEGIN
--Print 'DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_14_amk]';
--DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_14_amk];
--END
--Print 'Select * into [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_14_amk] from [VipunenTK_SA].[dbo].[TK_5_4_sopv_14_amk]';
--Select * into [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_14_amk] from [VipunenTK_SA].[dbo].[TK_5_4_sopv_14_amk];

--IF  EXISTS (SELECT * FROM [VipunenTK_aineistot].sys.objects WHERE object_id = OBJECT_ID(N'[VipunenTK_aineistot].[dbo].[TK_5_4_sopv_14_sekt]') AND type in (N'U'))
--BEGIN
--Print 'DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_14_sekt]';
--DROP TABLE [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_14_sekt];
--END
--Print 'Select * into [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_14_sekt] from [VipunenTK_SA].[dbo].[TK_5_4_sopv_14_sekt]';
--Select * into [VipunenTK_aineistot].[dbo].[TK_5_4_sopv_14_sekt] from [VipunenTK_SA].[dbo].[TK_5_4_sopv_14_sekt];
 

END 


GO
/****** Object:  StoredProcedure [dbo].[ETL_tyhjenna_ja_lataa_VipunenTK_DW_SA_taulut]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ETL_tyhjenna_ja_lataa_VipunenTK_DW_SA_taulut]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[ETL_tyhjenna_ja_lataa_VipunenTK_DW_SA_taulut] AS' 
END
GO


/****** Script for SelectTopNRows command from SSMS  ******/


ALTER PROCEDURE [dbo].[ETL_tyhjenna_ja_lataa_VipunenTK_DW_SA_taulut] AS 

/** sa-tauluihin ladattavat DW-kannassa **/
PRINT N'Starting 2_11 load';
truncate table VipunenTK_DW.[dbo].[sa_2_11_Oppilaitosten_tutkintoon_johtamaton];
insert into VipunenTK_DW.[dbo].[sa_2_11_Oppilaitosten_tutkintoon_johtamaton] select * from [v_sa_2_11_Oppilaitosten_tutkintoon_johtamaton];
PRINT N'2_11 ok';

PRINT N'Starting 2_13 load';
truncate table VipunenTK_DW.[dbo].[sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan];
insert into VipunenTK_DW.[dbo].[sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan] select * from [VipunenTK_SA].dbo.[v_sa_2_13_Tutkintoon_johtavan_koulutuksen_opiskelijat_kansalaisuuden_mukaan];
PRINT N'2_13 ok';

PRINT N'Starting 2_14 load';
truncate table VipunenTK_DW.[dbo].[sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan];
insert into VipunenTK_DW.[dbo].[sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan] select * from [VipunenTK_SA].dbo.[v_sa_2_14_Tutkintoon_johtavan_koulutuksen_opiskelijat_syntymamaan_mukaan];
PRINT N'2_14 ok';

PRINT N'Starting 2_15 load';
truncate table VipunenTK_DW.[dbo].[sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan];
insert into VipunenTK_DW.[dbo].[sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan] select * from [VipunenTK_SA].dbo.[v_sa_2_15_Tutkintoon_johtavan_koulutuksen_opiskelijat_aidinkielen_mukaan];
PRINT N'2_15 ok';


PRINT N'Starting K2_17a load';
truncate table [VipunenTK_DW].[dbo].[sa_K2_17a_Ulkomaalaistaustaiset_opisk_ja_tutk];
INSERT INTO [VipunenTK_DW].[dbo].[sa_K2_17a_Ulkomaalaistaustaiset_opisk_ja_tutk] SELECT * FROM [VipunenTK_SA].[dbo].[v_sa_K2_17a_Ulkomaalaistaustaiset_opisk_ja_tutk];
PRINT N'K2_17a ok';

PRINT N'Starting K2_17b load';
truncate table [VipunenTK_DW].[dbo].[sa_K2_17b_Ulkomaalaistaustaiset_opisk_ja_tutk];
INSERT INTO [VipunenTK_DW].[dbo].[sa_K2_17b_Ulkomaalaistaustaiset_opisk_ja_tutk] SELECT * FROM [VipunenTK_SA].[dbo].[v_sa_K2_17b_Ulkomaalaistaustaiset_opisk_ja_tutk];
PRINT N'K2_17b ok';


PRINT N'Starting 2_23 load';
truncate table vipunentk_dw..sa_2_23_Opisk_ja_tutksuor_vanh_aseman_muk;
insert into vipunentk_dw..sa_2_23_Opisk_ja_tutksuor_vanh_aseman_muk select * from v_sa_2_23_Opisk_ja_tutksuor_vanh_aseman_muk;
PRINT N'2_23 ok';

PRINT N'Starting 2_3 load';
truncate table vipunentk_dw..sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat;
insert into vipunentk_dw..sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat select * from v_sa_2_3_Lukio_ja_amm_koulutuksen_opiskelijat;
PRINT N'2_3 ok';

PRINT N'Starting 2_3h load';
truncate table vipunentk_dw..sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat
insert into vipunentk_dw..sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat select * from v_sa_2_3h_Lukio_ja_amm_koulutuksen_opiskelijat
PRINT N'2_3h ok';

PRINT N'Starting 2_3efg load';
truncate table vipunentk_dw..sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat
insert into vipunentk_dw..sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat select * from v_sa_2_3efg_Lukio_ja_amm_koulutuksen_opiskelijat
PRINT N'2_3efg ok';

PRINT N'Starting 2_4efg load';
truncate table vipunentk_dw..sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot
insert into vipunentk_dw..sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot select * from v_sa_2_4efg_Lukio_ja_amm_koulutuksen_tutkinnot
PRINT N'2_4efg ok';

PRINT N'Starting 2_4 load';
truncate table vipunentk_dw..sa_2_4_Amm_koulutuksen_tutkinnot;
insert into vipunentk_dw..sa_2_4_Amm_koulutuksen_tutkinnot select * from v_sa_2_4_Amm_koulutuksen_tutkinnot;
PRINT N'2_4 ok';

PRINT N'Starting 2_5 load';

truncate table VipunenTK_DW.dbo.sa_2_5_Lukiokoulutuksen_ainevalinnat;
insert into VipunenTK_DW.dbo.sa_2_5_Lukiokoulutuksen_ainevalinnat Select * from VipunenTK_SA.dbo.v_sa_2_5_Lukiokoulutuksen_ainevalinnat;

PRINT N'2_5 ok';

PRINT N'Starting 2_8 load';
truncate table vipunentk_dw..sa_2_8_Korkeakoulut_opiskelijat;
insert into vipunentk_dw..sa_2_8_Korkeakoulut_opiskelijat select * from v_sa_2_8_Korkeakoulut_opiskelijat;
PRINT N'2_8 ok';

PRINT N'Starting 2_9 load';
truncate table vipunentk_dw..sa_2_9_Korkeakoulut_tutkinnot;
insert into vipunentk_dw..sa_2_9_Korkeakoulut_tutkinnot select * from v_sa_2_9_Korkeakoulut_tutkinnot;
PRINT N'2_9 ok';

PRINT N'Starting 3_14 load';

truncate table vipunentk_dw..sa_3_14_Lukio_ja_amm_opisk_mediaani_iat;
insert into vipunentk_dw..sa_3_14_Lukio_ja_amm_opisk_mediaani_iat select * from v_sa_3_14_Lukio_ja_amm_opisk_mediaani_iat;

PRINT N'3_14 ok';
PRINT N'Starting 3_15 load';

truncate table vipunentk_dw..sa_3_15_Lukio_ja_amm_tutk_mediaani_iat;
insert into vipunentk_dw..sa_3_15_Lukio_ja_amm_tutk_mediaani_iat select * from v_sa_3_15_Lukio_ja_amm_tutk_mediaani_iat;

PRINT N'3_15 ok';
PRINT N'Starting K3_16 load';

truncate table vipunentk_dw..sa_K3_16_Moninkertainen_haku;
insert into vipunentk_dw..sa_K3_16_Moninkertainen_haku select * from v_sa_K3_16_Moninkertainen_haku;

PRINT N'K3_16 ok';
PRINT N'Starting 3_4 load';

truncate table vipunentk_dw..sa_3_4_Kk_tutk_suor_mediaani_iat_ja_tutk_mediaani_ajat;
insert into vipunentk_dw..sa_3_4_Kk_tutk_suor_mediaani_iat_ja_tutk_mediaani_ajat select * from v_sa_3_4_Kk_tutk_suor_mediaani_iat_ja_tutk_mediaani_ajat;

PRINT N'3_4 ok';

PRINT N'Starting 4_1 load';
truncate table vipunentk_dw..[sa_4_1_Perusopetuksen_lisäopetuksen_päättäneiden_sijoittuminen];
insert into vipunentk_dw..[sa_4_1_Perusopetuksen_lisäopetuksen_päättäneiden_sijoittuminen] select * from [v_sa_4_1_Perusopetuksen_lisäopetuksen_päättäneiden_sijoittuminen];
PRINT N'4_1 ok';

PRINT N'Starting 4_2 load';
truncate table vipunentk_dw..sa_4_2_Vaeston_koulutusrakenne_ja_paaasiallinen_toiminta;
insert into vipunentk_dw..sa_4_2_Vaeston_koulutusrakenne_ja_paaasiallinen_toiminta select * from v_sa_4_2_Vaeston_koulutusrakenne_ja_paaasiallinen_toiminta;
PRINT N'4_2 ok';

PRINT N'Starting 4_3 load';

truncate table vipunentk_dw..sa_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta;
insert into vipunentk_dw..sa_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta select * from v_sa_4_3_Tutkinnon_suorittaneiden_paaasiallinen_toiminta;

PRINT N'4_3 ok';

PRINT N'Starting 4_7 load';
Truncate table [VipunenTK_DW].[dbo].[sa_4_7_Tutkinnon_suorittaneiden_aiempi_koulutus]
Insert into [VipunenTK_DW].[dbo].[sa_4_7_Tutkinnon_suorittaneiden_aiempi_koulutus]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_4_7_Tutkinnon_suorittaneiden_aiempi_koulutus]
PRINT N'4_7 ok';

PRINT N'Starting 4_8 load';
Truncate table [VipunenTK_DW].[dbo].[sa_4_8_Tutkinnon_suorittaneiden_myohempi_koulutus]
Insert into [VipunenTK_DW].[dbo].[sa_4_8_Tutkinnon_suorittaneiden_myohempi_koulutus]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_4_8_Tutkinnon_suorittaneiden_myohempi_koulutus]
PRINT N'4_8 ok';

PRINT N'Starting 4_9 load';

truncate table vipunentk_dw..sa_4_9_Vaestorakenne_kunnittain;
insert into vipunentk_dw..sa_4_9_Vaestorakenne_kunnittain select * from v_sa_4_9_Vaestorakenne_kunnittain;

PRINT N'4_9 ok';

PRINT N'Starting 4_10 load';
truncate table vipunentk_dw..[sa_4_10_Vaestorakenne_aidinkielen_mukaan_maakunnittain];
insert into vipunentk_dw..[sa_4_10_Vaestorakenne_aidinkielen_mukaan_maakunnittain] select * from [v_sa_4_10_Väestörakenne_äidinkielen_mukaan_maakunnittain];
PRINT N'4_10 ok';

PRINT N'Starting 4_11 load';
truncate table vipunentk_dw..[sa_4_11_Vaeston_maassamuutto_asuinmaakunnan_ja_koulutuksen_mukaan];
insert into vipunentk_dw..[sa_4_11_Vaeston_maassamuutto_asuinmaakunnan_ja_koulutuksen_mukaan] select * from [v_sa_4_11_Vaeston_maassamuutto_asuinmaakunnan_ja_koulutuksen_mukaan];
PRINT N'4_11 ok';

PRINT N'Starting R4_19 load';
truncate table [VipunenTK_DW].[dbo].[sa_R4_19_Tyollisten_ammattisiirtymat];
INSERT INTO [VipunenTK_DW].[dbo].[sa_R4_19_Tyollisten_ammattisiirtymat] SELECT * FROM [VipunenTK_SA].[dbo].[v_sa_R4_19_Tyollisten_ammattisiirtymat];
PRINT N'R4_19 ok';

PRINT N'Starting R4_20 load';
truncate table [VipunenTK_DW].[dbo].[sa_R4_20_Tyollisten_aiemmat_ammatit];
INSERT INTO [VipunenTK_DW].[dbo].[sa_R4_20_Tyollisten_aiemmat_ammatit] SELECT * FROM [VipunenTK_SA].[dbo].[v_sa_R4_20_Tyollisten_aiemmat_ammatit];
PRINT N'R4_20 ok';

PRINT N'Starting 5_1 load';
Truncate table [VipunenTK_DW].[dbo].[sa_5_1_Yliopistojen_tutkimushenkilökunta_yliopistoittain];
Insert into [VipunenTK_DW].[dbo].[sa_5_1_Yliopistojen_tutkimushenkilökunta_yliopistoittain] Select * FROM VipunenTK_SA.[dbo].[v_sa_5_1_Yliopistojen_tutkimushenkilökunta_yliopistoittain];
PRINT N'5_1 ok';

PRINT N'Starting 5_2 load';
Truncate table [VipunenTK_DW].[dbo].[sa_5_2_Yliopistojen_tutkimustyovuodet_yliopistoittain];
Insert into [VipunenTK_DW].[dbo].[sa_5_2_Yliopistojen_tutkimustyovuodet_yliopistoittain] Select * FROM VipunenTK_SA.[dbo].[v_sa_5_2_Yliopistojen_tutkimustyovuodet_yliopistoittain];
PRINT N'5_2 ok';

PRINT N'Starting 5_3 load';
Truncate table [VipunenTK_DW].[dbo].[sa_5_3_Yliopistojen_tutkimustyovuodet_ja_tutkimusmenot_rahoituslahteittain_menolajeittain_yliopistoittain];
Insert into [VipunenTK_DW].[dbo].[sa_5_3_Yliopistojen_tutkimustyovuodet_ja_tutkimusmenot_rahoituslahteittain_menolajeittain_yliopistoittain] Select * FROM VipunenTK_SA.[dbo].[v_sa_5_3_Yliopistojen_tutkimustyovuodet_ja_tutkimusmenot_rahoituslahteittain_menolajeittain_yliopistoittain];
PRINT N'5_3 ok';

PRINT N'Starting 5_4 load';
Truncate table [VipunenTK_DW].[dbo].[sa_5_4_Ammattikorkeakoulujen_tutkimus_ja_kehitys]
Insert into [VipunenTK_DW].[dbo].[sa_5_4_Ammattikorkeakoulujen_tutkimus_ja_kehitys]
  Select * FROM VipunenTK_SA.[dbo].[v_sa_5_4_Ammattikorkeakoulujen_tutkimus_ja_kehitys]
PRINT N'5_4 ok';

PRINT N'Starting 5_4 sekt load';
Truncate table [VipunenTK_DW].[dbo].[sa_5_4_Sektoritutkimuslaitosten_tutkimus_ja_kehitys];
Insert into [VipunenTK_DW].[dbo].[sa_5_4_Sektoritutkimuslaitosten_tutkimus_ja_kehitys] Select * FROM VipunenTK_SA.[dbo].[v_sa_5_4_Sektoritutkimuslaitosten_tutkimus_ja_kehitys];
PRINT N'5_4 sekt ok';

PRINT N'Starting 5_4 yosair load';
Truncate table [VipunenTK_DW].[dbo].[sa_5_4_Yosairaaloiden_tutkimus_ja_kehitys];
Insert into [VipunenTK_DW].[dbo].[sa_5_4_Yosairaaloiden_tutkimus_ja_kehitys] Select * FROM VipunenTK_SA.[dbo].[v_sa_5_4_Yosairaaloiden_tutkimus_ja_kehitys];
PRINT N'5_4 yosair ok';

PRINT N'Starting 5_5 load';
Truncate table [VipunenTK_DW].[dbo].[sa_K5_5_Tieteen_ja_teknologian_henkilovoimavarat];
Insert into [VipunenTK_DW].[dbo].[sa_K5_5_Tieteen_ja_teknologian_henkilovoimavarat] Select * FROM VipunenTK_SA.[dbo].[v_sa_K5_5_Tieteen_ja_teknologian_henkilovoimavarat];
PRINT N'5_5 ok';

/** f-tauluihin ladattavat DW-kannassa **/
PRINT N'Starting 2_1 load';
truncate table VipunenTK_DW.[dbo].[f_2_1_Peruskoulutiedosto];
insert into VipunenTK_DW.[dbo].[f_2_1_Peruskoulutiedosto] select * from [v_sa_2_1_Peruskoulutiedosto];
PRINT N'2_1 ok';

PRINT N'Starting 2_10 load';
truncate table [VipunenTK_DW].[dbo].[sa_2_10_Korkeakouluopiskelijoiden_aikaisempi_koulutus];
INSERT INTO [VipunenTK_DW].[dbo].[sa_2_10_Korkeakouluopiskelijoiden_aikaisempi_koulutus] SELECT * FROM [VipunenTK_SA].[dbo].[v_sa_2_10_Korkeakouluopiskelijoiden_aikaisempi_koulutus];
PRINT N'2_10 ok';

PRINT N'Starting R2_20 load';
truncate table [VipunenTK_DW].[dbo].[sa_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan];
INSERT INTO [VipunenTK_DW].[dbo].[sa_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan] SELECT * FROM [VipunenTK_SA].[dbo].[v_sa_2_20_Lukio_amm_oppis_opisk_ian_ja_aik_koul_mukaan];
PRINT N'2_20 ok';

PRINT N'Starting R2_22 load';
truncate table VipunenTK_DW.dbo.f_R2_22_Oppilaitostason_oppil_ja_opisk;
insert into VipunenTK_DW.dbo.f_R2_22_Oppilaitostason_oppil_ja_opisk select * from v_sa_R2_22_Oppilaitostason_oppil_ja_opisk;
PRINT N'R2_22 ok';

PRINT N'Starting R4_14 load';
Truncate table [VipunenTK_DW].[dbo].[f_R4_14_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan];
Insert into [VipunenTK_DW].[dbo].[f_R4_14_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan] Select * from [VipunenTK_SA].[dbo].[v_sa_R4_14_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan];
PRINT N'R4_14 ok';

PRINT N'Starting R4_14b load';
Truncate table [VipunenTK_DW].[dbo].[f_R4_14b_Alueella_tyossakayvat_tilastokeskuksen_toimialan_mukaan];
Insert into [VipunenTK_DW].[dbo].[f_R4_14b_Alueella_tyossakayvat_tilastokeskuksen_toimialan_mukaan] Select * from [VipunenTK_SA].[dbo].[v_sa_R4_14b_Alueella_tyossakayvat_tilastokeskuksen_toimialan_mukaan];
PRINT N'R4_14b ok';

PRINT N'Starting R4_15 load';
Truncate table [VipunenTK_DW].[dbo].[f_R4_15_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan_1vuotisikaryh];
Insert into [VipunenTK_DW].[dbo].[f_R4_15_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan_1vuotisikaryh] Select * from [VipunenTK_SA].[dbo].[v_sa_R4_15_Alueella_tyossakayvat_toimialan_ammryhm_ja_koul_mukaan_1vuotisikaryh];
PRINT N'R4_15 ok';

PRINT N'Starting R4_16 load';
Truncate table [VipunenTK_DW].[dbo].[f_R4_16_Tyossakayvat_ammateittain];
Insert into [VipunenTK_DW].[dbo].[f_R4_16_Tyossakayvat_ammateittain] Select * from [VipunenTK_SA].[dbo].[v_sa_R4_16_Tyossakayvat_ammateittain];
PRINT N'R4_16 ok';

PRINT N'Starting R4_17 load';
truncate table [VipunenTK_DW].[dbo].[f_R4_17_Elakkeelle_siirt_ja_heidan_ammatti];
insert into [VipunenTK_DW].[dbo].[f_R4_17_Elakkeelle_siirt_ja_heidan_ammatti] SELECT *   FROM [VipunenTK_SA].[dbo].[v_sa_R4_17_Elakkeelle_siirt_ja_heidan_ammatti];
PRINT N'R4_17 ok';

PRINT N'Starting R4_18 load';
truncate table [VipunenTK_DW].[dbo].[f_R4_18_Elakkeelle_siirt_ja_heidan_ammatti_2v_aiemmin];
INSERT INTO [VipunenTK_DW].[dbo].[f_R4_18_Elakkeelle_siirt_ja_heidan_ammatti_2v_aiemmin] SELECT * FROM [VipunenTK_SA].[dbo].[v_sa_R4_18_Elakkeelle_siirt_ja_heidan_ammatti_2v_aiemmin];
PRINT N'R4_18 ok';

PRINT N'Starting 7_1 load';
Truncate table [VipunenTK_DW].[dbo].[f_7_1_Perusopetuksen_opettajat_kelpoisuus_opetusryhmakoot]
Insert into [VipunenTK_DW].[dbo].[f_7_1_Perusopetuksen_opettajat_kelpoisuus_opetusryhmakoot] Select * from [VipunenTK_SA].[dbo].[v_sa_7_1_Perusopetuksen_opettajat_kelpoisuus_opetusryhmakoot]
PRINT N'7_1 ok';

PRINT N'Starting 7_2 load';
Truncate table [VipunenTK_DW].[dbo].[f_7_2_Perusopetuksen_opettajat_koulutuksen_jarjestaja_opetusryhmakoot]
Insert into [VipunenTK_DW].[dbo].[f_7_2_Perusopetuksen_opettajat_koulutuksen_jarjestaja_opetusryhmakoot] Select * from [VipunenTK_SA].[dbo].[v_sa_7_2_Perusopetuksen_opettajat_koulutuksen_jarjestaja_opetusryhmakoot]
PRINT N'7_2 ok';

PRINT N'Starting 7_3 load';
Truncate table [VipunenTK_DW].[dbo].[f_7_3_Perusopetuksen_opettajat_osallistuminen_taydennyskoulutukseen]
Insert into [VipunenTK_DW].[dbo].[f_7_3_Perusopetuksen_opettajat_osallistuminen_taydennyskoulutukseen] Select * from [VipunenTK_SA].[dbo].[v_sa_7_3_Perusopetuksen_opettajat_osallistuminen_täydennyskoulutukseen]
PRINT N'7_3 ok';

PRINT N'Starting 7_4 load';
Truncate table [VipunenTK_DW].[dbo].[f_7_4_Lukiokoulutuksen_opettajat_kelpoisuus_aine]
Insert into [VipunenTK_DW].[dbo].[f_7_4_Lukiokoulutuksen_opettajat_kelpoisuus_aine] Select * from [VipunenTK_SA].[dbo].[v_sa_7_4_Lukiokoulutuksen_opettajat_kelpoisuus_aine]
PRINT N'7_4 ok';

PRINT N'Starting 7_5 load';
Truncate table [VipunenTK_DW].[dbo].[f_7_5_Lukiokoulutuksen_opettajat_koulutuksen_jarjestaja]
Insert into [VipunenTK_DW].[dbo].[f_7_5_Lukiokoulutuksen_opettajat_koulutuksen_jarjestaja] Select * from [VipunenTK_SA].[dbo].[v_sa_7_5_Lukiokoulutuksen_opettajat_koulutuksen_jarjestaja]
PRINT N'7_5 ok';

PRINT N'Starting 7_6 load';
Truncate table [VipunenTK_DW].[dbo].[f_7_6_Lukiokoulutuksen_opettajat_osallistuminen_taydennyskoulutukseen]
Insert into [VipunenTK_DW].[dbo].[f_7_6_Lukiokoulutuksen_opettajat_osallistuminen_taydennyskoulutukseen] Select * from [VipunenTK_SA].[dbo].[v_sa_7_6_Lukiokoulutuksen_opettajat_osallistuminen_täydennyskoulutukseen]
PRINT N'7_6 ok';

PRINT N'Starting 7_7 load';
Truncate table [VipunenTK_DW].[dbo].[f_7_7_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]
Insert into [VipunenTK_DW].[dbo].[f_7_7_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus] Select * from [VipunenTK_SA].[dbo].[v_sa_7_7_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]
PRINT N'7_7 ok';

PRINT N'Starting 7_8 load';
Truncate table [VipunenTK_DW].[dbo].[f_7_8_Ammatillisen_koulutuksen_opettajat_osallistuminen_täydennyskoulutukseen]
Insert into [VipunenTK_DW].[dbo].[f_7_8_Ammatillisen_koulutuksen_opettajat_osallistuminen_täydennyskoulutukseen] Select * from [VipunenTK_SA].[dbo].[v_sa_7_8_Ammatillisen_koulutuksen_opettajat_osallistuminen_täydennyskoulutukseen]
PRINT N'7_8 ok';

PRINT N'Starting 7_9 load';
Truncate table [VipunenTK_DW].[dbo].[f_7_9_Vapaan_sivistystyön_opettajat_osallistuminen_täydennyskoulutukseen]
Insert into [VipunenTK_DW].[dbo].[f_7_9_Vapaan_sivistystyön_opettajat_osallistuminen_täydennyskoulutukseen] Select * from [VipunenTK_SA].[dbo].[v_sa_7_9_Vapaan_sivistystyön_opettajat_osallistuminen_täydennyskoulutukseen]
PRINT N'7_9 ok';

PRINT N'Starting 7_10 load';
Truncate table [VipunenTK_DW].[dbo].[f_7_10_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]
Insert into [VipunenTK_DW].[dbo].[f_7_10_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus] Select * from [VipunenTK_SA].[dbo].[v_sa_7_10_Ammatillisen_koulutuksen_opettajat_kelpoisuus_koulutus]
PRINT N'7_10 ok';

PRINT N'Starting 7_12 load';
Truncate table [VipunenTK_DW].[dbo].[f_7_12_Vapaan_sivistystyön_opettajat_kelpoisuus_aine]
Insert into [VipunenTK_DW].[dbo].[f_7_12_Vapaan_sivistystyön_opettajat_kelpoisuus_aine] Select * from [VipunenTK_SA].[dbo].[v_sa_7_12_Vapaan_sivistystyön_opettajat_kelpoisuus_aine]
PRINT N'7_12 ok';

PRINT N'Starting 3_1a load';
Truncate table [VipunenTK_DW].[dbo].[sa_3_1a_Oppisopimuskoulutus]
Insert into [VipunenTK_DW].[dbo].[sa_3_1a_Oppisopimuskoulutus] Select * from [VipunenTK_SA].[dbo].[v_sa_3_1a_Oppisopimuskoulutus]
PRINT N'3_1a ok';


PRINT N'Starting 3_1b load';
Truncate table [VipunenTK_DW].[dbo].[sa_3_1b_Oppisopimuskoulutus]
Insert into [VipunenTK_DW].[dbo].[sa_3_1b_Oppisopimuskoulutus] Select * from [VipunenTK_SA].[dbo].[v_sa_3_1b_Oppisopimuskoulutus]
PRINT N'3_1b ok';

PRINT N'Starting 3_2 load';
Truncate table [VipunenTK_DW].[dbo].[sa_3_2_Oppisopimuskoulutus]
Insert into [VipunenTK_DW].[dbo].[sa_3_2_Oppisopimuskoulutus] Select * from [VipunenTK_SA].[dbo].[v_sa_3_2_Oppisopimuskoulutus_jatko_opinnot]
PRINT N'3_2 ok';

PRINT N'Starting K3_11 load';
Truncate table [VipunenTK_DW].[dbo].[sa_K3_11_ Tutkinnon suorittaneiden osuus poistumasta]
Insert into [VipunenTK_DW].[dbo].[sa_K3_11_ Tutkinnon suorittaneiden osuus poistumasta] Select * from [VipunenTK_SA].[dbo].[v_sa_K3_11_ Tutkinnon suorittaneiden osuus poistumasta]
PRINT N'K3_11 ok';

exec p_lataa_koulutukseen_sijoittuneet_2v;

exec p_lataa_koulutukseen_sijoittuneet_6v;




GO
/****** Object:  StoredProcedure [dbo].[GetNewSeqVal]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetNewSeqVal]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GetNewSeqVal] AS' 
END
GO
ALTER procedure [dbo].[GetNewSeqVal]

      @SeqName nvarchar(255)

as

begin

      declare @NewSeqVal int

      set NOCOUNT ON

      update dbo.AllSequences

      set @NewSeqVal = CurrVal = CurrVal+Incr

      where SeqName = @SeqName

     

      if @@rowcount = 0 begin

print 'Sequence does not exist'

            return

      end

 

      return @NewSeqVal

end

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_0__valittomasti__tarkastelujakso]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_0__valittomasti__tarkastelujakso]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_0__valittomasti__tarkastelujakso] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_0__valittomasti__tarkastelujakso] AS
declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;
DECLARE @seitsemas_suoritusvuosi int;

set @ensimmainen_suoritusvuosi = 2008;
set @toinen_suoritusvuosi = 2009;
set @kolmas_suoritusvuosi = 2010;
set @neljas_suoritusvuosi = 2011;
set @viides_suoritusvuosi = 2012;
set @kuudes_suoritusvuosi = 2013;
set @seitsemas_suoritusvuosi = 2014;


INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_2v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
,lkm
,pohjkoulk
,tietolahde
, aineisto
 ,lukiokoulutuksessa
 ,ammatillisessa_koulutuksessa
 ,ammattikorkeakoulutuksessa
 ,yliopistokoulutuksessa
 ,lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
 ,toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
 ,ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
 ,koulutuksen_paattaneiden_toiminta
 ,ika_1v
 ,ika_5v
)
SELECT
 l.rivinumero,
 '0',
 l.tilv,
 l.tilv_date,
 l.tutkryh,
 l.suorv,
   (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
l.tutktav,
l.aikoul,
l.tutkmaak,


 -- Koulutus 1
 (case
    --lukiokoulutuksessa 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008 
	-- ammattikoulutuksessa 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then l.ammopiskkoulk2008 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2008 ensim. koulutustietoihin
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammattikorkeakoulutuksessa 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then l.amkopiskkoulk2008
	-- yliopistokoulutuksessa 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then l.yoopiskkoulk2008
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and ammopiskkoulk2008 = ''  then l.amkopiskkoulk2008 
	
	
	-- lukiokoulutuksessa 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammatillisessa koulutuksessa 2009 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then l.ammopiskkoulk2009 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2009 ensimäisiin koulutustietoihin
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammattikorkeakoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009  = '' and l.ammopiskkoulk2009 = '' then l.amkopiskkoulk2009
	-- yliopistokoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then l.yoopiskkoulk2009 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.amkopiskkoulk2009 
	
	
	-- lukiokoulutuksessa 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammatillisessa koulutuksessa 2010 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then l.ammopiskkoulk2010 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010  = '' and l.ammopiskkoulk2010 = '' then l.amkopiskkoulk2010
	-- yliopistokoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then l.yoopiskkoulk2010 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.amkopiskkoulk2010 
	
	-- lukiokoulutuksessa 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammatillisessa koulutuksessa 2011 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then l.ammopiskkoulk2011 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2011 ensimäisiin koulutustietoihin
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammattikorkeakoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011  = '' and l.ammopiskkoulk2011 = '' then l.amkopiskkoulk2011
	-- yliopistokoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then l.yoopiskkoulk2011 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.amkopiskkoulk2011 
	
	
	-- lukiokoulutuksessa 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammatillisessa koulutuksessa 2012 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then l.ammopiskkoulk2012 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2012 ensimäisiin koulutustietoihin
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammattikorkeakoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012  = '' and l.ammopiskkoulk2012 = '' then l.amkopiskkoulk2012
	-- yliopistokoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then l.yoopiskkoulk2012 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.amkopiskkoulk2012 

	-- lukiokoulutuksessa 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.luopiskkoulk2013
	-- ammatillisessa koulutuksessa 2013 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 ='' and l.yoopiskkoulk2013 = ''  then l.ammopiskkoulk2013 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2012 ensimäisiin koulutustietoihin
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.luopiskkoulk2013
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013  <> '' and l.yoopiskkoulk2013  = '' and
	l.luopiskkoulk2013  = '' and l.ammopiskkoulk2013 = '' then l.amkopiskkoulk2013
	-- yliopistokoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 <> '' and 
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''   then l.yoopiskkoulk2013 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013  <> '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''  then l.amkopiskkoulk2013 
		-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013  = '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 <>''  then l.amkopiskkoulk2013 
	
	
	-- lukiokoulutuksessa 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then l.luopiskkoulk2014
	-- ammatillisessa koulutuksessa 2014 
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 ='' and l.yoopiskkoulk2014 = ''  then l.ammopiskkoulk2014 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2012 ensimäisiin koulutustietoihin
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then l.luopiskkoulk2014
	-- ammattikorkeakoulutuksessa
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014  <> '' and l.yoopiskkoulk2014  = '' and
	l.luopiskkoulk2014  = '' and l.ammopiskkoulk2014 = '' then l.amkopiskkoulk2014
	-- yliopistokoulutuksessa
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 <> '' and 
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''   then l.yoopiskkoulk2014 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014  <> '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''  then l.amkopiskkoulk2014 
		-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014  = '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 <>''  then l.amkopiskkoulk2014 

	else ''
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008 
	-- ammattikoulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and l.yoopisktunn2008 = ''  then l.ammopisktunn2008 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammattikorkeakoulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then l.amkopisktunn2008
	-- yliopistokoulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''   then l.yoopisktunn2008
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2008  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.amkopisktunn2008 
	
	
	-- lukiokoulutuksen oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammatillisen koulutuksen oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and l.yoopisktunn2009 = ''  then l.ammopisktunn2009
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammattikorkeakoulutuksen oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then l.amkopisktunn2009
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''   then l.yoopisktunn2009  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.amkopisktunn2009 
	
	-- lukiokoulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and l.yoopisktunn2010 = ''  then l.ammopisktunn2010
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then l.amkopisktunn2010
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''   then l.yoopisktunn2010 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.amkopisktunn2010
	
	-- lukiokoulutuksen oppilaitos 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammatillisen koulutuksen oppilaitos 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and l.yoopisktunn2011 = ''  then l.ammopisktunn2011
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammattikorkeakoulutuksen oppilaitos 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then l.amkopisktunn2011
	-- yliopistokoulutuksen oppilaitos 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''   then l.yoopisktunn2011 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.amkopisktunn2011
	
    -- lukiokoulutuksen oppilaitos 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammatillisen koulutuksen oppilaitos 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and l.yoopisktunn2012 = ''  then l.ammopisktunn2012
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammattikorkeakoulutuksen oppilaitos 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then l.amkopisktunn2012
	-- yliopistokoulutuksen oppilaitos 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''   then l.yoopisktunn2012 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.amkopisktunn2012
	
	 -- lukiokoulutuksen oppilaitos 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 = '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.luopisktunn2013
	-- ammatillisen koulutuksen oppilaitos 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 = '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 ='' and l.yoopisktunn2013 = ''  then l.ammopisktunn2013
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.luopisktunn2013
	-- ammattikorkeakoulutuksen oppilaitos 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013  <> '' and l.yoopisktunn2013  = '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = '' then l.amkopisktunn2013
	-- yliopistokoulutuksen oppilaitos 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013 = '' and l.yoopisktunn2013 <> '' and 
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''   then l.yoopisktunn2013 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013 <> '' and l.yoopisktunn2013  <> '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''  then l.amkopisktunn2013


	 -- lukiokoulutuksen oppilaitos 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 = '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then l.luopisktunn2014
	-- ammatillisen koulutuksen oppilaitos 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 = '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 ='' and l.yoopisktunn2014 = ''  then l.ammopisktunn2014
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then l.luopisktunn2014
	-- ammattikorkeakoulutuksen oppilaitos 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014  <> '' and l.yoopisktunn2014  = '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = '' then l.amkopisktunn2014
	-- yliopistokoulutuksen oppilaitos 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014 = '' and l.yoopisktunn2014 <> '' and 
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = ''   then l.yoopisktunn2014 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009  
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014 <> '' and l.yoopisktunn2014  <> '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = ''  then l.amkopisktunn2014
	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008 = '' and
	l.amkopiskjarj2008 = '' and yoopiskjarj2008 = '' then l.luopiskjarj2008
	-- ammatillisen koulutuksen järjestäjä 2008  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and l.yoopiskjarj2008 = ''  then l.ammopiskjarj2008
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen 2008 järjestäjä 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008
	-- ammattikorkeakoulutuksen järjestäjä 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then l.amkopiskjarj2008
	-- yliopistokoulutuksen järjestäjä 2008 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then l.yoopiskjarj2008
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen 2008 järjestäjä   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.amkopiskjarj2008 

	
	-- lukiokoulutuksen järjestäjä 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009  = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009  
	-- ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and yoopiskjarj2009 = ''  then l.ammopiskjarj2009 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009
	-- ammattikorkeakoulutuksen 2009 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then l.amkopiskjarj2009 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then l.yoopiskjarj2009
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.amkopiskjarj2009 
	
	-- lukiokoulutuksen järjestäjä 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010 
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and yoopiskjarj2010 = ''  then l.ammopiskjarj2010 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2010 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then l.amkopiskjarj2010 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then l.yoopiskjarj2010
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.amkopiskjarj2010 
	
	
	-- lukiokoulutuksen järjestäjä 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011 
	-- ammatillisen koulutuksen järjestäjä 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and yoopiskjarj2011 = ''  then l.ammopiskjarj2011 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2011, merkitään lukiokoulutuksen 2011 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011
	-- ammattikorkeakoulutuksen 2011 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then l.amkopiskjarj2011 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''   then l.yoopiskjarj2011
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011  = ''  then l.amkopiskjarj2011 
	
	-- lukiokoulutuksen järjestäjä 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012 = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.luopiskjarj2012 
	-- ammatillisen koulutuksen järjestäjä 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and yoopiskjarj2012 = ''  then l.ammopiskjarj2012 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2012, merkitään lukiokoulutuksen 2012 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.luopiskjarj2012
	-- ammattikorkeakoulutuksen 2012 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then l.amkopiskjarj2012 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012 = ''   then l.yoopiskjarj2012
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012  = ''  then l.amkopiskjarj2012 
	
	-- lukiokoulutuksen järjestäjä 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013  <> '' and l.ammopiskjarj2013 = '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.luopiskjarj2013 
	-- ammatillisen koulutuksen järjestäjä 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013 = '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 ='' and yoopiskjarj2013 = ''  then l.ammopiskjarj2013 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2012, merkitään lukiokoulutuksen 2012 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013 <> '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.luopiskjarj2013
	-- ammattikorkeakoulutuksen 2012 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   = '' and
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = '' then l.amkopiskjarj2013 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  = '' and l.yoopiskjarj2013  <> '' and 
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013 = ''   then l.yoopiskjarj2013
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   <> '' and
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013  = ''  then l.amkopiskjarj2013 


	 	-- lukiokoulutuksen järjestäjä 2012
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014  <> '' and l.ammopiskjarj2014 = '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then l.luopiskjarj2014 
	-- ammatillisen koulutuksen järjestäjä 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014 = '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 ='' and yoopiskjarj2014 = ''  then l.ammopiskjarj2014 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2012, merkitään lukiokoulutuksen 2012 järjestäjä
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014 <> '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then l.luopiskjarj2014
	-- ammattikorkeakoulutuksen 2012 järjestäjä
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   = '' and
	l.luopiskjarj2014 = '' and l.ammopiskjarj2014 = '' then l.amkopiskjarj2014 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  = '' and l.yoopiskjarj2014  <> '' and 
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014 = ''   then l.yoopiskjarj2014
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   <> '' and
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014  = ''  then l.amkopiskjarj2014 

	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008   
	-- ammatillisen koulutuksen maakunta 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  ='' and l.yoopiskmaak2008  = ''  then l.ammopiskmaak2008  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008 
    -- ammattikorkeakoulutuksen maakunta 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskmaak2008 = '' then l.amkopiskmaak2008
	-- yliopistokoulutuksen maakunta 2008 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskmaak2008 = ''   then l.yoopiskmaak2008
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta 2008   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskmaak2008  = ''  then l.amkopiskmaak2008 
	
	
	-- lukioopiskelun maakunta 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009
	-- ammatillisen koulutksen maakunta 2009    
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then l.ammopiskmaak2009
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009 
	-- ammattikorkekoulutuksen maakunta 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then l.amkopiskmaak2009
	-- yliopistokoulutuksen maakunta 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then l.yoopiskmaak2009
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2009   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.amkopiskmaak2009 
	
    -- lukioopiskelun maakunta 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010
	-- ammatillisen koulutksen maakunta 2010    
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010  = ''  then l.ammopiskmaak2010
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010 
	-- ammattikorkekoulutuksen maakunta 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskmaak2010 = '' then l.amkopiskmaak2010
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskmaak2010 = ''   then l.yoopiskmaak2010
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2009   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskmaak2010  = ''  then l.amkopiskmaak2010 
	
	-- lukioopiskelun maakunta 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011   <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011
	-- ammatillisen koulutksen maakunta 2011    
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  ='' and l.yoopiskmaak2011  = ''  then l.ammopiskmaak2011
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011 
	-- ammattikorkekoulutuksen maakunta 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskmaak2011 = '' then l.amkopiskmaak2011
	-- yliopistokoulutuksen maakunta 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskmaak2011 = ''   then l.yoopiskmaak2011
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2009   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskmaak2011  = ''  then l.amkopiskmaak2011 
	
	-- lukioopiskelun maakunta 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012   <> '' and l.ammopiskmaak2012  = '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.luopiskmaak2012
	-- ammatillisen koulutksen maakunta 2012    
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  = '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  ='' and l.yoopiskmaak2012  = ''  then l.ammopiskmaak2012
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.luopiskmaak2012 
	-- ammattikorkekoulutuksen maakunta 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012   <> '' and l.yoopiskmaak2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskmaak2012 = '' then l.amkopiskmaak2012
	-- yliopistokoulutuksen maakunta 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  <> '' and 
	l.luopiskjarj2012  = '' and l.ammopiskmaak2012 = ''   then l.yoopiskmaak2012
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2009   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012   <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskmaak2012  = ''  then l.amkopiskmaak2012 
	

	-- lukioopiskelun maakunta 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013   <> '' and l.ammopiskmaak2013  = '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.luopiskmaak2013
	-- ammatillisen koulutksen maakunta 2013    
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013  = '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  ='' and l.yoopiskmaak2013  = ''  then l.ammopiskmaak2013
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.luopiskmaak2013 
	-- ammattikorkekoulutuksen maakunta 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013   <> '' and l.yoopiskmaak2013   = '' and
	l.luopiskjarj2013 = '' and l.ammopiskmaak2013 = '' then l.amkopiskmaak2013
	-- yliopistokoulutuksen maakunta 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  <> '' and 
	l.luopiskjarj2013  = '' and l.ammopiskmaak2013 = ''   then l.yoopiskmaak2013
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2009   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013  <> '' and l.yoopiskmaak2013   <> '' and
	l.luopiskjarj2013  = '' and l.ammopiskmaak2013  = ''  then l.amkopiskmaak2013 


	 	-- lukioopiskelun maakunta 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014   <> '' and l.ammopiskmaak2014  = '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = '' then l.luopiskmaak2014
	-- ammatillisen koulutksen maakunta 2014    
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014  = '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  ='' and l.yoopiskmaak2014  = ''  then l.ammopiskmaak2014
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014  <> '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = '' then l.luopiskmaak2014 
	-- ammattikorkekoulutuksen maakunta 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014   <> '' and l.yoopiskmaak2014   = '' and
	l.luopiskjarj2014 = '' and l.ammopiskmaak2014 = '' then l.amkopiskmaak2014
	-- yliopistokoulutuksen maakunta 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  <> '' and 
	l.luopiskjarj2014  = '' and l.ammopiskmaak2014 = ''   then l.yoopiskmaak2014
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2009   
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014  <> '' and l.yoopiskmaak2014   <> '' and
	l.luopiskjarj2014  = '' and l.ammopiskmaak2014  = ''  then l.amkopiskmaak2014 
	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi 2008 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus 2008 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.ammopiskkoulk2008 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.yoopiskkoulk2008
	
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2009 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.ammopiskkoulk2009
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.yoopiskkoulk2009   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.ammopiskkoulk2010
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.yoopiskkoulk2010   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.ammopiskkoulk2011
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.yoopiskkoulk2011   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2013
	when l.suorv =  @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 ='' and l.yoopiskkoulk2013 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.ammopiskkoulk2013
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2013
	when l.suorv =  @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013  <> '' and l.yoopiskkoulk2013  = '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 <> '' and 
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv =  @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013  <> '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''  then l.yoopiskkoulk2013   
	  -- jos ammatillisessa koulutuksessa ja ammattikorkeakoulutuksessa merkitään ammattillinen
	when l.suorv =  @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013  = '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 <> ''  then l.ammopiskkoulk2013   
	

	 -- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2014
	when l.suorv =  @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 ='' and l.yoopiskkoulk2014 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then l.ammopiskkoulk2014
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2014
	when l.suorv =  @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014  <> '' and l.yoopiskkoulk2014  = '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 <> '' and 
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv =  @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014  <> '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''  then l.yoopiskkoulk2014   
	  -- jos ammatillisessa koulutuksessa ja ammattikorkeakoulutuksessa merkitään ammattillinen
	when l.suorv =  @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014  = '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 <> ''  then l.ammopiskkoulk2014   
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then ''
	-- ammatillisen koulutuksen oppilaitos 2008 merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and l.yoopisktunn2008 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.ammopisktunn2008 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.yoopisktunn2008 
	
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and yoopisktunn2009 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.ammopisktunn2009 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.yoopisktunn2009 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and yoopisktunn2010 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.ammopisktunn2010 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2010 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.yoopisktunn2010 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and yoopisktunn2011 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.ammopisktunn2011 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2011 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.yoopisktunn2011 


	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and yoopisktunn2012 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.ammopisktunn2012 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2012 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.yoopisktunn2012 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 = '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 = '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 ='' and yoopisktunn2013 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.ammopisktunn2013 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013  <> '' and l.yoopisktunn2013  = '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013 = '' and l.yoopisktunn2013 <> '' and 
	l.luopisktunn2013 = '' and l.ammopisktunn2013  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2013 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013 <> '' and l.yoopisktunn2013  <> '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''  then l.yoopisktunn2013 
	
	 -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 = '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 = '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 ='' and yoopisktunn2014 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then l.ammopisktunn2014 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014  <> '' and l.yoopisktunn2014  = '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014 = '' and l.yoopisktunn2014 <> '' and 
	l.luopisktunn2014 = '' and l.ammopisktunn2014  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2014 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014 <> '' and l.yoopisktunn2014  <> '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = ''  then l.yoopisktunn2014 

	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain 2008, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008 = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain 2008, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and l.yoopiskjarj2008 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.ammopiskjarj2008 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.yoopiskjarj2008 
	
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and l.yoopiskjarj2009 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.ammopiskjarj2009 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.yoopiskjarj2009 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and l.yoopiskjarj2010 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.ammopiskjarj2010 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.yoopiskjarj2010 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and l.yoopiskjarj2011 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.ammopiskjarj2011 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011  = ''  then l.yoopiskjarj2011 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012 = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and l.yoopiskjarj2012 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.ammopiskjarj2012 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012  = ''  then l.yoopiskjarj2012 


	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013  <> '' and l.ammopiskjarj2013 = '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013 = '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 ='' and l.yoopiskjarj2013 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013 <> '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.ammopiskjarj2013 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   = '' and
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  = '' and l.yoopiskjarj2013  <> '' and 
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   <> '' and
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013  = ''  then l.yoopiskjarj2013 

	
	 -- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014  <> '' and l.ammopiskjarj2014 = '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014 = '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 ='' and l.yoopiskjarj2014 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014 <> '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then l.ammopiskjarj2014 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   = '' and
	l.luopiskjarj2014 = '' and l.ammopiskjarj2014 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  = '' and l.yoopiskjarj2014  <> '' and 
	l.luopiskjarj2014 = '' and l.ammopiskjarj2014 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   <> '' and
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014  = ''  then l.yoopiskjarj2014
	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta 2008, jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2008, jätetään tyhjäksi   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  ='' and l.yoopiskmaak2008  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.ammopiskmaak2008 
	-- vain ammattikorkeakoulutuksen maakunta 2008, jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2008 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2008, merkitään yliopistokoulutuksen maakunta 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskmaak2008  = ''  then l.yoopiskmaak2008
	
	
	-- vain lukiokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and yoopiskmaak2009  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2009, merkitään tyhjäksi   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2009, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.ammopiskmaak2009 
	-- vain ammattikorkeakoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2009, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.yoopiskmaak2009  
	
	
	-- vain lukiokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and yoopiskmaak2010  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2010, merkitään tyhjäksi   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2010, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.ammopiskmaak2010 
	-- vain ammattikorkeakoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2010, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.yoopiskmaak2010  
	
	-- vain lukiokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011   <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and yoopiskmaak2011  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2011, merkitään tyhjäksi   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2011, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.ammopiskmaak2011 
	-- vain ammattikorkeakoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2011, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.yoopiskmaak2011  
	
	-- vain lukiokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012   <> '' and l.ammopiskmaak2012  = '' and
	l.amkopiskmaak2012  = '' and yoopiskmaak2012  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2012, merkitään tyhjäksi   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  = '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2012, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.ammopiskmaak2012 
	-- vain ammattikorkeakoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012   <> '' and l.yoopiskmaak2012   = '' and
	l.luopiskmaak2012 = '' and l.ammopiskmaak2012 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  <> '' and 
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2012, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012   <> '' and
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012  = ''  then l.yoopiskmaak2012  


	-- vain lukiokoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013   <> '' and l.ammopiskmaak2013  = '' and
	l.amkopiskmaak2013  = '' and yoopiskmaak2013  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2013, merkitään tyhjäksi   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013  = '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2013, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.ammopiskmaak2013 
	-- vain ammattikorkeakoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013   <> '' and l.yoopiskmaak2013   = '' and
	l.luopiskmaak2013 = '' and l.ammopiskmaak2013 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  <> '' and 
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2013, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013  <> '' and l.yoopiskmaak2013   <> '' and
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013  = ''  then l.yoopiskmaak2013  
	
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014   <> '' and l.ammopiskmaak2014  = '' and
	l.amkopiskmaak2014  = '' and yoopiskmaak2014  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2014, merkitään tyhjäksi   
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014  = '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2014, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014  <> '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = '' then l.ammopiskmaak2014 
	-- vain ammattikorkeakoulutuksen maakunta 2014, merkitään tyhjäksi
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014   <> '' and l.yoopiskmaak2014   = '' and
	l.luopiskmaak2014 = '' and l.ammopiskmaak2014 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2014, merkitään tyhjäksi
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  <> '' and 
	l.luopiskmaak2014  = '' and l.ammopiskmaak2014 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2014, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014  <> '' and l.yoopiskmaak2014   <> '' and
	l.luopiskmaak2014  = '' and l.ammopiskmaak2014  = ''  then l.yoopiskmaak2014  

	else ''
	
	    end),
	-- Monihaku
	(case
	 when l.monihaku2008 is NULL then ''
	 when l.monihaku2009 is NULL then ''
	 when l.monihaku2010 is NULL then ''
	 when l.monihaku2011 is NULL then ''
	 when l.monihaku2012 is NULL then ''
	 when l.monihaku2013 is NULL then ''
	  when l.monihaku2014 is NULL then ''
	-- 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.monihaku2008
	--2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1'  then l.monihaku2009
	-- 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.monihaku2010
	
		-- 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.monihaku2011
	
	-- 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.monihaku2012

	-- 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.monihaku2013

	-- 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' then l.monihaku2014
	
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2008
	-- 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2009 
	-- 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2010
	
	-- 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2011
	
    -- 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2012

	 -- 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2013

	-- 2014
	when l.suorv= @seitsemas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2014
   
	else ''
	end),
	-- Ammattiasema
	(case 
	-- 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.amas_2008
	-- 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' then l.amas_2009
	-- 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.amas_2010
	-- 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.amas_2011
	-- 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.amas_2012
	-- 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.amas_2013

	-- 2014
	when l.suorv = @seitsemas_suoritusvuosi and l.suorlk = '1' then l.amas_2014
	else ''
	end),
    l.lkm,
     (case when l.pohjkoul= '' then '' 
       when l.pohjkoul is NULL then '' else l.pohjkoul end ),
 l.tietolahde,
 'K3.12',
 -- Lukiokoulutuksessa
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'  
       when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1' 
       when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then '1' 
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then '1' 
	    when l.suorv = @seitsemas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then '1' 
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2008  <> '' and l.luopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2009 <> '' and l.luopiskkoulk2009  = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1'   
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2010 <> '' and l.luopiskkoulk2010  = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'    
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2011 <> '' and l.luopiskkoulk2011  = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1'
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2012 <> '' and l.luopiskkoulk2012  = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then '1'
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2013 <> '' and l.luopiskkoulk2013  = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then '1'
		when l.suorv = @seitsemas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2014 <> '' and l.luopiskkoulk2014  = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then '1'
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' then  '1'
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' then  '1'
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' then  '1'
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' then  '1'
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' then  '1'
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2013 = '' then  '1'
	   when l.suorv = @seitsemas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.luopiskkoulk2014 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2008  <> '' and l.amkopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then '1'  	   
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then '1'  
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' then '1'  
		 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2013 <> '' and l.amkopiskkoulk2013 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' then '1'  
		  when l.suorv = @seitsemas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2014 <> '' and l.amkopiskkoulk2014 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' then '1'  
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2008  <> '' and l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008  = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'  
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1'  
	   	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then '1'  
	   	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then '1'
		   	   	   when l.suorv = @seitsemas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 <> '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2008  <> '' and l.amkopiskkoulk2008 <> '' and l.luopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2009  <> '' and l.amkopiskkoulk2009 <> ''  and l.luopiskkoulk2009 = '' and l.yoopiskkoulk2009  = '' then '1' 
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 <> ''  and l.luopiskkoulk2010 = '' and l.yoopiskkoulk2010  = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 <> ''  and l.luopiskkoulk2011 = '' and l.yoopiskkoulk2011  = '' then '1'  
	   	when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 <> ''  and l.luopiskkoulk2012 = '' and l.yoopiskkoulk2012  = '' then '1'  
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2013 <> '' and l.amkopiskkoulk2013 <> ''  and l.luopiskkoulk2013 = '' and l.yoopiskkoulk2013  = '' then '1'  
		when l.suorv = @seitsemas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2014 <> '' and l.amkopiskkoulk2014 <> ''  and l.luopiskkoulk2014 = '' and l.yoopiskkoulk2014  = '' then '1' 
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008 <> '' and l.ammopiskkoulk2008  = '' and l.luopiskkoulk2008 = ''  then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009 <> ''  and l.ammopiskkoulk2009  = '' and l.luopiskkoulk2009 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010 <> ''  and l.ammopiskkoulk2010  = '' and l.luopiskkoulk2010 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011 <> ''  and l.ammopiskkoulk2011  = '' and l.luopiskkoulk2011 = '' then '1' 
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012 <> ''  and l.ammopiskkoulk2012  = '' and l.luopiskkoulk2012 = '' then '1' 
		  when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013 <> ''  and l.ammopiskkoulk2013  = '' and l.luopiskkoulk2013 = '' then '1' 
		    when l.suorv = @seitsemas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014 <> ''  and l.ammopiskkoulk2014  = '' and l.luopiskkoulk2014 = '' then '1' 
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   --2008
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') 
	   and (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 = '13')
	   and (l.luopiskkoulk2008 <>'' or l.ammopiskkoulk2008 <>'' or l.amkopiskkoulk2008 <>'' or l.yoopiskkoulk2008 <>'') then '1' 
	   --2009
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') 
	   and  (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009  = '13')
	   and (l.luopiskkoulk2009 <>'' or l.ammopiskkoulk2009 <>'' or l.amkopiskkoulk2009 <>'' or l.yoopiskkoulk2009 <>'')then '1'
	   --2010
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1')
	   and  (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13')
	   and (l.luopiskkoulk2010 <>'' or l.ammopiskkoulk2010 <>'' or l.amkopiskkoulk2010 <>'' or l.yoopiskkoulk2010 <>'')then '1'
	   --2011
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') 
	   and  (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
	   and (l.luopiskkoulk2011 <>'' or l.ammopiskkoulk2011 <>'' or l.amkopiskkoulk2011 <>'' or l.yoopiskkoulk2011 <>'')then '1'
	    --2012
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') 
	   and  (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13')
	   and (l.luopiskkoulk2012 <>'' or l.ammopiskkoulk2012 <>'' or l.amkopiskkoulk2012 <>'' or l.yoopiskkoulk2012 <>'')then '1'
	    --2013
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') 
	   and  (l.ptoim1r4_2013 = '22' or l.ptoim1r4_2013 = '13')
	   and (l.luopiskkoulk2013 <>'' or l.ammopiskkoulk2013 <>'' or l.amkopiskkoulk2013 <>'' or l.yoopiskkoulk2013 <>'')then '1'
	    --2014
	   when l.suorv = @seitsemas_suoritusvuosi and (l.suorlk = '1') 
	   and  (l.ptoim1r4_2014 = '22' or l.ptoim1r4_2014 = '13')
	   and (l.luopiskkoulk2014 <>'' or l.ammopiskkoulk2014 <>'' or l.amkopiskkoulk2014 <>'' or l.yoopiskkoulk2014 <>'')then '1'

	  -- Ei tutkintoon johtavassa koulutuksessa olevat
	   --2008
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') 
	   and (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 = '13')
	   and (l.luopiskkoulk2008 ='' and l.ammopiskkoulk2008 ='' and l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 ='') then '2' 
	   --2009
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') 
	   and  (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009  = '13')
	   and (l.luopiskkoulk2009 ='' and l.ammopiskkoulk2009 ='' and l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 ='')then '2'
	   --2010
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1')
	   and  (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13')
	   and (l.luopiskkoulk2010 ='' and l.ammopiskkoulk2010 ='' and l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 ='')then '2'
	   --2011
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') 
	   and  (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
	   and (l.luopiskkoulk2011 ='' and  l.ammopiskkoulk2011 ='' and l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 ='')then '2'
	   --2012
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') 
	   and  (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13')
	   and (l.luopiskkoulk2012 ='' and  l.ammopiskkoulk2012 ='' and l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 ='')then '2'
	 --2013
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') 
	   and  (l.ptoim1r4_2013 = '22' or l.ptoim1r4_2013 = '13')
	   and (l.luopiskkoulk2013 ='' and  l.ammopiskkoulk2013 ='' and l.amkopiskkoulk2013 ='' and l.yoopiskkoulk2013 ='')then '2'
	   --2014
	   when l.suorv = @seitsemas_suoritusvuosi and (l.suorlk = '1') 
	   and  (l.ptoim1r4_2014 = '22' or l.ptoim1r4_2014 = '13')
	   and (l.luopiskkoulk2014 ='' and  l.ammopiskkoulk2014 ='' and l.amkopiskkoulk2014 ='' and l.yoopiskkoulk2014 ='')then '2'
	   -- Ei opiskelevat työlliset
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')and  l.ptoim1r4_2008  = '10'  then '3' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2009 = '10'  then '3'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2010 = '10'  then '3' 
       when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2011 = '10'  then '3' 
       when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2012 = '10'  then '3' 
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2013 = '10'  then '3' 
	   when l.suorv = @seitsemas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2014 = '10'  then '3' 
	   -- Ei opiskelevat työttömät
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2008  = '12'  then '4' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2009 = '12'  then '4' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2010 = '12'  then '4' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2011 = '12'  then '4' 
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2012 = '12'  then '4' 
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2013 = '12'  then '4' 
	   when l.suorv = @seitsemas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2014 = '12'  then '4' 
	   --  
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1' else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_12_Perusk_paattaneet_amm_tutk_suorittaneet]
	where (suorv = '2008' or suorv = '2009' or suorv = '2010' or suorv = '2011' or suorv = '2012' or suorv= '2013' or suorv= '2014' ) and suorlk = '1'
	) as l
	
	
	WHERE 1=1
end;

--
-- TULOS
-- 
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_2v]
	
end;

if @debug_what_to_run>0 PRINT 'all done.';

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_0_5_tarkastelujakso]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_0_5_tarkastelujakso]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_0_5_tarkastelujakso] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_0_5_tarkastelujakso] AS
declare @debug_what_to_run tinyint; set @debug_what_to_run=1; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';



-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;


set @ensimmainen_suoritusvuosi = 2008;
set @toinen_suoritusvuosi = 2009
set @kolmas_suoritusvuosi = 2010
set @neljas_suoritusvuosi = 2011
set @viides_suoritusvuosi = 2012
set @kuudes_suoritusvuosi = 2013



INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_2v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn 
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
,lkm
,pohjkoulk
,tietolahde
, aineisto
 ,lukiokoulutuksessa
 ,ammatillisessa_koulutuksessa
 ,ammattikorkeakoulutuksessa
 ,yliopistokoulutuksessa
 ,lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
 ,toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
 ,ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
 ,koulutuksen_paattaneiden_toiminta
 ,ika_1v
 ,ika_5v
)
SELECT
 l.rivinumero,
 '0,5',
 l.tilv,
 l.tilv_date,
 l.tutkryh,
 l.suorv,
  (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
l.tutklaja,
l.tutktav,
 l.aikoul,
 l.tutkmaak,
(case
    -- Koulutus 1
	-- lukiokoulutuksessa 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammatillisessa koulutuksessa 2009 
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then l.ammopiskkoulk2009 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2009 ensimäisiin koulutustietoihin
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammattikorkeakoulutuksessa
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009  = '' and l.ammopiskkoulk2009 = '' then l.amkopiskkoulk2009
	-- yliopistokoulutuksessa
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then l.yoopiskkoulk2009 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.amkopiskkoulk2009 
	
	
	-- lukiokoulutuksessa 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammatillisessa koulutuksessa 2010
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then l.ammopiskkoulk2010 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammattikorkeakoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010  = '' and l.ammopiskkoulk2010 = '' then l.amkopiskkoulk2010
	-- yliopistokoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then l.yoopiskkoulk2010 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.amkopiskkoulk2010
	
		-- lukiokoulutuksessa 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammatillisessa koulutuksessa 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then l.ammopiskkoulk2011 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011  = '' and l.ammopiskkoulk2011 = '' then l.amkopiskkoulk2011
	-- yliopistokoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then l.yoopiskkoulk2011 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.amkopiskkoulk2011
	
	-- lukiokoulutuksessa 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammatillisessa koulutuksessa 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then l.ammopiskkoulk2012 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammattikorkeakoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012  = '' and l.ammopiskkoulk2012 = '' then l.amkopiskkoulk2012
	-- yliopistokoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then l.yoopiskkoulk2012 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.amkopiskkoulk2012


	--- lukiokoulutuksessa 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.luopiskkoulk2013
	-- ammatillisessa koulutuksessa 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 ='' and l.yoopiskkoulk2013 = ''  then l.ammopiskkoulk2013 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.luopiskkoulk2013
	-- ammattikorkeakoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2013  <> '' and l.yoopiskkoulk2013  = '' and
	l.luopiskkoulk2013  = '' and l.ammopiskkoulk2013 = '' then l.amkopiskkoulk2013
	-- yliopistokoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 <> '' and 
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''   then l.yoopiskkoulk2013 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013  <> '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''  then l.amkopiskkoulk2013

    --- lukiokoulutuksessa 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then l.luopiskkoulk2014
	-- ammatillisessa koulutuksessa 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 ='' and l.yoopiskkoulk2014 = ''  then l.ammopiskkoulk2014 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then l.luopiskkoulk2014
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2014  <> '' and l.yoopiskkoulk2014  = '' and
	l.luopiskkoulk2014  = '' and l.ammopiskkoulk2014 = '' then l.amkopiskkoulk2014
	-- yliopistokoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 <> '' and 
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''   then l.yoopiskkoulk2014 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014  <> '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''  then l.amkopiskkoulk2014
	else ''
	    end),
	 -- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammatillisen koulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and l.yoopisktunn2009 = ''  then l.ammopisktunn2009
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammattikorkeakoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then l.amkopisktunn2009
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''   then l.yoopisktunn2009  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.amkopisktunn2009 
	
	
	-- lukiokoulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and l.yoopisktunn2010 = ''  then l.ammopisktunn2010
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then l.amkopisktunn2010
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''   then l.yoopisktunn2010  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010 
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.amkopisktunn2010 
	
	-- lukiokoulutuksen oppilaitos 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and l.yoopisktunn2011 = ''  then l.ammopisktunn2011
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then l.amkopisktunn2011
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''   then l.yoopisktunn2011  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010 
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.amkopisktunn2011 
	
	-- lukiokoulutuksen oppilaitos 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and l.yoopisktunn2012 = ''  then l.ammopisktunn2012
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then l.amkopisktunn2012
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''   then l.yoopisktunn2012  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010 
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.amkopisktunn2012 


	-- lukiokoulutuksen oppilaitos 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 = '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.luopisktunn2013
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2013 = '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 ='' and l.yoopisktunn2013 = ''  then l.ammopisktunn2013
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.luopisktunn2013
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2013  <> '' and l.yoopisktunn2013  = '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = '' then l.amkopisktunn2013
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2013 = '' and l.yoopisktunn2013 <> '' and 
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''   then l.yoopisktunn2013  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010 
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2013 <> '' and l.yoopisktunn2013  <> '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''  then l.amkopisktunn2013 

	-- lukiokoulutuksen oppilaitos 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 = '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then l.luopisktunn2014
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2014 = '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 ='' and l.yoopisktunn2014 = ''  then l.ammopisktunn2014
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then l.luopisktunn2014
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2014  <> '' and l.yoopisktunn2014  = '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = '' then l.amkopisktunn2014
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2014 = '' and l.yoopisktunn2014 <> '' and 
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = ''   then l.yoopisktunn2014  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010 
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2014 <> '' and l.yoopisktunn2014  <> '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = ''  then l.amkopisktunn2014 
	
	else ''
	
	    end),
	-- Koulutuksen järjestäjä 1 
	(case
	-- lukiokoulutuksen järjestäjä 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009  = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009  
	-- ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @ensimmainen_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and yoopiskjarj2009 = ''  then l.ammopiskjarj2009 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009
	-- ammattikorkeakoulutuksen 2009 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then l.amkopiskjarj2009 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then l.yoopiskjarj2009
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.amkopiskjarj2009 
	
	
	-- lukiokoulutuksen järjestäjä 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010  = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010  
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @toinen_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and yoopiskjarj2010 = ''  then l.ammopiskjarj2010 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then l.amkopiskjarj2010 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then l.yoopiskjarj2010
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.amkopiskjarj2010 
	
	
	-- lukiokoulutuksen järjestäjä 2011
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011  = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011  
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and yoopiskjarj2011 = ''  then l.ammopiskjarj2011 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then l.amkopiskjarj2011 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''   then l.yoopiskjarj2011
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011  = ''  then l.amkopiskjarj2011 
	
	
	-- lukiokoulutuksen järjestäjä 2012
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012  = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.luopiskjarj2012  
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and yoopiskjarj2012 = ''  then l.ammopiskjarj2012 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.luopiskjarj2012
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then l.amkopiskjarj2012 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012 = ''   then l.yoopiskjarj2012
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012  = ''  then l.amkopiskjarj2012 


    -- lukiokoulutuksen järjestäjä 2013
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2013  <> '' and l.ammopiskjarj2013  = '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.luopiskjarj2013  
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2013 = '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 ='' and yoopiskjarj2013 = ''  then l.ammopiskjarj2013 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2013 <> '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.luopiskjarj2013
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   = '' and
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = '' then l.amkopiskjarj2013 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2013  = '' and l.yoopiskjarj2013  <> '' and 
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013 = ''   then l.yoopiskjarj2013
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   <> '' and
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013  = ''  then l.amkopiskjarj2013 

	 -- lukiokoulutuksen järjestäjä 2014
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2014  <> '' and l.ammopiskjarj2014  = '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then l.luopiskjarj2014  
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2014 = '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 ='' and yoopiskjarj2014 = ''  then l.ammopiskjarj2014 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2014 <> '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then l.luopiskjarj2014
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   = '' and
	l.luopiskjarj2014 = '' and l.ammopiskjarj2014 = '' then l.amkopiskjarj2014 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2014  = '' and l.yoopiskjarj2014  <> '' and 
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014 = ''   then l.yoopiskjarj2014
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   <> '' and
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014  = ''  then l.amkopiskjarj2014 
	else ''
	    end),
	    
	 -- Maakunta 1
	(case
	-- lukioopiskelun maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009
	-- ammatillisen koulutksen maakunta 2009    
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then l.ammopiskmaak2009
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009 
	-- ammattikorkekoulutuksen maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then l.amkopiskmaak2009
	-- yliopistokoulutuksen maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then l.yoopiskmaak2009
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2009   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.amkopiskmaak2009 
	
	
	-- lukioopiskelun maakunta 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010
	-- ammatillisen koulutksen maakunta 2010    
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010  = ''  then l.ammopiskmaak2010
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010 
	-- ammattikorkekoulutuksen maakunta 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then l.amkopiskmaak2010
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then l.yoopiskmaak2010
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.amkopiskmaak2010 
	
	-- lukioopiskelun maakunta 2011
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2011   <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011
	-- ammatillisen koulutksen maakunta 2010    
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011 ='' and l.yoopiskmaak2011  = ''  then l.ammopiskmaak2011
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011 
	-- ammattikorkekoulutuksen maakunta 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then l.amkopiskmaak2011
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then l.yoopiskmaak2011
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.amkopiskmaak2011 
	
		-- lukioopiskelun maakunta 2012
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2013   <> '' and l.ammopiskmaak2013  = '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.luopiskmaak2013
	-- ammatillisen koulutksen maakunta 2010    
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2013  = '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013 ='' and l.yoopiskmaak2013  = ''  then l.ammopiskmaak2013
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.luopiskmaak2013
	-- ammattikorkekoulutuksen maakunta 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2013   <> '' and l.yoopiskmaak2013   = '' and
	l.luopiskmaak2013 = '' and l.ammopiskmaak2013 = '' then l.amkopiskmaak2013
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  <> '' and 
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013 = ''   then l.yoopiskmaak2013
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2013  <> '' and l.yoopiskmaak2013   <> '' and
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013  = ''  then l.amkopiskmaak2013 
	

	-- lukioopiskelun maakunta 2012
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2014   <> '' and l.ammopiskmaak2014  = '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = '' then l.luopiskmaak2014
	-- ammatillisen koulutksen maakunta 2010    
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2014  = '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014 ='' and l.yoopiskmaak2014  = ''  then l.ammopiskmaak2014
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2014  <> '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = '' then l.luopiskmaak2014
	-- ammattikorkekoulutuksen maakunta 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2014   <> '' and l.yoopiskmaak2014   = '' and
	l.luopiskmaak2014 = '' and l.ammopiskmaak2014 = '' then l.amkopiskmaak2014
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  <> '' and 
	l.luopiskmaak2014  = '' and l.ammopiskmaak2014 = ''   then l.yoopiskmaak2014
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2014  <> '' and l.yoopiskmaak2014   <> '' and
	l.luopiskmaak2014  = '' and l.ammopiskmaak2014  = ''  then l.amkopiskmaak2014 
	
	else ''
	
	
	    end),
-- Koulutus 2
(case
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2009 
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.ammopiskkoulk2009
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.yoopiskkoulk2009   
	
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2009 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.ammopiskkoulk2010
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.yoopiskkoulk2010   
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2011 
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.ammopiskkoulk2011
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.yoopiskkoulk2011   
	

    	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2012 
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.ammopiskkoulk2012
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.yoopiskkoulk2012   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2012 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 ='' and l.yoopiskkoulk2013 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.ammopiskkoulk2013
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2013  <> '' and l.yoopiskkoulk2013  = '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 <> '' and 
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013  <> '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''  then l.yoopiskkoulk2013   
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2012
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2012 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 ='' and l.yoopiskkoulk2014 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then l.ammopiskkoulk2014
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2014  <> '' and l.yoopiskkoulk2014  = '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 <> '' and 
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014  <> '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''  then l.yoopiskkoulk2014   

	else ''
	    end),
	    
-- Oppilaitos 2
(case
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and yoopisktunn2009 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.ammopisktunn2009 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.yoopisktunn2009 
	
		-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and yoopisktunn2010 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.ammopisktunn2010 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.yoopisktunn2010 
	
	
    -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and yoopisktunn2011 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.ammopisktunn2011 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.yoopisktunn2011 
	
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and yoopisktunn2012 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.ammopisktunn2012 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.yoopisktunn2012 

	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 = '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2013 = '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 ='' and yoopisktunn2013 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.ammopisktunn2013 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2013  <> '' and l.yoopisktunn2013  = '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2013 = '' and l.yoopisktunn2013 <> '' and 
	l.luopisktunn2013 = '' and l.ammopisktunn2013  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2013 <> '' and l.yoopisktunn2013  <> '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''  then l.yoopisktunn2013 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 = '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2014 = '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 ='' and yoopisktunn2014 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then l.ammopisktunn2014 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2014  <> '' and l.yoopisktunn2014  = '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2014 = '' and l.yoopisktunn2014 <> '' and 
	l.luopisktunn2014 = '' and l.ammopisktunn2014  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2014 <> '' and l.yoopisktunn2014  <> '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = ''  then l.yoopisktunn2014  
	else ''
	    end),
	    
	-- Koulutuksen järjestäjä 2
	(case
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and l.yoopiskjarj2009 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.ammopiskjarj2009 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.yoopiskjarj2009 
	
	
		-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and l.yoopiskjarj2010 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.ammopiskjarj2010 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010  <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.yoopiskjarj2010 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and l.yoopiskjarj2011 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.ammopiskjarj2011 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011  <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''  then l.yoopiskjarj2011 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012 = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and l.yoopiskjarj2012 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.ammopiskjarj2012 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012  <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012 = ''  then l.yoopiskjarj2012 
	

	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2013  <> '' and l.ammopiskjarj2013 = '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2013 = '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 ='' and l.yoopiskjarj2013 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2013 <> '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.ammopiskjarj2013 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   = '' and
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2013  = '' and l.yoopiskjarj2013  <> '' and 
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013  <> '' and
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013 = ''  then l.yoopiskjarj2013 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2014  <> '' and l.ammopiskjarj2014 = '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2014 = '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 ='' and l.yoopiskjarj2014 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2014 <> '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then l.ammopiskjarj2014 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   = '' and
	l.luopiskjarj2014 = '' and l.ammopiskjarj2014 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2014  = '' and l.yoopiskjarj2014  <> '' and 
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014  <> '' and
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014 = ''  then l.yoopiskjarj2014 


	else ''
	    end),
	    
	-- Maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and yoopiskmaak2009  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2009, merkitään tyhjäksi   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2009, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.ammopiskmaak2009 
	-- vain ammattikorkeakoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2009, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.yoopiskmaak2009  
	
	
		-- vain lukiokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and yoopiskmaak2010  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2009, merkitään tyhjäksi   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2010, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.ammopiskmaak2010 
	-- vain ammattikorkeakoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2010, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.yoopiskmaak2010  
	
	
	-- vain lukiokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and yoopiskmaak2011  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2011, merkitään tyhjäksi   
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  ='' and l.yoopiskmaak2011 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2011, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.ammopiskmaak2011 
	-- vain ammattikorkeakoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2011, merkitään yliopistokoulutuksen 2011 maakunta 
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.yoopiskmaak2011  

	
	-- vain lukiokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  = '' and
	l.amkopiskmaak2012  = '' and yoopiskmaak2012  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2012, merkitään tyhjäksi   
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2012  = '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  ='' and l.yoopiskmaak2012 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2012, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.ammopiskmaak2012 
	-- vain ammattikorkeakoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2012   <> '' and l.yoopiskmaak2012   = '' and
	l.luopiskmaak2012 = '' and l.ammopiskmaak2012 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  <> '' and 
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2012, merkitään yliopistokoulutuksen 2012 maakunta 
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012   <> '' and
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012  = ''  then l.yoopiskmaak2012  


	-- vain lukiokoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013  = '' and
	l.amkopiskmaak2013  = '' and yoopiskmaak2013  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2013, merkitään tyhjäksi   
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2013  = '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  ='' and l.yoopiskmaak2013 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2013, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.ammopiskmaak2013 
	-- vain ammattikorkeakoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2013   <> '' and l.yoopiskmaak2013   = '' and
	l.luopiskmaak2013 = '' and l.ammopiskmaak2013 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  <> '' and 
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2013, merkitään yliopistokoulutuksen 2013 maakunta 
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2013  <> '' and l.yoopiskmaak2013   <> '' and
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013  = ''  then l.yoopiskmaak2013  

	-- vain lukiokoulutuksen maakunta 2014, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2014  <> '' and l.ammopiskmaak2014  = '' and
	l.amkopiskmaak2014  = '' and yoopiskmaak2014  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2014, merkitään tyhjäksi   
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2014  = '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  ='' and l.yoopiskmaak2014 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2014, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2014  <> '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = '' then l.ammopiskmaak2014 
	-- vain ammattikorkeakoulutuksen maakunta 2014, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2014   <> '' and l.yoopiskmaak2014   = '' and
	l.luopiskmaak2014 = '' and l.ammopiskmaak2014 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2014, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  <> '' and 
	l.luopiskmaak2014  = '' and l.ammopiskmaak2014 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2014, merkitään yliopistokoulutuksen 2014 maakunta 
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2014  <> '' and l.yoopiskmaak2014   <> '' and
	l.luopiskmaak2014  = '' and l.ammopiskmaak2014  = ''  then l.yoopiskmaak2014  

	else ''
	    end),
	-- Monihaku
	(case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.monihaku2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.monihaku2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.monihaku2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.monihaku2012
		when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.monihaku2013
		when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.monihaku2014
	else '8'
	end),
	-- Pääasiallinen toiminta
    (case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2009 
    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2010 
    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2011 
     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2012 
	      when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2013 
		    when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2014 
	else ''
	end),
	-- Ammattiasema
	(case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.amas_2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.amas_2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.amas_2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.amas_2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.amas_2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.amas_2014

	else ''
	end),
 l.lkm,
 l.pohjkoul,
 l.tietolahde,
 'K3.12',
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = ''  then  '1'  
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = ''   then '1'  
	     when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = ''   then '1'  
	      when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and
	    l.yoopiskkoulk2012 = ''   then '1'  
	 when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and
	    l.yoopiskkoulk2013 = ''   then '1'
		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and
	    l.yoopiskkoulk2014 = ''   then '1'
	    else '0'
	    end) as lukiokoulutuksessa,
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = ''  then '1'   
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2010 <> '' and l.luopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = ''  then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2011 <> '' and l.luopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = '' then '1'  
	     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2012 <> '' and l.luopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and
	    l.yoopiskkoulk2012 = '' then '1'  
		     when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2013 <> '' and l.luopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and
	    l.yoopiskkoulk2013 = '' then '1'  
		  when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2014 <> '' and l.luopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and
	    l.yoopiskkoulk2014 = '' then '1'  
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
 (case  
	   when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and
	   l.yoopiskkoulk2009 = ''  then  '1'
	   when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and
	   l.yoopiskkoulk2010 = ''  then  '1'
	   when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' and
	   l.yoopiskkoulk2011 = ''  then  '1'
	   when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' and
	   l.yoopiskkoulk2012 = ''  then  '1'
	     when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and l.luopiskkoulk2013 = '' and
	   l.yoopiskkoulk2013 = ''  then  '1'
	     when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and l.luopiskkoulk2014 = '' and
	   l.yoopiskkoulk2014 = ''  then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and  l.yoopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and 
	    l.ammopiskkoulk2009 = ''  then '1'  
	    when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and  l.yoopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and 
	    l.ammopiskkoulk2010 = ''  then '1' 
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' and 
	    l.ammopiskkoulk2011 = ''  then '1' 
	    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' and 
	    l.ammopiskkoulk2012 = ''  then '1' 
		  when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2013 <> '' and l.amkopiskkoulk2013 = '' and l.luopiskkoulk2013 = '' and 
	    l.ammopiskkoulk2013 = ''  then '1' 
		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2014 <> '' and l.amkopiskkoulk2014 = '' and l.luopiskkoulk2014 = '' and 
	    l.ammopiskkoulk2014 = ''  then '1'
	    else '0'
	    end) as yliopistokoulutuksessa,

(case

	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = '' then '1'  
	    
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = ''  then '1' 
	    
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = ''  then '1' 
	    
	    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and
	    l.yoopiskkoulk2012 = ''  then '1' 
	    
	    	    
	    when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and l.amkopiskkoulk2013 = '' and
	    l.yoopiskkoulk2013 = ''  then '1' 

		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 <> '' and l.amkopiskkoulk2014 = '' and
	    l.yoopiskkoulk2014 = ''  then '1' 

	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2'and  l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = ''  then '1' 
	     
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 <> '' and l.luopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = '' then '1' 
	    
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 <> '' and l.luopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = '' then '1' 
	    
	    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 <> '' and l.luopiskkoulk2012 = '' and
	    l.yoopiskkoulk2012 = '' then '1' 

		    when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2013 <> '' and l.amkopiskkoulk2013 <> '' and l.luopiskkoulk2013 = '' and
	    l.yoopiskkoulk2013 = '' then '1' 

		   when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2014 <> '' and l.amkopiskkoulk2014 <> '' and l.luopiskkoulk2014 = '' and
	    l.yoopiskkoulk2014 = '' then '1'

	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and
	    l.ammopiskkoulk2009 = ''  then '1'  
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010 <> '' and l.luopiskkoulk2010 = '' and
	    l.ammopiskkoulk2010 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011 <> '' and l.luopiskkoulk2011 = '' and
	    l.ammopiskkoulk2011 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012 <> '' and l.luopiskkoulk2012 = '' and
	    l.ammopiskkoulk2012 = '' then '1' 
		 when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013 <> '' and l.luopiskkoulk2013 = '' and
	    l.ammopiskkoulk2013 = '' then '1' 
		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014 <> '' and l.luopiskkoulk2014 = '' and
	    l.ammopiskkoulk2014 = '' then '1' 
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 ='13')
	   and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009<>'' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009<>'') then '1' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13')
	   and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010<>'' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010<>'') then '1'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
	   and (l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011<>'' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011<>'') then '1'
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13')
	   and (l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012<>'' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012<>'') then '1'  
	     when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2013 = '22' or l.ptoim1r4_2013 = '13')
	   and (l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013<>'' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013<>'') then '1'  
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2014 = '22' or l.ptoim1r4_2014 = '13')
	   and (l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014<>'' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014<>'') then '1'  
	   
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 ='13')
	   and (l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009='' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009='') then '2' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13')
	   and (l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010='' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010='') then '2'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
	   and (l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011='' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011= '') then '2' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13')
	   and (l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012='' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012= '') then '2'
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2013 = '22' or l.ptoim1r4_2013 = '13')
	   and (l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013='' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013= '') then '2' 
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2014 = '22' or l.ptoim1r4_2014 = '13')
	   and (l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014='' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014= '') then '2'   
  
  
	  -- Ei opiskelevat työlliset
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2')and l.ptoim1r4_2009 = '10'  then '3'
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and  l.ptoim1r4_2010 = '10'  then '3'     
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2011 = '10'  then '3' 
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2012 = '10'  then '3' 
		  when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2013 = '10'  then '3' 
		   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2014 = '10'  then '3' 
	  -- Ei opiskelevat työttömät 
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2009 = '12'  then '4' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and  l.ptoim1r4_2010 = '12'  then '4'
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2011 = '12'  then '4'  
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2012 = '12'  then '4' 
	      when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2013 = '12'  then '4'
		     when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2014 = '12'  then '4'
	   
	   -- Ei opiskelevat muut
      else '5'
	     
	     
	   end)as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1' else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_12_Perusk_paattaneet_amm_tutk_suorittaneet]
	where (suorv = '2008' or suorv = '2009' or suorv = '2010' or suorv = '2011' or suorv= '2012' or suorv= '2013') and suorlk = '2'
	
	) as l
	
	
	WHERE 1=1
end;

--
-- TULOS
-- 
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_2v]
	

end;

if @debug_what_to_run>0 PRINT 'all done.';

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_1_tarkastelujakso]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_1_tarkastelujakso]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_1_tarkastelujakso] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_1_tarkastelujakso] AS


declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;

set @ensimmainen_suoritusvuosi = 2008;
set @toinen_suoritusvuosi = 2009;
set @kolmas_suoritusvuosi = 2010;
set @neljas_suoritusvuosi = 2011;
set @viides_suoritusvuosi = 2012;
set @kuudes_suoritusvuosi = 2013;



INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_2v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
,lkm
,pohjkoulk
,tietolahde
, aineisto
 ,lukiokoulutuksessa
 ,ammatillisessa_koulutuksessa
 ,ammattikorkeakoulutuksessa
 ,yliopistokoulutuksessa
 ,lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
 ,toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
 ,ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
 ,koulutuksen_paattaneiden_toiminta
 ,ika_1v
 ,ika_5v
)
SELECT
 l.rivinumero,
 '1',
 l.tilv,
 l.tilv_date,
 l.tutkryh,
 l.suorv,
  (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 (case when l.tutklaja= '' then '' 
       when l.tutklaja is NULL then '' else l.tutklaja end ),
  (case when l.tutktav= '' then '' 
       when l.tutktav is NULL then '' else l.tutktav end ),
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009 
	-- ammattikoulutuksessa 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then l.ammopiskkoulk2009 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2009 ensim. koulutustietoihin
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammattikorkeakoulutuksessa 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then l.amkopiskkoulk2009
	-- yliopistokoulutuksessa 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then l.yoopiskkoulk2009
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and ammopiskkoulk2009 = ''  then l.amkopiskkoulk2009 
	
	
	-- lukiokoulutuksessa 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammatillisessa koulutuksessa 2010 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then l.ammopiskkoulk2010 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammattikorkeakoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010  = '' and l.ammopiskkoulk2010 = '' then l.amkopiskkoulk2010
	-- yliopistokoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then l.yoopiskkoulk2010 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.amkopiskkoulk2010 
	
	
	-- lukiokoulutuksessa 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammatillisessa koulutuksessa 2011 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then l.ammopiskkoulk2011 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2011 ensimäisiin koulutustietoihin
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011  = '' and l.ammopiskkoulk2011 = '' then l.amkopiskkoulk2011
	-- yliopistokoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then l.yoopiskkoulk2011 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.amkopiskkoulk2011 
	
	-- lukiokoulutuksessa 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammatillisessa koulutuksessa 2012 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then l.ammopiskkoulk2012 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2012 ensimäisiin koulutustietoihin
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammattikorkeakoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012  = '' and l.ammopiskkoulk2012 = '' then l.amkopiskkoulk2012
	-- yliopistokoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then l.yoopiskkoulk2012 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.amkopiskkoulk2012 

	-- lukiokoulutuksessa 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.luopiskkoulk2013
	-- ammatillisessa koulutuksessa 2013 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 ='' and l.yoopiskkoulk2013 = ''  then l.ammopiskkoulk2013 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2013 ensimäisiin koulutustietoihin
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.luopiskkoulk2013
	-- ammattikorkeakoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013  <> '' and l.yoopiskkoulk2013  = '' and
	l.luopiskkoulk2013  = '' and l.ammopiskkoulk2013 = '' then l.amkopiskkoulk2013
	-- yliopistokoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 <> '' and 
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''   then l.yoopiskkoulk2013 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013  <> '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''  then l.amkopiskkoulk2013 

	-- lukiokoulutuksessa 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then l.luopiskkoulk2014
	-- ammatillisessa koulutuksessa 2014 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 ='' and l.yoopiskkoulk2014 = ''  then l.ammopiskkoulk2014 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2014 ensimäisiin koulutustietoihin
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then l.luopiskkoulk2014
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014  <> '' and l.yoopiskkoulk2014  = '' and
	l.luopiskkoulk2014  = '' and l.ammopiskkoulk2014 = '' then l.amkopiskkoulk2014
	-- yliopistokoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 <> '' and 
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''   then l.yoopiskkoulk2014 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014  <> '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''  then l.amkopiskkoulk2014 
	
	else ''
	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009 
	-- ammattikoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and l.yoopisktunn2009 = ''  then l.ammopisktunn2009 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammattikorkeakoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then l.amkopisktunn2009
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''   then l.yoopisktunn2009
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.amkopisktunn2009 
	
	
	-- lukiokoulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and l.yoopisktunn2010 = ''  then l.ammopisktunn2010
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then l.amkopisktunn2010
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''   then l.yoopisktunn2010  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.amkopisktunn2010 
	
	-- lukiokoulutuksen oppilaitos 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammatillisen koulutuksen oppilaitos 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and l.yoopisktunn2011 = ''  then l.ammopisktunn2011
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammattikorkeakoulutuksen oppilaitos 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then l.amkopisktunn2011
	-- yliopistokoulutuksen oppilaitos 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''   then l.yoopisktunn2011 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.amkopisktunn2011
	
	-- lukiokoulutuksen oppilaitos 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammatillisen koulutuksen oppilaitos 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and l.yoopisktunn2012 = ''  then l.ammopisktunn2012
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammattikorkeakoulutuksen oppilaitos 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then l.amkopisktunn2012
	-- yliopistokoulutuksen oppilaitos 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''   then l.yoopisktunn2012 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.amkopisktunn2012

		-- lukiokoulutuksen oppilaitos 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 = '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.luopisktunn2013
	-- ammatillisen koulutuksen oppilaitos 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 = '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 ='' and l.yoopisktunn2013 = ''  then l.ammopisktunn2013
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.luopisktunn2013
	-- ammattikorkeakoulutuksen oppilaitos 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013  <> '' and l.yoopisktunn2013  = '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = '' then l.amkopisktunn2013
	-- yliopistokoulutuksen oppilaitos 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013 = '' and l.yoopisktunn2013 <> '' and 
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''   then l.yoopisktunn2013 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013 <> '' and l.yoopisktunn2013  <> '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''  then l.amkopisktunn2013

	-- lukiokoulutuksen oppilaitos 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 = '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then l.luopisktunn2014
	-- ammatillisen koulutuksen oppilaitos 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 = '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 ='' and l.yoopisktunn2014 = ''  then l.ammopisktunn2014
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then l.luopisktunn2014
	-- ammattikorkeakoulutuksen oppilaitos 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014  <> '' and l.yoopisktunn2014  = '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = '' then l.amkopisktunn2014
	-- yliopistokoulutuksen oppilaitos 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014 = '' and l.yoopisktunn2014 <> '' and 
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = ''   then l.yoopisktunn2014 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014 <> '' and l.yoopisktunn2014  <> '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = ''  then l.amkopisktunn2014

	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and yoopiskjarj2009 = '' then l.luopiskjarj2009
	-- ammatillisen koulutuksen järjestäjä 2009  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and l.yoopiskjarj2009 = ''  then l.ammopiskjarj2009
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen 2009 järjestäjä 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009
	-- ammattikorkeakoulutuksen järjestäjä 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then l.amkopiskjarj2009
	-- yliopistokoulutuksen järjestäjä 2009 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then l.yoopiskjarj2009
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen 2009 järjestäjä   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.amkopiskjarj2009 

	
	-- lukiokoulutuksen järjestäjä 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010  = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010  
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and yoopiskjarj2010 = ''  then l.ammopiskjarj2010 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2010, merkitään lukiokoulutuksen 2010 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then l.amkopiskjarj2010 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then l.yoopiskjarj2010
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.amkopiskjarj2010 
	
	-- lukiokoulutuksen järjestäjä 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011 
	-- ammatillisen koulutuksen järjestäjä 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and yoopiskjarj2011 = ''  then l.ammopiskjarj2011 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2010, merkitään lukiokoulutuksen 2011 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011
	-- ammattikorkeakoulutuksen 2011 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then l.amkopiskjarj2011 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''   then l.yoopiskjarj2011
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011  = ''  then l.amkopiskjarj2011 
	
	-- lukiokoulutuksen järjestäjä 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012 = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.luopiskjarj2012 
	-- ammatillisen koulutuksen järjestäjä 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and yoopiskjarj2012 = ''  then l.ammopiskjarj2012 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2010, merkitään lukiokoulutuksen 2012 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.luopiskjarj2012
	-- ammattikorkeakoulutuksen 2012 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then l.amkopiskjarj2012 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012 = ''   then l.yoopiskjarj2012
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012  = ''  then l.amkopiskjarj2012 

			-- lukiokoulutuksen järjestäjä 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013  <> '' and l.ammopiskjarj2013 = '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.luopiskjarj2013 
	-- ammatillisen koulutuksen järjestäjä 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013 = '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 ='' and yoopiskjarj2013 = ''  then l.ammopiskjarj2013 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2010, merkitään lukiokoulutuksen 2013 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013 <> '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.luopiskjarj2013
	-- ammattikorkeakoulutuksen 2013 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   = '' and
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = '' then l.amkopiskjarj2013 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  = '' and l.yoopiskjarj2013  <> '' and 
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013 = ''   then l.yoopiskjarj2013
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   <> '' and
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013  = ''  then l.amkopiskjarj2013 

	-- lukiokoulutuksen järjestäjä 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014  <> '' and l.ammopiskjarj2014 = '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then l.luopiskjarj2014 
	-- ammatillisen koulutuksen järjestäjä 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014 = '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 ='' and yoopiskjarj2014 = ''  then l.ammopiskjarj2014 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2010, merkitään lukiokoulutuksen 2014 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014 <> '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then l.luopiskjarj2014
	-- ammattikorkeakoulutuksen 2014 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   = '' and
	l.luopiskjarj2014 = '' and l.ammopiskjarj2014 = '' then l.amkopiskjarj2014 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  = '' and l.yoopiskjarj2014  <> '' and 
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014 = ''   then l.yoopiskjarj2014
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   <> '' and
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014  = ''  then l.amkopiskjarj2014 
	
	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009   
	-- ammatillisen koulutuksen maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then l.ammopiskmaak2009  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009 
    -- ammattikorkeakoulutuksen maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskmaak2009 = '' then l.amkopiskmaak2009
	-- yliopistokoulutuksen maakunta 2009 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskmaak2009 = ''   then l.yoopiskmaak2009
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta 2009   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskmaak2009  = ''  then l.amkopiskmaak2009 
	
	
	-- lukioopiskelun maakunta 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010
	-- ammatillisen koulutksen maakunta 2010    
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010  = ''  then l.ammopiskmaak2010
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010 
	-- ammattikorkekoulutuksen maakunta 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then l.amkopiskmaak2010
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then l.yoopiskmaak2010
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.amkopiskmaak2010 
	
    -- lukioopiskelun maakunta 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011   <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011
	-- ammatillisen koulutksen maakunta 2011    
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  ='' and l.yoopiskmaak2011  = ''  then l.ammopiskmaak2011
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011 
	-- ammattikorkekoulutuksen maakunta 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskmaak2011 = '' then l.amkopiskmaak2011
	-- yliopistokoulutuksen maakunta 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskmaak2011 = ''   then l.yoopiskmaak2011
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskmaak2011  = ''  then l.amkopiskmaak2011 
	
	
	-- lukioopiskelun maakunta 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012   <> '' and l.ammopiskmaak2012  = '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.luopiskmaak2012
	-- ammatillisen koulutksen maakunta 2012    
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  = '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  ='' and l.yoopiskmaak2012  = ''  then l.ammopiskmaak2012
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.luopiskmaak2012 
	-- ammattikorkekoulutuksen maakunta 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012   <> '' and l.yoopiskmaak2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskmaak2012 = '' then l.amkopiskmaak2012
	-- yliopistokoulutuksen maakunta 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  <> '' and 
	l.luopiskjarj2012  = '' and l.ammopiskmaak2012 = ''   then l.yoopiskmaak2012
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012   <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskmaak2012  = ''  then l.amkopiskmaak2012 

	-- lukioopiskelun maakunta 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013   <> '' and l.ammopiskmaak2013  = '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.luopiskmaak2013
	-- ammatillisen koulutksen maakunta 2013    
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013  = '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  ='' and l.yoopiskmaak2013  = ''  then l.ammopiskmaak2013
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.luopiskmaak2013 
	-- ammattikorkekoulutuksen maakunta 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013   <> '' and l.yoopiskmaak2013   = '' and
	l.luopiskjarj2013 = '' and l.ammopiskmaak2013 = '' then l.amkopiskmaak2013
	-- yliopistokoulutuksen maakunta 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  <> '' and 
	l.luopiskjarj2013  = '' and l.ammopiskmaak2013 = ''   then l.yoopiskmaak2013
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013  <> '' and l.yoopiskmaak2013   <> '' and
	l.luopiskjarj2013  = '' and l.ammopiskmaak2013  = ''  then l.amkopiskmaak2013 

		-- lukioopiskelun maakunta 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014   <> '' and l.ammopiskmaak2014  = '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = '' then l.luopiskmaak2014
	-- ammatillisen koulutksen maakunta 2014    
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014  = '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  ='' and l.yoopiskmaak2014  = ''  then l.ammopiskmaak2014
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014  <> '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = '' then l.luopiskmaak2014 
	-- ammattikorkekoulutuksen maakunta 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014   <> '' and l.yoopiskmaak2014   = '' and
	l.luopiskjarj2014 = '' and l.ammopiskmaak2014 = '' then l.amkopiskmaak2014
	-- yliopistokoulutuksen maakunta 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  <> '' and 
	l.luopiskjarj2014  = '' and l.ammopiskmaak2014 = ''   then l.yoopiskmaak2014
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014  <> '' and l.yoopiskmaak2014   <> '' and
	l.luopiskjarj2014  = '' and l.ammopiskmaak2014  = ''  then l.amkopiskmaak2014 
	
	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi 2009 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus 2009 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.ammopiskkoulk2009 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.yoopiskkoulk2009
	
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2010 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.ammopiskkoulk2010
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.yoopiskkoulk2010   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.ammopiskkoulk2011
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.yoopiskkoulk2011   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.ammopiskkoulk2012
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.yoopiskkoulk2012   

		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 ='' and l.yoopiskkoulk2013 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.ammopiskkoulk2013
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013  <> '' and l.yoopiskkoulk2013  = '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 <> '' and 
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013  <> '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''  then l.yoopiskkoulk2013  
	
			-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 ='' and l.yoopiskkoulk2014 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then l.ammopiskkoulk2014
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014  <> '' and l.yoopiskkoulk2014  = '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 <> '' and 
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014  <> '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''  then l.yoopiskkoulk2014   
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then ''
	-- ammatillisen koulutuksen oppilaitos 2009 merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and l.yoopisktunn2009 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.ammopisktunn2009 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.yoopisktunn2009 
	
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and yoopisktunn2010 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.ammopisktunn2010 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2010 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2010 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.yoopisktunn2010 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and yoopisktunn2011 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.ammopisktunn2011 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2011 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2010 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.yoopisktunn2011 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and yoopisktunn2012 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.ammopisktunn2012 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2012 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2010 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.yoopisktunn2012 

		-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 = '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 = '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 ='' and yoopisktunn2013 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.ammopisktunn2013 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013  <> '' and l.yoopisktunn2013  = '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013 = '' and l.yoopisktunn2013 <> '' and 
	l.luopisktunn2013 = '' and l.ammopisktunn2013  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2013 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2010 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013 <> '' and l.yoopisktunn2013  <> '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''  then l.yoopisktunn2013 

	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 = '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 = '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 ='' and yoopisktunn2014 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then l.ammopisktunn2014 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014  <> '' and l.yoopisktunn2014  = '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014 = '' and l.yoopisktunn2014 <> '' and 
	l.luopisktunn2014 = '' and l.ammopisktunn2014  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2014 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2010 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014 <> '' and l.yoopisktunn2014  <> '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = ''  then l.yoopisktunn2014  
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain 2009, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain 2009, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and l.yoopiskjarj2009 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.ammopiskjarj2009 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.yoopiskjarj2009 
	
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and l.yoopiskjarj2010 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.ammopiskjarj2010 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.yoopiskjarj2010 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and l.yoopiskjarj2011 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.ammopiskjarj2011 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011  = ''  then l.yoopiskjarj2011 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012 = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and l.yoopiskjarj2012 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.ammopiskjarj2012 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012  = ''  then l.yoopiskjarj2012 

		-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013  <> '' and l.ammopiskjarj2013 = '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013 = '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 ='' and l.yoopiskjarj2013 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013 <> '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.ammopiskjarj2013 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   = '' and
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  = '' and l.yoopiskjarj2013  <> '' and 
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   <> '' and
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013  = ''  then l.yoopiskjarj2013 

	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014  <> '' and l.ammopiskjarj2014 = '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014 = '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 ='' and l.yoopiskjarj2014 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014 <> '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then l.ammopiskjarj2014 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   = '' and
	l.luopiskjarj2014 = '' and l.ammopiskjarj2014 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  = '' and l.yoopiskjarj2014  <> '' and 
	l.luopiskjarj2014 = '' and l.ammopiskjarj2014 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   <> '' and
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014  = ''  then l.yoopiskjarj2014 
	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta 2009, jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2009, jätetään tyhjäksi   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.ammopiskmaak2009 
	-- vain ammattikorkeakoulutuksen maakunta 2009, jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2009 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2009, merkitään yliopistokoulutuksen maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskmaak2009  = ''  then l.yoopiskmaak2009
	
	
	-- vain lukiokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and yoopiskmaak2010  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2010, merkitään tyhjäksi   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2010, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.ammopiskmaak2010 
	-- vain ammattikorkeakoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2010, merkitään yliopistokoulutuksen 2010 maakunta 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.yoopiskmaak2010  
	
	
	-- vain lukiokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011   <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and yoopiskmaak2011  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2011, merkitään tyhjäksi   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2011, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.ammopiskmaak2011 
	-- vain ammattikorkeakoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2011, merkitään yliopistokoulutuksen 2010 maakunta 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.yoopiskmaak2011  
	
	
	-- vain lukiokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012   <> '' and l.ammopiskmaak2012  = '' and
	l.amkopiskmaak2012  = '' and yoopiskmaak2012  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2012, merkitään tyhjäksi   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  = '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2012, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.ammopiskmaak2012 
	-- vain ammattikorkeakoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012   <> '' and l.yoopiskmaak2012   = '' and
	l.luopiskmaak2012 = '' and l.ammopiskmaak2012 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  <> '' and 
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2012, merkitään yliopistokoulutuksen 2010 maakunta 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012   <> '' and
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012  = ''  then l.yoopiskmaak2012  

			-- vain lukiokoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013   <> '' and l.ammopiskmaak2013  = '' and
	l.amkopiskmaak2013  = '' and yoopiskmaak2013  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2013, merkitään tyhjäksi   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013  = '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2013, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.ammopiskmaak2013 
	-- vain ammattikorkeakoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013   <> '' and l.yoopiskmaak2013   = '' and
	l.luopiskmaak2013 = '' and l.ammopiskmaak2013 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  <> '' and 
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2013, merkitään yliopistokoulutuksen 2010 maakunta 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013  <> '' and l.yoopiskmaak2013   <> '' and
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013  = ''  then l.yoopiskmaak2013  


	-- vain lukiokoulutuksen maakunta 2014, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014   <> '' and l.ammopiskmaak2014  = '' and
	l.amkopiskmaak2014  = '' and yoopiskmaak2014  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2014, merkitään tyhjäksi   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014  = '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2014, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014  <> '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = '' then l.ammopiskmaak2014 
	-- vain ammattikorkeakoulutuksen maakunta 2014, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014   <> '' and l.yoopiskmaak2014   = '' and
	l.luopiskmaak2014 = '' and l.ammopiskmaak2014 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2014, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  <> '' and 
	l.luopiskmaak2014  = '' and l.ammopiskmaak2014 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2014, merkitään yliopistokoulutuksen 2010 maakunta 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014  <> '' and l.yoopiskmaak2014   <> '' and
	l.luopiskmaak2014  = '' and l.ammopiskmaak2014  = ''  then l.yoopiskmaak2014    
	
	else ''
	
	    end),
	-- Monihaku
	(case
	-- 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.monihaku2009
	--2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1'  then l.monihaku2010
	-- 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.monihaku2011
	
	-- 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.monihaku2012
		-- 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.monihaku2013

	-- 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.monihaku2014
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2009
	-- 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2010 
	-- 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2011
	-- 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2012
	-- 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2013

	-- 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2014
   
	else ''
	end),
	-- Ammattiasema
	(case
	-- 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.amas_2009
	-- 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' then l.amas_2010
	-- 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.amas_2011
	-- 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.amas_2012
	-- 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.amas_2013

	-- 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.amas_2014

	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.12',
 -- Lukiokoulutuksessa
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1'  
        when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then '1'  
			when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then '1'  
			when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then '1'  
	    else '0'
	 
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2009  <> '' and l.luopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2010 <> '' and l.luopiskkoulk2010  = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'   
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2011 <> '' and l.luopiskkoulk2011  = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1'    
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2012 <> '' and l.luopiskkoulk2012  = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then '1'    
		when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2013 <> '' and l.luopiskkoulk2013  = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then '1'  
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2014 <> '' and l.luopiskkoulk2014  = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then '1'    
	  
	   
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' then  '1'
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' then  '1'
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' then  '1'
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' then  '1'
		 when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2013<> '' and l.ammopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2013 = '' then  '1'
		  when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2014<> '' and l.ammopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.luopiskkoulk2014 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2009  <> '' and l.amkopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then '1'  	   
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' then '1'  	   
	    	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2013 <> '' and l.amkopiskkoulk2013 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' then '1'
				when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2014 <> '' and l.amkopiskkoulk2014 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' then '1'
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2009  <> '' and l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009  = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1'  
	   	when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then '1'  
			when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then '1'  
			when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 <> '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2009  <> '' and l.amkopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2010  <> '' and l.amkopiskkoulk2010 <> ''  and l.luopiskkoulk2010 = '' and l.yoopiskkoulk2010  = '' then '1' 
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 <> ''  and l.luopiskkoulk2011 = '' and l.yoopiskkoulk2011  = '' then '1'  
		    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 <> ''  and l.luopiskkoulk2012 = '' and l.yoopiskkoulk2012  = '' then '1'  
    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2013 <> '' and l.amkopiskkoulk2013 <> ''  and l.luopiskkoulk2013 = '' and l.yoopiskkoulk2013  = '' then '1' 
	when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2014 <> '' and l.amkopiskkoulk2014 <> ''  and l.luopiskkoulk2014 = '' and l.yoopiskkoulk2014  = '' then '1'   
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009 <> '' and l.ammopiskkoulk2009  = '' and l.luopiskkoulk2009 = ''  then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010 <> ''  and l.ammopiskkoulk2010  = '' and l.luopiskkoulk2010 = '' then '1'  
		 when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011 <> ''  and l.ammopiskkoulk2011  = '' and l.luopiskkoulk2011 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012 <> ''  and l.ammopiskkoulk2012  = '' and l.luopiskkoulk2012 = '' then '1'  
	     when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013 <> ''  and l.ammopiskkoulk2013  = '' and l.luopiskkoulk2013 = '' then '1' 
		   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014 <> ''  and l.ammopiskkoulk2014  = '' and l.luopiskkoulk2014 = '' then '1'  
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')  and (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13') 
	   and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009<>'' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009<>'') then '1' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010  = '13')
	   and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010<>'' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010<>'') then '1' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
	   and (l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011<>'' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011<>'')then '1' 
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13')
	   and (l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012<>'' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012<>'')then '1' 
        when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2013 = '22' or l.ptoim1r4_2013 = '13')
	   and (l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013<>'' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013<>'')then '1' 
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2014 = '22' or l.ptoim1r4_2014 = '13')
	   and (l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014<>'' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014<>'')then '1' 
	 
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 ='13')
	   and (l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009='' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009='') then '2' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13')
	   and (l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010='' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010='') then '2'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
	   and (l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011='' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011= '') then '2' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13')
	   and (l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012='' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012= '') then '2' 
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and (l.ptoim1r4_2013 = '22' or l.ptoim1r4_2013 = '13')
	   and (l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 ='' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013= '') then '2' 
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and (l.ptoim1r4_2014 = '22' or l.ptoim1r4_2014 = '13')
	   and (l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 ='' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014= '') then '2' 


	   -- Ei opiskelevat työlliset
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')and  l.ptoim1r4_2009  = '10'  then '3' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2010 = '10'  then '3'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2011 = '10'  then '3'
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2012 = '10'  then '3' 
   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2013 = '10'  then '3' 
    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2014 = '10'  then '3' 
 

	    
	   -- Ei opiskelevat työttömät
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2009  = '12'  then '4' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2010 = '12'  then '4' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2011 = '12'  then '4' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2012 = '12'  then '4' 
	 when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2013 = '12'  then '4' 
	 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2014 = '12'  then '4'
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
	   
  ,ika_1v = cast((case 
            when syntv = '' then '-1' else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_12_Perusk_paattaneet_amm_tutk_suorittaneet]
	where (suorv = '2008' or suorv = '2009' or suorv = '2010' or suorv = '2011' or suorv= '2012' or suorv= '2013' ) and suorlk = '1'
	) as l
	
	
	WHERE 1=1
end;

--
-- TULOS
-- 
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_2v]
end;

if @debug_what_to_run>0 PRINT 'all done.';

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_ensimmainen_laskenta]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_ensimmainen_laskenta]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_ensimmainen_laskenta] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_ensimmainen_laskenta] AS

TRUNCATE TABLE [VipunenTK_DW].[dbo].[_f_koulutukseen_sijoittuneet_2v_tarkastelu]

INSERT INTO [VipunenTK_DW].[dbo].[_f_koulutukseen_sijoittuneet_2v_tarkastelu]
(
aineistorivinumero,
tarkastelujakso,
tilv, 
tilv_date,
tutkryh,
suorv,
suorlk,
sp,
syntv,
aikielir1,
tutkkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
tunn,
jarj,
kkielir1,
tutklaja,
tutktav,
aikoul,
tutkmaak,
koulutus,
oppilaitos,
koulutuksen_jarjestaja,
koulutuksen_maakunta,
monihaku,
paaasiallinen_toiminta,
ammattiasema,
lkm,
pohjkoulk,
tietolahde,
aineisto,
lukiokoulutuksessa,
ammatillisessa_koulutuksessa,
ammattikorkeakoulutuksessa,
yliopistokoulutuksessa,
lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa,
koulutuksen_paattaneiden_toiminta,
rivinumero,
ika_1v,
ika_5v
)
SELECT
l.rivinumero,
l.tarkastelujakso,
l.tilv, 
l.tilv_date,
l.tutkryh,
l.suorv,
l.suorlk,
l.sp,
l.syntv,
l.aikielir1,
l.tutkkaskun,
l.kansalr1,
l.pohjmaa,
l.eumaa,
l.etamaa,
l.tunn,
l.jarj,
l.kkielir1,
l.tutklaja,
l.tutktav,
l.aikoul,
l.tutkmaak,
l.koulutus_1,
--coalesce(NULLIF(l.koulutus_2,''),l.koulutus_1),
l.oppilaitos_1,
--coalesce(NULLIF(l.oppilaitos_2,''),l.oppilaitos_1),
l.koulutuksen_jarjestaja_1,
--coalesce(NULLIF(l.koulutuksen_jarjestaja_2,''),l.koulutuksen_jarjestaja_1),
l.koulutuksen_maakunta_1,
--coalesce(NULLIF(l.koulutuksen_maakunta_2,''),l.koulutuksen_maakunta_1),
l.monihaku,
l.paaasiallinen_toiminta,
l.ammattiasema,
l.lkm,
l.pohjkoulk,
l.tietolahde,
l.aineisto,
l.lukiokoulutuksessa,
l.ammatillisessa_koulutuksessa,
l.ammattikorkeakoulutuksessa,
l.yliopistokoulutuksessa,
l.lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
l.toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
l.ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa,
l.koulutuksen_paattaneiden_toiminta,
ROW_NUMBER()OVER(ORDER BY l.tarkastelujakso),
l.ika_1v,
l.ika_5v
FROM 
		(
		select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_2v_tarkastelu]
		) as l

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_toinen_laskenta]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_toinen_laskenta]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_toinen_laskenta] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_toinen_laskenta] AS
/* Yksi koulutus per henkilö joten tätä ei ajeta
INSERT INTO [VipunenTK_DW].[dbo].[_f_koulutukseen_sijoittuneet_2v_tarkastelu]
(
aineistorivinumero,
tarkastelujakso,
tilv, 
tilv_date,
tutkryh,
suorv,
suorlk,
sp,
syntv,
aikielir1,
tutkkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
tunn,
jarj,
kkielir1,
tutklaja,
tutktav,
aikoul,
tutkmaak,
koulutus,
oppilaitos,
koulutuksen_jarjestaja,
koulutuksen_maakunta,
monihaku,
paaasiallinen_toiminta,
ammattiasema,
lkm,
pohjkoulk,
tietolahde,
aineisto,
lukiokoulutuksessa,
ammatillisessa_koulutuksessa,
ammattikorkeakoulutuksessa,
yliopistokoulutuksessa,
lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa,
koulutuksen_paattaneiden_toiminta,
rivinumero,
ika_1v,
ika_5v
)
SELECT
l.rivinumero,
l.tarkastelujakso,
l.tilv, 
l.tilv_date,
l.tutkryh,
l.suorv,
l.suorlk,
l.sp,
l.syntv,
l.aikielir1,
l.tutkkaskun,
l.kansalr1,
l.pohjmaa,
l.eumaa,
l.etamaa,
l.tunn,
l.jarj,
l.kkielir1,
l.tutklaja,
l.tutktav,
l.aikoul,
l.tutkmaak,
l.koulutus_2,
l.oppilaitos_2,
l.koulutuksen_jarjestaja_2,
l.koulutuksen_maakunta_2,
l.monihaku,
l.paaasiallinen_toiminta,
l.ammattiasema,
l.lkm,
l.pohjkoulk,
l.tietolahde,
l.aineisto,
l.lukiokoulutuksessa,
l.ammatillisessa_koulutuksessa,
l.ammattikorkeakoulutuksessa,
l.yliopistokoulutuksessa,
l.lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
l.toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
l.ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa,
l.koulutuksen_paattaneiden_toiminta,
(select rivinumero from [VipunenTK_DW].[dbo].[_f_koulutukseen_sijoittuneet_2v_tarkastelu]
 where (aineistorivinumero = l.rivinumero ) and (tarkastelujakso = l.tarkastelujakso) and (tilv = l.tilv) and  (suorv = l.suorv) and (suorlk = l.suorlk)),
l.ika_1v,
l.ika_5v
FROM 
		(
		select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_2v_tarkastelu]  where (koulutus_1 <> '') and (koulutus_2 <> '')
		) as l  where (koulutus_1 <> '') and (koulutus_2 <> '')

*/
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_toinen_laskenta_testi]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_toinen_laskenta_testi]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_toinen_laskenta_testi] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_2v_toinen_laskenta_testi] AS


UPDATE [VipunenTK_DW].[dbo].[_f_koulutukseen_sijoittuneet_2v_tarkastelu] SET

koulutus=l.koulutus_2,
oppilaitos=l.oppilaitos_2,
koulutuksen_jarjestaja=l.koulutuksen_jarjestaja_2,
koulutuksen_maakunta=l.koulutuksen_maakunta_2

FROM [VipunenTK_DW].[dbo].[_f_koulutukseen_sijoittuneet_2v_tarkastelu] f  
INNER JOIN [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_2v_tarkastelu] l on l.rivinumero=f.aineistorivinumero
where (l.koulutus_1 <> '') and (l.koulutus_2 <> '')


GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_0_5_tarkastelujakso]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_0_5_tarkastelujakso]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_0_5_tarkastelujakso] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_0_5_tarkastelujakso] AS

declare @debug_what_to_run tinyint; set @debug_what_to_run=1; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';



-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;


set @ensimmainen_suoritusvuosi = 2004;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;


INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn 
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
,lkm
,pohjkoulk
,tietolahde
, aineisto
 ,lukiokoulutuksessa
 ,ammatillisessa_koulutuksessa
 ,ammattikorkeakoulutuksessa
 ,yliopistokoulutuksessa
 ,lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
 ,toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
 ,ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
 ,koulutuksen_paattaneiden_toiminta
 ,ika_1v
 ,ika_5v
)
SELECT
 l.rivinumero,
 '0,5',
 l.tilv,
 l.tilv_date,
 l.tutkryh,
 l.suorv,
 (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
(case
    -- Koulutus 1
	-- lukiokoulutuksessa 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 = '' and
	l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then l.luopiskkoulk2005
	-- ammatillisessa koulutuksessa 2005 
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 <> '' and
	l.amkopiskkoulk2005 ='' and l.yoopiskkoulk2005 = ''  then l.ammopiskkoulk2005 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2005 ensimäisiin koulutustietoihin
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 <> '' and
	l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then l.luopiskkoulk2005
	-- ammattikorkeakoulutuksessa
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2005  <> '' and l.yoopiskkoulk2005  = '' and
	l.luopiskkoulk2005  = '' and l.ammopiskkoulk2005 = '' then l.amkopiskkoulk2005
	-- yliopistokoulutuksessa
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 <> '' and 
	l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = ''   then l.yoopiskkoulk2005 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2005 <> '' and l.yoopiskkoulk2005  <> '' and
	l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = ''  then l.amkopiskkoulk2005 
	
	
	-- lukiokoulutuksessa 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then l.luopiskkoulk2006
	-- ammatillisessa koulutuksessa 2006
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 ='' and l.yoopiskkoulk2006 = ''  then l.ammopiskkoulk2006 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2006 ensimäisiin koulutustietoihin
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then l.luopiskkoulk2006
	-- ammattikorkeakoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2006  <> '' and l.yoopiskkoulk2006  = '' and
	l.luopiskkoulk2006  = '' and l.ammopiskkoulk2006 = '' then l.amkopiskkoulk2006
	-- yliopistokoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 <> '' and 
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''   then l.yoopiskkoulk2006 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2006 <> '' and l.yoopiskkoulk2006  <> '' and
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''  then l.amkopiskkoulk2006
	
		-- lukiokoulutuksessa 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.luopiskkoulk2007
	-- ammatillisessa koulutuksessa 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 ='' and l.yoopiskkoulk2007 = ''  then l.ammopiskkoulk2007 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2006 ensimäisiin koulutustietoihin
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.luopiskkoulk2007
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2007  <> '' and l.yoopiskkoulk2007  = '' and
	l.luopiskkoulk2007  = '' and l.ammopiskkoulk2007 = '' then l.amkopiskkoulk2007
	-- yliopistokoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 <> '' and 
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''   then l.yoopiskkoulk2007 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007  <> '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''  then l.amkopiskkoulk2007
	
	-- lukiokoulutuksessa 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammatillisessa koulutuksessa 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then l.ammopiskkoulk2008 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2006 ensimäisiin koulutustietoihin
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammattikorkeakoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008  = '' and l.ammopiskkoulk2008 = '' then l.amkopiskkoulk2008
	-- yliopistokoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then l.yoopiskkoulk2008 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.amkopiskkoulk2008

	-- lukiokoulutuksessa 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammatillisessa koulutuksessa 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then l.ammopiskkoulk2009 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2006 ensimäisiin koulutustietoihin
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammattikorkeakoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009  = '' and l.ammopiskkoulk2009 = '' then l.amkopiskkoulk2009
	-- yliopistokoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then l.yoopiskkoulk2009 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.amkopiskkoulk2009

	-- lukiokoulutuksessa 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammatillisessa koulutuksessa 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then l.ammopiskkoulk2010 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2006 ensimäisiin koulutustietoihin
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010  = '' and l.ammopiskkoulk2010 = '' then l.amkopiskkoulk2010
	-- yliopistokoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then l.yoopiskkoulk2010 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.amkopiskkoulk2010

	else ''
	    end),
	 -- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos 2005
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2005 <> '' and l.ammopisktunn2005 = '' and
	l.amkopisktunn2005 = '' and l.yoopisktunn2005 = '' then l.luopisktunn2005
	-- ammatillisen koulutuksen oppilaitos 2005
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2005 = '' and l.ammopisktunn2005 <> '' and
	l.amkopisktunn2005 ='' and l.yoopisktunn2005 = ''  then l.ammopisktunn2005
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2005 <> '' and l.ammopisktunn2005 <> '' and
	l.amkopisktunn2005 = '' and l.yoopisktunn2005 = '' then l.luopisktunn2005
	-- ammattikorkeakoulutuksen oppilaitos 2005
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2005  <> '' and l.yoopisktunn2005  = '' and
	l.luopisktunn2005 = '' and l.ammopisktunn2005 = '' then l.amkopisktunn2005
	-- yliopistokoulutuksen oppilaitos 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2005 = '' and l.yoopisktunn2005 <> '' and 
	l.luopisktunn2005 = '' and l.ammopisktunn2005 = ''   then l.yoopisktunn2005  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2005  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2005 <> '' and l.yoopisktunn2005  <> '' and
	l.luopisktunn2005 = '' and l.ammopisktunn2005 = ''  then l.amkopisktunn2005 
	
	
	-- lukiokoulutuksen oppilaitos 2006
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 = '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then l.luopisktunn2006
	-- ammatillisen koulutuksen oppilaitos 2006
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2006 = '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 ='' and l.yoopisktunn2006 = ''  then l.ammopisktunn2006
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2005
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then l.luopisktunn2006
	-- ammattikorkeakoulutuksen oppilaitos 2006
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2006  <> '' and l.yoopisktunn2006  = '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = '' then l.amkopisktunn2006
	-- yliopistokoulutuksen oppilaitos 2006
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2006 = '' and l.yoopisktunn2006 <> '' and 
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = ''   then l.yoopisktunn2006  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2006 
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2006 <> '' and l.yoopisktunn2006  <> '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = ''  then l.amkopisktunn2006 
	
	-- lukiokoulutuksen oppilaitos 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 = '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.luopisktunn2007
	-- ammatillisen koulutuksen oppilaitos 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2007 = '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 ='' and l.yoopisktunn2007 = ''  then l.ammopisktunn2007
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2005
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.luopisktunn2007
	-- ammattikorkeakoulutuksen oppilaitos 2006
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2007  <> '' and l.yoopisktunn2007  = '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = '' then l.amkopisktunn2007
	-- yliopistokoulutuksen oppilaitos 2006
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2007 = '' and l.yoopisktunn2007 <> '' and 
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''   then l.yoopisktunn2007  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2006 
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2007 <> '' and l.yoopisktunn2007  <> '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''  then l.amkopisktunn2007 
	
	
	-- lukiokoulutuksen oppilaitos 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammatillisen koulutuksen oppilaitos 2006
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and l.yoopisktunn2008 = ''  then l.ammopisktunn2008
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2005
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammattikorkeakoulutuksen oppilaitos 2006
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then l.amkopisktunn2008
	-- yliopistokoulutuksen oppilaitos 2006
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''   then l.yoopisktunn2008  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2006 
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.amkopisktunn2008 

	-- lukiokoulutuksen oppilaitos 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammatillisen koulutuksen oppilaitos 2006
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and l.yoopisktunn2009 = ''  then l.ammopisktunn2009
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2005
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammattikorkeakoulutuksen oppilaitos 2006
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then l.amkopisktunn2009
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''   then l.yoopisktunn2009  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2006 
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.amkopisktunn2009 

	-- lukiokoulutuksen oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammatillisen koulutuksen oppilaitos 2006
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and l.yoopisktunn2010 = ''  then l.ammopisktunn2010
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2005
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammattikorkeakoulutuksen oppilaitos 2006
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then l.amkopisktunn2010
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''   then l.yoopisktunn2010  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2006 
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.amkopisktunn2010 
	
	else ''
	
	    end),
	-- Koulutuksen järjestäjä 1 
	(case
	-- lukiokoulutuksen järjestäjä 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2005  <> '' and l.ammopiskjarj2005  = '' and
	l.amkopiskjarj2005 = '' and l.yoopiskjarj2005 = '' then l.luopiskjarj2005  
	-- ammatillisen koulutuksen järjestäjä 2005
	when l.suorv = @ensimmainen_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2005 = '' and l.ammopiskjarj2005 <> '' and
	l.amkopiskjarj2005 ='' and yoopiskjarj2005 = ''  then l.ammopiskjarj2005 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2005, merkitään lukiokoulutuksen 2005 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2005 <> '' and l.ammopiskjarj2005 <> '' and
	l.amkopiskjarj2005 = '' and l.yoopiskjarj2005 = '' then l.luopiskjarj2005
	-- ammattikorkeakoulutuksen 2005 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2005  <> '' and l.yoopiskjarj2005   = '' and
	l.luopiskjarj2005 = '' and l.ammopiskjarj2005 = '' then l.amkopiskjarj2005 
	-- yliopistokoulutuksen 2005 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2005  = '' and l.yoopiskjarj2005  <> '' and 
	l.luopiskjarj2005  = '' and l.ammopiskjarj2005 = ''   then l.yoopiskjarj2005
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2005, merkitään ammattikorkekoulutuksen järjestäjä 2005   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2005  <> '' and l.yoopiskjarj2005   <> '' and
	l.luopiskjarj2005  = '' and l.ammopiskjarj2005  = ''  then l.amkopiskjarj2005 
	
	
	-- lukiokoulutuksen järjestäjä 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2006  <> '' and l.ammopiskjarj2006  = '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then l.luopiskjarj2006  
	-- ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @toinen_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2006 = '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 ='' and yoopiskjarj2006 = ''  then l.ammopiskjarj2006 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2005, merkitään lukiokoulutuksen 2005 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2006 <> '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then l.luopiskjarj2006
	-- ammattikorkeakoulutuksen 2006 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   = '' and
	l.luopiskjarj2006 = '' and l.ammopiskjarj2006 = '' then l.amkopiskjarj2006 
	-- yliopistokoulutuksen 2006 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2006  = '' and l.yoopiskjarj2006  <> '' and 
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006 = ''   then l.yoopiskjarj2006
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2006, merkitään ammattikorkekoulutuksen järjestäjä 2006   
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   <> '' and
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006  = ''  then l.amkopiskjarj2006 
	
	
	-- lukiokoulutuksen järjestäjä 2007
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2007  <> '' and l.ammopiskjarj2007  = '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.luopiskjarj2007  
	-- ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2007 = '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 ='' and yoopiskjarj2007 = ''  then l.ammopiskjarj2007 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2005, merkitään lukiokoulutuksen 2005 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2007 <> '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.luopiskjarj2007
	-- ammattikorkeakoulutuksen 2006 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskjarj2007 = '' then l.amkopiskjarj2007 
	-- yliopistokoulutuksen 2006 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2007  = '' and l.yoopiskjarj2007  <> '' and 
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007 = ''   then l.yoopiskjarj2007
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2006, merkitään ammattikorkekoulutuksen järjestäjä 2006   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   <> '' and
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007  = ''  then l.amkopiskjarj2007 
	
	-- lukiokoulutuksen järjestäjä 2008
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008  = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008  
	-- ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and yoopiskjarj2008 = ''  then l.ammopiskjarj2008 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2005, merkitään lukiokoulutuksen 2005 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008
	-- ammattikorkeakoulutuksen 2006 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then l.amkopiskjarj2008 
	-- yliopistokoulutuksen 2006 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then l.yoopiskjarj2008
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2006, merkitään ammattikorkekoulutuksen järjestäjä 2006   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.amkopiskjarj2008

	-- lukiokoulutuksen järjestäjä 2009
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009  = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009  
	-- ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and yoopiskjarj2009 = ''  then l.ammopiskjarj2009 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2005, merkitään lukiokoulutuksen 2005 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009
	-- ammattikorkeakoulutuksen 2006 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then l.amkopiskjarj2009 
	-- yliopistokoulutuksen 2006 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then l.yoopiskjarj2009
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2006, merkitään ammattikorkekoulutuksen järjestäjä 2006   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.amkopiskjarj2009

	-- lukiokoulutuksen järjestäjä 2010
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010  = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010  
	-- ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and yoopiskjarj2010 = ''  then l.ammopiskjarj2010 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2005, merkitään lukiokoulutuksen 2005 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010
	-- ammattikorkeakoulutuksen 2006 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then l.amkopiskjarj2010 
	-- yliopistokoulutuksen 2006 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then l.yoopiskjarj2010
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2006, merkitään ammattikorkekoulutuksen järjestäjä 2006   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.amkopiskjarj2010
	
	else ''
	    end),
	    
	 -- Maakunta 1
	(case
	-- lukioopiskelun maakunta 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2005   <> '' and l.ammopiskmaak2005  = '' and
	l.amkopiskmaak2005  = '' and l.yoopiskmaak2005  = '' then l.luopiskmaak2005
	-- ammatillisen koulutksen maakunta 2005    
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2005  = '' and l.ammopiskmaak2005  <> '' and
	l.amkopiskmaak2005  ='' and l.yoopiskmaak2005  = ''  then l.ammopiskmaak2005
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2005  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2005  <> '' and l.ammopiskmaak2005  <> '' and
	l.amkopiskmaak2005  = '' and l.yoopiskmaak2005  = '' then l.luopiskmaak2005 
	-- ammattikorkekoulutuksen maakunta 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2005   <> '' and l.yoopiskmaak2005   = '' and
	l.luopiskmaak2005 = '' and l.ammopiskmaak2005 = '' then l.amkopiskmaak2005
	-- yliopistokoulutuksen maakunta 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2005  = '' and l.yoopiskmaak2005  <> '' and 
	l.luopiskmaak2005  = '' and l.ammopiskmaak2005 = ''   then l.yoopiskmaak2005
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2005, otetaan talteen ammattikorkekoulutksen maakunta 2005   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2005  <> '' and l.yoopiskmaak2005   <> '' and
	l.luopiskmaak2005  = '' and l.ammopiskmaak2005  = ''  then l.amkopiskmaak2005 
	
	
	-- lukioopiskelun maakunta 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2006   <> '' and l.ammopiskmaak2006  = '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = '' then l.luopiskmaak2006
	-- ammatillisen koulutksen maakunta 2006    
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2006  = '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  ='' and l.yoopiskmaak2006  = ''  then l.ammopiskmaak2006
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2006  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2006  <> '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = '' then l.luopiskmaak2006 
	-- ammattikorkekoulutuksen maakunta 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2006   <> '' and l.yoopiskmaak2006   = '' and
	l.luopiskmaak2006 = '' and l.ammopiskmaak2006 = '' then l.amkopiskmaak2006
	-- yliopistokoulutuksen maakunta 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  <> '' and 
	l.luopiskmaak2006  = '' and l.ammopiskmaak2006 = ''   then l.yoopiskmaak2006
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2006, otetaan talteen ammattikorkekoulutksen maakunta 2006   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2006  <> '' and l.yoopiskmaak2006   <> '' and
	l.luopiskmaak2006  = '' and l.ammopiskmaak2006  = ''  then l.amkopiskmaak2006 
	
	-- lukioopiskelun maakunta 2007
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2007   <> '' and l.ammopiskmaak2007  = '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.luopiskmaak2007
	-- ammatillisen koulutksen maakunta 2006    
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2007  = '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007 ='' and l.yoopiskmaak2007  = ''  then l.ammopiskmaak2007
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2006  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2007  <> '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.luopiskmaak2007 
	-- ammattikorkekoulutuksen maakunta 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2007   <> '' and l.yoopiskmaak2007   = '' and
	l.luopiskmaak2007 = '' and l.ammopiskmaak2007 = '' then l.amkopiskmaak2007
	-- yliopistokoulutuksen maakunta 2006
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  <> '' and 
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007 = ''   then l.yoopiskmaak2007
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2006, otetaan talteen ammattikorkekoulutksen maakunta 2006   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2007  <> '' and l.yoopiskmaak2007   <> '' and
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007  = ''  then l.amkopiskmaak2007 
	
	-- lukioopiskelun maakunta 2008
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008
	-- ammatillisen koulutksen maakunta 2006    
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008 ='' and l.yoopiskmaak2008  = ''  then l.ammopiskmaak2008
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2006  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008 
	-- ammattikorkekoulutuksen maakunta 2006
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then l.amkopiskmaak2008
	-- yliopistokoulutuksen maakunta 2006
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008 = ''   then l.yoopiskmaak2008
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2006, otetaan talteen ammattikorkekoulutksen maakunta 2006   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008  = ''  then l.amkopiskmaak2008 

		-- lukioopiskelun maakunta 2009
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009
	-- ammatillisen koulutksen maakunta 2006    
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009 ='' and l.yoopiskmaak2009  = ''  then l.ammopiskmaak2009
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2006  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009 
	-- ammattikorkekoulutuksen maakunta 2006
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then l.amkopiskmaak2009
	-- yliopistokoulutuksen maakunta 2009
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then l.yoopiskmaak2009
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2006, otetaan talteen ammattikorkekoulutksen maakunta 2006   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.amkopiskmaak2009 

	-- lukioopiskelun maakunta 2010
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010
	-- ammatillisen koulutksen maakunta 2006    
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010 ='' and l.yoopiskmaak2010  = ''  then l.ammopiskmaak2010
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2006  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010 
	-- ammattikorkekoulutuksen maakunta 2006
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then l.amkopiskmaak2010
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then l.yoopiskmaak2010
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2006, otetaan talteen ammattikorkekoulutksen maakunta 2006   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.amkopiskmaak2010
	
	else ''
	
	
	    end),
-- Koulutus 2
(case
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2005
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 = '' and
	l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2005 
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 <> '' and
	l.amkopiskkoulk2005 ='' and l.yoopiskkoulk2005 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 <> '' and
	l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then l.ammopiskkoulk2005
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2005  <> '' and l.yoopiskkoulk2005  = '' and
	l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 <> '' and 
	l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2005 <> '' and l.yoopiskkoulk2005  <> '' and
	l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = ''  then l.yoopiskkoulk2005   
	
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2005 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 ='' and l.yoopiskkoulk2006 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then l.ammopiskkoulk2006
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2006  <> '' and l.yoopiskkoulk2006  = '' and
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 <> '' and 
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2006 <> '' and l.yoopiskkoulk2006  <> '' and
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''  then l.yoopiskkoulk2006   
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2007 
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 ='' and l.yoopiskkoulk2007 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2006
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.ammopiskkoulk2007
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2005
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2007  <> '' and l.yoopiskkoulk2007  = '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 <> '' and 
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007  <> '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''  then l.yoopiskkoulk2007   
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2008 
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2006
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.ammopiskkoulk2008
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2005
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.yoopiskkoulk2008   

		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2009 
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2006
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.ammopiskkoulk2009
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2005
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.yoopiskkoulk2009   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2010 
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2006
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.ammopiskkoulk2010
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2005
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.yoopiskkoulk2010 
	else ''
	    end),
	    
-- Oppilaitos 2
(case
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2005 <> '' and l.ammopisktunn2005 = '' and
	l.amkopisktunn2005 = '' and l.yoopisktunn2005 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2005 = '' and l.ammopisktunn2005 <> '' and
	l.amkopisktunn2005 ='' and yoopisktunn2005 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2005 <> '' and l.ammopisktunn2005 <> '' and
	l.amkopisktunn2005 = '' and l.yoopisktunn2005 = '' then l.ammopisktunn2005 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2005  <> '' and l.yoopisktunn2005  = '' and
	l.luopisktunn2005 = '' and l.ammopisktunn2005 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2005 = '' and l.yoopisktunn2005 <> '' and 
	l.luopisktunn2005 = '' and l.ammopisktunn2005  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2005 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2005 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2005 <> '' and l.yoopisktunn2005  <> '' and
	l.luopisktunn2005 = '' and l.ammopisktunn2005 = ''  then l.yoopisktunn2005 
	
		-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 = '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2006 = '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 ='' and yoopisktunn2006 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then l.ammopisktunn2006 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2006  <> '' and l.yoopisktunn2006  = '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2006 = '' and l.yoopisktunn2006 <> '' and 
	l.luopisktunn2006 = '' and l.ammopisktunn2006  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2005 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2005 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2006 <> '' and l.yoopisktunn2006  <> '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = ''  then l.yoopisktunn2006 
	
	
    -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 = '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2007 = '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 ='' and yoopisktunn2007 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.ammopisktunn2007 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2005
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2007  <> '' and l.yoopisktunn2007  = '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2005
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2007 = '' and l.yoopisktunn2007 <> '' and 
	l.luopisktunn2007 = '' and l.ammopisktunn2007  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2005 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2005 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2007 <> '' and l.yoopisktunn2007  <> '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''  then l.yoopisktunn2007 
	
	 -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2006
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and yoopisktunn2008 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2006
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.ammopisktunn2008 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2005
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2005
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2005 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2005 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.yoopisktunn2008 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2006
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and yoopisktunn2009 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2006
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.ammopisktunn2009 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2005
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2005 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2005 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.yoopisktunn2009 

		-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2006
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and yoopisktunn2010 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2006
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.ammopisktunn2010 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2005
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2005 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2005 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.yoopisktunn2010

	else ''
	    end),
	    
	-- Koulutuksen järjestäjä 2
	(case
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2005  <> '' and l.ammopiskjarj2005 = '' and
	l.amkopiskjarj2005 = '' and l.yoopiskjarj2005 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2005 = '' and l.ammopiskjarj2005 <> '' and
	l.amkopiskjarj2005 ='' and l.yoopiskjarj2005 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2005 <> '' and l.ammopiskjarj2005 <> '' and
	l.amkopiskjarj2005 = '' and l.yoopiskjarj2005 = '' then l.ammopiskjarj2005 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2005  <> '' and l.yoopiskjarj2005   = '' and
	l.luopiskjarj2005 = '' and l.ammopiskjarj2005 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2005  = '' and l.yoopiskjarj2005  <> '' and 
	l.luopiskjarj2005  = '' and l.ammopiskjarj2005 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2005  <> '' and l.yoopiskjarj2005   <> '' and
	l.luopiskjarj2005  = '' and l.ammopiskjarj2005  = ''  then l.yoopiskjarj2005 
	
	
		-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2006  <> '' and l.ammopiskjarj2006 = '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2006 = '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 ='' and l.yoopiskjarj2006 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2006 <> '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then l.ammopiskjarj2006 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   = '' and
	l.luopiskjarj2006 = '' and l.ammopiskjarj2006 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2005
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2006  = '' and l.yoopiskjarj2006  <> '' and 
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2005
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006  <> '' and
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006  = ''  then l.yoopiskjarj2006 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2007  <> '' and l.ammopiskjarj2007 = '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2007 = '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 ='' and l.yoopiskjarj2007 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2007 <> '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.ammopiskjarj2007 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskjarj2007 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2005
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2007  = '' and l.yoopiskjarj2007  <> '' and 
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2005
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007  <> '' and
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007 = ''  then l.yoopiskjarj2007 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008 = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and l.yoopiskjarj2008 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.ammopiskjarj2008 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2006
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2005
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2005
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008  <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''  then l.yoopiskjarj2008 

		-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and l.yoopiskjarj2009 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.ammopiskjarj2009 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2006
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2005
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2005
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009  <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''  then l.yoopiskjarj2009 
	

	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and l.yoopiskjarj2010 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.ammopiskjarj2010 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2006
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2005
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2005
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010  <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''  then l.yoopiskjarj2010 
	
	else ''
	    end),
	    
	-- Maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta 2005, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2005   <> '' and l.ammopiskmaak2005  = '' and
	l.amkopiskmaak2005  = '' and yoopiskmaak2005  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2005, merkitään tyhjäksi   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2005  = '' and l.ammopiskmaak2005  <> '' and
	l.amkopiskmaak2005  ='' and l.yoopiskmaak2005  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2005, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2005  <> '' and l.ammopiskmaak2005  <> '' and
	l.amkopiskmaak2005  = '' and l.yoopiskmaak2005  = '' then l.ammopiskmaak2005 
	-- vain ammattikorkeakoulutuksen maakunta 2005, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2005   <> '' and l.yoopiskmaak2005   = '' and
	l.luopiskmaak2005 = '' and l.ammopiskmaak2005 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2005, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2005  = '' and l.yoopiskmaak2005  <> '' and 
	l.luopiskmaak2005  = '' and l.ammopiskmaak2005 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2005, merkitään yliopistokoulutuksen 2005 maakunta 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2005  <> '' and l.yoopiskmaak2005   <> '' and
	l.luopiskmaak2005  = '' and l.ammopiskmaak2005  = ''  then l.yoopiskmaak2005  
	
	
		-- vain lukiokoulutuksen maakunta 2006, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2006  <> '' and l.ammopiskmaak2006  = '' and
	l.amkopiskmaak2006  = '' and yoopiskmaak2006  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2005, merkitään tyhjäksi   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2006  = '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  ='' and l.yoopiskmaak2006 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2006, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2006  <> '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = '' then l.ammopiskmaak2006 
	-- vain ammattikorkeakoulutuksen maakunta 2006, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2006   <> '' and l.yoopiskmaak2006   = '' and
	l.luopiskmaak2006 = '' and l.ammopiskmaak2006 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2006, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  <> '' and 
	l.luopiskmaak2006  = '' and l.ammopiskmaak2006 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2006, merkitään yliopistokoulutuksen 2005 maakunta 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2006  <> '' and l.yoopiskmaak2006   <> '' and
	l.luopiskmaak2006  = '' and l.ammopiskmaak2006  = ''  then l.yoopiskmaak2006  
	
	
	-- vain lukiokoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2007  <> '' and l.ammopiskmaak2007  = '' and
	l.amkopiskmaak2007  = '' and yoopiskmaak2007  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2007, merkitään tyhjäksi   
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2007  = '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  ='' and l.yoopiskmaak2007 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2007, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2007  <> '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.ammopiskmaak2007 
	-- vain ammattikorkeakoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2007   <> '' and l.yoopiskmaak2007   = '' and
	l.luopiskmaak2007 = '' and l.ammopiskmaak2007 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  <> '' and 
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2007, merkitään yliopistokoulutuksen 2007 maakunta 
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2007  <> '' and l.yoopiskmaak2007   <> '' and
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007  = ''  then l.yoopiskmaak2007  
	
	-- vain lukiokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and yoopiskmaak2008  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2008, merkitään tyhjäksi   
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  ='' and l.yoopiskmaak2008 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2008, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.ammopiskmaak2008 
	-- vain ammattikorkeakoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2008, merkitään yliopistokoulutuksen 2008 maakunta 
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008  = ''  then l.yoopiskmaak2008  

    	-- vain lukiokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and yoopiskmaak2009  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2009, merkitään tyhjäksi   
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2009, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.ammopiskmaak2009 
	-- vain ammattikorkeakoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2009, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.yoopiskmaak2009  


		-- vain lukiokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and yoopiskmaak2010  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2010, merkitään tyhjäksi   
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2010, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.ammopiskmaak2010 
	-- vain ammattikorkeakoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2010, merkitään yliopistokoulutuksen 2010 maakunta 
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.yoopiskmaak2010 

	else ''
	    end),
	-- Monihaku
	(case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.monihaku2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.monihaku2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.monihaku2007
    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.monihaku2008
	 when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.monihaku2009
	 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.monihaku2010
	else '8'
	end),
	-- Pääasiallinen toiminta
    (case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2005 
    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2006 
    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2007 
    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2008
	 when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2009
	  when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2010

	else ''
	end),
	-- Ammattiasema
	(case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.amas_2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.amas_2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.amas_2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.amas_2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.amas_2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.amas_2010

	else ''
	end),
 l.lkm,
 l.pohjkoul,
 l.tietolahde,
 'K3.13',
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 = '' and l.amkopiskkoulk2005 = '' and
	    l.yoopiskkoulk2005 = ''  then  '1'  
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and l.amkopiskkoulk2006 = '' and
	    l.yoopiskkoulk2006 = ''   then '1'  
	     when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and
	    l.yoopiskkoulk2007 = ''   then '1'  
	     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and
	    l.yoopiskkoulk2008 = ''   then '1'  
		    when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009= ''   then '1'  
		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010= ''   then '1'  
	    else '0'
	    end) as lukiokoulutuksessa,
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2005 <> '' and l.luopiskkoulk2005 = '' and l.amkopiskkoulk2005 = '' and
	    l.yoopiskkoulk2005 = ''  then '1'   
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2006 <> '' and l.luopiskkoulk2006 = '' and l.amkopiskkoulk2006 = '' and
	    l.yoopiskkoulk2006 = ''  then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2007 <> '' and l.luopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and
	    l.yoopiskkoulk2007 = '' then '1'  
	     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2008 <> '' and l.luopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and
	    l.yoopiskkoulk2008 = '' then '1'  
		  when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = '' then '1' 
		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2010 <> '' and l.luopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = '' then '1'  
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
 (case  
	   when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2005 <> '' and l.ammopiskkoulk2005 = '' and l.luopiskkoulk2005 = '' and
	   l.yoopiskkoulk2005 = ''  then  '1'
	   when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and l.luopiskkoulk2006 = '' and
	   l.yoopiskkoulk2006 = ''  then  '1'
	   when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and l.luopiskkoulk2007 = '' and
	   l.yoopiskkoulk2007 = ''  then  '1'
	    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' and
	   l.yoopiskkoulk2008 = ''  then  '1'
	    when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and
	   l.yoopiskkoulk2009 = ''  then  '1'
	    when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and
	   l.yoopiskkoulk2010 = ''  then  '1' 
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and  l.yoopiskkoulk2005 <> '' and l.amkopiskkoulk2005 = '' and l.luopiskkoulk2005 = '' and 
	    l.ammopiskkoulk2005 = ''  then '1'  
	    when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and  l.yoopiskkoulk2006 <> '' and l.amkopiskkoulk2006 = '' and l.luopiskkoulk2006 = '' and 
	    l.ammopiskkoulk2006 = ''  then '1' 
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2007 <> '' and l.amkopiskkoulk2007 = '' and l.luopiskkoulk2007 = '' and 
	    l.ammopiskkoulk2007 = ''  then '1' 
	     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' and 
	    l.ammopiskkoulk2008 = ''  then '1' 
		 when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and 
	    l.ammopiskkoulk2009 = ''  then '1' 
		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and 
	    l.ammopiskkoulk2010 = ''  then '1' 
	

	    else '0'
	    end) as yliopistokoulutuksessa,

(case

	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 <> '' and l.amkopiskkoulk2005 = '' and
	    l.yoopiskkoulk2005 = '' then '1'  
	    
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 <> '' and l.amkopiskkoulk2006 = '' and
	    l.yoopiskkoulk2006 = ''  then '1' 
	    
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and l.amkopiskkoulk2007 = '' and
	    l.yoopiskkoulk2007 = ''  then '1' 
	    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and
	    l.yoopiskkoulk2008 = ''  then '1' 
		 when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = ''  then '1' 
		when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = ''  then '1' 
	    
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2'and  l.ammopiskkoulk2005 <> '' and l.amkopiskkoulk2005 <> '' and l.luopiskkoulk2005 = '' and
	    l.yoopiskkoulk2005 = ''  then '1' 
	     
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2006 <> '' and l.amkopiskkoulk2006 <> '' and l.luopiskkoulk2006 = '' and
	    l.yoopiskkoulk2006 = '' then '1' 
	    
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2007 <> '' and l.amkopiskkoulk2007 <> '' and l.luopiskkoulk2007 = '' and
	    l.yoopiskkoulk2007 = '' then '1' 
	    
	     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 <> '' and l.luopiskkoulk2008 = '' and
	    l.yoopiskkoulk2008 = '' then '1' 

		   when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = '' then '1' 
		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 <> '' and l.luopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = '' then '1' 
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2005 <> '' and l.yoopiskkoulk2005 <> '' and l.luopiskkoulk2005 = '' and
	    l.ammopiskkoulk2005 = ''  then '1'  
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2006 <> '' and l.yoopiskkoulk2006 <> '' and l.luopiskkoulk2006 = '' and
	    l.ammopiskkoulk2006 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007 <> '' and l.luopiskkoulk2007 = '' and
	    l.ammopiskkoulk2007 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008 <> '' and l.luopiskkoulk2008 = '' and
	    l.ammopiskkoulk2008 = '' then '1'  
         when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and
	    l.ammopiskkoulk2009 = '' then '1'
		when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010 <> '' and l.luopiskkoulk2010 = '' and
	    l.ammopiskkoulk2010 = '' then '1'
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
(case
	   --Tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and (l.ptoim1r4_2005 = '22' or l.ptoim1r4_2005 ='13') 
	   and (l.luopiskkoulk2005 <> '' or l.ammopiskkoulk2005<>'' or l.amkopiskkoulk2005 <> '' or l.yoopiskkoulk2005<>'') then '1' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2006 = '22' or l.ptoim1r4_2006 = '13') 
	   and (l.luopiskkoulk2006 <> '' or l.ammopiskkoulk2006<>'' or l.amkopiskkoulk2006 <> '' or l.yoopiskkoulk2006<>'') then '1'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2007 = '22' or l.ptoim1r4_2007 = '13') 
	   and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007<>'' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007<>'') then '1' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 = '13') 
	   and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008<>'' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008<>'') then '1' 
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13') 
	   and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009<>'' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009<>'') then '1' 
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13') 
	   and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010<>'' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010<>'') then '1'  
	   
	   
	  -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and (l.ptoim1r4_2005 = '22' or l.ptoim1r4_2005 ='13') 
	   and (l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005='' and l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005='')	 then '2' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2006 = '22' or l.ptoim1r4_2006 = '13') 
	   and (l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006='' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006='')	 then '2'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2007 = '22' or l.ptoim1r4_2007 = '13') 
	   and (l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007='' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007='')	  then '2' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 = '13') 
	   and (l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008='' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008='')	  then '2'
	     when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13') 
	   and (l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009='' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009='')	  then '2'
	      when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13') 
	   and (l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010='' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010='')	  then '2'
  
	  -- Ei opiskelevat työlliset
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2')and l.ptoim1r4_2005 = '10' then '3'
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and  l.ptoim1r4_2006 = '10' then '3'     
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2007 = '10'  then '3' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2008 = '10'  then '3' 
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2009 = '10'  then '3'
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2010 = '10'  then '3'  
	  -- Ei opiskelevat työttömät 
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2005 = '12'  then '4' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and  l.ptoim1r4_2006 = '12'  then '4'
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2007 = '12'  then '4'  
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2008 = '12'  then '4' 
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2009 = '12'  then '4' 
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2010 = '12'  then '4'

	   
	   -- Ei opiskelevat muut
      else '5'
         end)as koulutuksen_paattaneiden_toiminta
	  ,ika_1v = cast((case 
            when syntv = '' then '-1' 
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
     ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))
	     

FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where (suorv = '2004' or suorv = '2005' or suorv = '2006' or suorv = '2007' or suorv= '2008' or suorv = '2009') and suorlk = '2'
	
	) as l
	
	
	WHERE 1=1
end;

--
-- TULOS
-- 
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_0_valittomasti_tarkastelujakso]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_0_valittomasti_tarkastelujakso]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_0_valittomasti_tarkastelujakso] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_0_valittomasti_tarkastelujakso] AS
declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;


set @ensimmainen_suoritusvuosi = 2004;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;



INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
,lkm
,pohjkoulk
,tietolahde
, aineisto
 ,lukiokoulutuksessa
 ,ammatillisessa_koulutuksessa
 ,ammattikorkeakoulutuksessa
 ,yliopistokoulutuksessa
 ,lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
 ,toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
 ,ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
 ,koulutuksen_paattaneiden_toiminta
 ,ika_1v
 ,ika_5v
)
SELECT
 l.rivinumero,
 '0',
 l.tilv,
 l.tilv_date,
 l.tutkryh,
 l.suorv,
  (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2004 <> '' and l.ammopiskkoulk2004 = '' and
	l.amkopiskkoulk2004 = '' and l.yoopiskkoulk2004 = '' then l.luopiskkoulk2004 
	-- ammattikoulutuksessa 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2004 = '' and l.ammopiskkoulk2004 <> '' and
	l.amkopiskkoulk2004 ='' and l.yoopiskkoulk2004 = ''  then l.ammopiskkoulk2004 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2004 ensim. koulutustietoihin
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2004 <> '' and l.ammopiskkoulk2004 <> '' and
	l.amkopiskkoulk2004 = '' and l.yoopiskkoulk2004 = '' then l.luopiskkoulk2004
	-- ammattikorkeakoulutuksessa 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2004  <> '' and l.yoopiskkoulk2004  = '' and
	l.luopiskkoulk2004 = '' and l.ammopiskkoulk2004 = '' then l.amkopiskkoulk2004
	-- yliopistokoulutuksessa 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2004 = '' and l.yoopiskkoulk2004 <> '' and 
	l.luopiskkoulk2004 = '' and l.ammopiskkoulk2004 = ''   then l.yoopiskkoulk2004
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2004 <> '' and l.yoopiskkoulk2004  <> '' and
	l.luopiskkoulk2004 = '' and ammopiskkoulk2004 = ''  then l.amkopiskkoulk2004 
	
	
	-- lukiokoulutuksessa 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 = '' and
	l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then l.luopiskkoulk2005
	-- ammatillisessa koulutuksessa 2005 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 <> '' and
	l.amkopiskkoulk2005 ='' and l.yoopiskkoulk2005 = ''  then l.ammopiskkoulk2005 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2005 ensimäisiin koulutustietoihin
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 <> '' and
	l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then l.luopiskkoulk2005
	-- ammattikorkeakoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2005  <> '' and l.yoopiskkoulk2005  = '' and
	l.luopiskkoulk2005  = '' and l.ammopiskkoulk2005 = '' then l.amkopiskkoulk2005
	-- yliopistokoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 <> '' and 
	l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = ''   then l.yoopiskkoulk2005 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2005 <> '' and l.yoopiskkoulk2005  <> '' and
	l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = ''  then l.amkopiskkoulk2005 
	
	
	-- lukiokoulutuksessa 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then l.luopiskkoulk2006
	-- ammatillisessa koulutuksessa 2006 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 ='' and l.yoopiskkoulk2006 = ''  then l.ammopiskkoulk2006 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2006 ensimäisiin koulutustietoihin
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then l.luopiskkoulk2006
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006  <> '' and l.yoopiskkoulk2006  = '' and
	l.luopiskkoulk2006  = '' and l.ammopiskkoulk2006 = '' then l.amkopiskkoulk2006
	-- yliopistokoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 <> '' and 
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''   then l.yoopiskkoulk2006 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006 <> '' and l.yoopiskkoulk2006  <> '' and
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''  then l.amkopiskkoulk2006 
	
	
	-- lukiokoulutuksessa 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.luopiskkoulk2007
	-- ammatillisessa koulutuksessa 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 ='' and l.yoopiskkoulk2007 = ''  then l.ammopiskkoulk2007 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2007 ensimäisiin koulutustietoihin
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.luopiskkoulk2007
	-- ammattikorkeakoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007  <> '' and l.yoopiskkoulk2007  = '' and
	l.luopiskkoulk2007  = '' and l.ammopiskkoulk2007 = '' then l.amkopiskkoulk2007
	-- yliopistokoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 <> '' and 
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''   then l.yoopiskkoulk2007
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007  <> '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''  then l.amkopiskkoulk2007 

	-- lukiokoulutuksessa 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammatillisessa koulutuksessa 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then l.ammopiskkoulk2008 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2008 ensimäisiin koulutustietoihin
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammattikorkeakoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008  = '' and l.ammopiskkoulk2008 = '' then l.amkopiskkoulk2008
	-- yliopistokoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then l.yoopiskkoulk2008
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.amkopiskkoulk2008 
    	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> ''  then l.ammopiskkoulk2008 
	
	-- lukiokoulutuksessa 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammatillisessa koulutuksessa 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then l.ammopiskkoulk2009 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2009 ensimäisiin koulutustietoihin
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009  = '' and l.ammopiskkoulk2009 = '' then l.amkopiskkoulk2009
	-- yliopistokoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then l.yoopiskkoulk2009
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.amkopiskkoulk2009 
    	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> ''  then l.ammopiskkoulk2009 
	else ''
	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2004 <> '' and l.ammopisktunn2004 = '' and
	l.amkopisktunn2004 = '' and l.yoopisktunn2004 = '' then l.luopisktunn2004 
	-- ammattikoulutuksen oppilaitos 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2004 = '' and l.ammopisktunn2004 <> '' and
	l.amkopisktunn2004 ='' and l.yoopisktunn2004 = ''  then l.ammopisktunn2004 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2004 <> '' and l.ammopisktunn2004 <> '' and
	l.amkopisktunn2004 = '' and l.yoopisktunn2004 = '' then l.luopisktunn2004
	-- ammattikorkeakoulutuksen oppilaitos 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2004  <> '' and l.yoopisktunn2004  = '' and
	l.luopisktunn2004 = '' and l.ammopisktunn2004 = '' then l.amkopisktunn2004
	-- yliopistokoulutuksen oppilaitos 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2004 = '' and l.yoopisktunn2004 <> '' and 
	l.luopisktunn2004 = '' and l.ammopisktunn2004 = ''   then l.yoopisktunn2004
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2004  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2004 <> '' and l.yoopisktunn2004  <> '' and
	l.luopisktunn2004 = '' and l.ammopisktunn2004 = ''  then l.amkopisktunn2004 
	
	
	-- lukiokoulutuksen oppilaitos 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2005 <> '' and l.ammopisktunn2005 = '' and
	l.amkopisktunn2005 = '' and l.yoopisktunn2005 = '' then l.luopisktunn2005
	-- ammatillisen koulutuksen oppilaitos 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2005 = '' and l.ammopisktunn2005 <> '' and
	l.amkopisktunn2005 ='' and l.yoopisktunn2005 = ''  then l.ammopisktunn2005
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2005 <> '' and l.ammopisktunn2005 <> '' and
	l.amkopisktunn2005 = '' and l.yoopisktunn2005 = '' then l.luopisktunn2005
	-- ammattikorkeakoulutuksen oppilaitos 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2005  <> '' and l.yoopisktunn2005  = '' and
	l.luopisktunn2005 = '' and l.ammopisktunn2005 = '' then l.amkopisktunn2005
	-- yliopistokoulutuksen oppilaitos 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2005 = '' and l.yoopisktunn2005 <> '' and 
	l.luopisktunn2005 = '' and l.ammopisktunn2005 = ''   then l.yoopisktunn2005  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2005  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2005 <> '' and l.yoopisktunn2005  <> '' and
	l.luopisktunn2005 = '' and l.ammopisktunn2005 = ''  then l.amkopisktunn2005 
	
	-- lukiokoulutuksen oppilaitos 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 = '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then l.luopisktunn2006
	-- ammatillisen koulutuksen oppilaitos 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 = '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 ='' and l.yoopisktunn2006 = ''  then l.ammopisktunn2006
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2005
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then l.luopisktunn2006
	-- ammattikorkeakoulutuksen oppilaitos 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006  <> '' and l.yoopisktunn2006  = '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = '' then l.amkopisktunn2006
	-- yliopistokoulutuksen oppilaitos 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006 = '' and l.yoopisktunn2006 <> '' and 
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = ''   then l.yoopisktunn2006 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2005  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006 <> '' and l.yoopisktunn2006  <> '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = ''  then l.amkopisktunn2006
	
	
	-- lukiokoulutuksen oppilaitos 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 = '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.luopisktunn2007
	-- ammatillisen koulutuksen oppilaitos 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 = '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 ='' and l.yoopisktunn2007 = ''  then l.ammopisktunn2007
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2005
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.luopisktunn2007
	-- ammattikorkeakoulutuksen oppilaitos 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007  <> '' and l.yoopisktunn2007  = '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = '' then l.amkopisktunn2007
	-- yliopistokoulutuksen oppilaitos 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007 = '' and l.yoopisktunn2007 <> '' and 
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''   then l.yoopisktunn2007
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2007  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007 <> '' and l.yoopisktunn2007  <> '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''  then l.amkopisktunn2007


	-- lukiokoulutuksen oppilaitos 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammatillisen koulutuksen oppilaitos 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and l.yoopisktunn2008 = ''  then l.ammopisktunn2008
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2005
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammattikorkeakoulutuksen oppilaitos 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then l.amkopisktunn2008
	-- yliopistokoulutuksen oppilaitos 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''   then l.yoopisktunn2008
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2008  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.amkopisktunn2008

	-- lukiokoulutuksen oppilaitos 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammatillisen koulutuksen oppilaitos 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and l.yoopisktunn2009 = ''  then l.ammopisktunn2009
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2005
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammattikorkeakoulutuksen oppilaitos 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then l.amkopisktunn2009
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''   then l.yoopisktunn2009
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.amkopisktunn2009

	
	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2004  <> '' and l.ammopiskjarj2004 = '' and
	l.amkopiskjarj2004 = '' and yoopiskjarj2004 = '' then l.luopiskjarj2004
	-- ammatillisen koulutuksen järjestäjä 2004  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2004 = '' and l.ammopiskjarj2004 <> '' and
	l.amkopiskjarj2004 ='' and l.yoopiskjarj2004 = ''  then l.ammopiskjarj2004
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen 2004 järjestäjä 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2004 <> '' and l.ammopiskjarj2004 <> '' and
	l.amkopiskjarj2004 = '' and l.yoopiskjarj2004 = '' then l.luopiskjarj2004
	-- ammattikorkeakoulutuksen järjestäjä 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2004  <> '' and l.yoopiskjarj2004   = '' and
	l.luopiskjarj2004 = '' and l.ammopiskjarj2004 = '' then l.amkopiskjarj2004
	-- yliopistokoulutuksen järjestäjä 2004 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2004  = '' and l.yoopiskjarj2004  <> '' and 
	l.luopiskjarj2004  = '' and l.ammopiskjarj2004 = ''   then l.yoopiskjarj2004
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen 2004 järjestäjä   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2004  <> '' and l.yoopiskjarj2004   <> '' and
	l.luopiskjarj2004  = '' and l.ammopiskjarj2004  = ''  then l.amkopiskjarj2004 

	
	-- lukiokoulutuksen järjestäjä 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2005  <> '' and l.ammopiskjarj2005  = '' and
	l.amkopiskjarj2005 = '' and l.yoopiskjarj2005 = '' then l.luopiskjarj2005  
	-- ammatillisen koulutuksen järjestäjä 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2005 = '' and l.ammopiskjarj2005 <> '' and
	l.amkopiskjarj2005 ='' and yoopiskjarj2005 = ''  then l.ammopiskjarj2005 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2005, merkitään lukiokoulutuksen 2005 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2005 <> '' and l.ammopiskjarj2005 <> '' and
	l.amkopiskjarj2005 = '' and l.yoopiskjarj2005 = '' then l.luopiskjarj2005
	-- ammattikorkeakoulutuksen 2005 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2005  <> '' and l.yoopiskjarj2005   = '' and
	l.luopiskjarj2005 = '' and l.ammopiskjarj2005 = '' then l.amkopiskjarj2005 
	-- yliopistokoulutuksen 2005 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2005  = '' and l.yoopiskjarj2005  <> '' and 
	l.luopiskjarj2005  = '' and l.ammopiskjarj2005 = ''   then l.yoopiskjarj2005
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2005, merkitään ammattikorkekoulutuksen järjestäjä 2005   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2005  <> '' and l.yoopiskjarj2005   <> '' and
	l.luopiskjarj2005  = '' and l.ammopiskjarj2005  = ''  then l.amkopiskjarj2005 
	
	-- lukiokoulutuksen järjestäjä 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006  <> '' and l.ammopiskjarj2006 = '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then l.luopiskjarj2006 
	-- ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006 = '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 ='' and yoopiskjarj2006 = ''  then l.ammopiskjarj2006 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2005, merkitään lukiokoulutuksen 2006 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006 <> '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then l.luopiskjarj2006
	-- ammattikorkeakoulutuksen 2006 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   = '' and
	l.luopiskjarj2006 = '' and l.ammopiskjarj2006 = '' then l.amkopiskjarj2006 
	-- yliopistokoulutuksen 2005 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  = '' and l.yoopiskjarj2006  <> '' and 
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006 = ''   then l.yoopiskjarj2006
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2005, merkitään ammattikorkekoulutuksen järjestäjä 2005   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   <> '' and
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006  = ''  then l.amkopiskjarj2006 
	
	--lukiokoulutuksen järjestäjä 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007  <> '' and l.ammopiskjarj2007 = '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.luopiskjarj2007 
	-- ammatillisen koulutuksen järjestäjä 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007 = '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 ='' and yoopiskjarj2007 = ''  then l.ammopiskjarj2007 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2005, merkitään lukiokoulutuksen 2007 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007 <> '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.luopiskjarj2007
	-- ammattikorkeakoulutuksen 2007 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskjarj2007 = '' then l.amkopiskjarj2007 
	-- yliopistokoulutuksen 2005 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  = '' and l.yoopiskjarj2007  <> '' and 
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007 = ''   then l.yoopiskjarj2007
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2005, merkitään ammattikorkekoulutuksen järjestäjä 2005   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   <> '' and
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007  = ''  then l.amkopiskjarj2007 

	--lukiokoulutuksen järjestäjä 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008 = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008 
	-- ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and yoopiskjarj2008 = ''  then l.ammopiskjarj2008 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2005, merkitään lukiokoulutuksen 2008 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008
	-- ammattikorkeakoulutuksen 2008 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then l.amkopiskjarj2008 
	-- yliopistokoulutuksen 2008 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then l.yoopiskjarj2008
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2005, merkitään ammattikorkekoulutuksen järjestäjä 2005   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.amkopiskjarj2008 


	--lukiokoulutuksen järjestäjä 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009 
	-- ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and yoopiskjarj2009 = ''  then l.ammopiskjarj2009 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2005, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009
	-- ammattikorkeakoulutuksen 2009 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then l.amkopiskjarj2009 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then l.yoopiskjarj2009
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2005, merkitään ammattikorkekoulutuksen järjestäjä 2005   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.amkopiskjarj2009 
	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2004   <> '' and l.ammopiskmaak2004  = '' and
	l.amkopiskmaak2004  = '' and l.yoopiskmaak2004  = '' then l.luopiskmaak2004   
	-- ammatillisen koulutuksen maakunta 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2004  = '' and l.ammopiskmaak2004  <> '' and
	l.amkopiskmaak2004  ='' and l.yoopiskmaak2004  = ''  then l.ammopiskmaak2004  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2004  <> '' and l.ammopiskmaak2004  <> '' and
	l.amkopiskmaak2004  = '' and l.yoopiskmaak2004  = '' then l.luopiskmaak2004 
    -- ammattikorkeakoulutuksen maakunta 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2004   <> '' and l.yoopiskmaak2004   = '' and
	l.luopiskjarj2004 = '' and l.ammopiskmaak2004 = '' then l.amkopiskmaak2004
	-- yliopistokoulutuksen maakunta 2004 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2004  = '' and l.yoopiskmaak2004  <> '' and 
	l.luopiskjarj2004  = '' and l.ammopiskmaak2004 = ''   then l.yoopiskmaak2004
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta 2004   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2004  <> '' and l.yoopiskmaak2004   <> '' and
	l.luopiskjarj2004  = '' and l.ammopiskmaak2004  = ''  then l.amkopiskmaak2004 
	
	
	-- lukioopiskelun maakunta 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2005   <> '' and l.ammopiskmaak2005  = '' and
	l.amkopiskmaak2005  = '' and l.yoopiskmaak2005  = '' then l.luopiskmaak2005
	-- ammatillisen koulutksen maakunta 2005    
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2005  = '' and l.ammopiskmaak2005  <> '' and
	l.amkopiskmaak2005  ='' and l.yoopiskmaak2005  = ''  then l.ammopiskmaak2005
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2005  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2005  <> '' and l.ammopiskmaak2005  <> '' and
	l.amkopiskmaak2005  = '' and l.yoopiskmaak2005  = '' then l.luopiskmaak2005 
	-- ammattikorkekoulutuksen maakunta 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2005   <> '' and l.yoopiskmaak2005   = '' and
	l.luopiskmaak2005 = '' and l.ammopiskmaak2005 = '' then l.amkopiskmaak2005
	-- yliopistokoulutuksen maakunta 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2005  = '' and l.yoopiskmaak2005  <> '' and 
	l.luopiskmaak2005  = '' and l.ammopiskmaak2005 = ''   then l.yoopiskmaak2005
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2005, otetaan talteen ammattikorkekoulutksen maakunta 2005   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2005  <> '' and l.yoopiskmaak2005   <> '' and
	l.luopiskmaak2005  = '' and l.ammopiskmaak2005  = ''  then l.amkopiskmaak2005 
	
    -- lukioopiskelun maakunta 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006   <> '' and l.ammopiskmaak2006  = '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = '' then l.luopiskmaak2006
	-- ammatillisen koulutksen maakunta 2006    
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006  = '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  ='' and l.yoopiskmaak2006  = ''  then l.ammopiskmaak2006
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2005  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006  <> '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = '' then l.luopiskmaak2006 
	-- ammattikorkekoulutuksen maakunta 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006   <> '' and l.yoopiskmaak2006   = '' and
	l.luopiskjarj2006 = '' and l.ammopiskmaak2006 = '' then l.amkopiskmaak2006
	-- yliopistokoulutuksen maakunta 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  <> '' and 
	l.luopiskjarj2006  = '' and l.ammopiskmaak2006 = ''   then l.yoopiskmaak2006
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2005, otetaan talteen ammattikorkekoulutksen maakunta 2005   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006  <> '' and l.yoopiskmaak2006   <> '' and
	l.luopiskmaak2006  = '' and l.ammopiskmaak2006  = ''  then l.amkopiskmaak2006 
	
	 -- lukioopiskelun maakunta 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007   <> '' and l.ammopiskmaak2007  = '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.luopiskmaak2007
	-- ammatillisen koulutksen maakunta 2007    
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007  = '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  ='' and l.yoopiskmaak2007  = ''  then l.ammopiskmaak2007
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2005  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007  <> '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.luopiskmaak2007 
	-- ammattikorkekoulutuksen maakunta 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007   <> '' and l.yoopiskmaak2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskmaak2007 = '' then l.amkopiskmaak2007
	-- yliopistokoulutuksen maakunta 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  <> '' and 
	l.luopiskjarj2007  = '' and l.ammopiskmaak2007 = ''   then l.yoopiskmaak2007
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2005, otetaan talteen ammattikorkekoulutksen maakunta 2005   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007  <> '' and l.yoopiskmaak2007   <> '' and
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007  = ''  then l.amkopiskmaak2007 

	 -- lukioopiskelun maakunta 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008
	-- ammatillisen koulutksen maakunta 2008    
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  ='' and l.yoopiskmaak2008  = ''  then l.ammopiskmaak2008
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2008 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008 
	-- ammattikorkekoulutuksen maakunta 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskmaak2008 = '' then l.amkopiskmaak2008
	-- yliopistokoulutuksen maakunta 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskmaak2008 = ''   then l.yoopiskmaak2008
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2008, otetaan talteen ammattikorkekoulutksen maakunta 2008   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008  = ''  then l.amkopiskmaak2008 

	 -- lukioopiskelun maakunta 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009
	-- ammatillisen koulutksen maakunta 2009    
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then l.ammopiskmaak2009
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009 
	-- ammattikorkekoulutuksen maakunta 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskmaak2009 = '' then l.amkopiskmaak2009
	-- yliopistokoulutuksen maakunta 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskmaak2009 = ''   then l.yoopiskmaak2009
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2009   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.amkopiskmaak2009 
	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2004 <> '' and l.ammopiskkoulk2004 = '' and
	l.amkopiskkoulk2004 = '' and l.yoopiskkoulk2004 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi 2004 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2004 = '' and l.ammopiskkoulk2004 <> '' and
	l.amkopiskkoulk2004 ='' and l.yoopiskkoulk2004 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus 2004 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2004 <> '' and l.ammopiskkoulk2004 <> '' and
	l.amkopiskkoulk2004 = '' and l.yoopiskkoulk2004 = '' then l.ammopiskkoulk2004 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2004  <> '' and l.yoopiskkoulk2004  = '' and
	l.luopiskkoulk2004 = '' and l.ammopiskkoulk2004 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2004 = '' and l.yoopiskkoulk2004 <> '' and 
	l.luopiskkoulk2004 = '' and l.ammopiskkoulk2004 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2004 <> '' and l.yoopiskkoulk2004  <> '' and
	l.luopiskkoulk2004 = '' and l.ammopiskkoulk2004 = ''  then l.yoopiskkoulk2004
	
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 = '' and
	l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2005 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 <> '' and
	l.amkopiskkoulk2005 ='' and l.yoopiskkoulk2005 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 <> '' and
	l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then l.ammopiskkoulk2005
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2005  <> '' and l.yoopiskkoulk2005  = '' and
	l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 <> '' and 
	l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2005 <> '' and l.yoopiskkoulk2005  <> '' and
	l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = ''  then l.yoopiskkoulk2005   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 ='' and l.yoopiskkoulk2006 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then l.ammopiskkoulk2006
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006  <> '' and l.yoopiskkoulk2006  = '' and
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 <> '' and 
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006 <> '' and l.yoopiskkoulk2006  <> '' and
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''  then l.yoopiskkoulk2006 
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 ='' and l.yoopiskkoulk2007 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.ammopiskkoulk2007
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007  <> '' and l.yoopiskkoulk2007  = '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 <> '' and 
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007  <> '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''  then l.yoopiskkoulk2007     

	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.ammopiskkoulk2008
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.yoopiskkoulk2008     

	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.ammopiskkoulk2009
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.yoopiskkoulk2009 
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2004 <> '' and l.ammopisktunn2004 = '' and
	l.amkopisktunn2004 = '' and l.yoopisktunn2004 = '' then ''
	-- ammatillisen koulutuksen oppilaitos 2004 merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2004 = '' and l.ammopisktunn2004 <> '' and
	l.amkopisktunn2004 ='' and l.yoopisktunn2004 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2004 <> '' and l.ammopisktunn2004 <> '' and
	l.amkopisktunn2004 = '' and l.yoopisktunn2004 = '' then l.ammopisktunn2004 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2004  <> '' and l.yoopisktunn2004  = '' and
	l.luopisktunn2004 = '' and l.ammopisktunn2004 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2004 = '' and l.yoopisktunn2004 <> '' and 
	l.luopisktunn2004 = '' and l.ammopisktunn2004 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2004 <> '' and l.yoopisktunn2004  <> '' and
	l.luopisktunn2004 = '' and l.ammopisktunn2004 = ''  then l.yoopisktunn2004 
	
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2005 <> '' and l.ammopisktunn2005 = '' and
	l.amkopisktunn2005 = '' and l.yoopisktunn2005 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2005 = '' and l.ammopisktunn2005 <> '' and
	l.amkopisktunn2005 ='' and yoopisktunn2005 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2005 <> '' and l.ammopisktunn2005 <> '' and
	l.amkopisktunn2005 = '' and l.yoopisktunn2005 = '' then l.ammopisktunn2005 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2005  <> '' and l.yoopisktunn2005  = '' and
	l.luopisktunn2005 = '' and l.ammopisktunn2005 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2005 = '' and l.yoopisktunn2005 <> '' and 
	l.luopisktunn2005 = '' and l.ammopisktunn2005  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2005 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2005 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2005 <> '' and l.yoopisktunn2005  <> '' and
	l.luopisktunn2005 = '' and l.ammopisktunn2005 = ''  then l.yoopisktunn2005 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 = '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 = '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 ='' and yoopisktunn2006 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then l.ammopisktunn2006 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006  <> '' and l.yoopisktunn2006  = '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006 = '' and l.yoopisktunn2006 <> '' and 
	l.luopisktunn2006 = '' and l.ammopisktunn2006  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2006 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2005 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006 <> '' and l.yoopisktunn2006  <> '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = ''  then l.yoopisktunn2006 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 = '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 = '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 ='' and yoopisktunn2007 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.ammopisktunn2007 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007  <> '' and l.yoopisktunn2007  = '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007 = '' and l.yoopisktunn2007 <> '' and 
	l.luopisktunn2007 = '' and l.ammopisktunn2007  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2007 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2005 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007 <> '' and l.yoopisktunn2007  <> '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''  then l.yoopisktunn2007 

	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and yoopisktunn2008 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.ammopisktunn2008 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2008 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2005 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.yoopisktunn2008 

	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and yoopisktunn2009 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.ammopisktunn2009 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2005 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.yoopisktunn2009
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain 2004, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2004  <> '' and l.ammopiskjarj2004 = '' and
	l.amkopiskjarj2004 = '' and l.yoopiskjarj2004 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain 2004, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2004 = '' and l.ammopiskjarj2004 <> '' and
	l.amkopiskjarj2004 ='' and l.yoopiskjarj2004 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2004 <> '' and l.ammopiskjarj2004 <> '' and
	l.amkopiskjarj2004 = '' and l.yoopiskjarj2004 = '' then l.ammopiskjarj2004 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2004  <> '' and l.yoopiskjarj2004   = '' and
	l.luopiskjarj2004 = '' and l.ammopiskjarj2004 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2004  = '' and l.yoopiskjarj2004  <> '' and 
	l.luopiskjarj2004  = '' and l.ammopiskjarj2004 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2004  <> '' and l.yoopiskjarj2004   <> '' and
	l.luopiskjarj2004  = '' and l.ammopiskjarj2004  = ''  then l.yoopiskjarj2004 
	
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2005  <> '' and l.ammopiskjarj2005 = '' and
	l.amkopiskjarj2005 = '' and l.yoopiskjarj2005 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2005 = '' and l.ammopiskjarj2005 <> '' and
	l.amkopiskjarj2005 ='' and l.yoopiskjarj2005 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2005 <> '' and l.ammopiskjarj2005 <> '' and
	l.amkopiskjarj2005 = '' and l.yoopiskjarj2005 = '' then l.ammopiskjarj2005 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2005  <> '' and l.yoopiskjarj2005   = '' and
	l.luopiskjarj2005 = '' and l.ammopiskjarj2005 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2005  = '' and l.yoopiskjarj2005  <> '' and 
	l.luopiskjarj2005  = '' and l.ammopiskjarj2005 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2005  <> '' and l.yoopiskjarj2005   <> '' and
	l.luopiskjarj2005  = '' and l.ammopiskjarj2005  = ''  then l.yoopiskjarj2005 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006  <> '' and l.ammopiskjarj2006 = '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006 = '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 ='' and l.yoopiskjarj2006 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006 <> '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then l.ammopiskjarj2006 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   = '' and
	l.luopiskjarj2006 = '' and l.ammopiskjarj2006 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  = '' and l.yoopiskjarj2006  <> '' and 
	l.luopiskjarj2006 = '' and l.ammopiskjarj2006 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   <> '' and
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006  = ''  then l.yoopiskjarj2006 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007  <> '' and l.ammopiskjarj2007 = '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007 = '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 ='' and l.yoopiskjarj2007 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007 <> '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.ammopiskjarj2007 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskjarj2007 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  = '' and l.yoopiskjarj2007  <> '' and 
	l.luopiskjarj2007 = '' and l.ammopiskjarj2007 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   <> '' and
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007  = ''  then l.yoopiskjarj2007 

	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008 = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and l.yoopiskjarj2008 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.ammopiskjarj2008 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.yoopiskjarj2008
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and l.yoopiskjarj2009 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.ammopiskjarj2009 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.yoopiskjarj2009  
	
	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta 2004, jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2004   <> '' and l.ammopiskmaak2004  = '' and
	l.amkopiskmaak2004  = '' and l.yoopiskmaak2004  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2004, jätetään tyhjäksi   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2004  = '' and l.ammopiskmaak2004  <> '' and
	l.amkopiskmaak2004  ='' and l.yoopiskmaak2004  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2004  <> '' and l.ammopiskmaak2004  <> '' and
	l.amkopiskmaak2004  = '' and l.yoopiskmaak2004  = '' then l.ammopiskmaak2004 
	-- vain ammattikorkeakoulutuksen maakunta 2004, jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2004   <> '' and l.yoopiskmaak2004   = '' and
	l.luopiskmaak2004 = '' and l.ammopiskmaak2004 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2004, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2004  = '' and l.yoopiskmaak2004  <> '' and 
	l.luopiskmaak2005  = '' and l.ammopiskmaak2004 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2004, merkitään yliopistokoulutuksen maakunta 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2004  <> '' and l.yoopiskmaak2004   <> '' and
	l.luopiskjarj2004  = '' and l.ammopiskmaak2004  = ''  then l.yoopiskmaak2004
	
	
	-- vain lukiokoulutuksen maakunta 2005, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2005   <> '' and l.ammopiskmaak2005  = '' and
	l.amkopiskmaak2005  = '' and yoopiskmaak2005  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2005, merkitään tyhjäksi   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2005  = '' and l.ammopiskmaak2005  <> '' and
	l.amkopiskmaak2005  ='' and l.yoopiskmaak2005  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2005, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2005  <> '' and l.ammopiskmaak2005  <> '' and
	l.amkopiskmaak2005  = '' and l.yoopiskmaak2005  = '' then l.ammopiskmaak2005 
	-- vain ammattikorkeakoulutuksen maakunta 2005, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2005   <> '' and l.yoopiskmaak2005   = '' and
	l.luopiskmaak2005 = '' and l.ammopiskmaak2005 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2005, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2005  = '' and l.yoopiskmaak2005  <> '' and 
	l.luopiskmaak2005  = '' and l.ammopiskmaak2005 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2005, merkitään yliopistokoulutuksen 2005 maakunta 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2005  <> '' and l.yoopiskmaak2005   <> '' and
	l.luopiskmaak2005  = '' and l.ammopiskmaak2005  = ''  then l.yoopiskmaak2005  
	
	
	-- vain lukiokoulutuksen maakunta 2006, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006   <> '' and l.ammopiskmaak2006  = '' and
	l.amkopiskmaak2006  = '' and yoopiskmaak2006  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2006, merkitään tyhjäksi   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006  = '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2006, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006  <> '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = '' then l.ammopiskmaak2006 
	-- vain ammattikorkeakoulutuksen maakunta 2006, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006   <> '' and l.yoopiskmaak2006   = '' and
	l.luopiskmaak2006 = '' and l.ammopiskmaak2006 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2006, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  <> '' and 
	l.luopiskmaak2006  = '' and l.ammopiskmaak2006 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2006, merkitään yliopistokoulutuksen 2005 maakunta 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006  <> '' and l.yoopiskmaak2006   <> '' and
	l.luopiskmaak2006  = '' and l.ammopiskmaak2006  = ''  then l.yoopiskmaak2006  
	
	-- vain lukiokoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007   <> '' and l.ammopiskmaak2007  = '' and
	l.amkopiskmaak2007  = '' and yoopiskmaak2007  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2007, merkitään tyhjäksi   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007  = '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2007, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007  <> '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.ammopiskmaak2007 
	-- vain ammattikorkeakoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007   <> '' and l.yoopiskmaak2007   = '' and
	l.luopiskmaak2007 = '' and l.ammopiskmaak2007 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  <> '' and 
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2007, merkitään yliopistokoulutuksen 2005 maakunta 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007  <> '' and l.yoopiskmaak2007   <> '' and
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007  = ''  then l.yoopiskmaak2007  
	
    -- vain lukiokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and yoopiskmaak2008  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2008, merkitään tyhjäksi   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2008, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.ammopiskmaak2008 
	-- vain ammattikorkeakoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2008, merkitään yliopistokoulutuksen 2005 maakunta 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008  = ''  then l.yoopiskmaak2008  

	-- vain lukiokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and yoopiskmaak2009  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2009, merkitään tyhjäksi   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2009, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.ammopiskmaak2009 
	-- vain ammattikorkeakoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2009, merkitään yliopistokoulutuksen 2005 maakunta 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.yoopiskmaak2009

	else ''
	
	    end),
	-- Monihaku
	(case
	-- 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.monihaku2004
	--2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1'  then l.monihaku2005
	-- 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.monihaku2006
	-- 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.monihaku2007 

	-- 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.monihaku2008

	-- 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.monihaku2009
	
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2004
	-- 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2005 
	-- 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2006
	-- 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2007
	-- 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2008

	-- 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2009
   
	else ''
	end),
	-- Ammattiasema
	(case
	-- 2004
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.amas_2004
	-- 2005
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' then l.amas_2005
	-- 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.amas_2006
	-- 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.amas_2007
	-- 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.amas_2008
	-- 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.amas_2009

	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2004 <> '' and l.ammopiskkoulk2004 = '' and l.yoopiskkoulk2004 = '' and l.amkopiskkoulk2004 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 = '' and l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then '1'  
 	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then '1'  
		 when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then '1'  
	 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1' 
     
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2004  <> '' and l.luopiskkoulk2004 = '' and l.amkopiskkoulk2004 = '' and l.yoopiskkoulk2004 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2005 <> '' and l.luopiskkoulk2005  = '' and l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then '1'   
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2006 <> '' and l.luopiskkoulk2006  = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then '1'    
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2007 <> '' and l.luopiskkoulk2007  = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then '1'    
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2008 <> '' and l.luopiskkoulk2008  = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then '1'    
		 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2009 <> '' and l.luopiskkoulk2009  = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1' 
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2004 <> '' and l.ammopiskkoulk2004 = '' and l.yoopiskkoulk2004 = '' and l.luopiskkoulk2004 = '' then  '1'
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2005 <> '' and l.ammopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' and l.luopiskkoulk2005 = '' then  '1'
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.luopiskkoulk2006 = '' then  '1'
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.luopiskkoulk2007 = '' then  '1'
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' then  '1'
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' then  '1' 
   
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2004  <> '' and l.amkopiskkoulk2004 = '' and l.luopiskkoulk2004 = '' and l.ammopiskkoulk2004 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2005 <> '' and l.amkopiskkoulk2005 = '' and l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2006 <> '' and l.amkopiskkoulk2006 = '' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' then '1'  	   
		when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2007 <> '' and l.amkopiskkoulk2007 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' then '1'  	   
 		when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then '1' 
		 		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then '1'   	   
   
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2004  <> '' and l.ammopiskkoulk2004 <> '' and l.amkopiskkoulk2004 = '' and l.yoopiskkoulk2004  = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 <> '' and l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 <> '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then '1'  
		when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then '1'
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1'   
   
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2004  <> '' and l.amkopiskkoulk2004 <> '' and l.luopiskkoulk2004 = '' and l.yoopiskkoulk2004 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2005  <> '' and l.amkopiskkoulk2005 <> ''  and l.luopiskkoulk2005 = '' and l.yoopiskkoulk2005  = '' then '1' 
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2006 <> '' and l.amkopiskkoulk2006 <> ''  and l.luopiskkoulk2006 = '' and l.yoopiskkoulk2006  = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2007 <> '' and l.amkopiskkoulk2007 <> ''  and l.luopiskkoulk2007 = '' and l.yoopiskkoulk2007  = '' then '1'  
	   	when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 <> ''  and l.luopiskkoulk2008 = '' and l.yoopiskkoulk2008  = '' then '1'  
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 <> ''  and l.luopiskkoulk2009 = '' and l.yoopiskkoulk2009  = '' then '1' 

	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2004  <> '' and l.yoopiskkoulk2004 <> '' and l.ammopiskkoulk2004  = '' and l.luopiskkoulk2004 = ''  then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2005 <> '' and l.yoopiskkoulk2005 <> ''  and l.ammopiskkoulk2005  = '' and l.luopiskkoulk2005 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2006 <> '' and l.yoopiskkoulk2006 <> ''  and l.ammopiskkoulk2006  = '' and l.luopiskkoulk2006 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007 <> ''  and l.ammopiskkoulk2007  = '' and l.luopiskkoulk2007 = '' then '1'  
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008 <> ''  and l.ammopiskkoulk2008  = '' and l.luopiskkoulk2008 = '' then '1'  
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009 <> ''  and l.ammopiskkoulk2009  = '' and l.luopiskkoulk2009 = '' then '1' 
	    
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')  and (l.ptoim1r4_2004 = '22' or l.ptoim1r4_2004 = '13')
       and	(l.luopiskkoulk2004 <>'' or l.ammopiskkoulk2004 <>'' or l.amkopiskkoulk2004 <>'' or l.yoopiskkoulk2004 <>'')   then '1' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2005 = '22' or l.ptoim1r4_2005  = '13')
	   and (l.luopiskkoulk2005 <>'' or l.ammopiskkoulk2005 <>'' or l.amkopiskkoulk2005 <>'' or l.yoopiskkoulk2005 <>'') then '1' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2006 = '22' or l.ptoim1r4_2006 = '13')
	   and (l.luopiskkoulk2006 <>'' or l.ammopiskkoulk2006 <>'' or l.amkopiskkoulk2006 <>'' or l.yoopiskkoulk2006 <>'') then '1' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2007 = '22' or l.ptoim1r4_2007  = '13')
	   and (l.luopiskkoulk2007 <>'' or l.ammopiskkoulk2007 <>'' or l.amkopiskkoulk2007 <>'' or l.yoopiskkoulk2007 <>'') then '1' 
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008  = '13')
	   and (l.luopiskkoulk2008 <>'' or l.ammopiskkoulk2008 <>'' or l.amkopiskkoulk2008 <>'' or l.yoopiskkoulk2008 <>'') then '1' 
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009  = '13')
	   and (l.luopiskkoulk2009 <>'' or l.ammopiskkoulk2009 <>'' or l.amkopiskkoulk2009 <>'' or l.yoopiskkoulk2009 <>'') then '1' 
	
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')  and (l.ptoim1r4_2004 = '22' or l.ptoim1r4_2004 = '13')
       and	(l.luopiskkoulk2004 ='' and l.ammopiskkoulk2004 ='' and l.amkopiskkoulk2004 ='' and l.yoopiskkoulk2004 ='')   then '2' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2005 = '22' or l.ptoim1r4_2005  = '13')
	   and (l.luopiskkoulk2005 ='' and l.ammopiskkoulk2005 ='' and l.amkopiskkoulk2005 ='' and l.yoopiskkoulk2005 ='') then '2' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2006 = '22' or l.ptoim1r4_2006 = '13')
	   and (l.luopiskkoulk2006 ='' and  l.ammopiskkoulk2006 ='' and l.amkopiskkoulk2006 ='' and l.yoopiskkoulk2006 ='') then '2' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2007 = '22' or l.ptoim1r4_2007 = '13')
	   and (l.luopiskkoulk2007 ='' and  l.ammopiskkoulk2007 ='' and l.amkopiskkoulk2007 ='' and l.yoopiskkoulk2007 ='') then '2' 
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 = '13')
	   and (l.luopiskkoulk2008 ='' and  l.ammopiskkoulk2008 ='' and l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 ='') then '2'
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13')
	   and (l.luopiskkoulk2009 ='' and  l.ammopiskkoulk2009 ='' and l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 ='') then '2'  
   
   
	   -- Ei opiskelevat työlliset
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')and  l.ptoim1r4_2004  = '10'  then '3' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2005 = '10'  then '3'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2006 = '10'  then '3' 
       when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2007 = '10'  then '3' 
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2008 = '10'  then '3' 
	     when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2009 = '10'  then '3' 
	   -- Ei opiskelevat työttömät
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2004  = '12'  then '4' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2005 = '12'  then '4' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2006 = '12'  then '4' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2007 = '12'  then '4' 
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2008 = '12'  then '4' 
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2009 = '12'  then '4' 
	
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where (suorv = '2004' or suorv = '2005' or suorv = '2006' or suorv = '2007'or suorv = '2008' or suorv = '2009'  ) and suorlk = '1'
	) as l
	
	
	WHERE 1=1
end;

--
-- TULOS
-- 
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_1_5_tarkastelujakso]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_1_5_tarkastelujakso]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_1_5_tarkastelujakso] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_1_5_tarkastelujakso] AS
declare @debug_what_to_run tinyint; set @debug_what_to_run=1; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';



-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;

set @ensimmainen_suoritusvuosi = 2004;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;




INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn 
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
,lkm
,pohjkoulk
,tietolahde
, aineisto
 ,lukiokoulutuksessa
 ,ammatillisessa_koulutuksessa
 ,ammattikorkeakoulutuksessa
 ,yliopistokoulutuksessa
 ,lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
 ,toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
 ,ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
 ,koulutuksen_paattaneiden_toiminta
 ,ika_1v
 ,ika_5v
)
SELECT
 l.rivinumero,
 '1,5',
 l.tilv,
 l.tilv_date,
 l.tutkryh,
 l.suorv,
  (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
(case
    -- Koulutus 1
	-- lukiokoulutuksessa 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then l.luopiskkoulk2006
	-- ammatillisessa koulutuksessa 2006 
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 ='' and l.yoopiskkoulk2006 = ''  then l.ammopiskkoulk2006 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2006 ensimäisiin koulutustietoihin
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then l.luopiskkoulk2006
	-- ammattikorkeakoulutuksessa
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2006  <> '' and l.yoopiskkoulk2006  = '' and
	l.luopiskkoulk2006  = '' and l.ammopiskkoulk2006 = '' then l.amkopiskkoulk2006
	-- yliopistokoulutuksessa
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 <> '' and 
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''   then l.yoopiskkoulk2006 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2006 <> '' and l.yoopiskkoulk2006  <> '' and
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''  then l.amkopiskkoulk2006 
	
	
	-- lukiokoulutuksessa 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.luopiskkoulk2007
	-- ammatillisessa koulutuksessa 2007
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 ='' and l.yoopiskkoulk2007 = ''  then l.ammopiskkoulk2007 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2007 ensimäisiin koulutustietoihin
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.luopiskkoulk2007
	-- ammattikorkeakoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2007  <> '' and l.yoopiskkoulk2007  = '' and
	l.luopiskkoulk2007  = '' and l.ammopiskkoulk2007 = '' then l.amkopiskkoulk2007
	-- yliopistokoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 <> '' and 
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''   then l.yoopiskkoulk2007 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007  <> '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''  then l.amkopiskkoulk2007
	
		-- lukiokoulutuksessa 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammatillisessa koulutuksessa 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then l.ammopiskkoulk2008 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2007 ensimäisiin koulutustietoihin
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008  = '' and l.ammopiskkoulk2008 = '' then l.amkopiskkoulk2008
	-- yliopistokoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then l.yoopiskkoulk2008 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.amkopiskkoulk2008
	
		-- lukiokoulutuksessa 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammatillisessa koulutuksessa 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then l.ammopiskkoulk2009 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2007 ensimäisiin koulutustietoihin
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammattikorkeakoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009  = '' and l.ammopiskkoulk2009 = '' then l.amkopiskkoulk2009
	-- yliopistokoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then l.yoopiskkoulk2009 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.amkopiskkoulk2009

	
	-- lukiokoulutuksessa 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammatillisessa koulutuksessa 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then l.ammopiskkoulk2010 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2007 ensimäisiin koulutustietoihin
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammattikorkeakoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010  = '' and l.ammopiskkoulk2010 = '' then l.amkopiskkoulk2010
	-- yliopistokoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then l.yoopiskkoulk2010 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.amkopiskkoulk2010

	-- lukiokoulutuksessa 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammatillisessa koulutuksessa 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then l.ammopiskkoulk2011 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2007 ensimäisiin koulutustietoihin
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011  = '' and l.ammopiskkoulk2011 = '' then l.amkopiskkoulk2011
	-- yliopistokoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then l.yoopiskkoulk2011 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.amkopiskkoulk2011



	else ''
	    end),
	 -- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos 2006
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 = '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then l.luopisktunn2006
	-- ammatillisen koulutuksen oppilaitos 2006
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2006 = '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 ='' and l.yoopisktunn2006 = ''  then l.ammopisktunn2006
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then l.luopisktunn2006
	-- ammattikorkeakoulutuksen oppilaitos 2006
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2006  <> '' and l.yoopisktunn2006  = '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = '' then l.amkopisktunn2006
	-- yliopistokoulutuksen oppilaitos 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2006 = '' and l.yoopisktunn2006 <> '' and 
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = ''   then l.yoopisktunn2006  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2006  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2006 <> '' and l.yoopisktunn2006  <> '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = ''  then l.amkopisktunn2006 
	
	
	-- lukiokoulutuksen oppilaitos 2007
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 = '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.luopisktunn2007
	-- ammatillisen koulutuksen oppilaitos 2007
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2007 = '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 ='' and l.yoopisktunn2007 = ''  then l.ammopisktunn2007
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2006
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.luopisktunn2007
	-- ammattikorkeakoulutuksen oppilaitos 2007
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2007  <> '' and l.yoopisktunn2007  = '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = '' then l.amkopisktunn2007
	-- yliopistokoulutuksen oppilaitos 2007
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2007 = '' and l.yoopisktunn2007 <> '' and 
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''   then l.yoopisktunn2007  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2007 
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2007 <> '' and l.yoopisktunn2007  <> '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''  then l.amkopisktunn2007 
	
	-- lukiokoulutuksen oppilaitos 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammatillisen koulutuksen oppilaitos 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and l.yoopisktunn2008 = ''  then l.ammopisktunn2008
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2006
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammattikorkeakoulutuksen oppilaitos 2008
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then l.amkopisktunn2008
	-- yliopistokoulutuksen oppilaitos 2008
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''   then l.yoopisktunn2008  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2007 
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.amkopisktunn2008 
	
	-- lukiokoulutuksen oppilaitos 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammatillisen koulutuksen oppilaitos 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and l.yoopisktunn2009 = ''  then l.ammopisktunn2009
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2006
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammattikorkeakoulutuksen oppilaitos 2009
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then l.amkopisktunn2009
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''   then l.yoopisktunn2009  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2007 
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.amkopisktunn2009 

	-- lukiokoulutuksen oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and l.yoopisktunn2010 = ''  then l.ammopisktunn2010
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2006
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then l.amkopisktunn2010
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''   then l.yoopisktunn2010  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2007 
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.amkopisktunn2010 

	-- lukiokoulutuksen oppilaitos 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammatillisen koulutuksen oppilaitos 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and l.yoopisktunn2011 = ''  then l.ammopisktunn2011
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2006
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammattikorkeakoulutuksen oppilaitos 2011
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then l.amkopisktunn2011
	-- yliopistokoulutuksen oppilaitos 2011
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''   then l.yoopisktunn2011  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2007 
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.amkopisktunn2011 
	
	else ''
	
	    end),
	-- Koulutuksen järjestäjä 1 
	(case
	-- lukiokoulutuksen järjestäjä 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2006  <> '' and l.ammopiskjarj2006  = '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then l.luopiskjarj2006  
	-- ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @ensimmainen_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2006 = '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 ='' and yoopiskjarj2006 = ''  then l.ammopiskjarj2006 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2006, merkitään lukiokoulutuksen 2006 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2006 <> '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then l.luopiskjarj2006
	-- ammattikorkeakoulutuksen 2006 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   = '' and
	l.luopiskjarj2006 = '' and l.ammopiskjarj2006 = '' then l.amkopiskjarj2006 
	-- yliopistokoulutuksen 2006 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2006  = '' and l.yoopiskjarj2006  <> '' and 
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006 = ''   then l.yoopiskjarj2006
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2006, merkitään ammattikorkekoulutuksen järjestäjä 2006   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   <> '' and
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006  = ''  then l.amkopiskjarj2006 
	
	
	-- lukiokoulutuksen järjestäjä 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2007  <> '' and l.ammopiskjarj2007  = '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.luopiskjarj2007  
	-- ammatillisen koulutuksen järjestäjä 2007
	when l.suorv = @toinen_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2007 = '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 ='' and yoopiskjarj2007 = ''  then l.ammopiskjarj2007 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2006, merkitään lukiokoulutuksen 2006 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2007 <> '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.luopiskjarj2007
	-- ammattikorkeakoulutuksen 2007 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskjarj2007 = '' then l.amkopiskjarj2007 
	-- yliopistokoulutuksen 2007 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2007  = '' and l.yoopiskjarj2007  <> '' and 
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007 = ''   then l.yoopiskjarj2007
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2007, merkitään ammattikorkekoulutuksen järjestäjä 2007   
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   <> '' and
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007  = ''  then l.amkopiskjarj2007 
	
	
	-- lukiokoulutuksen järjestäjä 2008
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008  = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008  
	-- ammatillisen koulutuksen järjestäjä 2007
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and yoopiskjarj2008 = ''  then l.ammopiskjarj2008 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2006, merkitään lukiokoulutuksen 2006 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008
	-- ammattikorkeakoulutuksen 2007 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then l.amkopiskjarj2008 
	-- yliopistokoulutuksen 2007 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then l.yoopiskjarj2008
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2007, merkitään ammattikorkekoulutuksen järjestäjä 2007   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.amkopiskjarj2008 
	
	-- lukiokoulutuksen järjestäjä 2009
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009  = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009  
	-- ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and yoopiskjarj2009 = ''  then l.ammopiskjarj2009 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäj, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009
	-- ammattikorkeakoulutuksen 2007 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then l.amkopiskjarj2009 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then l.yoopiskjarj2009
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkekoulutuksen järjestäjä 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.amkopiskjarj2009 

	-- lukiokoulutuksen järjestäjä 2010
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010  = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010  
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and yoopiskjarj2010 = ''  then l.ammopiskjarj2010 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäj, merkitään lukiokoulutuksen 2010 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010
	-- ammattikorkeakoulutuksen 2007 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then l.amkopiskjarj2010 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then l.yoopiskjarj2010
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkekoulutuksen järjestäjä 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.amkopiskjarj2010 

		-- lukiokoulutuksen järjestäjä 2011
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011  = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011  
	-- ammatillisen koulutuksen järjestäjä 2011
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and yoopiskjarj2011 = ''  then l.ammopiskjarj2011 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäj, merkitään lukiokoulutuksen 2011 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011
	-- ammattikorkeakoulutuksen 2007 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then l.amkopiskjarj2011 
	-- yliopistokoulutuksen 2011 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''   then l.yoopiskjarj2011
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkekoulutuksen järjestäjä 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011  = ''  then l.amkopiskjarj2011 
	
	else ''
	    end),
	    
	 -- Maakunta 1
	(case
	-- lukioopiskelun maakunta 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2006   <> '' and l.ammopiskmaak2006  = '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = '' then l.luopiskmaak2006
	-- ammatillisen koulutksen maakunta 2006    
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2006  = '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  ='' and l.yoopiskmaak2006  = ''  then l.ammopiskmaak2006
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2006  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2006  <> '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = '' then l.luopiskmaak2006 
	-- ammattikorkekoulutuksen maakunta 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2006   <> '' and l.yoopiskmaak2006   = '' and
	l.luopiskmaak2006 = '' and l.ammopiskmaak2006 = '' then l.amkopiskmaak2006
	-- yliopistokoulutuksen maakunta 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  <> '' and 
	l.luopiskmaak2006  = '' and l.ammopiskmaak2006 = ''   then l.yoopiskmaak2006
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2006, otetaan talteen ammattikorkekoulutksen maakunta 2006   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2006  <> '' and l.yoopiskmaak2006   <> '' and
	l.luopiskmaak2006  = '' and l.ammopiskmaak2006  = ''  then l.amkopiskmaak2006 
	
	
	-- lukioopiskelun maakunta 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2007   <> '' and l.ammopiskmaak2007  = '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.luopiskmaak2007
	-- ammatillisen koulutksen maakunta 2007    
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2007  = '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  ='' and l.yoopiskmaak2007  = ''  then l.ammopiskmaak2007
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2007  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2007  <> '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.luopiskmaak2007 
	-- ammattikorkekoulutuksen maakunta 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2007   <> '' and l.yoopiskmaak2007   = '' and
	l.luopiskmaak2007 = '' and l.ammopiskmaak2007 = '' then l.amkopiskmaak2007
	-- yliopistokoulutuksen maakunta 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  <> '' and 
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007 = ''   then l.yoopiskmaak2007
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2007, otetaan talteen ammattikorkekoulutksen maakunta 2007   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2007  <> '' and l.yoopiskmaak2007   <> '' and
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007  = ''  then l.amkopiskmaak2007 
	
	-- lukioopiskelun maakunta 2008
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008
	-- ammatillisen koulutksen maakunta 2007    
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008 ='' and l.yoopiskmaak2008  = ''  then l.ammopiskmaak2008
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2007  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008 
	-- ammattikorkekoulutuksen maakunta 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then l.amkopiskmaak2008
	-- yliopistokoulutuksen maakunta 2007
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008 = ''   then l.yoopiskmaak2008
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2007, otetaan talteen ammattikorkekoulutksen maakunta 2007   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008  = ''  then l.amkopiskmaak2008 
	
	-- lukioopiskelun maakunta 2009
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009
	-- ammatillisen koulutksen maakunta 2007    
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009 ='' and l.yoopiskmaak2009  = ''  then l.ammopiskmaak2009
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2007  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009 
	-- ammattikorkekoulutuksen maakunta 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then l.amkopiskmaak2009
	-- yliopistokoulutuksen maakunta 2007
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then l.yoopiskmaak2009
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2007, otetaan talteen ammattikorkekoulutksen maakunta 2007   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.amkopiskmaak2009 

	-- lukioopiskelun maakunta 2010
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010
	-- ammatillisen koulutksen maakunta 2007    
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010 ='' and l.yoopiskmaak2010  = ''  then l.ammopiskmaak2010
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2007  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010 
	-- ammattikorkekoulutuksen maakunta 2007
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then l.amkopiskmaak2010
	-- yliopistokoulutuksen maakunta 2007
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then l.yoopiskmaak2010
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2007, otetaan talteen ammattikorkekoulutksen maakunta 2007   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.amkopiskmaak2010 

	-- lukioopiskelun maakunta 2011
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2011   <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011
	-- ammatillisen koulutksen maakunta 2007    
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011 ='' and l.yoopiskmaak2011  = ''  then l.ammopiskmaak2011
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2007  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011 
	-- ammattikorkekoulutuksen maakunta 2007
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then l.amkopiskmaak2011
	-- yliopistokoulutuksen maakunta 2007
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then l.yoopiskmaak2011
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2007, otetaan talteen ammattikorkekoulutksen maakunta 2007   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.amkopiskmaak2011 
	
	else ''
	
	
	    end),
-- Koulutus 2
(case
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2006
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2006 
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 ='' and l.yoopiskkoulk2006 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then l.ammopiskkoulk2006
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2006  <> '' and l.yoopiskkoulk2006  = '' and
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 <> '' and 
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2006 <> '' and l.yoopiskkoulk2006  <> '' and
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''  then l.yoopiskkoulk2006   
	
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2006 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 ='' and l.yoopiskkoulk2007 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.ammopiskkoulk2007
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2007  <> '' and l.yoopiskkoulk2007  = '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 <> '' and 
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007  <> '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''  then l.yoopiskkoulk2007   
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2008 
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2007
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.ammopiskkoulk2008
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.yoopiskkoulk2008   
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2009 
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2007
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.ammopiskkoulk2009
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2006
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.yoopiskkoulk2009   

	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2010 
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2007
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.ammopiskkoulk2010
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2006
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.yoopiskkoulk2010   

	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2011
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2011 
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2007
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.ammopiskkoulk2011
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2006
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.yoopiskkoulk2011 

	
	else ''
	    end),
	    
-- Oppilaitos 2
(case
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 = '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2006 = '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 ='' and yoopisktunn2006 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then l.ammopisktunn2006 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2006  <> '' and l.yoopisktunn2006  = '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2006 = '' and l.yoopisktunn2006 <> '' and 
	l.luopisktunn2006 = '' and l.ammopisktunn2006  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2006 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2006 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2006 <> '' and l.yoopisktunn2006  <> '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = ''  then l.yoopisktunn2006 
	
		-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 = '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2007 = '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 ='' and yoopisktunn2007 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.ammopisktunn2007 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2007  <> '' and l.yoopisktunn2007  = '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2007 = '' and l.yoopisktunn2007 <> '' and 
	l.luopisktunn2007 = '' and l.ammopisktunn2007  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2006 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2006 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2007 <> '' and l.yoopisktunn2007  <> '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''  then l.yoopisktunn2007 
	
	
    -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and yoopisktunn2008 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.ammopisktunn2008 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2006 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2006 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.yoopisktunn2008 
	
	  -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and yoopisktunn2009 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.ammopisktunn2009 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2006
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2006
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2006 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2006 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.yoopisktunn2009 

	 -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2007
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and yoopisktunn2010 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2007
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.ammopisktunn2010 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2006
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2006
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2010 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2006 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.yoopisktunn2010 


		 -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2007
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and yoopisktunn2011 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2007
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.ammopisktunn2011 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2006
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2006
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2011 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2006 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.yoopisktunn2011  

	
	else ''
	    end),
	    
	-- Koulutuksen järjestäjä 2
	(case
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2006  <> '' and l.ammopiskjarj2006 = '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2006 = '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 ='' and l.yoopiskjarj2006 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2006 <> '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then l.ammopiskjarj2006 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   = '' and
	l.luopiskjarj2006 = '' and l.ammopiskjarj2006 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2006  = '' and l.yoopiskjarj2006  <> '' and 
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   <> '' and
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006  = ''  then l.yoopiskjarj2006 
	
	
		-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2007  <> '' and l.ammopiskjarj2007 = '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2007 = '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 ='' and l.yoopiskjarj2007 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2007 <> '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.ammopiskjarj2007 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskjarj2007 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2007  = '' and l.yoopiskjarj2007  <> '' and 
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2006
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007  <> '' and
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007  = ''  then l.yoopiskjarj2007 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008 = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and l.yoopiskjarj2008 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2007
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.ammopiskjarj2008 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008  <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''  then l.yoopiskjarj2008 
	
		-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and l.yoopiskjarj2009 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2007
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.ammopiskjarj2009 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2006
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009  <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''  then l.yoopiskjarj2009 
	
    	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and l.yoopiskjarj2010 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2007
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.ammopiskjarj2010 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2007
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2006
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010  <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''  then l.yoopiskjarj2010 


	    	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and l.yoopiskjarj2011 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2007
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.ammopiskjarj2011 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2007
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2006
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011  <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''  then l.yoopiskjarj2011 
	
	else ''
	    end),
	    
	-- Maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta 2006, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2006   <> '' and l.ammopiskmaak2006  = '' and
	l.amkopiskmaak2006  = '' and yoopiskmaak2006  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2006, merkitään tyhjäksi   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2006  = '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  ='' and l.yoopiskmaak2006  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2006, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2006  <> '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = '' then l.ammopiskmaak2006 
	-- vain ammattikorkeakoulutuksen maakunta 2006, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2006   <> '' and l.yoopiskmaak2006   = '' and
	l.luopiskmaak2006 = '' and l.ammopiskmaak2006 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2006, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  <> '' and 
	l.luopiskmaak2006  = '' and l.ammopiskmaak2006 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2006, merkitään yliopistokoulutuksen 2006 maakunta 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2006  <> '' and l.yoopiskmaak2006   <> '' and
	l.luopiskmaak2006  = '' and l.ammopiskmaak2006  = ''  then l.yoopiskmaak2006  
	
	
		-- vain lukiokoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2007  <> '' and l.ammopiskmaak2007  = '' and
	l.amkopiskmaak2007  = '' and yoopiskmaak2007  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2006, merkitään tyhjäksi   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2007  = '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  ='' and l.yoopiskmaak2007 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2007, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2007  <> '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.ammopiskmaak2007 
	-- vain ammattikorkeakoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2007   <> '' and l.yoopiskmaak2007   = '' and
	l.luopiskmaak2007 = '' and l.ammopiskmaak2007 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  <> '' and 
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2007, merkitään yliopistokoulutuksen 2006 maakunta 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2007  <> '' and l.yoopiskmaak2007   <> '' and
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007  = ''  then l.yoopiskmaak2007  
	
	
	-- vain lukiokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and yoopiskmaak2008  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2008, merkitään tyhjäksi   
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  ='' and l.yoopiskmaak2008 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2008, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.ammopiskmaak2008 
	-- vain ammattikorkeakoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2008, merkitään yliopistokoulutuksen 2008 maakunta 
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008  = ''  then l.yoopiskmaak2008  
	
	-- vain lukiokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and yoopiskmaak2009  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2009, merkitään tyhjäksi   
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2009, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.ammopiskmaak2009 
	-- vain ammattikorkeakoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2009, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.yoopiskmaak2009  

	-- vain lukiokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and yoopiskmaak2010  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2010, merkitään tyhjäksi   
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2010, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.ammopiskmaak2010 
	-- vain ammattikorkeakoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2010, merkitään yliopistokoulutuksen 2010 maakunta 
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.yoopiskmaak2010  


	-- vain lukiokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and yoopiskmaak2011  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2011, merkitään tyhjäksi   
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  ='' and l.yoopiskmaak2011 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2011, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.ammopiskmaak2011 
	-- vain ammattikorkeakoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2011, merkitään yliopistokoulutuksen 2011 maakunta 
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.yoopiskmaak2011 


	else ''
	    end),
	-- Monihaku
	(case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.monihaku2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.monihaku2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.monihaku2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.monihaku2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.monihaku2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.monihaku2011
	
	else '8'
	end),
	-- Pääasiallinen toiminta
    (case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2006 
    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2007 
    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2008 
    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2011
	else ''
	end),
	-- Ammattiasema
	(case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.amas_2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.amas_2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.amas_2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.amas_2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.amas_2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.amas_2011

	else ''
	end),
 l.lkm,
 l.pohjkoul,
 l.tietolahde,
 'K3.13',
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and l.amkopiskkoulk2006 = '' and
	    l.yoopiskkoulk2006 = ''  then  '1'  
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and
	    l.yoopiskkoulk2007 = ''   then '1'  
	     when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and
	    l.yoopiskkoulk2008 = ''   then '1'  
	      when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = ''   then '1'  
		 when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = ''   then '1'  
		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = ''   then '1'  
	
	    else '0'
	    end) as lukiokoulutuksessa,
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2006 <> '' and l.luopiskkoulk2006 = '' and l.amkopiskkoulk2006 = '' and
	    l.yoopiskkoulk2006 = ''  then '1'   
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2007 <> '' and l.luopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and
	    l.yoopiskkoulk2007 = ''  then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2008 <> '' and l.luopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and
	    l.yoopiskkoulk2008 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = '' then '1'  
		when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2010 <> '' and l.luopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = '' then '1'  
		when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2011 <> '' and l.luopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = '' then '1'  
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
 (case  
	   when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and l.luopiskkoulk2006 = '' and
	   l.yoopiskkoulk2006 = ''  then  '1'
	   when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and l.luopiskkoulk2007 = '' and
	   l.yoopiskkoulk2007 = ''  then  '1'
	   when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' and
	   l.yoopiskkoulk2008 = ''  then  '1'
	    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and
	   l.yoopiskkoulk2009 = ''  then  '1'
	    when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and
	   l.yoopiskkoulk2010 = ''  then  '1'
	    when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' and
	   l.yoopiskkoulk2011 = ''  then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and  l.yoopiskkoulk2006 <> '' and l.amkopiskkoulk2006 = '' and l.luopiskkoulk2006 = '' and 
	    l.ammopiskkoulk2006 = ''  then '1'  
	    when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and  l.yoopiskkoulk2007 <> '' and l.amkopiskkoulk2007 = '' and l.luopiskkoulk2007 = '' and 
	    l.ammopiskkoulk2007 = ''  then '1' 
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' and 
	    l.ammopiskkoulk2008 = ''  then '1' 
	     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and 
	    l.ammopiskkoulk2009 = ''  then '1' 
		 when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and 
	    l.ammopiskkoulk2010 = ''  then '1' 
		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' and 
	    l.ammopiskkoulk2011 = ''  then '1' 
	
	    else '0'
	    end) as yliopistokoulutuksessa,

(case

	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 <> '' and l.amkopiskkoulk2006 = '' and
	    l.yoopiskkoulk2006 = '' then '1'  
	    
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and l.amkopiskkoulk2007 = '' and
	    l.yoopiskkoulk2007 = ''  then '1' 
	    
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and
	    l.yoopiskkoulk2008 = ''  then '1' 
	    
	    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = ''  then '1'

		 when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = ''  then '1'

        when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = ''  then '1'
	

	    
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2'and  l.ammopiskkoulk2006 <> '' and l.amkopiskkoulk2006 <> '' and l.luopiskkoulk2006 = '' and
	    l.yoopiskkoulk2006 = ''  then '1' 
	     
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2007 <> '' and l.amkopiskkoulk2007 <> '' and l.luopiskkoulk2007 = '' and
	    l.yoopiskkoulk2007 = '' then '1' 
	    
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 <> '' and l.luopiskkoulk2008 = '' and
	    l.yoopiskkoulk2008 = '' then '1' 
	    
	    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = '' then '1' 

		when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 <> '' and l.luopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = '' then '1' 

		when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 <> '' and l.luopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = '' then '1' 
	

	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2006 <> '' and l.yoopiskkoulk2006 <> '' and l.luopiskkoulk2006 = '' and
	    l.ammopiskkoulk2006 = ''  then '1'  
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007 <> '' and l.luopiskkoulk2007 = '' and
	    l.ammopiskkoulk2007 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008 <> '' and l.luopiskkoulk2008 = '' and
	    l.ammopiskkoulk2008 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and
	    l.ammopiskkoulk2009 = '' then '1'  
		  when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010 <> '' and l.luopiskkoulk2010 = '' and
	    l.ammopiskkoulk2010 = '' then '1'  
		  when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011 <> '' and l.luopiskkoulk2011 = '' and
	    l.ammopiskkoulk2011 = '' then '1'  
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and (l.ptoim1r4_2006 = '22' or l.ptoim1r4_2006 ='13')
       and (l.luopiskkoulk2006 <> '' or l.ammopiskkoulk2006<>'' or l.amkopiskkoulk2006 <> '' or l.yoopiskkoulk2006<>'')	   then '1' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2007 = '22' or l.ptoim1r4_2007 = '13')
       and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007<>'' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007<>'')	   then '1'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 = '13')
       and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008<>'' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008<>'')	   then '1' 
          when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13')
       and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009<>'' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009<>'')	   then '1'
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13')
       and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010<>'' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010<>'')	   then '1'
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
       and (l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011<>'' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011<>'')	   then '1'
	   
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
       when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and (l.ptoim1r4_2006 = '22' or l.ptoim1r4_2006 ='13')
       and (l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006='' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006='')	   then '2' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2007 = '22' or l.ptoim1r4_2007 = '13')
       and (l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007='' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007='')	   then '2'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 = '13')
       and (l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008='' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008='')	   then '2' 
       when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13')
       and (l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009='' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009='')	   then '2'
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13')
       and (l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010='' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010='')	   then '2'
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
       and (l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011='' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011='')	   then '2'
	  -- Ei opiskelevat työlliset
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2')and l.ptoim1r4_2006 = '10'  then '3'
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and  l.ptoim1r4_2007 = '10'  then '3'     
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2008 = '10'  then '3' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2009 = '10'  then '3' 
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2010 = '10'  then '3' 
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2011 = '10'  then '3' 
	  -- Ei opiskelevat työttömät 
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2006 = '12'  then '4' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and  l.ptoim1r4_2007 = '12'  then '4'
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2008 = '12'  then '4'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2009 = '12'  then '4'  
		when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2010 = '12'  then '4'  
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2011 = '12'  then '4' 
	   -- Ei opiskelevat muut
      else '5'
	     
	     
	   end)as koulutuksen_paattaneiden_toiminta
	  ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
     ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where (suorv = '2004' or suorv = '2005' or suorv = '2006' or suorv = '2007' or suorv= '2008' or suorv = '2009') and suorlk = '2'
	
	) as l
	
	
	WHERE 1=1
end;

--
-- TULOS
-- 
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_1_tarkastelujakso]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_1_tarkastelujakso]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_1_tarkastelujakso] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_1_tarkastelujakso] AS
declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;

set @ensimmainen_suoritusvuosi = 2004;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;


INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
,lkm
,pohjkoulk
,tietolahde
, aineisto
 ,lukiokoulutuksessa
 ,ammatillisessa_koulutuksessa
 ,ammattikorkeakoulutuksessa
 ,yliopistokoulutuksessa
 ,lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
 ,toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
 ,ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
 ,koulutuksen_paattaneiden_toiminta
 ,ika_1v
 ,ika_5v
)
SELECT
 l.rivinumero,
 '1',
 l.tilv,
 l.tilv_date,
 l.tutkryh,
 l.suorv,
 (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 = '' and
	l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then l.luopiskkoulk2005 
	-- ammattikoulutuksessa 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 <> '' and
	l.amkopiskkoulk2005 ='' and l.yoopiskkoulk2005 = ''  then l.ammopiskkoulk2005 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2005 ensim. koulutustietoihin
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 <> '' and
	l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then l.luopiskkoulk2005
	-- ammattikorkeakoulutuksessa 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2005  <> '' and l.yoopiskkoulk2005  = '' and
	l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = '' then l.amkopiskkoulk2005
	-- yliopistokoulutuksessa 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 <> '' and 
	l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = ''   then l.yoopiskkoulk2005
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2005 <> '' and l.yoopiskkoulk2005  <> '' and
	l.luopiskkoulk2005 = '' and ammopiskkoulk2005 = ''  then l.amkopiskkoulk2005 
	
	
	-- lukiokoulutuksessa 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then l.luopiskkoulk2006
	-- ammatillisessa koulutuksessa 2006 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 ='' and l.yoopiskkoulk2006 = ''  then l.ammopiskkoulk2006 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2006 ensimäisiin koulutustietoihin
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then l.luopiskkoulk2006
	-- ammattikorkeakoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006  <> '' and l.yoopiskkoulk2006  = '' and
	l.luopiskkoulk2006  = '' and l.ammopiskkoulk2006 = '' then l.amkopiskkoulk2006
	-- yliopistokoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 <> '' and 
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''   then l.yoopiskkoulk2006 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006 <> '' and l.yoopiskkoulk2006  <> '' and
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''  then l.amkopiskkoulk2006 
	
	
	-- lukiokoulutuksessa 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.luopiskkoulk2007
	-- ammatillisessa koulutuksessa 2007 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 ='' and l.yoopiskkoulk2007 = ''  then l.ammopiskkoulk2007 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2007 ensimäisiin koulutustietoihin
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.luopiskkoulk2007
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007  <> '' and l.yoopiskkoulk2007  = '' and
	l.luopiskkoulk2007  = '' and l.ammopiskkoulk2007 = '' then l.amkopiskkoulk2007
	-- yliopistokoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 <> '' and 
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''   then l.yoopiskkoulk2007 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007  <> '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''  then l.amkopiskkoulk2007 
	
	-- lukiokoulutuksessa 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammatillisessa koulutuksessa 2008 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then l.ammopiskkoulk2008 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2008 ensimäisiin koulutustietoihin
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammattikorkeakoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008  = '' and l.ammopiskkoulk2008 = '' then l.amkopiskkoulk2008
	-- yliopistokoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then l.yoopiskkoulk2008 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.amkopiskkoulk2008 

		-- lukiokoulutuksessa 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammatillisessa koulutuksessa 2009 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then l.ammopiskkoulk2009 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2009 ensimäisiin koulutustietoihin
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammattikorkeakoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009  = '' and l.ammopiskkoulk2009 = '' then l.amkopiskkoulk2009
	-- yliopistokoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then l.yoopiskkoulk2009 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.amkopiskkoulk2009 

		-- lukiokoulutuksessa 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammatillisessa koulutuksessa 2010 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then l.ammopiskkoulk2010 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010  = '' and l.ammopiskkoulk2010 = '' then l.amkopiskkoulk2010
	-- yliopistokoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then l.yoopiskkoulk2010 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.amkopiskkoulk2010 

	else ''
	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2005 <> '' and l.ammopisktunn2005 = '' and
	l.amkopisktunn2005 = '' and l.yoopisktunn2005 = '' then l.luopisktunn2005 
	-- ammattikoulutuksen oppilaitos 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2005 = '' and l.ammopisktunn2005 <> '' and
	l.amkopisktunn2005 ='' and l.yoopisktunn2005 = ''  then l.ammopisktunn2005 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2005 <> '' and l.ammopisktunn2005 <> '' and
	l.amkopisktunn2005 = '' and l.yoopisktunn2005 = '' then l.luopisktunn2005
	-- ammattikorkeakoulutuksen oppilaitos 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2005  <> '' and l.yoopisktunn2005  = '' and
	l.luopisktunn2005 = '' and l.ammopisktunn2005 = '' then l.amkopisktunn2005
	-- yliopistokoulutuksen oppilaitos 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2005 = '' and l.yoopisktunn2005 <> '' and 
	l.luopisktunn2005 = '' and l.ammopisktunn2005 = ''   then l.yoopisktunn2005
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2005  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2005 <> '' and l.yoopisktunn2005  <> '' and
	l.luopisktunn2005 = '' and l.ammopisktunn2005 = ''  then l.amkopisktunn2005 
	
	
	-- lukiokoulutuksen oppilaitos 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 = '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then l.luopisktunn2006
	-- ammatillisen koulutuksen oppilaitos 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 = '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 ='' and l.yoopisktunn2006 = ''  then l.ammopisktunn2006
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then l.luopisktunn2006
	-- ammattikorkeakoulutuksen oppilaitos 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006  <> '' and l.yoopisktunn2006  = '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = '' then l.amkopisktunn2006
	-- yliopistokoulutuksen oppilaitos 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006 = '' and l.yoopisktunn2006 <> '' and 
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = ''   then l.yoopisktunn2006  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2006  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006 <> '' and l.yoopisktunn2006  <> '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = ''  then l.amkopisktunn2006 
	
	-- lukiokoulutuksen oppilaitos 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 = '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.luopisktunn2007
	-- ammatillisen koulutuksen oppilaitos 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 = '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 ='' and l.yoopisktunn2007 = ''  then l.ammopisktunn2007
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2006
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.luopisktunn2007
	-- ammattikorkeakoulutuksen oppilaitos 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007  <> '' and l.yoopisktunn2007  = '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = '' then l.amkopisktunn2007
	-- yliopistokoulutuksen oppilaitos 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007 = '' and l.yoopisktunn2007 <> '' and 
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''   then l.yoopisktunn2007 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2006  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007 <> '' and l.yoopisktunn2007  <> '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''  then l.amkopisktunn2007
	
	-- lukiokoulutuksen oppilaitos 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammatillisen koulutuksen oppilaitos 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and l.yoopisktunn2008 = ''  then l.ammopisktunn2008
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2006
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammattikorkeakoulutuksen oppilaitos 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then l.amkopisktunn2008
	-- yliopistokoulutuksen oppilaitos 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''   then l.yoopisktunn2008 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2006  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.amkopisktunn2008

	-- lukiokoulutuksen oppilaitos 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammatillisen koulutuksen oppilaitos 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and l.yoopisktunn2009 = ''  then l.ammopisktunn2009
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2006
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammattikorkeakoulutuksen oppilaitos 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then l.amkopisktunn2009
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''   then l.yoopisktunn2009 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2006  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.amkopisktunn2009

		-- lukiokoulutuksen oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and l.yoopisktunn2010 = ''  then l.ammopisktunn2010
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2006
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then l.amkopisktunn2010
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''   then l.yoopisktunn2010 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2006  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.amkopisktunn2010
	
	else ''


	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2005  <> '' and l.ammopiskjarj2005 = '' and
	l.amkopiskjarj2005 = '' and yoopiskjarj2005 = '' then l.luopiskjarj2005
	-- ammatillisen koulutuksen järjestäjä 2005  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2005 = '' and l.ammopiskjarj2005 <> '' and
	l.amkopiskjarj2005 ='' and l.yoopiskjarj2005 = ''  then l.ammopiskjarj2005
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen 2005 järjestäjä 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2005 <> '' and l.ammopiskjarj2005 <> '' and
	l.amkopiskjarj2005 = '' and l.yoopiskjarj2005 = '' then l.luopiskjarj2005
	-- ammattikorkeakoulutuksen järjestäjä 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2005  <> '' and l.yoopiskjarj2005   = '' and
	l.luopiskjarj2005 = '' and l.ammopiskjarj2005 = '' then l.amkopiskjarj2005
	-- yliopistokoulutuksen järjestäjä 2005 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2005  = '' and l.yoopiskjarj2005  <> '' and 
	l.luopiskjarj2005  = '' and l.ammopiskjarj2005 = ''   then l.yoopiskjarj2005
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen 2005 järjestäjä   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2005  <> '' and l.yoopiskjarj2005   <> '' and
	l.luopiskjarj2005  = '' and l.ammopiskjarj2005  = ''  then l.amkopiskjarj2005 

	
	-- lukiokoulutuksen järjestäjä 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006  <> '' and l.ammopiskjarj2006  = '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then l.luopiskjarj2006  
	-- ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006 = '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 ='' and yoopiskjarj2006 = ''  then l.ammopiskjarj2006 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2006, merkitään lukiokoulutuksen 2006 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006 <> '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then l.luopiskjarj2006
	-- ammattikorkeakoulutuksen 2006 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   = '' and
	l.luopiskjarj2006 = '' and l.ammopiskjarj2006 = '' then l.amkopiskjarj2006 
	-- yliopistokoulutuksen 2006 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  = '' and l.yoopiskjarj2006  <> '' and 
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006 = ''   then l.yoopiskjarj2006
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2006, merkitään ammattikorkekoulutuksen järjestäjä 2006   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   <> '' and
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006  = ''  then l.amkopiskjarj2006 
	
	-- lukiokoulutuksen järjestäjä 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007  <> '' and l.ammopiskjarj2007 = '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.luopiskjarj2007 
	-- ammatillisen koulutuksen järjestäjä 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007 = '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 ='' and yoopiskjarj2007 = ''  then l.ammopiskjarj2007 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2006, merkitään lukiokoulutuksen 2007 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007 <> '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.luopiskjarj2007
	-- ammattikorkeakoulutuksen 2007 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskjarj2007 = '' then l.amkopiskjarj2007 
	-- yliopistokoulutuksen 2006 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  = '' and l.yoopiskjarj2007  <> '' and 
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007 = ''   then l.yoopiskjarj2007
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2006, merkitään ammattikorkekoulutuksen järjestäjä 2006   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   <> '' and
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007  = ''  then l.amkopiskjarj2007 
	
	-- lukiokoulutuksen järjestäjä 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008 = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008 
	-- ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and yoopiskjarj2008 = ''  then l.ammopiskjarj2008 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2006, merkitään lukiokoulutuksen 2008 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008
	-- ammattikorkeakoulutuksen 2008 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then l.amkopiskjarj2008 
	-- yliopistokoulutuksen 2006 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then l.yoopiskjarj2008
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2006, merkitään ammattikorkekoulutuksen järjestäjä 2006   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.amkopiskjarj2008 

    -- lukiokoulutuksen järjestäjä 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009 
	-- ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and yoopiskjarj2009 = ''  then l.ammopiskjarj2009 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2006, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009
	-- ammattikorkeakoulutuksen 2009 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then l.amkopiskjarj2009 
	-- yliopistokoulutuksen 2006 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then l.yoopiskjarj2009
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2006, merkitään ammattikorkekoulutuksen järjestäjä 2006   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.amkopiskjarj2009 


	-- lukiokoulutuksen järjestäjä 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010 
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and yoopiskjarj2010 = ''  then l.ammopiskjarj2010 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2006, merkitään lukiokoulutuksen 2010 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then l.amkopiskjarj2010 
	-- yliopistokoulutuksen 2006 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then l.yoopiskjarj2010
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2006, merkitään ammattikorkekoulutuksen järjestäjä 2006   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.amkopiskjarj2010 

	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2005   <> '' and l.ammopiskmaak2005  = '' and
	l.amkopiskmaak2005  = '' and l.yoopiskmaak2005  = '' then l.luopiskmaak2005   
	-- ammatillisen koulutuksen maakunta 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2005  = '' and l.ammopiskmaak2005  <> '' and
	l.amkopiskmaak2005  ='' and l.yoopiskmaak2005  = ''  then l.ammopiskmaak2005  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2005  <> '' and l.ammopiskmaak2005  <> '' and
	l.amkopiskmaak2005  = '' and l.yoopiskmaak2005  = '' then l.luopiskmaak2005 
    -- ammattikorkeakoulutuksen maakunta 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2005   <> '' and l.yoopiskmaak2005   = '' and
	l.luopiskjarj2005 = '' and l.ammopiskmaak2005 = '' then l.amkopiskmaak2005
	-- yliopistokoulutuksen maakunta 2005 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2005  = '' and l.yoopiskmaak2005  <> '' and 
	l.luopiskjarj2005  = '' and l.ammopiskmaak2005 = ''   then l.yoopiskmaak2005
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta 2005   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2005  <> '' and l.yoopiskmaak2005   <> '' and
	l.luopiskjarj2005  = '' and l.ammopiskmaak2005  = ''  then l.amkopiskmaak2005 
	
	
	-- lukioopiskelun maakunta 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006   <> '' and l.ammopiskmaak2006  = '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = '' then l.luopiskmaak2006
	-- ammatillisen koulutksen maakunta 2006    
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006  = '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  ='' and l.yoopiskmaak2006  = ''  then l.ammopiskmaak2006
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2006  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006  <> '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = '' then l.luopiskmaak2006 
	-- ammattikorkekoulutuksen maakunta 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006   <> '' and l.yoopiskmaak2006   = '' and
	l.luopiskmaak2006 = '' and l.ammopiskmaak2006 = '' then l.amkopiskmaak2006
	-- yliopistokoulutuksen maakunta 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  <> '' and 
	l.luopiskmaak2006  = '' and l.ammopiskmaak2006 = ''   then l.yoopiskmaak2006
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2006, otetaan talteen ammattikorkekoulutksen maakunta 2006   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006  <> '' and l.yoopiskmaak2006   <> '' and
	l.luopiskmaak2006  = '' and l.ammopiskmaak2006  = ''  then l.amkopiskmaak2006 
	
    -- lukioopiskelun maakunta 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007   <> '' and l.ammopiskmaak2007  = '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.luopiskmaak2007
	-- ammatillisen koulutksen maakunta 2007    
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007  = '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  ='' and l.yoopiskmaak2007  = ''  then l.ammopiskmaak2007
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2006  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007  <> '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.luopiskmaak2007 
	-- ammattikorkekoulutuksen maakunta 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007   <> '' and l.yoopiskmaak2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskmaak2007 = '' then l.amkopiskmaak2007
	-- yliopistokoulutuksen maakunta 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  <> '' and 
	l.luopiskjarj2007  = '' and l.ammopiskmaak2007 = ''   then l.yoopiskmaak2007
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2006, otetaan talteen ammattikorkekoulutksen maakunta 2006   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007  <> '' and l.yoopiskmaak2007   <> '' and
	l.luopiskjarj2007  = '' and l.ammopiskmaak2007  = ''  then l.amkopiskmaak2007 
	
	 -- lukioopiskelun maakunta 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008
	-- ammatillisen koulutksen maakunta 2008    
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  ='' and l.yoopiskmaak2008  = ''  then l.ammopiskmaak2008
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2006  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008 
	-- ammattikorkekoulutuksen maakunta 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskmaak2008 = '' then l.amkopiskmaak2008
	-- yliopistokoulutuksen maakunta 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskmaak2008 = ''   then l.yoopiskmaak2008
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2006, otetaan talteen ammattikorkekoulutksen maakunta 2006   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskmaak2008  = ''  then l.amkopiskmaak2008 
	

	
 -- lukioopiskelun maakunta 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009
	-- ammatillisen koulutksen maakunta 2009    
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then l.ammopiskmaak2009
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2006  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009 
	-- ammattikorkekoulutuksen maakunta 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskmaak2009 = '' then l.amkopiskmaak2009
	-- yliopistokoulutuksen maakunta 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskmaak2009 = ''   then l.yoopiskmaak2009
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2006, otetaan talteen ammattikorkekoulutksen maakunta 2006   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskmaak2009  = ''  then l.amkopiskmaak2009 


	 -- lukioopiskelun maakunta 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010
	-- ammatillisen koulutksen maakunta 2010    
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010  = ''  then l.ammopiskmaak2010
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2006  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010 
	-- ammattikorkekoulutuksen maakunta 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskmaak2010 = '' then l.amkopiskmaak2010
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskmaak2010 = ''   then l.yoopiskmaak2010
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2006, otetaan talteen ammattikorkekoulutksen maakunta 2006   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskmaak2010  = ''  then l.amkopiskmaak2010 

	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 = '' and
	l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi 2005 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 <> '' and
	l.amkopiskkoulk2005 ='' and l.yoopiskkoulk2005 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus 2005 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 <> '' and
	l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then l.ammopiskkoulk2005 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2005  <> '' and l.yoopiskkoulk2005  = '' and
	l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 <> '' and 
	l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2005 <> '' and l.yoopiskkoulk2005  <> '' and
	l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = ''  then l.yoopiskkoulk2005
	
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2006 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 ='' and l.yoopiskkoulk2006 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then l.ammopiskkoulk2006
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006  <> '' and l.yoopiskkoulk2006  = '' and
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 <> '' and 
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006 <> '' and l.yoopiskkoulk2006  <> '' and
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''  then l.yoopiskkoulk2006   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 ='' and l.yoopiskkoulk2007 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.ammopiskkoulk2007
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007  <> '' and l.yoopiskkoulk2007  = '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 <> '' and 
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007  <> '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''  then l.yoopiskkoulk2007   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.ammopiskkoulk2008
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.yoopiskkoulk2008   

	 -- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.ammopiskkoulk2009
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.yoopiskkoulk2009  

	 -- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.ammopiskkoulk2010
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.yoopiskkoulk2010  
	
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2005 <> '' and l.ammopisktunn2005 = '' and
	l.amkopisktunn2005 = '' and l.yoopisktunn2005 = '' then ''
	-- ammatillisen koulutuksen oppilaitos 2005 merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2005 = '' and l.ammopisktunn2005 <> '' and
	l.amkopisktunn2005 ='' and l.yoopisktunn2005 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2005 <> '' and l.ammopisktunn2005 <> '' and
	l.amkopisktunn2005 = '' and l.yoopisktunn2005 = '' then l.ammopisktunn2005 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2005  <> '' and l.yoopisktunn2005  = '' and
	l.luopisktunn2005 = '' and l.ammopisktunn2005 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2005 = '' and l.yoopisktunn2005 <> '' and 
	l.luopisktunn2005 = '' and l.ammopisktunn2005 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2005 <> '' and l.yoopisktunn2005  <> '' and
	l.luopisktunn2005 = '' and l.ammopisktunn2005 = ''  then l.yoopisktunn2005 
	
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 = '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 = '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 ='' and yoopisktunn2006 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then l.ammopisktunn2006 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006  <> '' and l.yoopisktunn2006  = '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006 = '' and l.yoopisktunn2006 <> '' and 
	l.luopisktunn2006 = '' and l.ammopisktunn2006  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2006 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2006 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006 <> '' and l.yoopisktunn2006  <> '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = ''  then l.yoopisktunn2006 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 = '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 = '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 ='' and yoopisktunn2007 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.ammopisktunn2007 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007  <> '' and l.yoopisktunn2007  = '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007 = '' and l.yoopisktunn2007 <> '' and 
	l.luopisktunn2007 = '' and l.ammopisktunn2007  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2007 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2006 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007 <> '' and l.yoopisktunn2007  <> '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''  then l.yoopisktunn2007 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and yoopisktunn2008 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.ammopisktunn2008 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2008 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2006 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.yoopisktunn2008 
	
	 -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and yoopisktunn2009 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.ammopisktunn2009 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2006 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.yoopisktunn2009 


	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and yoopisktunn2010 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.ammopisktunn2010 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2010 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2006 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.yoopisktunn2010  
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain 2005, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2005  <> '' and l.ammopiskjarj2005 = '' and
	l.amkopiskjarj2005 = '' and l.yoopiskjarj2005 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain 2005, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2005 = '' and l.ammopiskjarj2005 <> '' and
	l.amkopiskjarj2005 ='' and l.yoopiskjarj2005 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2005 <> '' and l.ammopiskjarj2005 <> '' and
	l.amkopiskjarj2005 = '' and l.yoopiskjarj2005 = '' then l.ammopiskjarj2005 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2005  <> '' and l.yoopiskjarj2005   = '' and
	l.luopiskjarj2005 = '' and l.ammopiskjarj2005 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2005  = '' and l.yoopiskjarj2005  <> '' and 
	l.luopiskjarj2005  = '' and l.ammopiskjarj2005 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2005  <> '' and l.yoopiskjarj2005   <> '' and
	l.luopiskjarj2005  = '' and l.ammopiskjarj2005  = ''  then l.yoopiskjarj2005 
	
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006  <> '' and l.ammopiskjarj2006 = '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006 = '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 ='' and l.yoopiskjarj2006 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006 <> '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then l.ammopiskjarj2006 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   = '' and
	l.luopiskjarj2006 = '' and l.ammopiskjarj2006 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  = '' and l.yoopiskjarj2006  <> '' and 
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   <> '' and
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006  = ''  then l.yoopiskjarj2006 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007  <> '' and l.ammopiskjarj2007 = '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007 = '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 ='' and l.yoopiskjarj2007 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007 <> '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.ammopiskjarj2007 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskjarj2007 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  = '' and l.yoopiskjarj2007  <> '' and 
	l.luopiskjarj2007 = '' and l.ammopiskjarj2007 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   <> '' and
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007  = ''  then l.yoopiskjarj2007 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008 = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and l.yoopiskjarj2008 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.ammopiskjarj2008 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.yoopiskjarj2008 

	 -- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and l.yoopiskjarj2009 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.ammopiskjarj2009 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.yoopiskjarj2009 

	 -- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and l.yoopiskjarj2010 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.ammopiskjarj2010 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.yoopiskjarj2010 
	
	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta 2005, jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2005   <> '' and l.ammopiskmaak2005  = '' and
	l.amkopiskmaak2005  = '' and l.yoopiskmaak2005  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2005, jätetään tyhjäksi   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2005  = '' and l.ammopiskmaak2005  <> '' and
	l.amkopiskmaak2005  ='' and l.yoopiskmaak2005  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2005  <> '' and l.ammopiskmaak2005  <> '' and
	l.amkopiskmaak2005  = '' and l.yoopiskmaak2005  = '' then l.ammopiskmaak2005 
	-- vain ammattikorkeakoulutuksen maakunta 2005, jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2005   <> '' and l.yoopiskmaak2005   = '' and
	l.luopiskmaak2005 = '' and l.ammopiskmaak2005 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2005, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2005  = '' and l.yoopiskmaak2005  <> '' and 
	l.luopiskmaak2006  = '' and l.ammopiskmaak2005 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2005, merkitään yliopistokoulutuksen maakunta 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2005  <> '' and l.yoopiskmaak2005   <> '' and
	l.luopiskjarj2005  = '' and l.ammopiskmaak2005  = ''  then l.yoopiskmaak2005
	
	
	-- vain lukiokoulutuksen maakunta 2006, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006   <> '' and l.ammopiskmaak2006  = '' and
	l.amkopiskmaak2006  = '' and yoopiskmaak2006  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2006, merkitään tyhjäksi   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006  = '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  ='' and l.yoopiskmaak2006  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2006, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006  <> '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = '' then l.ammopiskmaak2006 
	-- vain ammattikorkeakoulutuksen maakunta 2006, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006   <> '' and l.yoopiskmaak2006   = '' and
	l.luopiskmaak2006 = '' and l.ammopiskmaak2006 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2006, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  <> '' and 
	l.luopiskmaak2006  = '' and l.ammopiskmaak2006 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2006, merkitään yliopistokoulutuksen 2006 maakunta 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006  <> '' and l.yoopiskmaak2006   <> '' and
	l.luopiskmaak2006  = '' and l.ammopiskmaak2006  = ''  then l.yoopiskmaak2006  
	
	
	-- vain lukiokoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007   <> '' and l.ammopiskmaak2007  = '' and
	l.amkopiskmaak2007  = '' and yoopiskmaak2007  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2007, merkitään tyhjäksi   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007  = '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2007, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007  <> '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.ammopiskmaak2007 
	-- vain ammattikorkeakoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007   <> '' and l.yoopiskmaak2007   = '' and
	l.luopiskmaak2007 = '' and l.ammopiskmaak2007 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  <> '' and 
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2007, merkitään yliopistokoulutuksen 2006 maakunta 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007  <> '' and l.yoopiskmaak2007   <> '' and
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007  = ''  then l.yoopiskmaak2007  
	
	-- vain lukiokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and yoopiskmaak2008  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2008, merkitään tyhjäksi   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2008, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.ammopiskmaak2008 
	-- vain ammattikorkeakoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2008, merkitään yliopistokoulutuksen 2006 maakunta 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008  = ''  then l.yoopiskmaak2008  

	-- vain lukiokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and yoopiskmaak2009  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2009, merkitään tyhjäksi   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2009, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.ammopiskmaak2009 
	-- vain ammattikorkeakoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2009, merkitään yliopistokoulutuksen 2006 maakunta 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.yoopiskmaak2009  


	-- vain lukiokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and yoopiskmaak2010  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2010, merkitään tyhjäksi   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2010, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.ammopiskmaak2010 
	-- vain ammattikorkeakoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2010, merkitään yliopistokoulutuksen 2006 maakunta 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.yoopiskmaak2010  
	
	else ''
	
	    end),
	-- Monihaku
	(case
	-- 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.monihaku2005
	--2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1'  then l.monihaku2006
	-- 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.monihaku2007
	-- 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.monihaku2008
    -- 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.monihaku2009
 
    -- 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.monihaku2010
	
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2005
	-- 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2006 
	-- 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2007
	-- 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2008
	-- 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2009
	-- 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2010
   
	else ''
	end),
	-- Ammattiasema
	(case
	-- 2005
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.amas_2005
	-- 2006
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' then l.amas_2006
	-- 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.amas_2007
	-- 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.amas_2008
	-- 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.amas_2009
	-- 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.amas_2010

	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2005 <> '' and l.ammopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' and l.amkopiskkoulk2005 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then '1'  
 	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then '1'  
        when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1'  
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2005  <> '' and l.luopiskkoulk2005 = '' and l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2006 <> '' and l.luopiskkoulk2006  = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then '1'   
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2007 <> '' and l.luopiskkoulk2007  = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then '1'    
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2008 <> '' and l.luopiskkoulk2008  = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then '1'    
		when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2009 <> '' and l.luopiskkoulk2009  = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1' 
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2010 <> '' and l.luopiskkoulk2010  = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'     
	   
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2005 <> '' and l.ammopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' and l.luopiskkoulk2005 = '' then  '1'
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.luopiskkoulk2006 = '' then  '1'
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.luopiskkoulk2007 = '' then  '1'
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' then  '1'
       when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' then  '1'
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2005  <> '' and l.amkopiskkoulk2005 = '' and l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2006 <> '' and l.amkopiskkoulk2006 = '' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2007 <> '' and l.amkopiskkoulk2007 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' then '1'  	   
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then '1'  	   
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then '1'  
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then '1'  		   
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2005  <> '' and l.ammopiskkoulk2005 <> '' and l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005  = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 <> '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then '1'  
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1'  
		 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1' 
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2005  <> '' and l.amkopiskkoulk2005 <> '' and l.luopiskkoulk2005 = '' and l.yoopiskkoulk2005 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2006  <> '' and l.amkopiskkoulk2006 <> ''  and l.luopiskkoulk2006 = '' and l.yoopiskkoulk2006  = '' then '1' 
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2007 <> '' and l.amkopiskkoulk2007 <> ''  and l.luopiskkoulk2007 = '' and l.yoopiskkoulk2007  = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 <> ''  and l.luopiskkoulk2008 = '' and l.yoopiskkoulk2008  = '' then '1'  
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 <> ''  and l.luopiskkoulk2009 = '' and l.yoopiskkoulk2009  = '' then '1'  
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 <> ''  and l.luopiskkoulk2010 = '' and l.yoopiskkoulk2010  = '' then '1' 
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2005  <> '' and l.yoopiskkoulk2005 <> '' and l.ammopiskkoulk2005  = '' and l.luopiskkoulk2005 = ''  then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2006 <> '' and l.yoopiskkoulk2006 <> ''  and l.ammopiskkoulk2006  = '' and l.luopiskkoulk2006 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007 <> ''  and l.ammopiskkoulk2007  = '' and l.luopiskkoulk2007 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008 <> ''  and l.ammopiskkoulk2008  = '' and l.luopiskkoulk2008 = '' then '1'  
	     when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009 <> ''  and l.ammopiskkoulk2009  = '' and l.luopiskkoulk2009 = '' then '1'  
		  when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010 <> ''  and l.ammopiskkoulk2010  = '' and l.luopiskkoulk2010 = '' then '1'  
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
       -- Tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')  and (l.ptoim1r4_2005 = '22' or l.ptoim1r4_2005 = '13') 
	   and (l.luopiskkoulk2005 <> '' or l.ammopiskkoulk2005<>'' or l.amkopiskkoulk2005 <> '' or l.yoopiskkoulk2005<>'') then '1' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2006 = '22' or l.ptoim1r4_2006  = '13')
	   and (l.luopiskkoulk2006 <> '' or l.ammopiskkoulk2006<>'' or l.amkopiskkoulk2006 <> '' or l.yoopiskkoulk2006<>'') then '1' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2007 = '22' or l.ptoim1r4_2007 = '13')
	   and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007<>'' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007<>'') then '1' 
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 = '13')
	   and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008<>'' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008<>'') then '1'
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13')
	   and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009<>'' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009<>'') then '1'
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13')
	   and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010<>'' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010<>'') then '1'
	   
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')  and (l.ptoim1r4_2005 = '22' or l.ptoim1r4_2005 = '13') 
	   and (l.luopiskkoulk2005 = '' and l.ammopiskkoulk2005='' and l.amkopiskkoulk2005 = '' and l.yoopiskkoulk2005='') then '2' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2006 = '22' or l.ptoim1r4_2006  = '13')
	   and (l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006='' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006='') then '2' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2007 = '22' or l.ptoim1r4_2007 = '13')
	    and (l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007='' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007='')	 then '2' 
	     when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 = '13')
	    and (l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008='' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008='')	 then '2' 
     when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13')
	    and (l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009='' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009='')	 then '2' 
		 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13')
	    and (l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010='' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010='')	 then '2' 

	   -- Ei opiskelevat työlliset
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')and  l.ptoim1r4_2005  = '10'  then '3' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2006 = '10'  then '3'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2007 = '10'  then '3' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2008 = '10'  then '3' 
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2009 = '10'  then '3' 
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2010 = '10'  then '3' 


	    
	   -- Ei opiskelevat työttömät
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2005  = '12'  then '4' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2006 = '12'  then '4' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2007 = '12'  then '4' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2008 = '12'  then '4' 
	 when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2009 = '12'  then '4' 
	 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2010 = '12'  then '4' 
	
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
  ,ika_1v = cast((case 
            when syntv = '' then '-1' 
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where (suorv = '2004' or suorv = '2005' or suorv = '2006' or suorv = '2007' or suorv = '2008' or suorv= '2009' ) and suorlk = '1'
	) as l
	
	
	WHERE 1=1
end;

--
-- TULOS
-- 
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_2_0_tarkastelujakso]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_2_0_tarkastelujakso]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_2_0_tarkastelujakso] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_2_0_tarkastelujakso] AS
declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;

set @ensimmainen_suoritusvuosi = 2004;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;


INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
,lkm
,pohjkoulk
,tietolahde
, aineisto
 ,lukiokoulutuksessa
 ,ammatillisessa_koulutuksessa
 ,ammattikorkeakoulutuksessa
 ,yliopistokoulutuksessa
 ,lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
 ,toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
 ,ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
 ,koulutuksen_paattaneiden_toiminta
 ,ika_1v
 ,ika_5v
)
SELECT
 l.rivinumero,
 '2',
 l.tilv,
 l.tilv_date,
 l.tutkryh,
 l.suorv,
 (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then l.luopiskkoulk2006 
	-- ammattikoulutuksessa 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 ='' and l.yoopiskkoulk2006 = ''  then l.ammopiskkoulk2006 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2006 ensim. koulutustietoihin
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then l.luopiskkoulk2006
	-- ammattikorkeakoulutuksessa 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006  <> '' and l.yoopiskkoulk2006  = '' and
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' then l.amkopiskkoulk2006
	-- yliopistokoulutuksessa 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 <> '' and 
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''   then l.yoopiskkoulk2006
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006 <> '' and l.yoopiskkoulk2006  <> '' and
	l.luopiskkoulk2006 = '' and ammopiskkoulk2006 = ''  then l.amkopiskkoulk2006 
	
	
	-- lukiokoulutuksessa 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.luopiskkoulk2007
	-- ammatillisessa koulutuksessa 2007 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 ='' and l.yoopiskkoulk2007 = ''  then l.ammopiskkoulk2007 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2007 ensimäisiin koulutustietoihin
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.luopiskkoulk2007
	-- ammattikorkeakoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007  <> '' and l.yoopiskkoulk2007  = '' and
	l.luopiskkoulk2007  = '' and l.ammopiskkoulk2007 = '' then l.amkopiskkoulk2007
	-- yliopistokoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 <> '' and 
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''   then l.yoopiskkoulk2007 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007  <> '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''  then l.amkopiskkoulk2007 
	
	
	-- lukiokoulutuksessa 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammatillisessa koulutuksessa 2008 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then l.ammopiskkoulk2008 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2008 ensimäisiin koulutustietoihin
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008  = '' and l.ammopiskkoulk2008 = '' then l.amkopiskkoulk2008
	-- yliopistokoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then l.yoopiskkoulk2008 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.amkopiskkoulk2008 
	
		-- lukiokoulutuksessa 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammatillisessa koulutuksessa 2009 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then l.ammopiskkoulk2009 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2009 ensimäisiin koulutustietoihin
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammattikorkeakoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009  = '' and l.ammopiskkoulk2009 = '' then l.amkopiskkoulk2009
	-- yliopistokoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then l.yoopiskkoulk2009 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.amkopiskkoulk2009 
	
		-- lukiokoulutuksessa 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammatillisessa koulutuksessa 2010 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then l.ammopiskkoulk2010 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammattikorkeakoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010  = '' and l.ammopiskkoulk2010 = '' then l.amkopiskkoulk2010
	-- yliopistokoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then l.yoopiskkoulk2010 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.amkopiskkoulk2010 

		-- lukiokoulutuksessa 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammatillisessa koulutuksessa 2011 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then l.ammopiskkoulk2011 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2011 ensimäisiin koulutustietoihin
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011  = '' and l.ammopiskkoulk2011 = '' then l.amkopiskkoulk2011
	-- yliopistokoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then l.yoopiskkoulk2011 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.amkopiskkoulk2011 

	
	else ''
	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 = '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then l.luopisktunn2006 
	-- ammattikoulutuksen oppilaitos 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 = '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 ='' and l.yoopisktunn2006 = ''  then l.ammopisktunn2006 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then l.luopisktunn2006
	-- ammattikorkeakoulutuksen oppilaitos 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006  <> '' and l.yoopisktunn2006  = '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = '' then l.amkopisktunn2006
	-- yliopistokoulutuksen oppilaitos 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006 = '' and l.yoopisktunn2006 <> '' and 
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = ''   then l.yoopisktunn2006
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2006  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006 <> '' and l.yoopisktunn2006  <> '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = ''  then l.amkopisktunn2006 
	
	
	-- lukiokoulutuksen oppilaitos 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 = '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.luopisktunn2007
	-- ammatillisen koulutuksen oppilaitos 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 = '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 ='' and l.yoopisktunn2007 = ''  then l.ammopisktunn2007
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.luopisktunn2007
	-- ammattikorkeakoulutuksen oppilaitos 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007  <> '' and l.yoopisktunn2007  = '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = '' then l.amkopisktunn2007
	-- yliopistokoulutuksen oppilaitos 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007 = '' and l.yoopisktunn2007 <> '' and 
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''   then l.yoopisktunn2007  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2007  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007 <> '' and l.yoopisktunn2007  <> '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''  then l.amkopisktunn2007 
	
	-- lukiokoulutuksen oppilaitos 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammatillisen koulutuksen oppilaitos 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and l.yoopisktunn2008 = ''  then l.ammopisktunn2008
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammattikorkeakoulutuksen oppilaitos 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then l.amkopisktunn2008
	-- yliopistokoulutuksen oppilaitos 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''   then l.yoopisktunn2008 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2007  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.amkopisktunn2008
	
	-- lukiokoulutuksen oppilaitos 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammatillisen koulutuksen oppilaitos 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and l.yoopisktunn2009 = ''  then l.ammopisktunn2009
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammattikorkeakoulutuksen oppilaitos 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then l.amkopisktunn2009
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''   then l.yoopisktunn2009 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2007  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.amkopisktunn2009

	-- lukiokoulutuksen oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and l.yoopisktunn2010 = ''  then l.ammopisktunn2010
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2007
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then l.amkopisktunn2010
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''   then l.yoopisktunn2010 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2007  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.amkopisktunn2010

	-- lukiokoulutuksen oppilaitos 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammatillisen koulutuksen oppilaitos 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and l.yoopisktunn2011 = ''  then l.ammopisktunn2011
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2007
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammattikorkeakoulutuksen oppilaitos 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then l.amkopisktunn2011
	-- yliopistokoulutuksen oppilaitos 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''   then l.yoopisktunn2011 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2007  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.amkopisktunn2011

	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006  <> '' and l.ammopiskjarj2006 = '' and
	l.amkopiskjarj2006 = '' and yoopiskjarj2006 = '' then l.luopiskjarj2006
	-- ammatillisen koulutuksen järjestäjä 2006  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006 = '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 ='' and l.yoopiskjarj2006 = ''  then l.ammopiskjarj2006
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen 2006 järjestäjä 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006 <> '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then l.luopiskjarj2006
	-- ammattikorkeakoulutuksen järjestäjä 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   = '' and
	l.luopiskjarj2006 = '' and l.ammopiskjarj2006 = '' then l.amkopiskjarj2006
	-- yliopistokoulutuksen järjestäjä 2006 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  = '' and l.yoopiskjarj2006  <> '' and 
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006 = ''   then l.yoopiskjarj2006
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen 2006 järjestäjä   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   <> '' and
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006  = ''  then l.amkopiskjarj2006 

	
	-- lukiokoulutuksen järjestäjä 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007  <> '' and l.ammopiskjarj2007  = '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.luopiskjarj2007  
	-- ammatillisen koulutuksen järjestäjä 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007 = '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 ='' and yoopiskjarj2007 = ''  then l.ammopiskjarj2007 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2007, merkitään lukiokoulutuksen 2007 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007 <> '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.luopiskjarj2007
	-- ammattikorkeakoulutuksen 2007 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskjarj2007 = '' then l.amkopiskjarj2007 
	-- yliopistokoulutuksen 2007 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  = '' and l.yoopiskjarj2007  <> '' and 
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007 = ''   then l.yoopiskjarj2007
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2007, merkitään ammattikorkekoulutuksen järjestäjä 2007   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   <> '' and
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007  = ''  then l.amkopiskjarj2007 
	
	-- lukiokoulutuksen järjestäjä 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008 = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008 
	-- ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and yoopiskjarj2008 = ''  then l.ammopiskjarj2008 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2007, merkitään lukiokoulutuksen 2008 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008
	-- ammattikorkeakoulutuksen 2008 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then l.amkopiskjarj2008 
	-- yliopistokoulutuksen 2007 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then l.yoopiskjarj2008
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2007, merkitään ammattikorkekoulutuksen järjestäjä 2007   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.amkopiskjarj2008 
	
	-- lukiokoulutuksen järjestäjä 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009 
	-- ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and yoopiskjarj2009 = ''  then l.ammopiskjarj2009 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2007, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009
	-- ammattikorkeakoulutuksen 2009 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then l.amkopiskjarj2009 
	-- yliopistokoulutuksen 2007 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then l.yoopiskjarj2009
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2007, merkitään ammattikorkekoulutuksen järjestäjä 2007   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.amkopiskjarj2009
	
	-- lukiokoulutuksen järjestäjä 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010 
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and yoopiskjarj2010 = ''  then l.ammopiskjarj2010 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2007, merkitään lukiokoulutuksen 2010 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then l.amkopiskjarj2010 
	-- yliopistokoulutuksen 2007 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then l.yoopiskjarj2010
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2007, merkitään ammattikorkekoulutuksen järjestäjä 2007   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.amkopiskjarj2010  

	-- lukiokoulutuksen järjestäjä 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011 
	-- ammatillisen koulutuksen järjestäjä 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and yoopiskjarj2011 = ''  then l.ammopiskjarj2011 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2007, merkitään lukiokoulutuksen 2011 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011
	-- ammattikorkeakoulutuksen 2011 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then l.amkopiskjarj2011 
	-- yliopistokoulutuksen 2007 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''   then l.yoopiskjarj2011
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2007, merkitään ammattikorkekoulutuksen järjestäjä 2007   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011  = ''  then l.amkopiskjarj2011  
	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006   <> '' and l.ammopiskmaak2006  = '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = '' then l.luopiskmaak2006   
	-- ammatillisen koulutuksen maakunta 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006  = '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  ='' and l.yoopiskmaak2006  = ''  then l.ammopiskmaak2006  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006  <> '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = '' then l.luopiskmaak2006 
    -- ammattikorkeakoulutuksen maakunta 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006   <> '' and l.yoopiskmaak2006   = '' and
	l.luopiskjarj2006 = '' and l.ammopiskmaak2006 = '' then l.amkopiskmaak2006
	-- yliopistokoulutuksen maakunta 2006 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  <> '' and 
	l.luopiskjarj2006  = '' and l.ammopiskmaak2006 = ''   then l.yoopiskmaak2006
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta 2006   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006  <> '' and l.yoopiskmaak2006   <> '' and
	l.luopiskjarj2006  = '' and l.ammopiskmaak2006  = ''  then l.amkopiskmaak2006 
	
	
	-- lukioopiskelun maakunta 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007   <> '' and l.ammopiskmaak2007  = '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.luopiskmaak2007
	-- ammatillisen koulutksen maakunta 2007    
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007  = '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  ='' and l.yoopiskmaak2007  = ''  then l.ammopiskmaak2007
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2007  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007  <> '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.luopiskmaak2007 
	-- ammattikorkekoulutuksen maakunta 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007   <> '' and l.yoopiskmaak2007   = '' and
	l.luopiskmaak2007 = '' and l.ammopiskmaak2007 = '' then l.amkopiskmaak2007
	-- yliopistokoulutuksen maakunta 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  <> '' and 
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007 = ''   then l.yoopiskmaak2007
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2007, otetaan talteen ammattikorkekoulutksen maakunta 2007   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007  <> '' and l.yoopiskmaak2007   <> '' and
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007  = ''  then l.amkopiskmaak2007 
	
    -- lukioopiskelun maakunta 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008
	-- ammatillisen koulutksen maakunta 2008    
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  ='' and l.yoopiskmaak2008  = ''  then l.ammopiskmaak2008
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2007  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008 
	-- ammattikorkekoulutuksen maakunta 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then l.amkopiskmaak2008
	-- yliopistokoulutuksen maakunta 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008 = ''   then l.yoopiskmaak2008
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2007, otetaan talteen ammattikorkekoulutksen maakunta 2007   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008  = ''  then l.amkopiskmaak2008 
	
	 -- lukioopiskelun maakunta 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009
	-- ammatillisen koulutksen maakunta 2009    
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then l.ammopiskmaak2009
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2007  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009 
	-- ammattikorkekoulutuksen maakunta 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then l.amkopiskmaak2009
	-- yliopistokoulutuksen maakunta 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then l.yoopiskmaak2009
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2007, otetaan talteen ammattikorkekoulutksen maakunta 2007   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.amkopiskmaak2009 

		 -- lukioopiskelun maakunta 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010
	-- ammatillisen koulutksen maakunta 2010    
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010  = ''  then l.ammopiskmaak2010
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2007  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010 
	-- ammattikorkekoulutuksen maakunta 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then l.amkopiskmaak2010
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then l.yoopiskmaak2010
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.amkopiskmaak2010 

		 -- lukioopiskelun maakunta 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011   <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011
	-- ammatillisen koulutksen maakunta 2011    
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  ='' and l.yoopiskmaak2011  = ''  then l.ammopiskmaak2011
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2007  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011 
	-- ammattikorkekoulutuksen maakunta 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then l.amkopiskmaak2011
	-- yliopistokoulutuksen maakunta 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then l.yoopiskmaak2011
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2011, otetaan talteen ammattikorkekoulutksen maakunta 2011  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.amkopiskmaak2011 
	
	
	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi 2006 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 ='' and l.yoopiskkoulk2006 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus 2006 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 <> '' and
	l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then l.ammopiskkoulk2006 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006  <> '' and l.yoopiskkoulk2006  = '' and
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 <> '' and 
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2006 <> '' and l.yoopiskkoulk2006  <> '' and
	l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = ''  then l.yoopiskkoulk2006
	
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2007 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 ='' and l.yoopiskkoulk2007 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.ammopiskkoulk2007
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007  <> '' and l.yoopiskkoulk2007  = '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 <> '' and 
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007  <> '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''  then l.yoopiskkoulk2007   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.ammopiskkoulk2008
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.yoopiskkoulk2008   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.ammopiskkoulk2009
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.yoopiskkoulk2009   

	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.ammopiskkoulk2010
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.yoopiskkoulk2010   


	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.ammopiskkoulk2011
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.yoopiskkoulk2011   
	
	
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 = '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then ''
	-- ammatillisen koulutuksen oppilaitos 2006 merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 = '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 ='' and l.yoopisktunn2006 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2006 <> '' and l.ammopisktunn2006 <> '' and
	l.amkopisktunn2006 = '' and l.yoopisktunn2006 = '' then l.ammopisktunn2006 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006  <> '' and l.yoopisktunn2006  = '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006 = '' and l.yoopisktunn2006 <> '' and 
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2006 <> '' and l.yoopisktunn2006  <> '' and
	l.luopisktunn2006 = '' and l.ammopisktunn2006 = ''  then l.yoopisktunn2006 
	
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 = '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 = '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 ='' and yoopisktunn2007 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.ammopisktunn2007 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007  <> '' and l.yoopisktunn2007  = '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007 = '' and l.yoopisktunn2007 <> '' and 
	l.luopisktunn2007 = '' and l.ammopisktunn2007  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2007 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2007 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007 <> '' and l.yoopisktunn2007  <> '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''  then l.yoopisktunn2007 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and yoopisktunn2008 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.ammopisktunn2008 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2008 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2007 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.yoopisktunn2008 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and yoopisktunn2009 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.ammopisktunn2009 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2007 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.yoopisktunn2009 

	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and yoopisktunn2010 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.ammopisktunn2010 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2010 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2007 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.yoopisktunn2010 

	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and yoopisktunn2011 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.ammopisktunn2011 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2011 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2007 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.yoopisktunn2011 
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain 2006, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006  <> '' and l.ammopiskjarj2006 = '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain 2006, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006 = '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 ='' and l.yoopiskjarj2006 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2006 <> '' and l.ammopiskjarj2006 <> '' and
	l.amkopiskjarj2006 = '' and l.yoopiskjarj2006 = '' then l.ammopiskjarj2006 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   = '' and
	l.luopiskjarj2006 = '' and l.ammopiskjarj2006 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  = '' and l.yoopiskjarj2006  <> '' and 
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2006  <> '' and l.yoopiskjarj2006   <> '' and
	l.luopiskjarj2006  = '' and l.ammopiskjarj2006  = ''  then l.yoopiskjarj2006 
	
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007  <> '' and l.ammopiskjarj2007 = '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007 = '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 ='' and l.yoopiskjarj2007 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007 <> '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.ammopiskjarj2007 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskjarj2007 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  = '' and l.yoopiskjarj2007  <> '' and 
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   <> '' and
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007  = ''  then l.yoopiskjarj2007 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008 = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and l.yoopiskjarj2008 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.ammopiskjarj2008 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.yoopiskjarj2008 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and l.yoopiskjarj2009 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.ammopiskjarj2009 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.yoopiskjarj2009 

	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and l.yoopiskjarj2010 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.ammopiskjarj2010 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.yoopiskjarj2010 


	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and l.yoopiskjarj2011 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.ammopiskjarj2011 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011  = ''  then l.yoopiskjarj2011 
	
	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta 2006, jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006   <> '' and l.ammopiskmaak2006  = '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2006, jätetään tyhjäksi   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006  = '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  ='' and l.yoopiskmaak2006  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2006  <> '' and l.ammopiskmaak2006  <> '' and
	l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  = '' then l.ammopiskmaak2006 
	-- vain ammattikorkeakoulutuksen maakunta 2006, jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006   <> '' and l.yoopiskmaak2006   = '' and
	l.luopiskmaak2006 = '' and l.ammopiskmaak2006 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2006, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006  = '' and l.yoopiskmaak2006  <> '' and 
	l.luopiskmaak2007  = '' and l.ammopiskmaak2006 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2006, merkitään yliopistokoulutuksen maakunta 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2006  <> '' and l.yoopiskmaak2006   <> '' and
	l.luopiskjarj2006  = '' and l.ammopiskmaak2006  = ''  then l.yoopiskmaak2006
	
	
	-- vain lukiokoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007   <> '' and l.ammopiskmaak2007  = '' and
	l.amkopiskmaak2007  = '' and yoopiskmaak2007  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2007, merkitään tyhjäksi   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007  = '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  ='' and l.yoopiskmaak2007  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2007, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007  <> '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.ammopiskmaak2007 
	-- vain ammattikorkeakoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007   <> '' and l.yoopiskmaak2007   = '' and
	l.luopiskmaak2007 = '' and l.ammopiskmaak2007 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  <> '' and 
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2007, merkitään yliopistokoulutuksen 2007 maakunta 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007  <> '' and l.yoopiskmaak2007   <> '' and
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007  = ''  then l.yoopiskmaak2007  
	
	
	-- vain lukiokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and yoopiskmaak2008  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2008, merkitään tyhjäksi   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2008, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.ammopiskmaak2008 
	-- vain ammattikorkeakoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2008, merkitään yliopistokoulutuksen 2007 maakunta 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008  = ''  then l.yoopiskmaak2008  
	
		-- vain lukiokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and yoopiskmaak2009  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2009, merkitään tyhjäksi   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2009, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.ammopiskmaak2009 
	-- vain ammattikorkeakoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2009, merkitään yliopistokoulutuksen 2007 maakunta 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.yoopiskmaak2009  
	

	-- vain lukiokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and yoopiskmaak2010  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2010, merkitään tyhjäksi   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2010, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.ammopiskmaak2010 
	-- vain ammattikorkeakoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2010, merkitään yliopistokoulutuksen 2007 maakunta 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.yoopiskmaak2010  



	-- vain lukiokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011   <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and yoopiskmaak2011  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2011, merkitään tyhjäksi   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2011, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.ammopiskmaak2011 
	-- vain ammattikorkeakoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2011, merkitään yliopistokoulutuksen 2007 maakunta 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.yoopiskmaak2011  

	else ''
	
	    end),
	-- Monihaku
	(case
	-- 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.monihaku2006
	--2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1'  then l.monihaku2007
	-- 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.monihaku2008
	-- 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.monihaku2009
	-- 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.monihaku2010
	-- 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.monihaku2011
	
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2006
	-- 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2007 
	-- 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2008
	-- 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2009
	-- 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2010
	-- 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2011
   
	else ''
	end),
	-- Ammattiasema
	(case
	-- 2006
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.amas_2006
	-- 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' then l.amas_2007
	-- 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.amas_2008
	-- 2009	
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.amas_2009
	-- 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.amas_2010
	-- 2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.amas_2011

	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.amkopiskkoulk2006 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then '1'  
  	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1'  
		when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'  
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1'  
    
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2006  <> '' and l.luopiskkoulk2006 = '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2007 <> '' and l.luopiskkoulk2007  = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then '1'   
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2008 <> '' and l.luopiskkoulk2008  = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then '1'    
		when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2009 <> '' and l.luopiskkoulk2009  = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1'    
		when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2010 <> '' and l.luopiskkoulk2010  = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1' 
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2011 <> '' and l.luopiskkoulk2011  = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1'     
   
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2006 <> '' and l.ammopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' and l.luopiskkoulk2006 = '' then  '1'
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.luopiskkoulk2007 = '' then  '1'
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' then  '1'
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' then  '1'
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' then  '1'
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2011 <> '' and l.luopiskkoulk2011  = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1' 
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2006  <> '' and l.amkopiskkoulk2006 = '' and l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2007 <> '' and l.amkopiskkoulk2007 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then '1'  	   
		when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then '1'  	   
        when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then '1'  
		  when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then '1'  
	 
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2006  <> '' and l.ammopiskkoulk2006 <> '' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006  = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1'  
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'  
		 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2006  <> '' and l.amkopiskkoulk2006 <> '' and l.luopiskkoulk2006 = '' and l.yoopiskkoulk2006 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2007  <> '' and l.amkopiskkoulk2007 <> ''  and l.luopiskkoulk2007 = '' and l.yoopiskkoulk2007  = '' then '1' 
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 <> ''  and l.luopiskkoulk2008 = '' and l.yoopiskkoulk2008  = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 <> ''  and l.luopiskkoulk2009 = '' and l.yoopiskkoulk2009  = '' then '1'  
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 <> ''  and l.luopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1' 
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 <> ''  and l.luopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1'   
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2006  <> '' and l.yoopiskkoulk2006 <> '' and l.ammopiskkoulk2006  = '' and l.luopiskkoulk2006 = ''  then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007 <> ''  and l.ammopiskkoulk2007  = '' and l.luopiskkoulk2007 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008 <> ''  and l.ammopiskkoulk2008  = '' and l.luopiskkoulk2008 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009 <> ''  and l.ammopiskkoulk2009  = '' and l.luopiskkoulk2009 = '' then '1'  
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010 <> ''  and l.ammopiskkoulk2010  = '' and l.luopiskkoulk2010 = '' then '1'  
		 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011 <> ''  and l.ammopiskkoulk2011  = '' and l.luopiskkoulk2011 = '' then '1'  
	    
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat 
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')  and (l.ptoim1r4_2006 = '22' or l.ptoim1r4_2006 = '13')
        and (l.luopiskkoulk2006 <> '' or l.ammopiskkoulk2006<>'' or l.amkopiskkoulk2006 <> '' or l.yoopiskkoulk2006<>'')	   then '1' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2007 = '22' or l.ptoim1r4_2007  = '13')
	    and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007<>'' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007<>'')then '1' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 = '13')
	    and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008<>'' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008<>'')then '1' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13')
	    and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009<>'' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009<>'')then '1' 
	     when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13')
	    and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010<>'' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010<>'')then '1' 
		 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
	    and (l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011<>'' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011<>'')then '1' 
		
	 -- Ei tutkintoon johtavassa koulutuksessa olevat 
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')  and (l.ptoim1r4_2006 = '22' or l.ptoim1r4_2006 = '13')
        and (l.luopiskkoulk2006 = '' and l.ammopiskkoulk2006='' and l.amkopiskkoulk2006 = '' and l.yoopiskkoulk2006='')	    then '2' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2007 = '22' or l.ptoim1r4_2007  = '13')
	    and (l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007='' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007='')	 then '2' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 = '13')
	    and (l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008='' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008='')	 then '2' 
	     when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13')
	    and (l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009='' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009='')	 then '2' 
	 when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13')
	    and (l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010='' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010='')	 then '2' 
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
	    and (l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011='' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011='')	 then '2' 
   

	   -- Ei opiskelevat työlliset
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')and  l.ptoim1r4_2006  = '10'  then '3' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2007 = '10'  then '3'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2008 = '10'  then '3' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2009 = '10'  then '3' 
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2010 = '10'  then '3' 
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2011 = '10'  then '3' 
	    
	   -- Ei opiskelevat työttömät
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2006  = '12'  then '4' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2007 = '12'  then '4' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2008 = '12'  then '4' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2009 = '12'  then '4' 
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2010 = '12'  then '4' 
		 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2011 = '12'  then '4' 
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1' 
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where (suorv = '2004' or suorv = '2005' or suorv = '2006' or suorv= '2007' or suorv= '2008' or suorv= '2009' ) and suorlk = '1'
	) as l
	
	
	WHERE 1=1
end;

--
-- TULOS
-- 
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_2_5_tarkastelujakso]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_2_5_tarkastelujakso]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_2_5_tarkastelujakso] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_2_5_tarkastelujakso] AS

declare @debug_what_to_run tinyint; set @debug_what_to_run=1; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';


-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;

set @ensimmainen_suoritusvuosi = 2004;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;



INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn 
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
,lkm
,pohjkoulk
,tietolahde
, aineisto
 ,lukiokoulutuksessa
 ,ammatillisessa_koulutuksessa
 ,ammattikorkeakoulutuksessa
 ,yliopistokoulutuksessa
 ,lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
 ,toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
 ,ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
 ,koulutuksen_paattaneiden_toiminta
 ,ika_1v
 ,ika_5v
)
SELECT
 l.rivinumero,
 '2,5',
 l.tilv,
 l.tilv_date,
 l.tutkryh,
 l.suorv,
 (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
(case
    -- Koulutus 1
	-- lukiokoulutuksessa 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.luopiskkoulk2007
	-- ammatillisessa koulutuksessa 2007 
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 ='' and l.yoopiskkoulk2007 = ''  then l.ammopiskkoulk2007 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2007 ensimäisiin koulutustietoihin
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.luopiskkoulk2007
	-- ammattikorkeakoulutuksessa
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2007  <> '' and l.yoopiskkoulk2007  = '' and
	l.luopiskkoulk2007  = '' and l.ammopiskkoulk2007 = '' then l.amkopiskkoulk2007
	-- yliopistokoulutuksessa
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 <> '' and 
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''   then l.yoopiskkoulk2007 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007  <> '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''  then l.amkopiskkoulk2007 
	
	
	-- lukiokoulutuksessa 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammatillisessa koulutuksessa 2008
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then l.ammopiskkoulk2008 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2008 ensimäisiin koulutustietoihin
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammattikorkeakoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008  = '' and l.ammopiskkoulk2008 = '' then l.amkopiskkoulk2008
	-- yliopistokoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then l.yoopiskkoulk2008 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.amkopiskkoulk2008
	
		-- lukiokoulutuksessa 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammatillisessa koulutuksessa 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then l.ammopiskkoulk2009 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2008 ensimäisiin koulutustietoihin
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009  = '' and l.ammopiskkoulk2009 = '' then l.amkopiskkoulk2009
	-- yliopistokoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then l.yoopiskkoulk2009 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.amkopiskkoulk2009
	
		-- lukiokoulutuksessa 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammatillisessa koulutuksessa 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then l.ammopiskkoulk2010 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2008 ensimäisiin koulutustietoihin
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammattikorkeakoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010  = '' and l.ammopiskkoulk2010 = '' then l.amkopiskkoulk2010
	-- yliopistokoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then l.yoopiskkoulk2010 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.amkopiskkoulk2010

			-- lukiokoulutuksessa 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammatillisessa koulutuksessa 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then l.ammopiskkoulk2011 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2008 ensimäisiin koulutustietoihin
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammattikorkeakoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011  = '' and l.ammopiskkoulk2011 = '' then l.amkopiskkoulk2011
	-- yliopistokoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then l.yoopiskkoulk2011 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.amkopiskkoulk2011

	-- lukiokoulutuksessa 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammatillisessa koulutuksessa 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then l.ammopiskkoulk2012 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2008 ensimäisiin koulutustietoihin
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012  = '' and l.ammopiskkoulk2012 = '' then l.amkopiskkoulk2012
	-- yliopistokoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then l.yoopiskkoulk2012 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.amkopiskkoulk2012

	else ''
	    end),
	 -- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos 2007
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 = '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.luopisktunn2007
	-- ammatillisen koulutuksen oppilaitos 2007
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2007 = '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 ='' and l.yoopisktunn2007 = ''  then l.ammopisktunn2007
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.luopisktunn2007
	-- ammattikorkeakoulutuksen oppilaitos 2007
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2007  <> '' and l.yoopisktunn2007  = '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = '' then l.amkopisktunn2007
	-- yliopistokoulutuksen oppilaitos 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2007 = '' and l.yoopisktunn2007 <> '' and 
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''   then l.yoopisktunn2007  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2007  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2007 <> '' and l.yoopisktunn2007  <> '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''  then l.amkopisktunn2007 
	
	
	-- lukiokoulutuksen oppilaitos 2008
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammatillisen koulutuksen oppilaitos 2008
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and l.yoopisktunn2008 = ''  then l.ammopisktunn2008
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2007
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammattikorkeakoulutuksen oppilaitos 2008
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then l.amkopisktunn2008
	-- yliopistokoulutuksen oppilaitos 2008
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''   then l.yoopisktunn2008  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2008 
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.amkopisktunn2008 
	
	-- lukiokoulutuksen oppilaitos 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammatillisen koulutuksen oppilaitos 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and l.yoopisktunn2009 = ''  then l.ammopisktunn2009
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2007
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammattikorkeakoulutuksen oppilaitos 2008
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then l.amkopisktunn2009
	-- yliopistokoulutuksen oppilaitos 2008
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''   then l.yoopisktunn2009  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2008 
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.amkopisktunn2009 
	
	-- lukiokoulutuksen oppilaitos 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammatillisen koulutuksen oppilaitos 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and l.yoopisktunn2010 = ''  then l.ammopisktunn2010
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2007
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammattikorkeakoulutuksen oppilaitos 2008
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then l.amkopisktunn2010
	-- yliopistokoulutuksen oppilaitos 2008
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''   then l.yoopisktunn2010  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2008 
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.amkopisktunn2010 

		-- lukiokoulutuksen oppilaitos 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammatillisen koulutuksen oppilaitos 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and l.yoopisktunn2011 = ''  then l.ammopisktunn2011
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2007
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammattikorkeakoulutuksen oppilaitos 2008
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then l.amkopisktunn2011
	-- yliopistokoulutuksen oppilaitos 2008
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''   then l.yoopisktunn2011  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2008 
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.amkopisktunn2011 

		-- lukiokoulutuksen oppilaitos 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammatillisen koulutuksen oppilaitos 2008
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and l.yoopisktunn2012 = ''  then l.ammopisktunn2012
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2007
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammattikorkeakoulutuksen oppilaitos 2008
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then l.amkopisktunn2012
	-- yliopistokoulutuksen oppilaitos 2008
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''   then l.yoopisktunn2012  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2008 
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.amkopisktunn2012 
	
	
	else ''
	
	    end),
	-- Koulutuksen järjestäjä 1 
	(case
	-- lukiokoulutuksen järjestäjä 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2007  <> '' and l.ammopiskjarj2007  = '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.luopiskjarj2007  
	-- ammatillisen koulutuksen järjestäjä 2007
	when l.suorv = @ensimmainen_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2007 = '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 ='' and yoopiskjarj2007 = ''  then l.ammopiskjarj2007 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2007, merkitään lukiokoulutuksen 2007 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2007 <> '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.luopiskjarj2007
	-- ammattikorkeakoulutuksen 2007 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskjarj2007 = '' then l.amkopiskjarj2007 
	-- yliopistokoulutuksen 2007 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2007  = '' and l.yoopiskjarj2007  <> '' and 
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007 = ''   then l.yoopiskjarj2007
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2007, merkitään ammattikorkekoulutuksen järjestäjä 2007   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   <> '' and
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007  = ''  then l.amkopiskjarj2007 
	
	
	-- lukiokoulutuksen järjestäjä 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008  = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008  
	-- ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @toinen_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and yoopiskjarj2008 = ''  then l.ammopiskjarj2008 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2007, merkitään lukiokoulutuksen 2007 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008
	-- ammattikorkeakoulutuksen 2008 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then l.amkopiskjarj2008 
	-- yliopistokoulutuksen 2008 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then l.yoopiskjarj2008
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2008, merkitään ammattikorkekoulutuksen järjestäjä 2008   
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.amkopiskjarj2008 
	
	
	-- lukiokoulutuksen järjestäjä 2009
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009  = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009  
	-- ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and yoopiskjarj2009 = ''  then l.ammopiskjarj2009 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2007, merkitään lukiokoulutuksen 2007 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009
	-- ammattikorkeakoulutuksen 2008 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then l.amkopiskjarj2009 
	-- yliopistokoulutuksen 2008 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then l.yoopiskjarj2009
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2008, merkitään ammattikorkekoulutuksen järjestäjä 2008   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.amkopiskjarj2009 
	
	-- lukiokoulutuksen järjestäjä 2010
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010  = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010  
	-- ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and yoopiskjarj2010 = ''  then l.ammopiskjarj2010 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2007, merkitään lukiokoulutuksen 2007 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010
	-- ammattikorkeakoulutuksen 2008 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then l.amkopiskjarj2010 
	-- yliopistokoulutuksen 2008 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then l.yoopiskjarj2010
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2008, merkitään ammattikorkekoulutuksen järjestäjä 2008   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.amkopiskjarj2010 

	
-- lukiokoulutuksen järjestäjä 2011
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011  = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011  
	-- ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and yoopiskjarj2011 = ''  then l.ammopiskjarj2011 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2007, merkitään lukiokoulutuksen 2007 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011
	-- ammattikorkeakoulutuksen 2008 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then l.amkopiskjarj2011 
	-- yliopistokoulutuksen 2008 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''   then l.yoopiskjarj2011
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2008, merkitään ammattikorkekoulutuksen järjestäjä 2008   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011  = ''  then l.amkopiskjarj2011 

	-- lukiokoulutuksen järjestäjä 2012
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012  = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.luopiskjarj2012  
	-- ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and yoopiskjarj2012 = ''  then l.ammopiskjarj2012 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2007, merkitään lukiokoulutuksen 2007 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.luopiskjarj2012
	-- ammattikorkeakoulutuksen 2008 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then l.amkopiskjarj2012 
	-- yliopistokoulutuksen 2008 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012 = ''   then l.yoopiskjarj2012
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2008, merkitään ammattikorkekoulutuksen järjestäjä 2008   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012  = ''  then l.amkopiskjarj2012 


	else ''
	    end),
	    
	 -- Maakunta 1
	(case
	-- lukioopiskelun maakunta 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2007   <> '' and l.ammopiskmaak2007  = '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.luopiskmaak2007
	-- ammatillisen koulutksen maakunta 2007    
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2007  = '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  ='' and l.yoopiskmaak2007  = ''  then l.ammopiskmaak2007
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2007  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2007  <> '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.luopiskmaak2007 
	-- ammattikorkekoulutuksen maakunta 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2007   <> '' and l.yoopiskmaak2007   = '' and
	l.luopiskmaak2007 = '' and l.ammopiskmaak2007 = '' then l.amkopiskmaak2007
	-- yliopistokoulutuksen maakunta 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  <> '' and 
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007 = ''   then l.yoopiskmaak2007
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2007, otetaan talteen ammattikorkekoulutksen maakunta 2007   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2007  <> '' and l.yoopiskmaak2007   <> '' and
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007  = ''  then l.amkopiskmaak2007 
	
	
	-- lukioopiskelun maakunta 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008
	-- ammatillisen koulutksen maakunta 2008    
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  ='' and l.yoopiskmaak2008  = ''  then l.ammopiskmaak2008
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2008  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008 
	-- ammattikorkekoulutuksen maakunta 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then l.amkopiskmaak2008
	-- yliopistokoulutuksen maakunta 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008 = ''   then l.yoopiskmaak2008
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2008, otetaan talteen ammattikorkekoulutksen maakunta 2008   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008  = ''  then l.amkopiskmaak2008 
	
	-- lukioopiskelun maakunta 2009
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009
	-- ammatillisen koulutksen maakunta 2008    
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009 ='' and l.yoopiskmaak2009  = ''  then l.ammopiskmaak2009
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2008  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009 
	-- ammattikorkekoulutuksen maakunta 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then l.amkopiskmaak2009
	-- yliopistokoulutuksen maakunta 2008
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then l.yoopiskmaak2009
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2008, otetaan talteen ammattikorkekoulutksen maakunta 2008   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.amkopiskmaak2009 
	
	-- lukioopiskelun maakunta 2010
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010
	-- ammatillisen koulutksen maakunta 2008    
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010 ='' and l.yoopiskmaak2010  = ''  then l.ammopiskmaak2010
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2008  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010 
	-- ammattikorkekoulutuksen maakunta 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then l.amkopiskmaak2010
	-- yliopistokoulutuksen maakunta 2008
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then l.yoopiskmaak2010
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2008, otetaan talteen ammattikorkekoulutksen maakunta 2008   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.amkopiskmaak2010 

	-- lukioopiskelun maakunta 2011
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2011   <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011
	-- ammatillisen koulutksen maakunta 2008    
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011 ='' and l.yoopiskmaak2011  = ''  then l.ammopiskmaak2011
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2008  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011 
	-- ammattikorkekoulutuksen maakunta 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then l.amkopiskmaak2011
	-- yliopistokoulutuksen maakunta 2008
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then l.yoopiskmaak2011
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2008, otetaan talteen ammattikorkekoulutksen maakunta 2008   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.amkopiskmaak2011 

	-- lukioopiskelun maakunta 2012
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2012   <> '' and l.ammopiskmaak2012  = '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.luopiskmaak2012
	-- ammatillisen koulutksen maakunta 2008    
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2012  = '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012 ='' and l.yoopiskmaak2012  = ''  then l.ammopiskmaak2012
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2008  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.luopiskmaak2012 
	-- ammattikorkekoulutuksen maakunta 2008
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2012   <> '' and l.yoopiskmaak2012   = '' and
	l.luopiskmaak2012 = '' and l.ammopiskmaak2012 = '' then l.amkopiskmaak2012
	-- yliopistokoulutuksen maakunta 2008
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  <> '' and 
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012 = ''   then l.yoopiskmaak2012
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2008, otetaan talteen ammattikorkekoulutksen maakunta 2008   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012   <> '' and
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012  = ''  then l.amkopiskmaak2012 
	
	
	
	else ''
	
	
	    end),
-- Koulutus 2
(case
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2007
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2007 
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 ='' and l.yoopiskkoulk2007 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.ammopiskkoulk2007
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2007  <> '' and l.yoopiskkoulk2007  = '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 <> '' and 
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007  <> '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''  then l.yoopiskkoulk2007   
	
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2007 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.ammopiskkoulk2008
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.yoopiskkoulk2008   
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2009 
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2008
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.ammopiskkoulk2009
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.yoopiskkoulk2009   
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2010 
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2008
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.ammopiskkoulk2010
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.yoopiskkoulk2010  
	
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2011
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2011 
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2008
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.ammopiskkoulk2011
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2011
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.yoopiskkoulk2011    


	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2012
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2012 
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2008
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.ammopiskkoulk2012
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2012
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.yoopiskkoulk2012   

	
	else ''
	    end),
	    
-- Oppilaitos 2
(case
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 = '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2007 = '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 ='' and yoopisktunn2007 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.ammopisktunn2007 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2007  <> '' and l.yoopisktunn2007  = '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2007 = '' and l.yoopisktunn2007 <> '' and 
	l.luopisktunn2007 = '' and l.ammopisktunn2007  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2007 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2007 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2007 <> '' and l.yoopisktunn2007  <> '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''  then l.yoopisktunn2007 
	
		-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and yoopisktunn2008 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.ammopisktunn2008 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2007 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2007 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.yoopisktunn2008 
	
	
    -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and yoopisktunn2009 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.ammopisktunn2009 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2007 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2007 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.yoopisktunn2009 
	
	 -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and yoopisktunn2010 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.ammopisktunn2010 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2007 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2007 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.yoopisktunn2010 

	 -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and yoopisktunn2011 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.ammopisktunn2011 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2007 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2007 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.yoopisktunn2011 


	 -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2008
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and yoopisktunn2012 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2008
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.ammopisktunn2012 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2007
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2007 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2007 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.yoopisktunn2012 
	
	else ''
	    end),
	    
	-- Koulutuksen järjestäjä 2
	(case
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2007  <> '' and l.ammopiskjarj2007 = '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2007 = '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 ='' and l.yoopiskjarj2007 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2007 <> '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.ammopiskjarj2007 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskjarj2007 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2007  = '' and l.yoopiskjarj2007  <> '' and 
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   <> '' and
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007  = ''  then l.yoopiskjarj2007 
	
	
		-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008 = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and l.yoopiskjarj2008 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.ammopiskjarj2008 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2007
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008  <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.yoopiskjarj2008 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and l.yoopiskjarj2009 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.ammopiskjarj2009 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2007
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009  <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''  then l.yoopiskjarj2009 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and l.yoopiskjarj2010 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.ammopiskjarj2010 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2007
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010  <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''  then l.yoopiskjarj2010 

	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and l.yoopiskjarj2011 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.ammopiskjarj2011 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2008
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2007
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011  <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''  then l.yoopiskjarj2011 
	

	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012 = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and l.yoopiskjarj2012 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.ammopiskjarj2012 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2008
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2007
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2007
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012  <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012 = ''  then l.yoopiskjarj2012 
	
	else ''
	    end),
	    
	-- Maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2007   <> '' and l.ammopiskmaak2007  = '' and
	l.amkopiskmaak2007  = '' and yoopiskmaak2007  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2007, merkitään tyhjäksi   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2007  = '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  ='' and l.yoopiskmaak2007  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2007, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2007  <> '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.ammopiskmaak2007 
	-- vain ammattikorkeakoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2007   <> '' and l.yoopiskmaak2007   = '' and
	l.luopiskmaak2007 = '' and l.ammopiskmaak2007 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  <> '' and 
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2007, merkitään yliopistokoulutuksen 2007 maakunta 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2007  <> '' and l.yoopiskmaak2007   <> '' and
	l.luopiskmaak2007  = '' and l.ammopiskmaak2007  = ''  then l.yoopiskmaak2007  
	
	
		-- vain lukiokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and yoopiskmaak2008  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2007, merkitään tyhjäksi   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  ='' and l.yoopiskmaak2008 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2008, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.ammopiskmaak2008 
	-- vain ammattikorkeakoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2008, merkitään yliopistokoulutuksen 2007 maakunta 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008  = ''  then l.yoopiskmaak2008  
	
	
	-- vain lukiokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and yoopiskmaak2009  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2009, merkitään tyhjäksi   
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2009, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.ammopiskmaak2009 
	-- vain ammattikorkeakoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2009, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.yoopiskmaak2009  
	
		-- vain lukiokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and yoopiskmaak2010  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2010, merkitään tyhjäksi   
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2010, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.ammopiskmaak2010 
	-- vain ammattikorkeakoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2010, merkitään yliopistokoulutuksen 2010 maakunta 
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.yoopiskmaak2010  

		-- vain lukiokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and yoopiskmaak2011  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2011, merkitään tyhjäksi   
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  ='' and l.yoopiskmaak2011 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2011, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.ammopiskmaak2011 
	-- vain ammattikorkeakoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2011, merkitään yliopistokoulutuksen 2011 maakunta 
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.yoopiskmaak2011 
	
		-- vain lukiokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  = '' and
	l.amkopiskmaak2012  = '' and yoopiskmaak2012  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2012, merkitään tyhjäksi   
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2012  = '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  ='' and l.yoopiskmaak2012 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2012, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.ammopiskmaak2012 
	-- vain ammattikorkeakoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2012   <> '' and l.yoopiskmaak2012   = '' and
	l.luopiskmaak2012 = '' and l.ammopiskmaak2012 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  <> '' and 
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2012, merkitään yliopistokoulutuksen 2012 maakunta 
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012   <> '' and
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012  = ''  then l.yoopiskmaak2012   
	
	else ''
	    end),
	-- Monihaku
	(case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.monihaku2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.monihaku2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.monihaku2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.monihaku2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.monihaku2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.monihaku2012
	else '8'
	end),
	-- Pääasiallinen toiminta
    (case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2007 
    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2008 
    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2009 
       when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2010
	    when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2011

		when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2012
	else ''
	end),
	-- Ammattiasema
	(case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.amas_2007
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.amas_2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.amas_2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.amas_2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.amas_2011
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.amas_2012
	else ''
	end),
 l.lkm,
 l.pohjkoul,
 l.tietolahde,
 'K3.13',
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and
	    l.yoopiskkoulk2007 = ''  then  '1'  
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and
	    l.yoopiskkoulk2008 = ''   then '1'  
	     when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = ''   then '1'  
	      when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = ''   then '1'  
		 when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = ''   then '1'  
		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and
	    l.yoopiskkoulk2012 = ''   then '1' 
	    else '0'
	    end) as lukiokoulutuksessa,
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2007 <> '' and l.luopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and
	    l.yoopiskkoulk2007 = ''  then '1'   
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2008 <> '' and l.luopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and
	    l.yoopiskkoulk2008 = ''  then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = '' then '1'  
	     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2010<> '' and l.luopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = '' then '1'  
		  when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2011<> '' and l.luopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = '' then '1'  
		  when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2012<> '' and l.luopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and
	    l.yoopiskkoulk2012 = '' then '1'  
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
 (case  
	   when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and l.luopiskkoulk2007 = '' and
	   l.yoopiskkoulk2007 = ''  then  '1'
	   when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' and
	   l.yoopiskkoulk2008 = ''  then  '1'
	   when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and
	   l.yoopiskkoulk2009 = ''  then  '1'
	   when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and
	   l.yoopiskkoulk2010 = ''  then  '1'
	    when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' and
	   l.yoopiskkoulk2011 = ''  then  '1'
	     when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' and
	   l.yoopiskkoulk2012 = ''  then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and  l.yoopiskkoulk2007 <> '' and l.amkopiskkoulk2007 = '' and l.luopiskkoulk2007 = '' and 
	    l.ammopiskkoulk2007 = ''  then '1'  
	    when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and  l.yoopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' and 
	    l.ammopiskkoulk2008 = ''  then '1' 
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and 
	    l.ammopiskkoulk2009 = ''  then '1' 
	     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and 
	    l.ammopiskkoulk2010 = ''  then '1' 
		  when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' and 
	    l.ammopiskkoulk2011 = ''  then '1' 
		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' and 
	    l.ammopiskkoulk2012 = ''  then '1' 
	    else '0'
	    end) as yliopistokoulutuksessa,

(case

	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and l.amkopiskkoulk2007 = '' and
	    l.yoopiskkoulk2007 = '' then '1'  
	    
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and
	    l.yoopiskkoulk2008 = ''  then '1' 
	    
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = ''  then '1' 
	    
	     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = ''  then '1' 

		when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = ''  then '1' 

		when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' and 
	    l.ammopiskkoulk2012 = ''  then '1' 
	    
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2'and  l.ammopiskkoulk2007 <> '' and l.amkopiskkoulk2007 <> '' and l.luopiskkoulk2007 = '' and
	    l.yoopiskkoulk2007 = ''  then '1' 
	     
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 <> '' and l.luopiskkoulk2008 = '' and
	    l.yoopiskkoulk2008 = '' then '1' 
	    
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = '' then '1' 
	    
	     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 <> '' and l.luopiskkoulk2010= '' and
	    l.yoopiskkoulk2010 = '' then '1' 

		  when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 <> '' and l.luopiskkoulk2011= '' and
	    l.yoopiskkoulk2011 = '' then '1' 

		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 <> '' and l.luopiskkoulk2012= '' and
	    l.yoopiskkoulk2012 = '' then '1' 

	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007 <> '' and l.luopiskkoulk2007 = '' and
	    l.ammopiskkoulk2007 = ''  then '1'  
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008 <> '' and l.luopiskkoulk2008 = '' and
	    l.ammopiskkoulk2008 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and
	    l.ammopiskkoulk2009 = '' then '1' 
	      when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010<> '' and l.luopiskkoulk2010 = '' and
	    l.ammopiskkoulk2010 = '' then '1'   
		      when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011<> '' and l.luopiskkoulk2011 = '' and
	    l.ammopiskkoulk2011 = '' then '1'   
		when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012<> '' and l.luopiskkoulk2012 = '' and
	    l.ammopiskkoulk2012 = '' then '1'  
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
(case
	   --Tutkintoon johtavassa koulutuksessa olevan
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and (l.ptoim1r4_2007 = '22' or l.ptoim1r4_2007 ='13') 
	   and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007<>'' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007<>'') then '1' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 = '13')
       and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008<>'' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008<>'')	   then '1'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13') 
	   and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009<>'' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009<>'')then '1' 
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13') 
	   and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010<>'' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010<>'')then '1'
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13') 
	   and (l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011<>'' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011<>'')then '1'
	     when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13') 
	   and (l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012<>'' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012<>'')then '1'
   
       --Ei tutkintoon johtavassa koulutuksessa olevan
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and (l.ptoim1r4_2007 = '22' or l.ptoim1r4_2007 ='13') 
	  and (l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007='' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007='')	 then '2' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 = '13')
       and (l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008='' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008='')		   then '2'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13') 
	   and (l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009='' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009='')	then '2'
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13') 
	   and (l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010='' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010='')	then '2' 
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13') 
	   and (l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011='' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011='')	then '2' 
	     when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13') 
	   and (l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012='' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012='')	then '2' 
   
	  -- Ei opiskelevat työlliset
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2')and l.ptoim1r4_2007 = '10'  then '3'
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and  l.ptoim1r4_2008 = '10'  then '3'     
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2009 = '10'  then '3' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2010 = '10'  then '3'
	     when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2011 = '10'  then '3'
		  when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2012 = '10'  then '3'
	  -- Ei opiskelevat työttömät 
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2007 = '12'  then '4' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and  l.ptoim1r4_2008 = '12'  then '4'
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2009 = '12'  then '4'
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2010 = '12'  then '4'    
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2011 = '12'  then '4'
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2012 = '12'  then '4'
	   
	   -- Ei opiskelevat muut
      else '5'
	     
	     
	   end)as koulutuksen_paattaneiden_toiminta
	   
	 ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
     ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))
	     
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where (suorv = '2004' or suorv = '2005' or suorv = '2006' or suorv = '2007' or suorv = '2008' or suorv = '2009') and suorlk = '2'
	
	) as l
	
	
	WHERE 1=1
end;

--
-- TULOS
-- 
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_3_0_tarkastelujakso]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_3_0_tarkastelujakso]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_3_0_tarkastelujakso] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_3_0_tarkastelujakso] AS
declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;

set @ensimmainen_suoritusvuosi = 2004;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;



INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
,lkm
,pohjkoulk
,tietolahde
, aineisto
 ,lukiokoulutuksessa
 ,ammatillisessa_koulutuksessa
 ,ammattikorkeakoulutuksessa
 ,yliopistokoulutuksessa
 ,lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
 ,toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
 ,ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
 ,koulutuksen_paattaneiden_toiminta
 ,ika_1v
 ,ika_5v
)
SELECT
 l.rivinumero,
 '3',
 l.tilv,
 l.tilv_date,
 l.tutkryh,
 l.suorv,
 (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.luopiskkoulk2007 
	-- ammattikoulutuksessa 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 ='' and l.yoopiskkoulk2007 = ''  then l.ammopiskkoulk2007 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2007 ensim. koulutustietoihin
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.luopiskkoulk2007
	-- ammattikorkeakoulutuksessa 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007  <> '' and l.yoopiskkoulk2007  = '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' then l.amkopiskkoulk2007
	-- yliopistokoulutuksessa 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 <> '' and 
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''   then l.yoopiskkoulk2007
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007  <> '' and
	l.luopiskkoulk2007 = '' and ammopiskkoulk2007 = ''  then l.amkopiskkoulk2007 
	
	
	-- lukiokoulutuksessa 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammatillisessa koulutuksessa 2008 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then l.ammopiskkoulk2008 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2008 ensimäisiin koulutustietoihin
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammattikorkeakoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008  = '' and l.ammopiskkoulk2008 = '' then l.amkopiskkoulk2008
	-- yliopistokoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then l.yoopiskkoulk2008 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.amkopiskkoulk2008 
	
	
	-- lukiokoulutuksessa 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammatillisessa koulutuksessa 2009 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then l.ammopiskkoulk2009 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2009 ensimäisiin koulutustietoihin
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009  = '' and l.ammopiskkoulk2009 = '' then l.amkopiskkoulk2009
	-- yliopistokoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then l.yoopiskkoulk2009 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.amkopiskkoulk2009 
	
	-- lukiokoulutuksessa 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammatillisessa koulutuksessa 2010 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then l.ammopiskkoulk2010 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammattikorkeakoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010  = '' and l.ammopiskkoulk2010 = '' then l.amkopiskkoulk2010
	-- yliopistokoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then l.yoopiskkoulk2010 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.amkopiskkoulk2010 

	-- lukiokoulutuksessa 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammatillisessa koulutuksessa 2011 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then l.ammopiskkoulk2011 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2011 ensimäisiin koulutustietoihin
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammattikorkeakoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011  = '' and l.ammopiskkoulk2011 = '' then l.amkopiskkoulk2011
	-- yliopistokoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then l.yoopiskkoulk2011 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.amkopiskkoulk2011 


	-- lukiokoulutuksessa 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammatillisessa koulutuksessa 2012 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then l.ammopiskkoulk2012 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2012 ensimäisiin koulutustietoihin
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012  = '' and l.ammopiskkoulk2012 = '' then l.amkopiskkoulk2012
	-- yliopistokoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then l.yoopiskkoulk2012 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.amkopiskkoulk2012 
	
	else ''
	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 = '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.luopisktunn2007 
	-- ammattikoulutuksen oppilaitos 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 = '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 ='' and l.yoopisktunn2007 = ''  then l.ammopisktunn2007 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.luopisktunn2007
	-- ammattikorkeakoulutuksen oppilaitos 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007  <> '' and l.yoopisktunn2007  = '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = '' then l.amkopisktunn2007
	-- yliopistokoulutuksen oppilaitos 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007 = '' and l.yoopisktunn2007 <> '' and 
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''   then l.yoopisktunn2007
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2007  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007 <> '' and l.yoopisktunn2007  <> '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''  then l.amkopisktunn2007 
	
	
	-- lukiokoulutuksen oppilaitos 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammatillisen koulutuksen oppilaitos 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and l.yoopisktunn2008 = ''  then l.ammopisktunn2008
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammattikorkeakoulutuksen oppilaitos 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then l.amkopisktunn2008
	-- yliopistokoulutuksen oppilaitos 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''   then l.yoopisktunn2008  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2008  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.amkopisktunn2008 
	
	-- lukiokoulutuksen oppilaitos 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammatillisen koulutuksen oppilaitos 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and l.yoopisktunn2009 = ''  then l.ammopisktunn2009
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2008
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammattikorkeakoulutuksen oppilaitos 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then l.amkopisktunn2009
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''   then l.yoopisktunn2009 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2008  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.amkopisktunn2009
	
	-- lukiokoulutuksen oppilaitos 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and l.yoopisktunn2010 = ''  then l.ammopisktunn2010
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2008
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then l.amkopisktunn2010
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''   then l.yoopisktunn2010 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2008  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.amkopisktunn2010

	-- lukiokoulutuksen oppilaitos 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammatillisen koulutuksen oppilaitos 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and l.yoopisktunn2011 = ''  then l.ammopisktunn2011
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2008
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammattikorkeakoulutuksen oppilaitos 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then l.amkopisktunn2011
	-- yliopistokoulutuksen oppilaitos 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''   then l.yoopisktunn2011 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2008  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.amkopisktunn2011

	-- lukiokoulutuksen oppilaitos 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammatillisen koulutuksen oppilaitos 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and l.yoopisktunn2012 = ''  then l.ammopisktunn2012
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2008
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammattikorkeakoulutuksen oppilaitos 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then l.amkopisktunn2012
	-- yliopistokoulutuksen oppilaitos 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''   then l.yoopisktunn2012 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2008  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.amkopisktunn2012
	
	
	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007  <> '' and l.ammopiskjarj2007 = '' and
	l.amkopiskjarj2007 = '' and yoopiskjarj2007 = '' then l.luopiskjarj2007
	-- ammatillisen koulutuksen järjestäjä 2007  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007 = '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 ='' and l.yoopiskjarj2007 = ''  then l.ammopiskjarj2007
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen 2007 järjestäjä 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007 <> '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.luopiskjarj2007
	-- ammattikorkeakoulutuksen järjestäjä 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskjarj2007 = '' then l.amkopiskjarj2007
	-- yliopistokoulutuksen järjestäjä 2007 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  = '' and l.yoopiskjarj2007  <> '' and 
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007 = ''   then l.yoopiskjarj2007
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen 2007 järjestäjä   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   <> '' and
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007  = ''  then l.amkopiskjarj2007 

	
	-- lukiokoulutuksen järjestäjä 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008  = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008  
	-- ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and yoopiskjarj2008 = ''  then l.ammopiskjarj2008 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2008, merkitään lukiokoulutuksen 2008 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008
	-- ammattikorkeakoulutuksen 2008 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then l.amkopiskjarj2008 
	-- yliopistokoulutuksen 2008 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then l.yoopiskjarj2008
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2008, merkitään ammattikorkekoulutuksen järjestäjä 2008   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.amkopiskjarj2008 
	
	-- lukiokoulutuksen järjestäjä 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009 
	-- ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and yoopiskjarj2009 = ''  then l.ammopiskjarj2009 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2008, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009
	-- ammattikorkeakoulutuksen 2009 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then l.amkopiskjarj2009 
	-- yliopistokoulutuksen 2008 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then l.yoopiskjarj2009
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2008, merkitään ammattikorkekoulutuksen järjestäjä 2008   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.amkopiskjarj2009 
	
	-- lukiokoulutuksen järjestäjä 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010 
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and yoopiskjarj2010 = ''  then l.ammopiskjarj2010 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2008, merkitään lukiokoulutuksen 2010 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then l.amkopiskjarj2010 
	-- yliopistokoulutuksen 2008 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then l.yoopiskjarj2010
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2008, merkitään ammattikorkekoulutuksen järjestäjä 2008   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.amkopiskjarj2010 

	-- lukiokoulutuksen järjestäjä 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011 
	-- ammatillisen koulutuksen järjestäjä 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and yoopiskjarj2011 = ''  then l.ammopiskjarj2011 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2008, merkitään lukiokoulutuksen 2011 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011
	-- ammattikorkeakoulutuksen 2011 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then l.amkopiskjarj2011 
	-- yliopistokoulutuksen 2008 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''   then l.yoopiskjarj2011
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2008, merkitään ammattikorkekoulutuksen järjestäjä 2008   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011  = ''  then l.amkopiskjarj2011 

	-- lukiokoulutuksen järjestäjä 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012 = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.luopiskjarj2012 
	-- ammatillisen koulutuksen järjestäjä 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and yoopiskjarj2012 = ''  then l.ammopiskjarj2012 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2008, merkitään lukiokoulutuksen 2012 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.luopiskjarj2012
	-- ammattikorkeakoulutuksen 2012 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then l.amkopiskjarj2012 
	-- yliopistokoulutuksen 2008 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012 = ''   then l.yoopiskjarj2012
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2008, merkitään ammattikorkekoulutuksen järjestäjä 2008   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012  = ''  then l.amkopiskjarj2012 
	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007   <> '' and l.ammopiskmaak2007  = '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.luopiskmaak2007   
	-- ammatillisen koulutuksen maakunta 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007  = '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  ='' and l.yoopiskmaak2007  = ''  then l.ammopiskmaak2007  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007  <> '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.luopiskmaak2007 
    -- ammattikorkeakoulutuksen maakunta 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007   <> '' and l.yoopiskmaak2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskmaak2007 = '' then l.amkopiskmaak2007
	-- yliopistokoulutuksen maakunta 2007 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  <> '' and 
	l.luopiskjarj2007  = '' and l.ammopiskmaak2007 = ''   then l.yoopiskmaak2007
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta 2007   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007  <> '' and l.yoopiskmaak2007   <> '' and
	l.luopiskjarj2007  = '' and l.ammopiskmaak2007  = ''  then l.amkopiskmaak2007 
	
	
	-- lukioopiskelun maakunta 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008
	-- ammatillisen koulutksen maakunta 2008    
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  ='' and l.yoopiskmaak2008  = ''  then l.ammopiskmaak2008
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2008  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008 
	-- ammattikorkekoulutuksen maakunta 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then l.amkopiskmaak2008
	-- yliopistokoulutuksen maakunta 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008 = ''   then l.yoopiskmaak2008
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2008, otetaan talteen ammattikorkekoulutksen maakunta 2008   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008  = ''  then l.amkopiskmaak2008 
	
    -- lukioopiskelun maakunta 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009
	-- ammatillisen koulutksen maakunta 2009    
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then l.ammopiskmaak2009
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2008  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009 
	-- ammattikorkekoulutuksen maakunta 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then l.amkopiskmaak2009
	-- yliopistokoulutuksen maakunta 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then l.yoopiskmaak2009
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2008, otetaan talteen ammattikorkekoulutksen maakunta 2008   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.amkopiskmaak2009 
	
	 -- lukioopiskelun maakunta 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010
	-- ammatillisen koulutksen maakunta 2010    
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010  = ''  then l.ammopiskmaak2010
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2008  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010 
	-- ammattikorkekoulutuksen maakunta 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then l.amkopiskmaak2010
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then l.yoopiskmaak2010
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2008, otetaan talteen ammattikorkekoulutksen maakunta 2008   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.amkopiskmaak2010 

	-- lukioopiskelun maakunta 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011   <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011
	-- ammatillisen koulutksen maakunta 2011    
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  ='' and l.yoopiskmaak2011  = ''  then l.ammopiskmaak2011
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2008  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011 
	-- ammattikorkekoulutuksen maakunta 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then l.amkopiskmaak2011
	-- yliopistokoulutuksen maakunta 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then l.yoopiskmaak2011
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2008, otetaan talteen ammattikorkekoulutksen maakunta 2008   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.amkopiskmaak2011 

	-- lukioopiskelun maakunta 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012   <> '' and l.ammopiskmaak2012  = '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.luopiskmaak2012
	-- ammatillisen koulutksen maakunta 2012    
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  = '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  ='' and l.yoopiskmaak2012  = ''  then l.ammopiskmaak2012
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2008  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.luopiskmaak2012 
	-- ammattikorkekoulutuksen maakunta 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012   <> '' and l.yoopiskmaak2012   = '' and
	l.luopiskmaak2012 = '' and l.ammopiskmaak2012 = '' then l.amkopiskmaak2012
	-- yliopistokoulutuksen maakunta 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  <> '' and 
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012 = ''   then l.yoopiskmaak2012
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2008, otetaan talteen ammattikorkekoulutksen maakunta 2008   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012   <> '' and
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012  = ''  then l.amkopiskmaak2012 
	
	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi 2007 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 ='' and l.yoopiskkoulk2007 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus 2007 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 <> '' and
	l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then l.ammopiskkoulk2007 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007  <> '' and l.yoopiskkoulk2007  = '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 <> '' and 
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2007 <> '' and l.yoopiskkoulk2007  <> '' and
	l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = ''  then l.yoopiskkoulk2007
	
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2008 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.ammopiskkoulk2008
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.yoopiskkoulk2008   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.ammopiskkoulk2009
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.yoopiskkoulk2009   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.ammopiskkoulk2010
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.yoopiskkoulk2010   

	 -- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.ammopiskkoulk2011
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.yoopiskkoulk2011   


		 -- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.ammopiskkoulk2012
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.yoopiskkoulk2012   

	
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 = '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then ''
	-- ammatillisen koulutuksen oppilaitos 2007 merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 = '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 ='' and l.yoopisktunn2007 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2007 <> '' and l.ammopisktunn2007 <> '' and
	l.amkopisktunn2007 = '' and l.yoopisktunn2007 = '' then l.ammopisktunn2007 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007  <> '' and l.yoopisktunn2007  = '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007 = '' and l.yoopisktunn2007 <> '' and 
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2007 <> '' and l.yoopisktunn2007  <> '' and
	l.luopisktunn2007 = '' and l.ammopisktunn2007 = ''  then l.yoopisktunn2007 
	
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and yoopisktunn2008 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.ammopisktunn2008 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2008 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2008 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.yoopisktunn2008 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and yoopisktunn2009 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.ammopisktunn2009 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2008 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.yoopisktunn2009 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and yoopisktunn2010 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.ammopisktunn2010 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2010 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2008 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.yoopisktunn2010 

	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and yoopisktunn2011 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.ammopisktunn2011 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2011 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2008 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.yoopisktunn2011  

	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and yoopisktunn2012 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.ammopisktunn2012 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2012 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2008 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.yoopisktunn2012  
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain 2007, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007  <> '' and l.ammopiskjarj2007 = '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain 2007, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007 = '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 ='' and l.yoopiskjarj2007 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2007 <> '' and l.ammopiskjarj2007 <> '' and
	l.amkopiskjarj2007 = '' and l.yoopiskjarj2007 = '' then l.ammopiskjarj2007 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   = '' and
	l.luopiskjarj2007 = '' and l.ammopiskjarj2007 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  = '' and l.yoopiskjarj2007  <> '' and 
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2007  <> '' and l.yoopiskjarj2007   <> '' and
	l.luopiskjarj2007  = '' and l.ammopiskjarj2007  = ''  then l.yoopiskjarj2007 
	
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008 = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and l.yoopiskjarj2008 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.ammopiskjarj2008 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.yoopiskjarj2008 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and l.yoopiskjarj2009 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.ammopiskjarj2009 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.yoopiskjarj2009 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and l.yoopiskjarj2010 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.ammopiskjarj2010 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.yoopiskjarj2010 

	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and l.yoopiskjarj2011 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.ammopiskjarj2011 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011  = ''  then l.yoopiskjarj2011 

	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012 = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and l.yoopiskjarj2012 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.ammopiskjarj2012 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012  = ''  then l.yoopiskjarj2012 
	
	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta 2007, jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007   <> '' and l.ammopiskmaak2007  = '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2007, jätetään tyhjäksi   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007  = '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  ='' and l.yoopiskmaak2007  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2007  <> '' and l.ammopiskmaak2007  <> '' and
	l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  = '' then l.ammopiskmaak2007 
	-- vain ammattikorkeakoulutuksen maakunta 2007, jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007   <> '' and l.yoopiskmaak2007   = '' and
	l.luopiskmaak2007 = '' and l.ammopiskmaak2007 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2007, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007  = '' and l.yoopiskmaak2007  <> '' and 
	l.luopiskmaak2008  = '' and l.ammopiskmaak2007 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2007, merkitään yliopistokoulutuksen maakunta 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2007  <> '' and l.yoopiskmaak2007   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2007  = ''  then l.yoopiskmaak2007
	
	
	-- vain lukiokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and yoopiskmaak2008  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2008, merkitään tyhjäksi   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  ='' and l.yoopiskmaak2008  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2008, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.ammopiskmaak2008 
	-- vain ammattikorkeakoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2008, merkitään yliopistokoulutuksen 2008 maakunta 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008  = ''  then l.yoopiskmaak2008  
	
	
	-- vain lukiokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and yoopiskmaak2009  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2009, merkitään tyhjäksi   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2009, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.ammopiskmaak2009 
	-- vain ammattikorkeakoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2009, merkitään yliopistokoulutuksen 2008 maakunta 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.yoopiskmaak2009  
	
		-- vain lukiokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and yoopiskmaak2010  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2010, merkitään tyhjäksi   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2010, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.ammopiskmaak2010 
	-- vain ammattikorkeakoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2010, merkitään yliopistokoulutuksen 2008 maakunta 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.yoopiskmaak2010  

		-- vain lukiokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011   <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and yoopiskmaak2011  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2011, merkitään tyhjäksi   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2011, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.ammopiskmaak2011 
	-- vain ammattikorkeakoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2011, merkitään yliopistokoulutuksen 2008 maakunta 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.yoopiskmaak2011  


		-- vain lukiokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012   <> '' and l.ammopiskmaak2012  = '' and
	l.amkopiskmaak2012  = '' and yoopiskmaak2012  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2012, merkitään tyhjäksi   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  = '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2012, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.ammopiskmaak2012 
	-- vain ammattikorkeakoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012   <> '' and l.yoopiskmaak2012   = '' and
	l.luopiskmaak2012 = '' and l.ammopiskmaak2012 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  <> '' and 
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2012, merkitään yliopistokoulutuksen 2008 maakunta 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012   <> '' and
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012  = ''  then l.yoopiskmaak2012  
	
	else ''
	
	    end),
	-- Monihaku
	(case
	-- 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.monihaku2007
	--2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1'  then l.monihaku2008
	-- 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.monihaku2009
	-- 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.monihaku2010
	-- 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.monihaku2011
	-- 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.monihaku2012
	
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2007
	-- 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2008 
	-- 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2009
	-- 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2010
	--2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2011
	--2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2012

   
	else ''
	end),
	-- Ammattiasema
	(case
	-- 2007
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.amas_2007
	-- 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' then l.amas_2008
	-- 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.amas_2009
	-- 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.amas_2010
    -- 2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.amas_2011
	-- 2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.amas_2012

	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1'  
 	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'  
        when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1' 
		 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then '1'   
	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2007  <> '' and l.luopiskkoulk2007 = '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2008 <> '' and l.luopiskkoulk2008  = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then '1'   
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2009 <> '' and l.luopiskkoulk2009  = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1'    
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2010 <> '' and l.luopiskkoulk2010  = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'    
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2011 <> '' and l.luopiskkoulk2011  = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1'    
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2012 <> '' and l.luopiskkoulk2012  = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then '1' 
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2007 <> '' and l.ammopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' and l.luopiskkoulk2007 = '' then  '1'
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' then  '1'
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' then  '1'
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' then  '1'
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' then  '1'
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2007  <> '' and l.amkopiskkoulk2007 = '' and l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then '1'  	   
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then '1'  	   
	     when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then '1'  
		 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' then '1'  	   
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2007  <> '' and l.ammopiskkoulk2007 <> '' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007  = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'  
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1' 
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then '1'    
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2007  <> '' and l.amkopiskkoulk2007 <> '' and l.luopiskkoulk2007 = '' and l.yoopiskkoulk2007 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2008  <> '' and l.amkopiskkoulk2008 <> ''  and l.luopiskkoulk2008 = '' and l.yoopiskkoulk2008  = '' then '1' 
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 <> ''  and l.luopiskkoulk2009 = '' and l.yoopiskkoulk2009  = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 <> ''  and l.luopiskkoulk2010 = '' and l.yoopiskkoulk2010  = '' then '1'  
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 <> ''  and l.luopiskkoulk2011 = '' and l.yoopiskkoulk2011  = '' then '1'  
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 <> ''  and l.luopiskkoulk2012 = '' and l.yoopiskkoulk2012  = '' then '1'    
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2007  <> '' and l.yoopiskkoulk2007 <> '' and l.ammopiskkoulk2007  = '' and l.luopiskkoulk2007 = ''  then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008 <> ''  and l.ammopiskkoulk2008  = '' and l.luopiskkoulk2008 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009 <> ''  and l.ammopiskkoulk2009  = '' and l.luopiskkoulk2009 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010 <> ''  and l.ammopiskkoulk2010  = '' and l.luopiskkoulk2010 = '' then '1'  
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011 <> ''  and l.ammopiskkoulk2011  = '' and l.luopiskkoulk2011 = '' then '1'  
		 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012 <> ''  and l.ammopiskkoulk2012  = '' and l.luopiskkoulk2012 = '' then '1'   
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
       -- Tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')  and (l.ptoim1r4_2007 = '22' or l.ptoim1r4_2007 = '13')
       and (l.luopiskkoulk2007 <> '' or l.ammopiskkoulk2007<>'' or l.amkopiskkoulk2007 <> '' or l.yoopiskkoulk2007<>'')	   then '1' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008  = '13')
	   and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008<>'' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008<>'')then '1' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13')
	   and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009<>'' or l.amkopiskkoulk2009<> '' or l.yoopiskkoulk2009<>'')then '1' 
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13')
	   and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010<>'' or l.amkopiskkoulk2010<> '' or l.yoopiskkoulk2010<>'')then '1' 
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
	   and (l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011<>'' or l.amkopiskkoulk2011<> '' or l.yoopiskkoulk2011<>'')then '1' 
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13')
	   and (l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012<>'' or l.amkopiskkoulk2012<> '' or l.yoopiskkoulk2012<>'')then '1'
	
     -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')  and (l.ptoim1r4_2007 = '22' or l.ptoim1r4_2007 = '13')
       and (l.luopiskkoulk2007 = '' and l.ammopiskkoulk2007='' and l.amkopiskkoulk2007 = '' and l.yoopiskkoulk2007='')	   then '2' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008  = '13')
	  and (l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008='' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008='') then '2' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13')
	   and (l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009='' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009='')then '2' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13')
	   and (l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010='' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010='')then '2' 
	 when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
	   and (l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011='' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011='')then '2' 
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13')
	   and (l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012='' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012='')then '2' 


	   -- Ei opiskelevat työlliset
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')and  l.ptoim1r4_2007  = '10'  then '3' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2008 = '10'  then '3'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2009 = '10'  then '3' 
	   	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2010 = '10'  then '3' 
		    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2011 = '10'  then '3' 
			 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2012 = '10'  then '3' 


	    
	   -- Ei opiskelevat työttömät
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2007  = '12'  then '4' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2008 = '12'  then '4' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2009 = '12'  then '4' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2010 = '12'  then '4' 
	when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2011 = '12'  then '4' 
	when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2012 = '12'  then '4' 
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
  ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where (suorv = '2004' or suorv = '2005' or suorv = '2006' or suorv= '2007' or suorv= '2008' or suorv = '2009') and suorlk = '1'
	) as l
	
	
	WHERE 1=1
end;

--
-- TULOS
-- 
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_3_5_tarkastelujakso]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_3_5_tarkastelujakso]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_3_5_tarkastelujakso] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_3_5_tarkastelujakso] AS
declare @debug_what_to_run tinyint; set @debug_what_to_run=1; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';



-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;
set @ensimmainen_suoritusvuosi = 2004;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;



INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn 
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
,lkm
,pohjkoulk
,tietolahde
, aineisto
 ,lukiokoulutuksessa
 ,ammatillisessa_koulutuksessa
 ,ammattikorkeakoulutuksessa
 ,yliopistokoulutuksessa
 ,lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
 ,toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
 ,ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
 ,koulutuksen_paattaneiden_toiminta
 ,ika_1v
 ,ika_5v
)
SELECT
 l.rivinumero,
 '3,5',
 l.tilv,
 l.tilv_date,
 l.tutkryh,
 l.suorv,
 (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
(case
    -- Koulutus 1
	-- lukiokoulutuksessa 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammatillisessa koulutuksessa 2008 
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then l.ammopiskkoulk2008 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2008 ensimäisiin koulutustietoihin
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammattikorkeakoulutuksessa
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008  = '' and l.ammopiskkoulk2008 = '' then l.amkopiskkoulk2008
	-- yliopistokoulutuksessa
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then l.yoopiskkoulk2008 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.amkopiskkoulk2008 
	
	
	-- lukiokoulutuksessa 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammatillisessa koulutuksessa 2009
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then l.ammopiskkoulk2009 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2009 ensimäisiin koulutustietoihin
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammattikorkeakoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009  = '' and l.ammopiskkoulk2009 = '' then l.amkopiskkoulk2009
	-- yliopistokoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then l.yoopiskkoulk2009 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.amkopiskkoulk2009
	
		-- lukiokoulutuksessa 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammatillisessa koulutuksessa 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then l.ammopiskkoulk2010 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2009 ensimäisiin koulutustietoihin
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010  = '' and l.ammopiskkoulk2010 = '' then l.amkopiskkoulk2010
	-- yliopistokoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then l.yoopiskkoulk2010 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.amkopiskkoulk2010
	
	-- lukiokoulutuksessa 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammatillisessa koulutuksessa 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then l.ammopiskkoulk2011 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2009 ensimäisiin koulutustietoihin
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammattikorkeakoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011  = '' and l.ammopiskkoulk2011 = '' then l.amkopiskkoulk2011
	-- yliopistokoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then l.yoopiskkoulk2011 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.amkopiskkoulk2011

    -- lukiokoulutuksessa 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammatillisessa koulutuksessa 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then l.ammopiskkoulk2012 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2009 ensimäisiin koulutustietoihin
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammattikorkeakoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012  = '' and l.ammopiskkoulk2012 = '' then l.amkopiskkoulk2012
	-- yliopistokoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then l.yoopiskkoulk2012 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.amkopiskkoulk2012

	 -- lukiokoulutuksessa 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.luopiskkoulk2013
	-- ammatillisessa koulutuksessa 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 ='' and l.yoopiskkoulk2013 = ''  then l.ammopiskkoulk2013 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2009 ensimäisiin koulutustietoihin
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.luopiskkoulk2013
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2013  <> '' and l.yoopiskkoulk2013  = '' and
	l.luopiskkoulk2013  = '' and l.ammopiskkoulk2013 = '' then l.amkopiskkoulk2013
	-- yliopistokoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 <> '' and 
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''   then l.yoopiskkoulk2013 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013  <> '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''  then l.amkopiskkoulk2013

	
	else ''
	    end),
	 -- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammatillisen koulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and l.yoopisktunn2008 = ''  then l.ammopisktunn2008
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammattikorkeakoulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then l.amkopisktunn2008
	-- yliopistokoulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''   then l.yoopisktunn2008  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2008  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.amkopisktunn2008 
	
	
	-- lukiokoulutuksen oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammatillisen koulutuksen oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and l.yoopisktunn2009 = ''  then l.ammopisktunn2009
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2008
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammattikorkeakoulutuksen oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then l.amkopisktunn2009
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''   then l.yoopisktunn2009  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009 
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.amkopisktunn2009 
	
	-- lukiokoulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammatillisen koulutuksen oppilaitos 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and l.yoopisktunn2010 = ''  then l.ammopisktunn2010
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2008
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammattikorkeakoulutuksen oppilaitos 2009
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then l.amkopisktunn2010
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''   then l.yoopisktunn2010  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009 
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.amkopisktunn2010 
	
	-- lukiokoulutuksen oppilaitos 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammatillisen koulutuksen oppilaitos 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and l.yoopisktunn2011 = ''  then l.ammopisktunn2011
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2008
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammattikorkeakoulutuksen oppilaitos 2009
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then l.amkopisktunn2011
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''   then l.yoopisktunn2011  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009 
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.amkopisktunn2011 

	-- lukiokoulutuksen oppilaitos 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammatillisen koulutuksen oppilaitos 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and l.yoopisktunn2012 = ''  then l.ammopisktunn2012
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2008
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammattikorkeakoulutuksen oppilaitos 2009
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then l.amkopisktunn2012
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''   then l.yoopisktunn2012  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009 
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.amkopisktunn2012 


	-- lukiokoulutuksen oppilaitos 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 = '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.luopisktunn2013
	-- ammatillisen koulutuksen oppilaitos 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2013 = '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 ='' and l.yoopisktunn2013 = ''  then l.ammopisktunn2013
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2008
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.luopisktunn2013
	-- ammattikorkeakoulutuksen oppilaitos 2009
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2013  <> '' and l.yoopisktunn2013  = '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = '' then l.amkopisktunn2013
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2013 = '' and l.yoopisktunn2013 <> '' and 
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''   then l.yoopisktunn2013  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009 
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2013 <> '' and l.yoopisktunn2013  <> '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''  then l.amkopisktunn2013 
	
	else ''
	
	    end),
	-- Koulutuksen järjestäjä 1 
	(case
	-- lukiokoulutuksen järjestäjä 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008  = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008  
	-- ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @ensimmainen_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and yoopiskjarj2008 = ''  then l.ammopiskjarj2008 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2008, merkitään lukiokoulutuksen 2008 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008
	-- ammattikorkeakoulutuksen 2008 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then l.amkopiskjarj2008 
	-- yliopistokoulutuksen 2008 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then l.yoopiskjarj2008
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2008, merkitään ammattikorkekoulutuksen järjestäjä 2008   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.amkopiskjarj2008 
	
	
	-- lukiokoulutuksen järjestäjä 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009  = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009  
	-- ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @toinen_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and yoopiskjarj2009 = ''  then l.ammopiskjarj2009 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2008, merkitään lukiokoulutuksen 2008 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009
	-- ammattikorkeakoulutuksen 2009 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then l.amkopiskjarj2009 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then l.yoopiskjarj2009
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.amkopiskjarj2009 
	
	
	-- lukiokoulutuksen järjestäjä 2010
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010  = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010  
	-- ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and yoopiskjarj2010 = ''  then l.ammopiskjarj2010 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2008, merkitään lukiokoulutuksen 2008 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010
	-- ammattikorkeakoulutuksen 2009 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then l.amkopiskjarj2010 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then l.yoopiskjarj2010
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.amkopiskjarj2010 
	
	-- lukiokoulutuksen järjestäjä 2010
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011= '' and l.yoopiskjarj2011= '' then l.luopiskjarj2011 
	-- ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2011= '' and l.ammopiskjarj2011<> '' and
	l.amkopiskjarj2011='' and yoopiskjarj2011= ''  then l.ammopiskjarj2011
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2008, merkitään lukiokoulutuksen 2008 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2011<> '' and l.ammopiskjarj2011<> '' and
	l.amkopiskjarj2011= '' and l.yoopiskjarj2011= '' then l.luopiskjarj2010
	-- ammattikorkeakoulutuksen 2009 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011 <> '' and l.yoopiskjarj2011  = '' and
	l.luopiskjarj2011= '' and l.ammopiskjarj2011= '' then l.amkopiskjarj2011
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 <> '' and 
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011= ''   then l.yoopiskjarj2011
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011 <> '' and l.yoopiskjarj2011  <> '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = ''  then l.amkopiskjarj2011

	-- lukiokoulutuksen järjestäjä 2012
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 = '' and
	l.amkopiskjarj2012= '' and l.yoopiskjarj2012= '' then l.luopiskjarj2012 
	-- ammatillisen koulutuksen järjestäjä 2012
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2012= '' and l.ammopiskjarj2012<> '' and
	l.amkopiskjarj2012='' and yoopiskjarj2012= ''  then l.ammopiskjarj2012
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2008, merkitään lukiokoulutuksen 2008 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2012<> '' and l.ammopiskjarj2012<> '' and
	l.amkopiskjarj2012= '' and l.yoopiskjarj2012= '' then l.luopiskjarj2010
	-- ammattikorkeakoulutuksen 2009 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2012 <> '' and l.yoopiskjarj2012  = '' and
	l.luopiskjarj2012= '' and l.ammopiskjarj2012= '' then l.amkopiskjarj2012
	-- yliopistokoulutuksen 2012 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 <> '' and 
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012= ''   then l.yoopiskjarj2012
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2012 <> '' and l.yoopiskjarj2012  <> '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = ''  then l.amkopiskjarj2012

	-- lukiokoulutuksen järjestäjä 2013
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2013 <> '' and l.ammopiskjarj2013 = '' and
	l.amkopiskjarj2013= '' and l.yoopiskjarj2013= '' then l.luopiskjarj2013 
	-- ammatillisen koulutuksen järjestäjä 2013
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2013= '' and l.ammopiskjarj2013<> '' and
	l.amkopiskjarj2013='' and yoopiskjarj2013= ''  then l.ammopiskjarj2013
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2008, merkitään lukiokoulutuksen 2008 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2013<> '' and l.ammopiskjarj2013<> '' and
	l.amkopiskjarj2013= '' and l.yoopiskjarj2013= '' then l.luopiskjarj2010
	-- ammattikorkeakoulutuksen 2009 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2013 <> '' and l.yoopiskjarj2013  = '' and
	l.luopiskjarj2013= '' and l.ammopiskjarj2013= '' then l.amkopiskjarj2013
	-- yliopistokoulutuksen 2013 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 <> '' and 
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013= ''   then l.yoopiskjarj2013
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2013 <> '' and l.yoopiskjarj2013  <> '' and
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = ''  then l.amkopiskjarj2013


	else ''
	    end),
	    
	 -- Maakunta 1
	(case
	-- lukioopiskelun maakunta 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008
	-- ammatillisen koulutksen maakunta 2008    
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  ='' and l.yoopiskmaak2008  = ''  then l.ammopiskmaak2008
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2008  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008 
	-- ammattikorkekoulutuksen maakunta 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then l.amkopiskmaak2008
	-- yliopistokoulutuksen maakunta 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008 = ''   then l.yoopiskmaak2008
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2008, otetaan talteen ammattikorkekoulutksen maakunta 2008   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008  = ''  then l.amkopiskmaak2008 
	
	
	-- lukioopiskelun maakunta 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009
	-- ammatillisen koulutksen maakunta 2009    
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then l.ammopiskmaak2009
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009 
	-- ammattikorkekoulutuksen maakunta 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then l.amkopiskmaak2009
	-- yliopistokoulutuksen maakunta 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then l.yoopiskmaak2009
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2009   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.amkopiskmaak2009 
	
	-- lukioopiskelun maakunta 2010
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010
	-- ammatillisen koulutksen maakunta 2009    
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010 ='' and l.yoopiskmaak2010  = ''  then l.ammopiskmaak2010
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010 
	-- ammattikorkekoulutuksen maakunta 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then l.amkopiskmaak2010
	-- yliopistokoulutuksen maakunta 2009
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then l.yoopiskmaak2010
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2009   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.amkopiskmaak2010 
	
	
	-- lukioopiskelun maakunta 2011
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011 = '' and
	l.amkopiskmaak2011 = '' and l.yoopiskmaak2011 = '' then l.luopiskmaak2011
	-- ammatillisen koulutksen maakunta 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2011 = '' and l.ammopiskmaak2011 <> '' and
	l.amkopiskmaak2011='' and l.yoopiskmaak2011 = ''  then l.ammopiskmaak2011
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2011 <> '' and l.ammopiskmaak2011 <> '' and
	l.amkopiskmaak2011 = '' and l.yoopiskmaak2011 = '' then l.luopiskmaak2011
	-- ammattikorkekoulutuksen maakunta 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011  = '' and
	l.luopiskmaak2011= '' and l.ammopiskmaak2011= '' then l.amkopiskmaak2011
	-- yliopistokoulutuksen maakunta 2011
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2011 = '' and l.yoopiskmaak2011 <> '' and 
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011= ''   then l.yoopiskmaak2011
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2011   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2011 <> '' and l.yoopiskmaak2011  <> '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = ''  then l.amkopiskmaak2011

	-- lukioopiskelun maakunta 2012
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012 = '' and
	l.amkopiskmaak2012 = '' and l.yoopiskmaak2012 = '' then l.luopiskmaak2012
	-- ammatillisen koulutksen maakunta 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2012 = '' and l.ammopiskmaak2012 <> '' and
	l.amkopiskmaak2012='' and l.yoopiskmaak2012 = ''  then l.ammopiskmaak2012
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2012 <> '' and l.ammopiskmaak2012 <> '' and
	l.amkopiskmaak2012 = '' and l.yoopiskmaak2012 = '' then l.luopiskmaak2012
	-- ammattikorkekoulutuksen maakunta 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012  = '' and
	l.luopiskmaak2012= '' and l.ammopiskmaak2012= '' then l.amkopiskmaak2012
	-- yliopistokoulutuksen maakunta 2012
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2012 = '' and l.yoopiskmaak2012 <> '' and 
	l.luopiskmaak2012 = '' and l.ammopiskmaak2012= ''   then l.yoopiskmaak2012
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2012   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2012 <> '' and l.yoopiskmaak2012  <> '' and
	l.luopiskmaak2012 = '' and l.ammopiskmaak2012 = ''  then l.amkopiskmaak2012


	-- lukioopiskelun maakunta 2013
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013 = '' and
	l.amkopiskmaak2013 = '' and l.yoopiskmaak2013 = '' then l.luopiskmaak2013
	-- ammatillisen koulutksen maakunta 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2013 = '' and l.ammopiskmaak2013 <> '' and
	l.amkopiskmaak2013='' and l.yoopiskmaak2013 = ''  then l.ammopiskmaak2013
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2013 <> '' and l.ammopiskmaak2013 <> '' and
	l.amkopiskmaak2013 = '' and l.yoopiskmaak2013 = '' then l.luopiskmaak2013
	-- ammattikorkekoulutuksen maakunta 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2013  <> '' and l.yoopiskmaak2013  = '' and
	l.luopiskmaak2013= '' and l.ammopiskmaak2013= '' then l.amkopiskmaak2013
	-- yliopistokoulutuksen maakunta 2013
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2013 = '' and l.yoopiskmaak2013 <> '' and 
	l.luopiskmaak2013 = '' and l.ammopiskmaak2013= ''   then l.yoopiskmaak2013
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2013   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2013 <> '' and l.yoopiskmaak2013  <> '' and
	l.luopiskmaak2013 = '' and l.ammopiskmaak2013 = ''  then l.amkopiskmaak2013
	
	else ''
	
	
	    end),
-- Koulutus 2
(case
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2008
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2008 
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.ammopiskkoulk2008
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.yoopiskkoulk2008   
	
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2008 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.ammopiskkoulk2009
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.yoopiskkoulk2009   
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2010 
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2009
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.ammopiskkoulk2010
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2008
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.yoopiskkoulk2010  
	
			-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2011 
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2009
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.ammopiskkoulk2011
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2008
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.yoopiskkoulk2011   
	
			-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2012 
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2009
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.ammopiskkoulk2012
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2008
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.yoopiskkoulk2012     

			-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2013 
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 ='' and l.yoopiskkoulk2013 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2009
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.ammopiskkoulk2013
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2008
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2013  <> '' and l.yoopiskkoulk2013  = '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 <> '' and 
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013  <> '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''  then l.yoopiskkoulk2013  
	
	else ''
	    end),
	    
-- Oppilaitos 2
(case
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and yoopisktunn2008 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.ammopisktunn2008 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2008 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2008 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.yoopisktunn2008 
	
		-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and yoopisktunn2009 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.ammopisktunn2009 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.yoopisktunn2009 
	
	
    -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and yoopisktunn2010 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.ammopisktunn2010 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2010 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2010 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.yoopisktunn2010 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and yoopisktunn2011 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.ammopisktunn2011 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2011 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.yoopisktunn2011 

	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and yoopisktunn2012 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.ammopisktunn2012 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2012 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2012 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.yoopisktunn2012 

	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 = '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2013 = '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 ='' and yoopisktunn2013 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.ammopisktunn2013 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2013  <> '' and l.yoopisktunn2013  = '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2013 = '' and l.yoopisktunn2013 <> '' and 
	l.luopisktunn2013 = '' and l.ammopisktunn2013  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2013 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2013 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2013 <> '' and l.yoopisktunn2013  <> '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''  then l.yoopisktunn2013 
	
	else ''
	    end),
	    
	-- Koulutuksen järjestäjä 2
	(case
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008 = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and l.yoopiskjarj2008 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.ammopiskjarj2008 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.yoopiskjarj2008 
	
	
		-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and l.yoopiskjarj2009 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.ammopiskjarj2009 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2008
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009  <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.yoopiskjarj2009 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and l.yoopiskjarj2010 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.ammopiskjarj2010 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010  <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''  then l.yoopiskjarj2010 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and l.yoopiskjarj2011 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2011
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.ammopiskjarj2011 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011  <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''  then l.yoopiskjarj2011 

	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012 = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and l.yoopiskjarj2012 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2012
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.ammopiskjarj2012 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012  <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012 = ''  then l.yoopiskjarj2012 

	--- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2013  <> '' and l.ammopiskjarj2013 = '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2013 = '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 ='' and l.yoopiskjarj2013 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2013
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2013 <> '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.ammopiskjarj2013 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   = '' and
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2013  = '' and l.yoopiskjarj2013  <> '' and 
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013  <> '' and
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013 = ''  then l.yoopiskjarj2013 

	
	
	else ''
	    end),
	    
	-- Maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and yoopiskmaak2008  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2008, merkitään tyhjäksi   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  ='' and l.yoopiskmaak2008  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2008, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.ammopiskmaak2008 
	-- vain ammattikorkeakoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2008, merkitään yliopistokoulutuksen 2008 maakunta 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008  = ''  then l.yoopiskmaak2008  
	
	
		-- vain lukiokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and yoopiskmaak2009  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2008, merkitään tyhjäksi   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2009, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.ammopiskmaak2009 
	-- vain ammattikorkeakoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2009, merkitään yliopistokoulutuksen 2008 maakunta 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.yoopiskmaak2009  
	
	
	-- vain lukiokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and yoopiskmaak2010  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2010, merkitään tyhjäksi   
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2010, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.ammopiskmaak2010 
	-- vain ammattikorkeakoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2010, merkitään yliopistokoulutuksen 2010 maakunta 
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.yoopiskmaak2010  
	
	-- vain lukiokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and yoopiskmaak2011  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2011, merkitään tyhjäksi   
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  ='' and l.yoopiskmaak2011 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2011, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.ammopiskmaak2011 
	-- vain ammattikorkeakoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2011, merkitään yliopistokoulutuksen 2011 maakunta 
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.yoopiskmaak2011  

	
	-- vain lukiokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  = '' and
	l.amkopiskmaak2012  = '' and yoopiskmaak2012  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2012, merkitään tyhjäksi   
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2012  = '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  ='' and l.yoopiskmaak2012 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2012, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.ammopiskmaak2012 
	-- vain ammattikorkeakoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2012   <> '' and l.yoopiskmaak2012   = '' and
	l.luopiskmaak2012 = '' and l.ammopiskmaak2012 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  <> '' and 
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2012, merkitään yliopistokoulutuksen 2012 maakunta 
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012   <> '' and
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012  = ''  then l.yoopiskmaak2012  


	-- vain lukiokoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013  = '' and
	l.amkopiskmaak2013  = '' and yoopiskmaak2013  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2013, merkitään tyhjäksi   
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2013  = '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  ='' and l.yoopiskmaak2013 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2013, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.ammopiskmaak2013 
	-- vain ammattikorkeakoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2013   <> '' and l.yoopiskmaak2013   = '' and
	l.luopiskmaak2013 = '' and l.ammopiskmaak2013 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  <> '' and 
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2013, merkitään yliopistokoulutuksen 2013 maakunta 
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2013  <> '' and l.yoopiskmaak2013   <> '' and
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013  = ''  then l.yoopiskmaak2013  

	else ''
	    end),
	-- Monihaku
	(case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.monihaku2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.monihaku2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.monihaku2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.monihaku2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.monihaku2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.monihaku2013
	else '8'
	end),
	-- Pääasiallinen toiminta
    (case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2008 
    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2009 
    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2010 
    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2012
		when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2013
	else ''
	end),
	-- Ammattiasema
	(case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.amas_2008
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.amas_2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.amas_2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.amas_2011
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.amas_2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.amas_2013


	else ''
	end),
 l.lkm,
 l.pohjkoul,
 l.tietolahde,
 'K3.13',
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and
	    l.yoopiskkoulk2008 = ''  then  '1'  
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = ''   then '1'  
	     when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = ''   then '1'  
	         when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = ''   then '1'  
		 when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and
	    l.yoopiskkoulk2012 = ''   then '1'  
		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and
	    l.yoopiskkoulk2013 = ''   then '1'
	    else '0'
	    end) as lukiokoulutuksessa,
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2008 <> '' and l.luopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and
	    l.yoopiskkoulk2008 = ''  then '1'   
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = ''  then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2010 <> '' and l.luopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = '' then '1'  
	     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2011 <> '' and l.luopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = '' then '1'  
		  when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2012 <> '' and l.luopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and
	    l.yoopiskkoulk2012 = '' then '1'  
		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2013 <> '' and l.luopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and
	    l.yoopiskkoulk2013 = '' then '1'  
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
 (case  
	   when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' and
	   l.yoopiskkoulk2008 = ''  then  '1'
	   when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and
	   l.yoopiskkoulk2009 = ''  then  '1'
	   when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and
	   l.yoopiskkoulk2010 = ''  then  '1'
	    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' and
	   l.yoopiskkoulk2011 = ''  then  '1'
	    when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' and
	   l.yoopiskkoulk2012 = ''  then  '1'
	    when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and l.luopiskkoulk2013 = '' and
	   l.yoopiskkoulk2013 = ''  then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and  l.yoopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' and 
	    l.ammopiskkoulk2008 = ''  then '1'  
	    when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and  l.yoopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and 
	    l.ammopiskkoulk2009 = ''  then '1' 
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and 
	    l.ammopiskkoulk2010 = ''  then '1' 
	      when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' and 
	    l.ammopiskkoulk2011 = ''  then '1' 
		 when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' and 
	    l.ammopiskkoulk2012 = ''  then '1' 
		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2013 <> '' and l.amkopiskkoulk2013 = '' and l.luopiskkoulk2013 = '' and 
	    l.ammopiskkoulk2013 = ''  then '1' 
	    else '0'
	    end) as yliopistokoulutuksessa,

(case

	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and
	    l.yoopiskkoulk2008 = '' then '1'  
	    
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = ''  then '1' 
	    
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = ''  then '1' 
	    
	    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = ''  then '1' 
		when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and
	    l.yoopiskkoulk2012 = ''  then '1' 
		when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and l.amkopiskkoulk2013 = '' and
	    l.yoopiskkoulk2013 = ''  then '1' 
	    
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2'and  l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 <> '' and l.luopiskkoulk2008 = '' and
	    l.yoopiskkoulk2008 = ''  then '1' 
	     
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = '' then '1' 
	    
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 <> '' and l.luopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = '' then '1' 
	     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 <> '' and l.luopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = '' then '1' 
		 when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 <> '' and l.luopiskkoulk2012 = '' and
	    l.yoopiskkoulk2012 = '' then '1' 
		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2013 <> '' and l.amkopiskkoulk2013 <> '' and l.luopiskkoulk2013 = '' and
	    l.yoopiskkoulk2013 = '' then '1' 
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008 <> '' and l.luopiskkoulk2008 = '' and
	    l.ammopiskkoulk2008 = ''  then '1'  
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and
	    l.ammopiskkoulk2009 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010 <> '' and l.luopiskkoulk2010 = '' and
	    l.ammopiskkoulk2010 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011 <> '' and l.luopiskkoulk2011 = '' and
	    l.ammopiskkoulk2011 = '' then '1'  
		 when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012 <> '' and l.luopiskkoulk2012 = '' and
	    l.ammopiskkoulk2012 = '' then '1'  
		 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013 <> '' and l.luopiskkoulk2013 = '' and
	    l.ammopiskkoulk2013 = '' then '1'  
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 ='13') 
	   and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008<>'' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008<>'')  then '1' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13') 
	   and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009<>'' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009<>'') then '1'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13') 
	    and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010<>'' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010<>'')then '1' 
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13') 
	    and (l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011<>'' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011<>'')then '1' 
		 when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13') 
	    and (l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012<>'' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012<>'')then '1'
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2013 = '22' or l.ptoim1r4_2013 = '13') 
	    and (l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013<>'' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013<>'')then '1'
	   
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 ='13') 
	   and (l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008='' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008='')then '2' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13') 
	   and (l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009='' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009='') then '2'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13')
       and (l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010='' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010='')	   then '2' 
        when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
       and (l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011='' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011='')	   then '2' 
   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13')
       and (l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012='' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012='')	   then '2' 
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2013 = '22' or l.ptoim1r4_2013 = '13')
       and (l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013='' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013='')	   then '2' 

	  -- Ei opiskelevat työlliset
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2')and l.ptoim1r4_2008 = '10'  then '3'
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and  l.ptoim1r4_2009 = '10'  then '3'     
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2010 = '10'  then '3' 
	   	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2011 = '10'  then '3' 
		     when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2012 = '10'  then '3' 
			  when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2013 = '10'  then '3' 
	  -- Ei opiskelevat työttömät 
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2008 = '12'  then '4' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and  l.ptoim1r4_2009 = '12'  then '4'
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2010 = '12'  then '4' 
	   	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2011 = '12'  then '4'  
		    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2012 = '12'  then '4' 
			 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2013 = '12'  then '4' 
	   
	   -- Ei opiskelevat muut
      else '5'
	     
	     
	   end)as koulutuksen_paattaneiden_toiminta
	  ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
     ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))
	 
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where (suorv = '2004' or suorv = '2005' or suorv = '2006' or suorv= '2007' or suorv = '2008' or suorv = '2009') and suorlk = '2'
	
	) as l
	
	
	WHERE 1=1
end;

--
-- TULOS
-- 
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_4_0_tarkastelujakso]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_4_0_tarkastelujakso]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_4_0_tarkastelujakso] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_4_0_tarkastelujakso] AS
declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;

set @ensimmainen_suoritusvuosi = 2004;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;



INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
,lkm
,pohjkoulk
,tietolahde
, aineisto
 ,lukiokoulutuksessa
 ,ammatillisessa_koulutuksessa
 ,ammattikorkeakoulutuksessa
 ,yliopistokoulutuksessa
 ,lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
 ,toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
 ,ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
 ,koulutuksen_paattaneiden_toiminta
 ,ika_1v
 ,ika_5v
)
SELECT
 l.rivinumero,
 '4',
 l.tilv,
 l.tilv_date,
 l.tutkryh,
 l.suorv,
 (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008 
	-- ammattikoulutuksessa 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then l.ammopiskkoulk2008 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2008 ensim. koulutustietoihin
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.luopiskkoulk2008
	-- ammattikorkeakoulutuksessa 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then l.amkopiskkoulk2008
	-- yliopistokoulutuksessa 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then l.yoopiskkoulk2008
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and ammopiskkoulk2008 = ''  then l.amkopiskkoulk2008 
	
	
	-- lukiokoulutuksessa 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammatillisessa koulutuksessa 2009 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then l.ammopiskkoulk2009 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2009 ensimäisiin koulutustietoihin
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammattikorkeakoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009  = '' and l.ammopiskkoulk2009 = '' then l.amkopiskkoulk2009
	-- yliopistokoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then l.yoopiskkoulk2009 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.amkopiskkoulk2009 
	
	
	-- lukiokoulutuksessa 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammatillisessa koulutuksessa 2010 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then l.ammopiskkoulk2010 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010  = '' and l.ammopiskkoulk2010 = '' then l.amkopiskkoulk2010
	-- yliopistokoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then l.yoopiskkoulk2010 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.amkopiskkoulk2010 
	
	-- lukiokoulutuksessa 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammatillisessa koulutuksessa 2011 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then l.ammopiskkoulk2011 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2011 ensimäisiin koulutustietoihin
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammattikorkeakoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011  = '' and l.ammopiskkoulk2011 = '' then l.amkopiskkoulk2011
	-- yliopistokoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then l.yoopiskkoulk2011 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.amkopiskkoulk2011 
	
			-- lukiokoulutuksessa 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammatillisessa koulutuksessa 2012 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then l.ammopiskkoulk2012 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2012 ensimäisiin koulutustietoihin
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammattikorkeakoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012  = '' and l.ammopiskkoulk2012 = '' then l.amkopiskkoulk2012
	-- yliopistokoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then l.yoopiskkoulk2012 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.amkopiskkoulk2012 

	-- lukiokoulutuksessa 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.luopiskkoulk2013
	-- ammatillisessa koulutuksessa 2013 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 ='' and l.yoopiskkoulk2013 = ''  then l.ammopiskkoulk2013 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2013 ensimäisiin koulutustietoihin
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.luopiskkoulk2013
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013  <> '' and l.yoopiskkoulk2013  = '' and
	l.luopiskkoulk2013  = '' and l.ammopiskkoulk2013 = '' then l.amkopiskkoulk2013
	-- yliopistokoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 <> '' and 
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''   then l.yoopiskkoulk2013 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013  <> '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''  then l.amkopiskkoulk2013 

	else ''
	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008 
	-- ammattikoulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and l.yoopisktunn2008 = ''  then l.ammopisktunn2008 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.luopisktunn2008
	-- ammattikorkeakoulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then l.amkopisktunn2008
	-- yliopistokoulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''   then l.yoopisktunn2008
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2008  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.amkopisktunn2008 
	
	
	-- lukiokoulutuksen oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammatillisen koulutuksen oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and l.yoopisktunn2009 = ''  then l.ammopisktunn2009
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammattikorkeakoulutuksen oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then l.amkopisktunn2009
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''   then l.yoopisktunn2009  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.amkopisktunn2009 
	
	-- lukiokoulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and l.yoopisktunn2010 = ''  then l.ammopisktunn2010
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then l.amkopisktunn2010
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''   then l.yoopisktunn2010 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.amkopisktunn2010
	
	-- lukiokoulutuksen oppilaitos 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammatillisen koulutuksen oppilaitos 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and l.yoopisktunn2011 = ''  then l.ammopisktunn2011
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammattikorkeakoulutuksen oppilaitos 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then l.amkopisktunn2011
	-- yliopistokoulutuksen oppilaitos 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''   then l.yoopisktunn2011 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.amkopisktunn2011

	-- lukiokoulutuksen oppilaitos 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammatillisen koulutuksen oppilaitos 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and l.yoopisktunn2012 = ''  then l.ammopisktunn2012
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammattikorkeakoulutuksen oppilaitos 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then l.amkopisktunn2012
	-- yliopistokoulutuksen oppilaitos 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''   then l.yoopisktunn2012 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.amkopisktunn2012


	-- lukiokoulutuksen oppilaitos 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 = '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.luopisktunn2013
	-- ammatillisen koulutuksen oppilaitos 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 = '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 ='' and l.yoopisktunn2013 = ''  then l.ammopisktunn2013
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.luopisktunn2013
	-- ammattikorkeakoulutuksen oppilaitos 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013  <> '' and l.yoopisktunn2013  = '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = '' then l.amkopisktunn2013
	-- yliopistokoulutuksen oppilaitos 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013 = '' and l.yoopisktunn2013 <> '' and 
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''   then l.yoopisktunn2013 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013 <> '' and l.yoopisktunn2013  <> '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''  then l.amkopisktunn2013
	
	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008 = '' and
	l.amkopiskjarj2008 = '' and yoopiskjarj2008 = '' then l.luopiskjarj2008
	-- ammatillisen koulutuksen järjestäjä 2008  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and l.yoopiskjarj2008 = ''  then l.ammopiskjarj2008
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen 2008 järjestäjä 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.luopiskjarj2008
	-- ammattikorkeakoulutuksen järjestäjä 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then l.amkopiskjarj2008
	-- yliopistokoulutuksen järjestäjä 2008 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then l.yoopiskjarj2008
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen 2008 järjestäjä   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.amkopiskjarj2008 

	
	-- lukiokoulutuksen järjestäjä 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009  = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009  
	-- ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and yoopiskjarj2009 = ''  then l.ammopiskjarj2009 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009
	-- ammattikorkeakoulutuksen 2009 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then l.amkopiskjarj2009 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then l.yoopiskjarj2009
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.amkopiskjarj2009 
	
	-- lukiokoulutuksen järjestäjä 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010 
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and yoopiskjarj2010 = ''  then l.ammopiskjarj2010 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2010 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then l.amkopiskjarj2010 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then l.yoopiskjarj2010
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.amkopiskjarj2010 
	
	-- lukiokoulutuksen järjestäjä 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011 
	-- ammatillisen koulutuksen järjestäjä 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and yoopiskjarj2011 = ''  then l.ammopiskjarj2011 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2011 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011
	-- ammattikorkeakoulutuksen 2011 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then l.amkopiskjarj2011 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''   then l.yoopiskjarj2011
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011  = ''  then l.amkopiskjarj2011 

	
-- lukiokoulutuksen järjestäjä 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012 = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.luopiskjarj2012 
	-- ammatillisen koulutuksen järjestäjä 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and yoopiskjarj2012 = ''  then l.ammopiskjarj2012 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2012 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.luopiskjarj2012
	-- ammattikorkeakoulutuksen 2012 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then l.amkopiskjarj2012 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012 = ''   then l.yoopiskjarj2012
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012  = ''  then l.amkopiskjarj2012 

	-- lukiokoulutuksen järjestäjä 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013  <> '' and l.ammopiskjarj2013 = '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.luopiskjarj2013 
	-- ammatillisen koulutuksen järjestäjä 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013 = '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 ='' and yoopiskjarj2013 = ''  then l.ammopiskjarj2013 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2013 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013 <> '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.luopiskjarj2013
	-- ammattikorkeakoulutuksen 2013 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   = '' and
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = '' then l.amkopiskjarj2013 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  = '' and l.yoopiskjarj2013  <> '' and 
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013 = ''   then l.yoopiskjarj2013
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   <> '' and
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013  = ''  then l.amkopiskjarj2013 
	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008   
	-- ammatillisen koulutuksen maakunta 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  ='' and l.yoopiskmaak2008  = ''  then l.ammopiskmaak2008  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.luopiskmaak2008 
    -- ammattikorkeakoulutuksen maakunta 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then l.amkopiskmaak2008
	-- yliopistokoulutuksen maakunta 2008 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008 = ''   then l.yoopiskmaak2008
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta 2008   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskmaak2008  = '' and l.ammopiskmaak2008  = ''  then l.amkopiskmaak2008 
	
	
	-- lukioopiskelun maakunta 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009
	-- ammatillisen koulutksen maakunta 2009    
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then l.ammopiskmaak2009
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009 
	-- ammattikorkekoulutuksen maakunta 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then l.amkopiskmaak2009
	-- yliopistokoulutuksen maakunta 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then l.yoopiskmaak2009
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2009   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.amkopiskmaak2009 
	
    -- lukioopiskelun maakunta 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010
	-- ammatillisen koulutksen maakunta 2010    
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010  = ''  then l.ammopiskmaak2010
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010 
	-- ammattikorkekoulutuksen maakunta 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then l.amkopiskmaak2010
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then l.yoopiskmaak2010
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2009   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.amkopiskmaak2010 
	
	
	-- lukioopiskelun maakunta 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011   <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011
	-- ammatillisen koulutksen maakunta 2011    
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  ='' and l.yoopiskmaak2011  = ''  then l.ammopiskmaak2011
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011 
	-- ammattikorkekoulutuksen maakunta 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then l.amkopiskmaak2011
	-- yliopistokoulutuksen maakunta 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then l.yoopiskmaak2011
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2009   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.amkopiskmaak2011 
	

	-- lukioopiskelun maakunta 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012   <> '' and l.ammopiskmaak2012  = '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.luopiskmaak2012
	-- ammatillisen koulutksen maakunta 2012    
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  = '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  ='' and l.yoopiskmaak2012  = ''  then l.ammopiskmaak2012
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.luopiskmaak2012 
	-- ammattikorkekoulutuksen maakunta 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012   <> '' and l.yoopiskmaak2012   = '' and
	l.luopiskmaak2012 = '' and l.ammopiskmaak2012 = '' then l.amkopiskmaak2012
	-- yliopistokoulutuksen maakunta 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  <> '' and 
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012 = ''   then l.yoopiskmaak2012
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2009   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012   <> '' and
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012  = ''  then l.amkopiskmaak2012 

	-- lukioopiskelun maakunta 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013   <> '' and l.ammopiskmaak2013  = '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.luopiskmaak2013
	-- ammatillisen koulutksen maakunta 2013    
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013  = '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  ='' and l.yoopiskmaak2013  = ''  then l.ammopiskmaak2013
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.luopiskmaak2013 
	-- ammattikorkekoulutuksen maakunta 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013   <> '' and l.yoopiskmaak2013   = '' and
	l.luopiskmaak2013 = '' and l.ammopiskmaak2013 = '' then l.amkopiskmaak2013
	-- yliopistokoulutuksen maakunta 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  <> '' and 
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013 = ''   then l.yoopiskmaak2013
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2009   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013  <> '' and l.yoopiskmaak2013   <> '' and
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013  = ''  then l.amkopiskmaak2013 

	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi 2008 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 ='' and l.yoopiskkoulk2008 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus 2008 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 <> '' and
	l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then l.ammopiskkoulk2008 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008  = '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 <> '' and 
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2008 <> '' and l.yoopiskkoulk2008  <> '' and
	l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = ''  then l.yoopiskkoulk2008
	
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2009 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.ammopiskkoulk2009
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.yoopiskkoulk2009   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.ammopiskkoulk2010
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.yoopiskkoulk2010   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.ammopiskkoulk2011
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.yoopiskkoulk2011   

	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.ammopiskkoulk2012
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.yoopiskkoulk2012   

	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 ='' and l.yoopiskkoulk2013 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.ammopiskkoulk2013
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013  <> '' and l.yoopiskkoulk2013  = '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 <> '' and 
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013  <> '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''  then l.yoopiskkoulk2013   
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 = '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then ''
	-- ammatillisen koulutuksen oppilaitos 2008 merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 = '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 ='' and l.yoopisktunn2008 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2008 <> '' and l.ammopisktunn2008 <> '' and
	l.amkopisktunn2008 = '' and l.yoopisktunn2008 = '' then l.ammopisktunn2008 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008  <> '' and l.yoopisktunn2008  = '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 = '' and l.yoopisktunn2008 <> '' and 
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2008 <> '' and l.yoopisktunn2008  <> '' and
	l.luopisktunn2008 = '' and l.ammopisktunn2008 = ''  then l.yoopisktunn2008 
	
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and yoopisktunn2009 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.ammopisktunn2009 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.yoopisktunn2009 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and yoopisktunn2010 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.ammopisktunn2010 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2010 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.yoopisktunn2010 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and yoopisktunn2011 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.ammopisktunn2011 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2011 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.yoopisktunn2011 

		-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and yoopisktunn2012 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.ammopisktunn2012 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2012 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.yoopisktunn2012 

	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 = '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 = '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 ='' and yoopisktunn2013 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.ammopisktunn2013 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013  <> '' and l.yoopisktunn2013  = '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013 = '' and l.yoopisktunn2013 <> '' and 
	l.luopisktunn2013 = '' and l.ammopisktunn2013  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2013 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013 <> '' and l.yoopisktunn2013  <> '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''  then l.yoopisktunn2013 
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain 2008, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008  <> '' and l.ammopiskjarj2008 = '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain 2008, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 = '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 ='' and l.yoopiskjarj2008 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2008 <> '' and l.ammopiskjarj2008 <> '' and
	l.amkopiskjarj2008 = '' and l.yoopiskjarj2008 = '' then l.ammopiskjarj2008 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   = '' and
	l.luopiskjarj2008 = '' and l.ammopiskjarj2008 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  = '' and l.yoopiskjarj2008  <> '' and 
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2008  <> '' and l.yoopiskjarj2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskjarj2008  = ''  then l.yoopiskjarj2008 
	
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and l.yoopiskjarj2009 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.ammopiskjarj2009 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.yoopiskjarj2009 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and l.yoopiskjarj2010 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.ammopiskjarj2010 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.yoopiskjarj2010 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and l.yoopiskjarj2011 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.ammopiskjarj2011 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011  = ''  then l.yoopiskjarj2011 

	
-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012 = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and l.yoopiskjarj2012 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.ammopiskjarj2012 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012  = ''  then l.yoopiskjarj2012 


	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013  <> '' and l.ammopiskjarj2013 = '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013 = '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 ='' and l.yoopiskjarj2013 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013 <> '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.ammopiskjarj2013 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   = '' and
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  = '' and l.yoopiskjarj2013  <> '' and 
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   <> '' and
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013  = ''  then l.yoopiskjarj2013 

	
	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta 2008, jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008   <> '' and l.ammopiskmaak2008  = '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2008, jätetään tyhjäksi   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  = '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  ='' and l.yoopiskmaak2008  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2008  <> '' and l.ammopiskmaak2008  <> '' and
	l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  = '' then l.ammopiskmaak2008 
	-- vain ammattikorkeakoulutuksen maakunta 2008, jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008   <> '' and l.yoopiskmaak2008   = '' and
	l.luopiskmaak2008 = '' and l.ammopiskmaak2008 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2008, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  = '' and l.yoopiskmaak2008  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2008 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2008, merkitään yliopistokoulutuksen maakunta 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2008  <> '' and l.yoopiskmaak2008   <> '' and
	l.luopiskjarj2008  = '' and l.ammopiskmaak2008  = ''  then l.yoopiskmaak2008
	
	
	-- vain lukiokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and yoopiskmaak2009  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2009, merkitään tyhjäksi   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2009, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.ammopiskmaak2009 
	-- vain ammattikorkeakoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2009, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.yoopiskmaak2009  
	
	
	-- vain lukiokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and yoopiskmaak2010  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2010, merkitään tyhjäksi   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2010, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.ammopiskmaak2010 
	-- vain ammattikorkeakoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2010, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.yoopiskmaak2010  
	
	-- vain lukiokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011   <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and yoopiskmaak2011  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2011, merkitään tyhjäksi   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2011, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.ammopiskmaak2011 
	-- vain ammattikorkeakoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2011, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.yoopiskmaak2011  

	-- vain lukiokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012   <> '' and l.ammopiskmaak2012  = '' and
	l.amkopiskmaak2012  = '' and yoopiskmaak2012  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2012, merkitään tyhjäksi   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  = '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2012, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.ammopiskmaak2012 
	-- vain ammattikorkeakoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012   <> '' and l.yoopiskmaak2012   = '' and
	l.luopiskmaak2012 = '' and l.ammopiskmaak2012 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  <> '' and 
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2012, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012   <> '' and
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012  = ''  then l.yoopiskmaak2012  

	-- vain lukiokoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013   <> '' and l.ammopiskmaak2013  = '' and
	l.amkopiskmaak2013  = '' and yoopiskmaak2013  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2013, merkitään tyhjäksi   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013  = '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2013, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.ammopiskmaak2013 
	-- vain ammattikorkeakoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013   <> '' and l.yoopiskmaak2013   = '' and
	l.luopiskmaak2013 = '' and l.ammopiskmaak2013 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  <> '' and 
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2013, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013  <> '' and l.yoopiskmaak2013   <> '' and
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013  = ''  then l.yoopiskmaak2013  
	
	else ''
	
	    end),
	-- Monihaku
	(case
	-- 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.monihaku2008
	--2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1'  then l.monihaku2009
	-- 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.monihaku2010
	-- 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.monihaku2011
	-- 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.monihaku2012

	-- 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.monihaku2013
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2008
	-- 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2009 
	-- 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2010
	-- 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2011
   -- 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2012
	-- 2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2013
	else ''
	end),
	-- Ammattiasema
	(case
	-- 2008
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.amas_2008
	-- 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' then l.amas_2009
	-- 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.amas_2010
	-- 2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.amas_2011
	-- 2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.amas_2012
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.amas_2013


	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'  
  	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1'  
      when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then '1'  
      when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then '1'  


	    else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2008  <> '' and l.luopiskkoulk2008 = '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2009 <> '' and l.luopiskkoulk2009  = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1'   
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2010 <> '' and l.luopiskkoulk2010  = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'    
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2011 <> '' and l.luopiskkoulk2011  = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1'    
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2012 <> '' and l.luopiskkoulk2012  = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then '1'    
	   	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2013 <> '' and l.luopiskkoulk2013  = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then '1'    
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2008 <> '' and l.ammopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' then  '1'
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' then  '1'
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' then  '1'
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' then  '1'
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' then  '1'
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2013 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2008  <> '' and l.amkopiskkoulk2008 = '' and l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then '1'  	   
		    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then '1'  	   
    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' then '1'  	   
	 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2013 <> '' and l.amkopiskkoulk2013 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' then '1'  
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2008  <> '' and l.ammopiskkoulk2008 <> '' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008  = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'  
		    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1'  
   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then '1'  
	  when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then '1' 
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2008  <> '' and l.amkopiskkoulk2008 <> '' and l.luopiskkoulk2008 = '' and l.yoopiskkoulk2008 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2009  <> '' and l.amkopiskkoulk2009 <> ''  and l.luopiskkoulk2009 = '' and l.yoopiskkoulk2009  = '' then '1' 
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 <> ''  and l.luopiskkoulk2010 = '' and l.yoopiskkoulk2010  = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 <> ''  and l.luopiskkoulk2011 = '' and l.yoopiskkoulk2011  = '' then '1'  
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 <> ''  and l.luopiskkoulk2012 = '' and l.yoopiskkoulk2012  = '' then '1'  
	   when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2013 <> '' and l.amkopiskkoulk2013 <> ''  and l.luopiskkoulk2013 = '' and l.yoopiskkoulk2013  = '' then '1'
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2008  <> '' and l.yoopiskkoulk2008 <> '' and l.ammopiskkoulk2008  = '' and l.luopiskkoulk2008 = ''  then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009 <> ''  and l.ammopiskkoulk2009  = '' and l.luopiskkoulk2009 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010 <> ''  and l.ammopiskkoulk2010  = '' and l.luopiskkoulk2010 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011 <> ''  and l.ammopiskkoulk2011  = '' and l.luopiskkoulk2011 = '' then '1'  
	     when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012 <> ''  and l.ammopiskkoulk2012  = '' and l.luopiskkoulk2012 = '' then '1'  
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013 <> ''  and l.ammopiskkoulk2013  = '' and l.luopiskkoulk2013 = '' then '1'  
		else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   --Tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')  and (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 = '13') 
	   and (l.luopiskkoulk2008 <> '' or l.ammopiskkoulk2008<>'' or l.amkopiskkoulk2008 <> '' or l.yoopiskkoulk2008<>'') then '1' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009  = '13')
	   and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009<>'' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009<>'') then '1' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13')
	   and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010<>'' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010<>'') then '1' 
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
	   and (l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011<>'' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011<>'') then '1' 
	     when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13')
	   and (l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012<>'' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012<>'') then '1'
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2013 = '22' or l.ptoim1r4_2013 = '13')
	   and (l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013<>'' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013<>'') then '1'  
	
	-- Ei tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')  and (l.ptoim1r4_2008 = '22' or l.ptoim1r4_2008 = '13') 
	    and (l.luopiskkoulk2008 = '' and l.ammopiskkoulk2008='' and l.amkopiskkoulk2008 = '' and l.yoopiskkoulk2008='')	 then '2' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009  = '13')
	    and (l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009='' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009='')	 then '2' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13')
	    and (l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010='' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010='')	 then '2' 
	      when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
	    and (l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011='' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011='')	 then '2' 
		 when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13')
	    and (l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012='' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012='')	 then '2' 
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2013 = '22' or l.ptoim1r4_2013 = '13')
	    and (l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013='' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013='')	 then '2' 


	   -- Ei opiskelevat työlliset
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')and  l.ptoim1r4_2008  = '10'  then '3' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2009 = '10'  then '3'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2010 = '10'  then '3' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2011 = '10'  then '3' 
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2012 = '10'  then '3' 
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2013 = '10'  then '3' 
	    
	   -- Ei opiskelevat työttömät
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2008  = '12'  then '4' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2009 = '12'  then '4' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2010 = '12'  then '4' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2011 = '12'  then '4' 
	 when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2012 = '12'  then '4' 
	 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2013 = '12'  then '4' 
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
    ,ika_1v = cast((case 
            when syntv = '' then '-1' 
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
   ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where (suorv = '2004' or suorv = '2005' or suorv = '2006' or suorv = '2007' or suorv = '2008' or suorv = '2009' ) and suorlk = '1'
	) as l
	
	
	WHERE 1=1
end;

--
-- TULOS
-- 
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_4_5_tarkastelujakso]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_4_5_tarkastelujakso]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_4_5_tarkastelujakso] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_4_5_tarkastelujakso] AS
declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 3=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';



-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi varchar(4);
DECLARE @toinen_suoritusvuosi varchar(4);
DECLARE @kolmas_suoritusvuosi varchar(4);
DECLARE @neljas_suoritusvuosi varchar(4);
DECLARE @viides_suoritusvuosi varchar(4);
DECLARE @kuudes_suoritusvuosi varchar(4);


set @ensimmainen_suoritusvuosi = 2004;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;

INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn 
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
,lkm
,pohjkoulk
,tietolahde
, aineisto
 ,lukiokoulutuksessa
 ,ammatillisessa_koulutuksessa
 ,ammattikorkeakoulutuksessa
 ,yliopistokoulutuksessa
 ,lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
 ,toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
 ,ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
 ,koulutuksen_paattaneiden_toiminta
 ,ika_1v
 ,ika_5v
)
SELECT
 l.rivinumero,
 '4,5',
 l.tilv,
 l.tilv_date,
 l.tutkryh,
 l.suorv,
 (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
(case
    -- Koulutus 1
	-- lukiokoulutuksessa 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammatillisessa koulutuksessa 2009 
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then l.ammopiskkoulk2009 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2009 ensimäisiin koulutustietoihin
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammattikorkeakoulutuksessa
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009  = '' and l.ammopiskkoulk2009 = '' then l.amkopiskkoulk2009
	-- yliopistokoulutuksessa
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then l.yoopiskkoulk2009 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.amkopiskkoulk2009 
	
	
	-- lukiokoulutuksessa 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammatillisessa koulutuksessa 2010
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then l.ammopiskkoulk2010 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammattikorkeakoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010  = '' and l.ammopiskkoulk2010 = '' then l.amkopiskkoulk2010
	-- yliopistokoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then l.yoopiskkoulk2010 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.amkopiskkoulk2010
	
		-- lukiokoulutuksessa 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammatillisessa koulutuksessa 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then l.ammopiskkoulk2011 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011  = '' and l.ammopiskkoulk2011 = '' then l.amkopiskkoulk2011
	-- yliopistokoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then l.yoopiskkoulk2011 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.amkopiskkoulk2011
	
		-- lukiokoulutuksessa 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammatillisessa koulutuksessa 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then l.ammopiskkoulk2012 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammattikorkeakoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012  = '' and l.ammopiskkoulk2012 = '' then l.amkopiskkoulk2012
	-- yliopistokoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then l.yoopiskkoulk2012 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.amkopiskkoulk2012

		-- lukiokoulutuksessa 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.luopiskkoulk2013
	-- ammatillisessa koulutuksessa 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 ='' and l.yoopiskkoulk2013 = ''  then l.ammopiskkoulk2013 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.luopiskkoulk2013
	-- ammattikorkeakoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2013  <> '' and l.yoopiskkoulk2013  = '' and
	l.luopiskkoulk2013  = '' and l.ammopiskkoulk2013 = '' then l.amkopiskkoulk2013
	-- yliopistokoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 <> '' and 
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''   then l.yoopiskkoulk2013 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013  <> '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''  then l.amkopiskkoulk2013

		-- lukiokoulutuksessa 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then l.luopiskkoulk2014
	-- ammatillisessa koulutuksessa 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 ='' and l.yoopiskkoulk2014 = ''  then l.ammopiskkoulk2014 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then l.luopiskkoulk2014
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2014  <> '' and l.yoopiskkoulk2014  = '' and
	l.luopiskkoulk2014  = '' and l.ammopiskkoulk2014 = '' then l.amkopiskkoulk2014
	-- yliopistokoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 <> '' and 
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''   then l.yoopiskkoulk2014 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014  <> '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''  then l.amkopiskkoulk2014
	else ''
	    end),
	 -- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammatillisen koulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and l.yoopisktunn2009 = ''  then l.ammopisktunn2009
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammattikorkeakoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then l.amkopisktunn2009
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''   then l.yoopisktunn2009  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.amkopisktunn2009 
	
	
	-- lukiokoulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and l.yoopisktunn2010 = ''  then l.ammopisktunn2010
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then l.amkopisktunn2010
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''   then l.yoopisktunn2010  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010 
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.amkopisktunn2010 
	
	-- lukiokoulutuksen oppilaitos 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and l.yoopisktunn2011 = ''  then l.ammopisktunn2011
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then l.amkopisktunn2011
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''   then l.yoopisktunn2011  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010 
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.amkopisktunn2011 
	
	-- lukiokoulutuksen oppilaitos 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and l.yoopisktunn2012 = ''  then l.ammopisktunn2012
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then l.amkopisktunn2012
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''   then l.yoopisktunn2012  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010 
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.amkopisktunn2012 

		-- lukiokoulutuksen oppilaitos 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 = '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.luopisktunn2013
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2013 = '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 ='' and l.yoopisktunn2013 = ''  then l.ammopisktunn2013
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.luopisktunn2013
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2013  <> '' and l.yoopisktunn2013  = '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = '' then l.amkopisktunn2013
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2013 = '' and l.yoopisktunn2013 <> '' and 
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''   then l.yoopisktunn2013  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010 
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2013 <> '' and l.yoopisktunn2013  <> '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''  then l.amkopisktunn2013 

		-- lukiokoulutuksen oppilaitos 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 = '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then l.luopisktunn2014
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2014 = '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 ='' and l.yoopisktunn2014 = ''  then l.ammopisktunn2014
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then l.luopisktunn2014
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2014  <> '' and l.yoopisktunn2014  = '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = '' then l.amkopisktunn2014
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2014 = '' and l.yoopisktunn2014 <> '' and 
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = ''   then l.yoopisktunn2014  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010 
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopisktunn2014 <> '' and l.yoopisktunn2014  <> '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = ''  then l.amkopisktunn2014 
	
	else ''
	

	    end),
	-- Koulutuksen järjestäjä 1 
	(case
	-- lukiokoulutuksen järjestäjä 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009  = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009  
	-- ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @ensimmainen_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and yoopiskjarj2009 = ''  then l.ammopiskjarj2009 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009
	-- ammattikorkeakoulutuksen 2009 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then l.amkopiskjarj2009 
	-- yliopistokoulutuksen 2009 järjestäjä
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then l.yoopiskjarj2009
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2009, merkitään ammattikorkekoulutuksen järjestäjä 2009   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.amkopiskjarj2009 
	
	
	-- lukiokoulutuksen järjestäjä 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010  = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010  
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @toinen_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and yoopiskjarj2010 = ''  then l.ammopiskjarj2010 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then l.amkopiskjarj2010 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then l.yoopiskjarj2010
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.amkopiskjarj2010 
	
	
	-- lukiokoulutuksen järjestäjä 2011
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011  = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011  
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and yoopiskjarj2011 = ''  then l.ammopiskjarj2011 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then l.amkopiskjarj2011 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''   then l.yoopiskjarj2011
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011  = ''  then l.amkopiskjarj2011 
	
	-- lukiokoulutuksen järjestäjä 2012
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012  = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.luopiskjarj2012  
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and yoopiskjarj2012 = ''  then l.ammopiskjarj2012 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.luopiskjarj2012
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then l.amkopiskjarj2012 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012 = ''   then l.yoopiskjarj2012
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012  = ''  then l.amkopiskjarj2012 

-- lukiokoulutuksen järjestäjä 2013
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2013  <> '' and l.ammopiskjarj2013  = '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.luopiskjarj2013  
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2013 = '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 ='' and yoopiskjarj2013 = ''  then l.ammopiskjarj2013 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2013 <> '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.luopiskjarj2013
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   = '' and
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = '' then l.amkopiskjarj2013 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2013  = '' and l.yoopiskjarj2013  <> '' and 
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013 = ''   then l.yoopiskjarj2013
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   <> '' and
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013  = ''  then l.amkopiskjarj2013 

	-- lukiokoulutuksen järjestäjä 2014
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2014  <> '' and l.ammopiskjarj2014  = '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then l.luopiskjarj2014  
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskjarj2014 = '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 ='' and yoopiskjarj2014 = ''  then l.ammopiskjarj2014 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2009, merkitään lukiokoulutuksen 2009 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2014 <> '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then l.luopiskjarj2014
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   = '' and
	l.luopiskjarj2014 = '' and l.ammopiskjarj2014 = '' then l.amkopiskjarj2014 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2014  = '' and l.yoopiskjarj2014  <> '' and 
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014 = ''   then l.yoopiskjarj2014
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   <> '' and
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014  = ''  then l.amkopiskjarj2014 
	else ''
	    end),
	    
	 -- Maakunta 1
	(case
	-- lukioopiskelun maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009
	-- ammatillisen koulutksen maakunta 2009    
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then l.ammopiskmaak2009
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2009  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009 
	-- ammattikorkekoulutuksen maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then l.amkopiskmaak2009
	-- yliopistokoulutuksen maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then l.yoopiskmaak2009
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2009, otetaan talteen ammattikorkekoulutksen maakunta 2009   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.amkopiskmaak2009 
	
	
	-- lukioopiskelun maakunta 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010
	-- ammatillisen koulutksen maakunta 2010    
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010  = ''  then l.ammopiskmaak2010
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010 
	-- ammattikorkekoulutuksen maakunta 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then l.amkopiskmaak2010
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then l.yoopiskmaak2010
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.amkopiskmaak2010 
	
	-- lukioopiskelun maakunta 2011
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2011   <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011
	-- ammatillisen koulutksen maakunta 2010    
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011 ='' and l.yoopiskmaak2011  = ''  then l.ammopiskmaak2011
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011 
	-- ammattikorkekoulutuksen maakunta 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then l.amkopiskmaak2011
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @kolmas_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then l.yoopiskmaak2011
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.amkopiskmaak2011 
	
	-- lukioopiskelun maakunta 2012
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2012   <> '' and l.ammopiskmaak2012  = '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.luopiskmaak2012
	-- ammatillisen koulutksen maakunta 2010    
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2012  = '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012 ='' and l.yoopiskmaak2012  = ''  then l.ammopiskmaak2012
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.luopiskmaak2012 
	-- ammattikorkekoulutuksen maakunta 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2012   <> '' and l.yoopiskmaak2012   = '' and
	l.luopiskmaak2012 = '' and l.ammopiskmaak2012 = '' then l.amkopiskmaak2012
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @neljas_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  <> '' and 
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012 = ''   then l.yoopiskmaak2012
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012   <> '' and
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012  = ''  then l.amkopiskmaak2012 

	-- lukioopiskelun maakunta 2013
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2013   <> '' and l.ammopiskmaak2013  = '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.luopiskmaak2013
	-- ammatillisen koulutksen maakunta 2010    
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2013  = '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013 ='' and l.yoopiskmaak2013  = ''  then l.ammopiskmaak2013
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.luopiskmaak2013 
	-- ammattikorkekoulutuksen maakunta 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2013   <> '' and l.yoopiskmaak2013   = '' and
	l.luopiskmaak2013 = '' and l.ammopiskmaak2013 = '' then l.amkopiskmaak2013
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @viides_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  <> '' and 
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013 = ''   then l.yoopiskmaak2013
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2013  <> '' and l.yoopiskmaak2013   <> '' and
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013  = ''  then l.amkopiskmaak2013 

	-- lukioopiskelun maakunta 2014
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2014   <> '' and l.ammopiskmaak2014  = '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = '' then l.luopiskmaak2014
	-- ammatillisen koulutksen maakunta 2010    
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2014  = '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014 ='' and l.yoopiskmaak2014  = ''  then l.ammopiskmaak2014
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2014  <> '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = '' then l.luopiskmaak2014 
	-- ammattikorkekoulutuksen maakunta 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2014   <> '' and l.yoopiskmaak2014   = '' and
	l.luopiskmaak2014 = '' and l.ammopiskmaak2014 = '' then l.amkopiskmaak2014
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @kuudes_suoritusvuosi and  l.suorlk = '2' and l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  <> '' and 
	l.luopiskmaak2014  = '' and l.ammopiskmaak2014 = ''   then l.yoopiskmaak2014
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2014  <> '' and l.yoopiskmaak2014   <> '' and
	l.luopiskmaak2014  = '' and l.ammopiskmaak2014  = ''  then l.amkopiskmaak2014 
	
	else ''
	
	
	    end),
-- Koulutus 2
(case
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2009 
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.ammopiskkoulk2009
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.yoopiskkoulk2009   
	
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2009 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.ammopiskkoulk2010
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.yoopiskkoulk2010   
	
		-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2011 
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.ammopiskkoulk2011
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.yoopiskkoulk2011   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2012 
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.ammopiskkoulk2012
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.yoopiskkoulk2012 

	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2013 
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 ='' and l.yoopiskkoulk2013 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.ammopiskkoulk2013
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2013  <> '' and l.yoopiskkoulk2013  = '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 <> '' and 
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013  <> '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''  then l.yoopiskkoulk2013 

	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2014 
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 ='' and l.yoopiskkoulk2014 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then l.ammopiskkoulk2014
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2014  <> '' and l.yoopiskkoulk2014  = '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 <> '' and 
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014  <> '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''  then l.yoopiskkoulk2014 

	
	
	else ''
	    end),
	    
-- Oppilaitos 2
(case
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and yoopisktunn2009 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.ammopisktunn2009 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.yoopisktunn2009 
	
		-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and yoopisktunn2010 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.ammopisktunn2010 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.yoopisktunn2010 
	
	
    -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and yoopisktunn2011 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.ammopisktunn2011 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.yoopisktunn2011 
	
	 -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and yoopisktunn2012 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.ammopisktunn2012 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.yoopisktunn2012 

	 -- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 = '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2013 = '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 ='' and yoopisktunn2013 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.ammopisktunn2013 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2013  <> '' and l.yoopisktunn2013  = '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2013 = '' and l.yoopisktunn2013 <> '' and 
	l.luopisktunn2013 = '' and l.ammopisktunn2013  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2013 <> '' and l.yoopisktunn2013  <> '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''  then l.yoopisktunn2013 

	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 = '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2014 = '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 ='' and yoopisktunn2014 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then l.ammopisktunn2014 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2014  <> '' and l.yoopisktunn2014  = '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2014 = '' and l.yoopisktunn2014 <> '' and 
	l.luopisktunn2014 = '' and l.ammopisktunn2014  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2009 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopisktunn2014 <> '' and l.yoopisktunn2014  <> '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = ''  then l.yoopisktunn2014 
	
	else ''
	    end),
	    
	-- Koulutuksen järjestäjä 2
	(case
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and l.yoopiskjarj2009 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.ammopiskjarj2009 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.yoopiskjarj2009 
	
	
		-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and l.yoopiskjarj2010 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.ammopiskjarj2010 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010  <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.yoopiskjarj2010 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and l.yoopiskjarj2011 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.ammopiskjarj2011 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011  <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''  then l.yoopiskjarj2011 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012 = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and l.yoopiskjarj2012 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.ammopiskjarj2012 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012  <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012 = ''  then l.yoopiskjarj2012 

	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2013  <> '' and l.ammopiskjarj2013 = '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2013 = '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 ='' and l.yoopiskjarj2013 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2013 <> '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.ammopiskjarj2013 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   = '' and
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2013  = '' and l.yoopiskjarj2013  <> '' and 
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013  <> '' and
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013 = ''  then l.yoopiskjarj2013 

	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2014  <> '' and l.ammopiskjarj2014 = '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2014 = '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 ='' and l.yoopiskjarj2014 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskjarj2014 <> '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then l.ammopiskjarj2014 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   = '' and
	l.luopiskjarj2014 = '' and l.ammopiskjarj2014 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2009
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.amkopiskjarj2014  = '' and l.yoopiskjarj2014  <> '' and 
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2009
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014  <> '' and
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014 = ''  then l.yoopiskjarj2014 
	
	
	else ''
	    end),
	    
	-- Maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and yoopiskmaak2009  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2009, merkitään tyhjäksi   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2009, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.ammopiskmaak2009 
	-- vain ammattikorkeakoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2009, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.yoopiskmaak2009  
	
	
		-- vain lukiokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and yoopiskmaak2010  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2009, merkitään tyhjäksi   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2010, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.ammopiskmaak2010 
	-- vain ammattikorkeakoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2010, merkitään yliopistokoulutuksen 2009 maakunta 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.yoopiskmaak2010  
	
	
	-- vain lukiokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and yoopiskmaak2011  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2011, merkitään tyhjäksi   
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  ='' and l.yoopiskmaak2011 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2011, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kolmas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.ammopiskmaak2011 
	-- vain ammattikorkeakoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2011, merkitään yliopistokoulutuksen 2011 maakunta 
	when l.suorv = @kolmas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.yoopiskmaak2011  
	
	-- vain lukiokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  = '' and
	l.amkopiskmaak2012  = '' and yoopiskmaak2012  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2012, merkitään tyhjäksi   
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2012  = '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  ='' and l.yoopiskmaak2012 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2012, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @neljas_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.ammopiskmaak2012 
	-- vain ammattikorkeakoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2012   <> '' and l.yoopiskmaak2012   = '' and
	l.luopiskmaak2012 = '' and l.ammopiskmaak2012 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  <> '' and 
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2012, merkitään yliopistokoulutuksen 2012 maakunta 
	when l.suorv = @neljas_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012   <> '' and
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012  = ''  then l.yoopiskmaak2012 
	
	-- vain lukiokoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013  = '' and
	l.amkopiskmaak2013  = '' and yoopiskmaak2013  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2013, merkitään tyhjäksi   
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2013  = '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  ='' and l.yoopiskmaak2013 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2013, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @viides_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.ammopiskmaak2013 
	-- vain ammattikorkeakoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2013   <> '' and l.yoopiskmaak2013   = '' and
	l.luopiskmaak2013 = '' and l.ammopiskmaak2013 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  <> '' and 
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2013, merkitään yliopistokoulutuksen 2013 maakunta 
	when l.suorv = @viides_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2013  <> '' and l.yoopiskmaak2013   <> '' and
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013  = ''  then l.yoopiskmaak2013  

	-- vain lukiokoulutuksen maakunta 2014, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2014  <> '' and l.ammopiskmaak2014  = '' and
	l.amkopiskmaak2014  = '' and yoopiskmaak2014  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2014, merkitään tyhjäksi   
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.luopiskmaak2014  = '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  ='' and l.yoopiskmaak2014 = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2014, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kuudes_suoritusvuosi  and  l.suorlk = '2' and l.luopiskmaak2014  <> '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = '' then l.ammopiskmaak2014 
	-- vain ammattikorkeakoulutuksen maakunta 2014, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2014   <> '' and l.yoopiskmaak2014   = '' and
	l.luopiskmaak2014 = '' and l.ammopiskmaak2014 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2014, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  <> '' and 
	l.luopiskmaak2014  = '' and l.ammopiskmaak2014 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2014, merkitään yliopistokoulutuksen 2014 maakunta 
	when l.suorv = @kuudes_suoritusvuosi  and l.suorlk = '2' and l.amkopiskmaak2014  <> '' and l.yoopiskmaak2014   <> '' and
	l.luopiskmaak2014  = '' and l.ammopiskmaak2014  = ''  then l.yoopiskmaak2014  
	 
	else ''
	    end),
	-- Monihaku
	(case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.monihaku2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.monihaku2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.monihaku2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.monihaku2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.monihaku2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.monihaku2014
	
	else '8'
	end),
	-- Pääasiallinen toiminta
    (case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2009 
    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2010 
    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2011 
     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2012
	 when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2013
	  when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.ptoim1r4_2014
	else ''
	end),
	-- Ammattiasema
	(case
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' then l.amas_2009
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' then l.amas_2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' then l.amas_2011
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' then l.amas_2012
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' then l.amas_2013
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' then l.amas_2014
	else ''
	end),
 l.lkm,
 l.pohjkoul,
 l.tietolahde,
 'K3.13',
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = ''  then  '1'  
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = ''   then '1'  
	     when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = ''   then '1'  
	       when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and
	    l.yoopiskkoulk2012 = ''   then '1' 
		when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and
	    l.yoopiskkoulk2012 = ''   then '1' 
		when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and
	    l.yoopiskkoulk2013 = ''   then '1' 
			when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and
	    l.yoopiskkoulk2014 = ''   then '1' 
	    else '0'
	    end) as lukiokoulutuksessa,
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = '' then '1'   
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2010 <> '' and l.luopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = ''  then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2011 <> '' and l.luopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = '' then '1'  
	     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2012 <> '' and l.luopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and
	    l.yoopiskkoulk2012 = '' then '1'  
		when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2013 <> '' and l.luopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and
	    l.yoopiskkoulk2013 = '' then '1'  
		when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2014 <> '' and l.luopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and
	    l.yoopiskkoulk2014 = '' then '1'  
	    else '0'
	    end) as ammatillisessa_koulutuksessa,
 (case  
	   when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and
	   l.yoopiskkoulk2009 = ''  then  '1'
	   when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and
	   l.yoopiskkoulk2010 = ''  then  '1'
	   when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' and
	   l.yoopiskkoulk2011 = ''  then  '1'
	     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' and
	   l.yoopiskkoulk2012 = ''  then  '1'
	    when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and l.luopiskkoulk2013 = '' and
	   l.yoopiskkoulk2013 = ''  then  '1'
	   when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and l.luopiskkoulk2014 = '' and
	   l.yoopiskkoulk2014 = ''  then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
 (case 
	    when l.suorv = @ensimmainen_suoritusvuosi and  l.suorlk = '2' and  l.yoopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and 
	    l.ammopiskkoulk2009 = ''  then '1'  
	    when l.suorv = @toinen_suoritusvuosi and  l.suorlk = '2' and  l.yoopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and 
	    l.ammopiskkoulk2010 = ''  then '1' 
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' and 
	    l.ammopiskkoulk2011 = ''  then '1' 
	     when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' and 
	    l.ammopiskkoulk2012 = ''  then '1' 
		 when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2013 <> '' and l.amkopiskkoulk2013 = '' and l.luopiskkoulk2013 = '' and 
	    l.ammopiskkoulk2013 = ''  then '1' 
			 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.yoopiskkoulk2014 <> '' and l.amkopiskkoulk2014 = '' and l.luopiskkoulk2014 = '' and 
	    l.ammopiskkoulk2014 = ''  then '1' 
	    else '0'
	    end) as yliopistokoulutuksessa,

(case

	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = '' then '1'  
	    
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = ''  then '1' 
	    
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = ''  then '1' 
	     
	    when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and
	    l.yoopiskkoulk2012 = ''  then '1' 

		when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and l.amkopiskkoulk2013 = '' and
	    l.yoopiskkoulk2013 = ''  then '1' 

			when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 <> '' and l.amkopiskkoulk2014 = '' and
	    l.yoopiskkoulk2014 = ''  then '1'  

	
	    
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2'and  l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and
	    l.yoopiskkoulk2009 = ''  then '1' 
	     
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 <> '' and l.luopiskkoulk2010 = '' and
	    l.yoopiskkoulk2010 = '' then '1' 
	    
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 <> '' and l.luopiskkoulk2011 = '' and
	    l.yoopiskkoulk2011 = '' then '1' 
	    
	       when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 <> '' and l.luopiskkoulk2012 = '' and
	    l.yoopiskkoulk2012 = '' then '1' 
		  when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2013 <> '' and l.amkopiskkoulk2013 <> '' and l.luopiskkoulk2013 = '' and
	    l.yoopiskkoulk2013 = '' then '1' 
			 when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.ammopiskkoulk2014 <> '' and l.amkopiskkoulk2014 <> '' and l.luopiskkoulk2014 = '' and
	    l.yoopiskkoulk2014 = '' then '1' 
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and
	    l.ammopiskkoulk2009 = ''  then '1'  
	    when l.suorv = @toinen_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010 <> '' and l.luopiskkoulk2010 = '' and
	    l.ammopiskkoulk2010 = '' then '1' 
	    when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011 <> '' and l.luopiskkoulk2011 = '' and
	    l.ammopiskkoulk2011 = '' then '1'  
	      when l.suorv = @neljas_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012 <> '' and l.luopiskkoulk2012 = '' and
	    l.ammopiskkoulk2012 = '' then '1'  
		when l.suorv = @viides_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013 <> '' and l.luopiskkoulk2013 = '' and
	    l.ammopiskkoulk2013 = '' then '1'  
		when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '2' and  l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014 <> '' and l.luopiskkoulk2014 = '' and
	    l.ammopiskkoulk2014 = '' then '1'  
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
(case
	-- Tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 ='13')
and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009<>'' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009<>'') 	   then '1' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13') 
	   and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010<>'' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010<>'') then '1'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13') 
	   and (l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011<>'' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011<>'') then '1' 
	      when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13') 
	   and (l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012<>'' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012<>'') then '1' 
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2013 = '22' or l.ptoim1r4_2013 = '13') 
	   and (l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013<>'' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013<>'') then '1' 
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2014 = '22' or l.ptoim1r4_2014 = '13') 
	   and (l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014<>'' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014<>'') then '1' 
	   
	   
	   -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 ='13')
       and (l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009='' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009='')	   then '2' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010 = '13') 
	   and (l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010='' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010='')then '2'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13') 
	   and (l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011='' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011='') then '2' 
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13') 
	   and (l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012='' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012='') then '2'
	   	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2013 = '22' or l.ptoim1r4_2013 = '13') 
	   and (l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013='' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013='') then '2'
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' ) and (l.ptoim1r4_2014 = '22' or l.ptoim1r4_2014 = '13') 
	   and (l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014='' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014='') then '2'
   
	  -- Ei opiskelevat työlliset
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2')and l.ptoim1r4_2009 = '10'  then '3'
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and  l.ptoim1r4_2010 = '10'  then '3'     
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2011 = '10'  then '3' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2012 = '10'  then '3'
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2013 = '10'  then '3'
		 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2' )and  l.ptoim1r4_2014 = '10'  then '3'
	  -- Ei opiskelevat työttömät 
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2009 = '12'  then '4' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '2' ) and  l.ptoim1r4_2010 = '12'  then '4'
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2011 = '12'  then '4'  
	     when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2012 = '12'  then '4'  
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2013 = '12'  then '4'  
		 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '2') and  l.ptoim1r4_2014 = '12'  then '4'  
	   
	   -- Ei opiskelevat muut
      else '5'
	     
	     
	   end)as koulutuksen_paattaneiden_toiminta
 ,ika_1v = cast((case 
            when syntv = '' then '-1' 
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
 ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where (suorv = '2004' or suorv = '2005' or suorv = '2006' or suorv= '2007' or suorv= '2008' or suorv = '2009') and suorlk = '2'
	
	) as l
	
	
	WHERE 1=1
end;

--
-- TULOS
-- 
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_5_0_tarkastelujakso]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_5_0_tarkastelujakso]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_5_0_tarkastelujakso] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_5_0_tarkastelujakso] AS
declare @debug_what_to_run tinyint; set @debug_what_to_run=2; -- käytä arvoa 3 vain kun teet yhden vuoden
print '$'+convert(varchar,sysdatetime(),20)+'$ '+'DEBUG (what to run)='+cast(@debug_what_to_run as varchar)+
': 0=luo vain taulut, älä tulosta mitään; 1=luo taulut ja tulosta joitakin merkittävimpiä välivaiheita; 2=luo taulut ja tulosta välivaiheet; 3=luo taulut, tulosta välivaiheet ja tulosta myös tulokset, 4=tulosta välivaiheet, mutta älä tee mitään';




-- lisätään data
if @debug_what_to_run not in (4) begin
if @debug_what_to_run>0 print 'inserting data';

-- parametrimuuttujien arvot
-- parametrimuuttujat
DECLARE @ensimmainen_suoritusvuosi int;
DECLARE @toinen_suoritusvuosi int;
DECLARE @kolmas_suoritusvuosi int;
DECLARE @neljas_suoritusvuosi int;
DECLARE @viides_suoritusvuosi int;
DECLARE @kuudes_suoritusvuosi int;

set @ensimmainen_suoritusvuosi = 2004;
set @toinen_suoritusvuosi = 2005;
set @kolmas_suoritusvuosi = 2006;
set @neljas_suoritusvuosi = 2007;
set @viides_suoritusvuosi = 2008;
set @kuudes_suoritusvuosi = 2009;


INSERT INTO [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
(
rivinumero
, tarkastelujakso
, tilv 
, tilv_date
, tutkryh 
, suorv
, suorlk 
, sp 
, syntv
, aikielir1 
, tutkkaskun 
, kansalr1
, pohjmaa 
, eumaa 
, etamaa 
, tunn
, jarj
, kkielir1 
, tutklaja 
, tutktav 
, aikoul 
, tutkmaak
, koulutus_1
, oppilaitos_1
, koulutuksen_jarjestaja_1
, koulutuksen_maakunta_1
, koulutus_2
, oppilaitos_2
, koulutuksen_jarjestaja_2
, koulutuksen_maakunta_2
, monihaku
, paaasiallinen_toiminta
, ammattiasema
,lkm
,pohjkoulk
,tietolahde
, aineisto
 ,lukiokoulutuksessa
 ,ammatillisessa_koulutuksessa
 ,ammattikorkeakoulutuksessa
 ,yliopistokoulutuksessa
 ,lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa
 ,toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa
 ,ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa
 ,koulutuksen_paattaneiden_toiminta
 ,ika_1v
 ,ika_5v
)
SELECT
 l.rivinumero,
 '5',
 l.tilv,
 l.tilv_date,
 l.tutkryh,
 l.suorv,
 (case
	when l.suorlk = '1'  then (l.suorv+'0'+l.suorlk)
	when l.suorlk = '2'  then (l.suorv+'0'+'8')
	else ''
	end),
 l.sp,
 l.syntv,
 l.aikielir1,
 l.tutkaskun,
 l.kansalr1,
 l.pohjmaa,
 l.eumaa,
 l.etamaa,
 l.tunn,
 l.jarj,
 l.kkielir1,
 l.tutklaja,
 l.tutktav,
 l.aikoul,
 l.tutkmaak,
 -- Koulutus 1
 (case
    --lukiokoulutuksessa 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009 
	-- ammattikoulutuksessa 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then l.ammopiskkoulk2009 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2009 ensim. koulutustietoihin
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.luopiskkoulk2009
	-- ammattikorkeakoulutuksessa 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then l.amkopiskkoulk2009
	-- yliopistokoulutuksessa 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then l.yoopiskkoulk2009
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa, merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and ammopiskkoulk2009 = ''  then l.amkopiskkoulk2009 
	
	
	-- lukiokoulutuksessa 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammatillisessa koulutuksessa 2010 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then l.ammopiskkoulk2010 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2010 ensimäisiin koulutustietoihin
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.luopiskkoulk2010
	-- ammattikorkeakoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010  = '' and l.ammopiskkoulk2010 = '' then l.amkopiskkoulk2010
	-- yliopistokoulutuksessa
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then l.yoopiskkoulk2010 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.amkopiskkoulk2010 
	
	
	-- lukiokoulutuksessa 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammatillisessa koulutuksessa 2011 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then l.ammopiskkoulk2011 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2011 ensimäisiin koulutustietoihin
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.luopiskkoulk2011
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011  = '' and l.ammopiskkoulk2011 = '' then l.amkopiskkoulk2011
	-- yliopistokoulutuksessa
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then l.yoopiskkoulk2011 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.amkopiskkoulk2011 
	
	-- lukiokoulutuksessa 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammatillisessa koulutuksessa 2012 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then l.ammopiskkoulk2012 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2012 ensimäisiin koulutustietoihin
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.luopiskkoulk2012
	-- ammattikorkeakoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012  = '' and l.ammopiskkoulk2012 = '' then l.amkopiskkoulk2012
	-- yliopistokoulutuksessa
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then l.yoopiskkoulk2012 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.amkopiskkoulk2012 
	
	-- lukiokoulutuksessa 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.luopiskkoulk2013
	-- ammatillisessa koulutuksessa 2013 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 ='' and l.yoopiskkoulk2013 = ''  then l.ammopiskkoulk2013 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2013 ensimäisiin koulutustietoihin
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.luopiskkoulk2013
	-- ammattikorkeakoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013  <> '' and l.yoopiskkoulk2013  = '' and
	l.luopiskkoulk2013  = '' and l.ammopiskkoulk2013 = '' then l.amkopiskkoulk2013
	-- yliopistokoulutuksessa
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 <> '' and 
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''   then l.yoopiskkoulk2013 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013  <> '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''  then l.amkopiskkoulk2013  

	-- lukiokoulutuksessa 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then l.luopiskkoulk2014
	-- ammatillisessa koulutuksessa 2014 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 ='' and l.yoopiskkoulk2014 = ''  then l.ammopiskkoulk2014 
	--lukiokoulutuksessa ja ammattillisessa koulutuksessa, otetaan tieto lukiokoulutuksen 2014 ensimäisiin koulutustietoihin
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then l.luopiskkoulk2014
	-- ammattikorkeakoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014  <> '' and l.yoopiskkoulk2014  = '' and
	l.luopiskkoulk2014  = '' and l.ammopiskkoulk2014 = '' then l.amkopiskkoulk2014
	-- yliopistokoulutuksessa
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 <> '' and 
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''   then l.yoopiskkoulk2014 
	-- ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään ensimmäiseen koulutustietoihin ammattikorkeakoulutus  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014  <> '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''  then l.amkopiskkoulk2014  

	else ''
	
	    
	    end),
	    
-- Oppilaitos 1
	(case
	-- lukiokoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009 
	-- ammattikoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and l.yoopisktunn2009 = ''  then l.ammopisktunn2009 
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.luopisktunn2009
	-- ammattikorkeakoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then l.amkopisktunn2009
	-- yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''   then l.yoopisktunn2009
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2009  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.amkopisktunn2009 
	
	
	-- lukiokoulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammatillisen koulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and l.yoopisktunn2010 = ''  then l.ammopisktunn2010
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.luopisktunn2010
	-- ammattikorkeakoulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then l.amkopisktunn2010
	-- yliopistokoulutuksen oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''   then l.yoopisktunn2010  
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.amkopisktunn2010 
	
	-- lukiokoulutuksen oppilaitos 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammatillisen koulutuksen oppilaitos 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and l.yoopisktunn2011 = ''  then l.ammopisktunn2011
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2010
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.luopisktunn2011
	-- ammattikorkeakoulutuksen oppilaitos 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then l.amkopisktunn2011
	-- yliopistokoulutuksen oppilaitos 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''   then l.yoopisktunn2011 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.amkopisktunn2011
	
	-- lukiokoulutuksen oppilaitos 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammatillisen koulutuksen oppilaitos 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and l.yoopisktunn2012 = ''  then l.ammopisktunn2012
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2010
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.luopisktunn2012
	-- ammattikorkeakoulutuksen oppilaitos 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then l.amkopisktunn2012
	-- yliopistokoulutuksen oppilaitos 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''   then l.yoopisktunn2012 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.amkopisktunn2012

	-- lukiokoulutuksen oppilaitos 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 = '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.luopisktunn2013
	-- ammatillisen koulutuksen oppilaitos 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 = '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 ='' and l.yoopisktunn2013 = ''  then l.ammopisktunn2013
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2010
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.luopisktunn2013
	-- ammattikorkeakoulutuksen oppilaitos 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013  <> '' and l.yoopisktunn2013  = '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = '' then l.amkopisktunn2013
	-- yliopistokoulutuksen oppilaitos 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013 = '' and l.yoopisktunn2013 <> '' and 
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''   then l.yoopisktunn2013 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013 <> '' and l.yoopisktunn2013  <> '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''  then l.amkopisktunn2013

	-- lukiokoulutuksen oppilaitos 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 = '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then l.luopisktunn2014
	-- ammatillisen koulutuksen oppilaitos 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 = '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 ='' and l.yoopisktunn2014 = ''  then l.ammopisktunn2014
	-- lukiokoulutuksen oppilaitos ja ammatillisen koulutuksen oppilaitos, merkitään lukiokoulutuksen oppilaitos 2010
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then l.luopisktunn2014
	-- ammattikorkeakoulutuksen oppilaitos 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014  <> '' and l.yoopisktunn2014  = '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = '' then l.amkopisktunn2014
	-- yliopistokoulutuksen oppilaitos 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014 = '' and l.yoopisktunn2014 <> '' and 
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = ''   then l.yoopisktunn2014 
	-- ammattikorkeakoulutus ja yliopistokoulutus oppilaitos, merkitään ammattikorkeakoulutus 2010  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014 <> '' and l.yoopisktunn2014  <> '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = ''  then l.amkopisktunn2014

	else ''
	
	    end),
  --Koulutuksen järjestäjä 1
	(case
	-- lukikoulutuksen järjestäjä 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and yoopiskjarj2009 = '' then l.luopiskjarj2009
	-- ammatillisen koulutuksen järjestäjä 2009  
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and l.yoopiskjarj2009 = ''  then l.ammopiskjarj2009
	-- lukio- ja ammatillisen koulutuksen järjestäjä, merkitään lukiokoulutuksen 2009 järjestäjä 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.luopiskjarj2009
	-- ammattikorkeakoulutuksen järjestäjä 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then l.amkopiskjarj2009
	-- yliopistokoulutuksen järjestäjä 2009 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then l.yoopiskjarj2009
	-- ammattikorkea- ja yliopistokoulutuksen järjestäjä, merkitään ammattikorkeakoulutuksen 2009 järjestäjä   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.amkopiskjarj2009 

	
	-- lukiokoulutuksen järjestäjä 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010  = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010  
	-- ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and yoopiskjarj2010 = ''  then l.ammopiskjarj2010 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2010, merkitään lukiokoulutuksen 2010 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.luopiskjarj2010
	-- ammattikorkeakoulutuksen 2010 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then l.amkopiskjarj2010 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then l.yoopiskjarj2010
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.amkopiskjarj2010 
	
	-- lukiokoulutuksen järjestäjä 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011 
	-- ammatillisen koulutuksen järjestäjä 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and yoopiskjarj2011 = ''  then l.ammopiskjarj2011 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2010, merkitään lukiokoulutuksen 2011 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.luopiskjarj2011
	-- ammattikorkeakoulutuksen 2011 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then l.amkopiskjarj2011 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011 = ''   then l.yoopiskjarj2011
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011  = ''  then l.amkopiskjarj2011 
	
	-- lukiokoulutuksen järjestäjä 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012 = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.luopiskjarj2012 
	-- ammatillisen koulutuksen järjestäjä 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and yoopiskjarj2012 = ''  then l.ammopiskjarj2012 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2010, merkitään lukiokoulutuksen 2012 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.luopiskjarj2012
	-- ammattikorkeakoulutuksen 2012 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then l.amkopiskjarj2012 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012 = ''   then l.yoopiskjarj2012
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012  = ''  then l.amkopiskjarj2012 

	-- lukiokoulutuksen järjestäjä 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013  <> '' and l.ammopiskjarj2013 = '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.luopiskjarj2013 
	-- ammatillisen koulutuksen järjestäjä 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013 = '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 ='' and yoopiskjarj2013 = ''  then l.ammopiskjarj2013 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2010, merkitään lukiokoulutuksen 2013 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013 <> '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.luopiskjarj2013
	-- ammattikorkeakoulutuksen 2013 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   = '' and
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = '' then l.amkopiskjarj2013 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  = '' and l.yoopiskjarj2013  <> '' and 
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013 = ''   then l.yoopiskjarj2013
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   <> '' and
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013  = ''  then l.amkopiskjarj2013 

	-- lukiokoulutuksen järjestäjä 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014  <> '' and l.ammopiskjarj2014 = '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then l.luopiskjarj2014 
	-- ammatillisen koulutuksen järjestäjä 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014 = '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 ='' and yoopiskjarj2014 = ''  then l.ammopiskjarj2014 
	--lukiokoulutuksen- ja ammattikoulutuksen järjestäjä 2010, merkitään lukiokoulutuksen 2014 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014 <> '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then l.luopiskjarj2014
	-- ammattikorkeakoulutuksen 2014 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   = '' and
	l.luopiskjarj2014 = '' and l.ammopiskjarj2014 = '' then l.amkopiskjarj2014 
	-- yliopistokoulutuksen 2010 järjestäjä
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  = '' and l.yoopiskjarj2014  <> '' and 
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014 = ''   then l.yoopiskjarj2014
	-- ammattikorkekoulutuksen- ja yliopistokoulutuksen järjestäjä 2010, merkitään ammattikorkekoulutuksen järjestäjä 2010   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   <> '' and
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014  = ''  then l.amkopiskjarj2014 
	
	else ''
	    end),
 --Koulutuksen maakunta 1
	(case
	-- lukioopiskelun maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009   
	-- ammatillisen koulutuksen maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then l.ammopiskmaak2009  
	-- lukiokoulutuksen ja ammatillisen koulutus otetaan lukiokoulutuksen maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.luopiskmaak2009 
    -- ammattikorkeakoulutuksen maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then l.amkopiskmaak2009
	-- yliopistokoulutuksen maakunta 2009 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009 = ''   then l.yoopiskmaak2009
	-- ammattikorkekoulutuksen ja yliopistokoulutksen maakunta otetaan ammattikorkeakoulutuksen maakunta 2009   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskmaak2009  = '' and l.ammopiskmaak2009  = ''  then l.amkopiskmaak2009 
	
	
	-- lukioopiskelun maakunta 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010
	-- ammatillisen koulutksen maakunta 2010    
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010  = ''  then l.ammopiskmaak2010
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.luopiskmaak2010 
	-- ammattikorkekoulutuksen maakunta 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then l.amkopiskmaak2010
	-- yliopistokoulutuksen maakunta 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then l.yoopiskmaak2010
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.amkopiskmaak2010 
	
    -- lukioopiskelun maakunta 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011   <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011
	-- ammatillisen koulutksen maakunta 2011    
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  ='' and l.yoopiskmaak2011  = ''  then l.ammopiskmaak2011
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.luopiskmaak2011 
	-- ammattikorkekoulutuksen maakunta 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then l.amkopiskmaak2011
	-- yliopistokoulutuksen maakunta 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then l.yoopiskmaak2011
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.amkopiskmaak2011 
	
	
	-- lukioopiskelun maakunta 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012   <> '' and l.ammopiskmaak2012  = '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.luopiskmaak2012
	-- ammatillisen koulutksen maakunta 2012    
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  = '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  ='' and l.yoopiskmaak2012  = ''  then l.ammopiskmaak2012
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.luopiskmaak2012 
	-- ammattikorkekoulutuksen maakunta 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012   <> '' and l.yoopiskmaak2012   = '' and
	l.luopiskmaak2012 = '' and l.ammopiskmaak2012 = '' then l.amkopiskmaak2012
	-- yliopistokoulutuksen maakunta 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  <> '' and 
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012 = ''   then l.yoopiskmaak2012
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012   <> '' and
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012  = ''  then l.amkopiskmaak2012 
	
	-- lukioopiskelun maakunta 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013   <> '' and l.ammopiskmaak2013  = '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.luopiskmaak2013
	-- ammatillisen koulutksen maakunta 2013    
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013  = '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  ='' and l.yoopiskmaak2013  = ''  then l.ammopiskmaak2013
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.luopiskmaak2013 
	-- ammattikorkekoulutuksen maakunta 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013   <> '' and l.yoopiskmaak2013   = '' and
	l.luopiskmaak2013 = '' and l.ammopiskmaak2013 = '' then l.amkopiskmaak2013
	-- yliopistokoulutuksen maakunta 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  <> '' and 
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013 = ''   then l.yoopiskmaak2013
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013  <> '' and l.yoopiskmaak2013   <> '' and
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013  = ''  then l.amkopiskmaak2013 

	-- lukioopiskelun maakunta 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014   <> '' and l.ammopiskmaak2014  = '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = '' then l.luopiskmaak2014
	-- ammatillisen koulutksen maakunta 2014    
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014  = '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  ='' and l.yoopiskmaak2014  = ''  then l.ammopiskmaak2014
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta otetaan lukiokoulutuksen maakunta 2010  
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014  <> '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = '' then l.luopiskmaak2014 
	-- ammattikorkekoulutuksen maakunta 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014   <> '' and l.yoopiskmaak2014   = '' and
	l.luopiskmaak2014 = '' and l.ammopiskmaak2014 = '' then l.amkopiskmaak2014
	-- yliopistokoulutuksen maakunta 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  <> '' and 
	l.luopiskmaak2014  = '' and l.ammopiskmaak2014 = ''   then l.yoopiskmaak2014
	-- ammattikorkeakoulutuksen ja yliopistokoulutksen maakunta 2010, otetaan talteen ammattikorkekoulutksen maakunta 2010   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014  <> '' and l.yoopiskmaak2014   <> '' and
	l.luopiskmaak2014  = '' and l.ammopiskmaak2014  = ''  then l.amkopiskmaak2014 

	else ''
	
	    end),
-- Koulutus 2
(case
   -- jos lukiokoulutuksessa vain niin jätetään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then ''
	-- jos ammattikoulutuksessa vain  jätetään tyhjäksi 2009 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 ='' and l.yoopiskkoulk2009 = ''  then ''
	-- jos lukiokoulutksessa ja ammattikoulutuksessa merkitään ammattikoulutus 2009 
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 <> '' and
	l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then l.ammopiskkoulk2009 
	-- jos vain ammattikorkeakoulutuksessa jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009  = '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 <> '' and 
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''   then ''
	-- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2009 <> '' and l.yoopiskkoulk2009  <> '' and
	l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = ''  then l.yoopiskkoulk2009
	
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2010 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 ='' and l.yoopiskkoulk2010 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and
	l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then l.ammopiskkoulk2010
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010  <> '' and l.yoopiskkoulk2010  = '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 <> '' and 
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010  <> '' and
	l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = ''  then l.yoopiskkoulk2010   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 ='' and l.yoopiskkoulk2011 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and
	l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then l.ammopiskkoulk2011
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011  <> '' and l.yoopiskkoulk2011  = '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 <> '' and 
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011  <> '' and
	l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = ''  then l.yoopiskkoulk2011   
	
	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 ='' and l.yoopiskkoulk2012 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and
	l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then l.ammopiskkoulk2012
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012  <> '' and l.yoopiskkoulk2012  = '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 <> '' and 
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012  <> '' and
	l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = ''  then l.yoopiskkoulk2012  

	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 ='' and l.yoopiskkoulk2013 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and
	l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then l.ammopiskkoulk2013
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013  <> '' and l.yoopiskkoulk2013  = '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 <> '' and 
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013  <> '' and
	l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = ''  then l.yoopiskkoulk2013  


	-- jos lukiokoulutksessa vain niin jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then ''
	-- jos ammatillisessa koulutuksessa vain jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 ='' and l.yoopiskkoulk2014 = ''  then '' 
	-- jos ammatillisessa ja lukiokoulutuksessa merkitään ammatillisen koulutus 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 <> '' and
	l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then l.ammopiskkoulk2014
	-- jos ammattikorkeakoulutuksessa vain jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014  <> '' and l.yoopiskkoulk2014  = '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' then ''
	-- jos yliopistokoulutuksessa vain jätetään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 <> '' and 
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''   then ''
    -- jos ammattikorkeakoulutuksessa ja yliopistokoulutuksessa merkitään yliopistokoulutus
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014  <> '' and
	l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = ''  then l.yoopiskkoulk2014  
	
	
	else ''
	    end),
-- Oppilaitos 2
(case
    -- lukiokoulutuksen oppilaitos vain merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 = '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then ''
	-- ammatillisen koulutuksen oppilaitos 2009 merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 = '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 ='' and l.yoopisktunn2009 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos merkitään ammatillisen koulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2009 <> '' and l.ammopisktunn2009 <> '' and
	l.amkopisktunn2009 = '' and l.yoopisktunn2009 = '' then l.ammopisktunn2009 
	-- ammattikorkeakoulutksen oppilaitos vain merkitään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009  <> '' and l.yoopisktunn2009  = '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = '' then ''
	-- yliopistokoulutksen oppilaitos vain merkitään tyhjäksi 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 = '' and l.yoopisktunn2009 <> '' and 
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''   then ''  
	--  ammattikorkeakoulutksen oppilaitos ja yliopistokoulutuksen oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2009 <> '' and l.yoopisktunn2009  <> '' and
	l.luopisktunn2009 = '' and l.ammopisktunn2009 = ''  then l.yoopisktunn2009 
	
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 = '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 = '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 ='' and yoopisktunn2010 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2010 <> '' and l.ammopisktunn2010 <> '' and
	l.amkopisktunn2010 = '' and l.yoopisktunn2010 = '' then l.ammopisktunn2010 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010  <> '' and l.yoopisktunn2010  = '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 = '' and l.yoopisktunn2010 <> '' and 
	l.luopisktunn2010 = '' and l.ammopisktunn2010  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2010 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2010 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2010 <> '' and l.yoopisktunn2010  <> '' and
	l.luopisktunn2010 = '' and l.ammopisktunn2010 = ''  then l.yoopisktunn2010 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 = '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 = '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 ='' and yoopisktunn2011 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2011 <> '' and l.ammopisktunn2011 <> '' and
	l.amkopisktunn2011 = '' and l.yoopisktunn2011 = '' then l.ammopisktunn2011 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011  <> '' and l.yoopisktunn2011  = '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 = '' and l.yoopisktunn2011 <> '' and 
	l.luopisktunn2011 = '' and l.ammopisktunn2011  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2011 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2010 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2011 <> '' and l.yoopisktunn2011  <> '' and
	l.luopisktunn2011 = '' and l.ammopisktunn2011 = ''  then l.yoopisktunn2011 
	
	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 = '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 = '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 ='' and yoopisktunn2012 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2012 <> '' and l.ammopisktunn2012 <> '' and
	l.amkopisktunn2012 = '' and l.yoopisktunn2012 = '' then l.ammopisktunn2012 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012  <> '' and l.yoopisktunn2012  = '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 = '' and l.yoopisktunn2012 <> '' and 
	l.luopisktunn2012 = '' and l.ammopisktunn2012  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2012 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2010 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2012 <> '' and l.yoopisktunn2012  <> '' and
	l.luopisktunn2012 = '' and l.ammopisktunn2012 = ''  then l.yoopisktunn2012 

	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 = '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 = '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 ='' and yoopisktunn2013 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2013 <> '' and l.ammopisktunn2013 <> '' and
	l.amkopisktunn2013 = '' and l.yoopisktunn2013 = '' then l.ammopisktunn2013 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013  <> '' and l.yoopisktunn2013  = '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013 = '' and l.yoopisktunn2013 <> '' and 
	l.luopisktunn2013 = '' and l.ammopisktunn2013  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2013 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2010 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2013 <> '' and l.yoopisktunn2013  <> '' and
	l.luopisktunn2013 = '' and l.ammopisktunn2013 = ''  then l.yoopisktunn2013 

	-- vain lukiokoulutuksen oppilaitos, merkitään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 = '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then ''
	-- vain ammatillisen koulutuksen oppilaitos merkitään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 = '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 ='' and yoopisktunn2014 = ''  then '' 
	-- lukiokoulutuksen ja ammatillisen koulutuksen oppilaitos, merkitään ammatillinen koulutus oppilaitos 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopisktunn2014 <> '' and l.ammopisktunn2014 <> '' and
	l.amkopisktunn2014 = '' and l.yoopisktunn2014 = '' then l.ammopisktunn2014 
	-- vain ammattikorkeakoulutuksen oppilaitos, jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014  <> '' and l.yoopisktunn2014  = '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = '' then ''
	-- vin yliopistokoulutuksen oppilaitos, jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014 = '' and l.yoopisktunn2014 <> '' and 
	l.luopisktunn2014 = '' and l.ammopisktunn2014  = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen 2014 oppilaitos, merkitään yliopistokoulutuksen oppilaitos 2010 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopisktunn2014 <> '' and l.yoopisktunn2014  <> '' and
	l.luopisktunn2014 = '' and l.ammopisktunn2014 = ''  then l.yoopisktunn2014 
	
	else ''
	    end),
-- Koulutuksen järjestäjä 2
	(case
	-- lukiokoulutuksen järjestäjä vain 2009, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009  <> '' and l.ammopiskjarj2009 = '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then ''
	-- ammatillisen koulutuksen järjestäjä vain 2009, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 = '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 ='' and l.yoopiskjarj2009 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2009 <> '' and l.ammopiskjarj2009 <> '' and
	l.amkopiskjarj2009 = '' and l.yoopiskjarj2009 = '' then l.ammopiskjarj2009 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   = '' and
	l.luopiskjarj2009 = '' and l.ammopiskjarj2009 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  = '' and l.yoopiskjarj2009  <> '' and 
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestäjä merkitään yliopistokoulutuksen järjetäjä 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2009  <> '' and l.yoopiskjarj2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskjarj2009  = ''  then l.yoopiskjarj2009 
	
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010  <> '' and l.ammopiskjarj2010 = '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 = '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 ='' and l.yoopiskjarj2010 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2010 <> '' and l.ammopiskjarj2010 <> '' and
	l.amkopiskjarj2010 = '' and l.yoopiskjarj2010 = '' then l.ammopiskjarj2010 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   = '' and
	l.luopiskjarj2010 = '' and l.ammopiskjarj2010 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  = '' and l.yoopiskjarj2010  <> '' and 
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2010  <> '' and l.yoopiskjarj2010   <> '' and
	l.luopiskjarj2010  = '' and l.ammopiskjarj2010  = ''  then l.yoopiskjarj2010 
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011  <> '' and l.ammopiskjarj2011 = '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 = '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 ='' and l.yoopiskjarj2011 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2011 <> '' and l.ammopiskjarj2011 <> '' and
	l.amkopiskjarj2011 = '' and l.yoopiskjarj2011 = '' then l.ammopiskjarj2011 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   = '' and
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  = '' and l.yoopiskjarj2011  <> '' and 
	l.luopiskjarj2011 = '' and l.ammopiskjarj2011 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2011  <> '' and l.yoopiskjarj2011   <> '' and
	l.luopiskjarj2011  = '' and l.ammopiskjarj2011  = ''  then l.yoopiskjarj2011
	
	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012  <> '' and l.ammopiskjarj2012 = '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 = '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 ='' and l.yoopiskjarj2012 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2012 <> '' and l.ammopiskjarj2012 <> '' and
	l.amkopiskjarj2012 = '' and l.yoopiskjarj2012 = '' then l.ammopiskjarj2012 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   = '' and
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  = '' and l.yoopiskjarj2012  <> '' and 
	l.luopiskjarj2012 = '' and l.ammopiskjarj2012 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2012  <> '' and l.yoopiskjarj2012   <> '' and
	l.luopiskjarj2012  = '' and l.ammopiskjarj2012  = ''  then l.yoopiskjarj2012  

	-- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013  <> '' and l.ammopiskjarj2013 = '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013 = '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 ='' and l.yoopiskjarj2013 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2013 <> '' and l.ammopiskjarj2013 <> '' and
	l.amkopiskjarj2013 = '' and l.yoopiskjarj2013 = '' then l.ammopiskjarj2013 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   = '' and
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  = '' and l.yoopiskjarj2013  <> '' and 
	l.luopiskjarj2013 = '' and l.ammopiskjarj2013 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2013  <> '' and l.yoopiskjarj2013   <> '' and
	l.luopiskjarj2013  = '' and l.ammopiskjarj2013  = ''  then l.yoopiskjarj2013  


    -- vain lukiokoulutuksen järjestäjä, jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014  <> '' and l.ammopiskjarj2014 = '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then ''
	-- vain ammattikoulutuksen järjestäjä, jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014 = '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 ='' and l.yoopiskjarj2014 = ''  then ''
	-- lukiokoulutuksen ja ammatillisen koulutuksen järjestäjä, merkitään ammatillisen koulutuksen järjestäjä 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskjarj2014 <> '' and l.ammopiskjarj2014 <> '' and
	l.amkopiskjarj2014 = '' and l.yoopiskjarj2014 = '' then l.ammopiskjarj2014 
	-- vain ammattikorkeakoulutuksen järjestäjä merkitään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   = '' and
	l.luopiskjarj2014 = '' and l.ammopiskjarj2014 = '' then ''
	-- vain yliopistokoulutuksen järjestäjä, jätetään tyhjäksi 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  = '' and l.yoopiskjarj2014  <> '' and 
	l.luopiskjarj2014 = '' and l.ammopiskjarj2014 = ''   then ''
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen järjestjät, merkitään yliopistokoulutuksen järjestäjä 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskjarj2014  <> '' and l.yoopiskjarj2014   <> '' and
	l.luopiskjarj2014  = '' and l.ammopiskjarj2014  = ''  then l.yoopiskjarj2014  
	
	else ''
	    end),
-- Koulutuksen maakunta 2
	(case
	-- vain lukiokoulutuksen maakunta 2009, jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009   <> '' and l.ammopiskmaak2009  = '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2009, jätetään tyhjäksi   
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  = '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  ='' and l.yoopiskmaak2009  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta, merkitään ammatillisen koulutuksen maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2009  <> '' and l.ammopiskmaak2009  <> '' and
	l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  = '' then l.ammopiskmaak2009 
	-- vain ammattikorkeakoulutuksen maakunta 2009, jätetään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009   <> '' and l.yoopiskmaak2009   = '' and
	l.luopiskmaak2009 = '' and l.ammopiskmaak2009 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2009, merkitään tyhjäksi
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  = '' and l.yoopiskmaak2009  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2009 = ''   then '' 
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2009, merkitään yliopistokoulutuksen maakunta 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2009  <> '' and l.yoopiskmaak2009   <> '' and
	l.luopiskjarj2009  = '' and l.ammopiskmaak2009  = ''  then l.yoopiskmaak2009
	
	
	-- vain lukiokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010   <> '' and l.ammopiskmaak2010  = '' and
	l.amkopiskmaak2010  = '' and yoopiskmaak2010  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2010, merkitään tyhjäksi   
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  = '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  ='' and l.yoopiskmaak2010  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2010, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2010  <> '' and l.ammopiskmaak2010  <> '' and
	l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  = '' then l.ammopiskmaak2010 
	-- vain ammattikorkeakoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010   <> '' and l.yoopiskmaak2010   = '' and
	l.luopiskmaak2010 = '' and l.ammopiskmaak2010 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2010, merkitään tyhjäksi
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  = '' and l.yoopiskmaak2010  <> '' and 
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2010, merkitään yliopistokoulutuksen 2010 maakunta 
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2010  <> '' and l.yoopiskmaak2010   <> '' and
	l.luopiskmaak2010  = '' and l.ammopiskmaak2010  = ''  then l.yoopiskmaak2010  
	
	
	-- vain lukiokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011   <> '' and l.ammopiskmaak2011  = '' and
	l.amkopiskmaak2011  = '' and yoopiskmaak2011  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2011, merkitään tyhjäksi   
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  = '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2011, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2011  <> '' and l.ammopiskmaak2011  <> '' and
	l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  = '' then l.ammopiskmaak2011 
	-- vain ammattikorkeakoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011   <> '' and l.yoopiskmaak2011   = '' and
	l.luopiskmaak2011 = '' and l.ammopiskmaak2011 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2011, merkitään tyhjäksi
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  = '' and l.yoopiskmaak2011  <> '' and 
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2011, merkitään yliopistokoulutuksen 2010 maakunta 
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2011  <> '' and l.yoopiskmaak2011   <> '' and
	l.luopiskmaak2011  = '' and l.ammopiskmaak2011  = ''  then l.yoopiskmaak2011  
	
	-- vain lukiokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012   <> '' and l.ammopiskmaak2012  = '' and
	l.amkopiskmaak2012  = '' and yoopiskmaak2012  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2012, merkitään tyhjäksi   
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  = '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2012, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2012  <> '' and l.ammopiskmaak2012  <> '' and
	l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  = '' then l.ammopiskmaak2012 
	-- vain ammattikorkeakoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012   <> '' and l.yoopiskmaak2012   = '' and
	l.luopiskmaak2012 = '' and l.ammopiskmaak2012 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2012, merkitään tyhjäksi
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  = '' and l.yoopiskmaak2012  <> '' and 
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2012, merkitään yliopistokoulutuksen 2010 maakunta 
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2012  <> '' and l.yoopiskmaak2012   <> '' and
	l.luopiskmaak2012  = '' and l.ammopiskmaak2012  = ''  then l.yoopiskmaak2012  

	-- vain lukiokoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013   <> '' and l.ammopiskmaak2013  = '' and
	l.amkopiskmaak2013  = '' and yoopiskmaak2013  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2013, merkitään tyhjäksi   
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013  = '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2013, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2013  <> '' and l.ammopiskmaak2013  <> '' and
	l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  = '' then l.ammopiskmaak2013 
	-- vain ammattikorkeakoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013   <> '' and l.yoopiskmaak2013   = '' and
	l.luopiskmaak2013 = '' and l.ammopiskmaak2013 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2013, merkitään tyhjäksi
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013  = '' and l.yoopiskmaak2013  <> '' and 
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2013, merkitään yliopistokoulutuksen 2010 maakunta 
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2013  <> '' and l.yoopiskmaak2013   <> '' and
	l.luopiskmaak2013  = '' and l.ammopiskmaak2013  = ''  then l.yoopiskmaak2013  

	-- vain lukiokoulutuksen maakunta 2014, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014   <> '' and l.ammopiskmaak2014  = '' and
	l.amkopiskmaak2014  = '' and yoopiskmaak2014  = '' then ''
	-- vain ammatillisen koulutuksen maakunta 2014, merkitään tyhjäksi   
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014  = '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = ''  then ''  
	-- lukiokoulutuksen ja ammatillisen koulutuksen maakunta 2014, merkitään ammatillisen koulutuksen maakunta
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.luopiskmaak2014  <> '' and l.ammopiskmaak2014  <> '' and
	l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  = '' then l.ammopiskmaak2014 
	-- vain ammattikorkeakoulutuksen maakunta 2014, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014   <> '' and l.yoopiskmaak2014   = '' and
	l.luopiskmaak2014 = '' and l.ammopiskmaak2014 = '' then '' 
	-- vain yliopistokoulutuksen maakunta 2014, merkitään tyhjäksi
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014  = '' and l.yoopiskmaak2014  <> '' and 
	l.luopiskmaak2014  = '' and l.ammopiskmaak2014 = ''   then ''  
	-- ammattikorkeakoulutuksen ja yliopistokoulutuksen maakunta 2014, merkitään yliopistokoulutuksen 2010 maakunta 
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' and l.amkopiskmaak2014  <> '' and l.yoopiskmaak2014   <> '' and
	l.luopiskmaak2014  = '' and l.ammopiskmaak2014  = ''  then l.yoopiskmaak2014  
	
	else ''
	
	    end),
	-- Monihaku
	(case
	-- 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.monihaku2009
	--2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1'  then l.monihaku2010
	-- 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.monihaku2011
	-- 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.monihaku2012
		-- 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.monihaku2013
			-- 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.monihaku2014
	
	else '8'
	end),
    -- Pääasiallinen toiminta
    (case
    -- 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2009
	-- 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2010 
	-- 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2011
	-- 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2012
	-- 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2013
	-- 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.ptoim1r4_2014
   
   
	else ''
	end),
	-- Ammattiasema
	(case
	-- 2009
	when l.suorv = @ensimmainen_suoritusvuosi and l.suorlk = '1' then l.amas_2009
	-- 2010
	when l.suorv = @toinen_suoritusvuosi and l.suorlk = '1' then l.amas_2010
	-- 2011
	when l.suorv = @kolmas_suoritusvuosi and l.suorlk = '1' then l.amas_2011
	-- 2012
	when l.suorv = @neljas_suoritusvuosi and l.suorlk = '1' then l.amas_2012
	-- 2013
	when l.suorv = @viides_suoritusvuosi and l.suorlk = '1' then l.amas_2013
	-- 2014
	when l.suorv = @kuudes_suoritusvuosi and l.suorlk = '1' then l.amas_2014


	else ''
	end),
    l.lkm,
	l.pohjkoul,
 l.tietolahde,
 'K3.13',
 -- Lukiokoulutuksessa
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then '1'  
        when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then '1'  
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then '1'  
	
		else '0'
	    end) as lukiokoulutuksessa,
 -- Ammatillisessa koulutuksessa 
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2009  <> '' and l.luopiskkoulk2009 = '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2010 <> '' and l.luopiskkoulk2010  = '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'   
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2011 <> '' and l.luopiskkoulk2011  = '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1'    
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2012 <> '' and l.luopiskkoulk2012  = '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then '1'    
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2013 <> '' and l.luopiskkoulk2013  = '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then '1'    
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2014 <> '' and l.luopiskkoulk2014  = '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then '1'    
		else '0'
	    end) as ammatillisessa_koulutuksessa,
-- Ammattikorkeakoulutuksessa
 (case
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2009 <> '' and l.ammopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' then  '1'
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2010 <> '' and l.ammopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' then  '1'
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2011 <> '' and l.ammopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' then  '1'
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2012 <> '' and l.ammopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' then  '1'
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2013 <> '' and l.ammopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' and l.luopiskkoulk2013 = '' then  '1'
		 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2014 <> '' and l.ammopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' and l.luopiskkoulk2014 = '' then  '1'
	   else '0' 
	   end) as ammattikorkeakoulutuksessa,
-- Yliopistokoulutuksessa
 (case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2009  <> '' and l.amkopiskkoulk2009 = '' and l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011 = '' then '1'  	   
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012 = '' then '1'  	   
	     when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2013 <> '' and l.amkopiskkoulk2013 = '' and l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013 = '' then '1' 
		  when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.yoopiskkoulk2014 <> '' and l.amkopiskkoulk2014 = '' and l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014 = '' then '1' 
	    else '0'
	    end) as yliopistokoulutuksessa,
-- Lukiokoulutuksessa ja ammatillisessa koulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2009  <> '' and l.ammopiskkoulk2009 <> '' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009  = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2010 <> '' and l.ammopiskkoulk2010 <> '' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2011 <> '' and l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2012 <> '' and l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012 = '' then '1'  
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2013 <> '' and l.ammopiskkoulk2013 <> '' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013 = '' then '1'  
		 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.luopiskkoulk2014 <> '' and l.ammopiskkoulk2014 <> '' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014 = '' then '1'  
	    else '0'
	    end) as lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
-- Toisen asteen ammatillisessa koulutuksessa ja korkeakoulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2009  <> '' and l.amkopiskkoulk2009 <> '' and l.luopiskkoulk2009 = '' and l.yoopiskkoulk2009 = '' then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2010  <> '' and l.amkopiskkoulk2010 <> ''  and l.luopiskkoulk2010 = '' and l.yoopiskkoulk2010  = '' then '1' 
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2011 <> '' and l.amkopiskkoulk2011 <> ''  and l.luopiskkoulk2011 = '' and l.yoopiskkoulk2011  = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2012 <> '' and l.amkopiskkoulk2012 <> ''  and l.luopiskkoulk2012 = '' and l.yoopiskkoulk2012  = '' then '1'  
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2013 <> '' and l.amkopiskkoulk2013 <> ''  and l.luopiskkoulk2013 = '' and l.yoopiskkoulk2013  = '' then '1'  
		 when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ammopiskkoulk2014 <> '' and l.amkopiskkoulk2014 <> ''  and l.luopiskkoulk2014 = '' and l.yoopiskkoulk2014  = '' then '1'  
	    else '0'
	    end) as toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
-- Ammattikorkeakoulutuksessa ja yliopistokoulutuksessa
(case
	    when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.amkopiskkoulk2009  <> '' and l.yoopiskkoulk2009 <> '' and l.ammopiskkoulk2009  = '' and l.luopiskkoulk2009 = ''  then '1' 
	    when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2010 <> '' and l.yoopiskkoulk2010 <> ''  and l.ammopiskkoulk2010  = '' and l.luopiskkoulk2010 = '' then '1'  
	    when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2011 <> '' and l.yoopiskkoulk2011 <> ''  and l.ammopiskkoulk2011  = '' and l.luopiskkoulk2011 = '' then '1'  
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2012 <> '' and l.yoopiskkoulk2012 <> ''  and l.ammopiskkoulk2012  = '' and l.luopiskkoulk2012 = '' then '1'  
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2013 <> '' and l.yoopiskkoulk2013 <> ''  and l.ammopiskkoulk2013  = '' and l.luopiskkoulk2013 = '' then '1'  
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.amkopiskkoulk2014 <> '' and l.yoopiskkoulk2014 <> ''  and l.ammopiskkoulk2014  = '' and l.luopiskkoulk2014 = '' then '1'  
	    else '0'
	    end) as ammattikorkekoulutuksessa_ja_yliopistokoulutuksessa,    
-- Koulutuksen päättäneiden toiminta
(case
	   -- Tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')  and (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13') 
	   and (l.luopiskkoulk2009 <> '' or l.ammopiskkoulk2009<>'' or l.amkopiskkoulk2009 <> '' or l.yoopiskkoulk2009<>'') then '1' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010  = '13')
	   and (l.luopiskkoulk2010 <> '' or l.ammopiskkoulk2010<>'' or l.amkopiskkoulk2010 <> '' or l.yoopiskkoulk2010<>'') then '1' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
	   and (l.luopiskkoulk2011 <> '' or l.ammopiskkoulk2011<>'' or l.amkopiskkoulk2011 <> '' or l.yoopiskkoulk2011<>'') then '1' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13')
	   and (l.luopiskkoulk2012 <> '' or l.ammopiskkoulk2012<>'' or l.amkopiskkoulk2012 <> '' or l.yoopiskkoulk2012<>'') then '1' 
	   when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2013 = '22' or l.ptoim1r4_2013 = '13')
	   and (l.luopiskkoulk2013 <> '' or l.ammopiskkoulk2013<>'' or l.amkopiskkoulk2013 <> '' or l.yoopiskkoulk2013<>'') then '1' 
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2014 = '22' or l.ptoim1r4_2014 = '13')
	   and (l.luopiskkoulk2014 <> '' or l.ammopiskkoulk2014<>'' or l.amkopiskkoulk2014 <> '' or l.yoopiskkoulk2014<>'') then '1' 
	
    -- Ei tutkintoon johtavassa koulutuksessa olevat
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')  and (l.ptoim1r4_2009 = '22' or l.ptoim1r4_2009 = '13') 
	   and (l.luopiskkoulk2009 = '' and l.ammopiskkoulk2009='' and l.amkopiskkoulk2009 = '' and l.yoopiskkoulk2009='') then '2' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2010 = '22' or l.ptoim1r4_2010  = '13')
	   and (l.luopiskkoulk2010 = '' and l.ammopiskkoulk2010='' and l.amkopiskkoulk2010 = '' and l.yoopiskkoulk2010='')then '2' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2011 = '22' or l.ptoim1r4_2011 = '13')
	   and (l.luopiskkoulk2011 = '' and l.ammopiskkoulk2011='' and l.amkopiskkoulk2011 = '' and l.yoopiskkoulk2011='')then '2' 
	    when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2012 = '22' or l.ptoim1r4_2012 = '13')
	   and (l.luopiskkoulk2012 = '' and l.ammopiskkoulk2012='' and l.amkopiskkoulk2012 = '' and l.yoopiskkoulk2012='')then '2' 
	     when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2013 = '22' or l.ptoim1r4_2013 = '13')
	   and (l.luopiskkoulk2013 = '' and l.ammopiskkoulk2013='' and l.amkopiskkoulk2013 = '' and l.yoopiskkoulk2013='')then '2' 
	    when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  (l.ptoim1r4_2014 = '22' or l.ptoim1r4_2014 = '13')
	   and (l.luopiskkoulk2014 = '' and l.ammopiskkoulk2014='' and l.amkopiskkoulk2014 = '' and l.yoopiskkoulk2014='')then '2' 

	   -- Ei opiskelevat työlliset
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1')and  l.ptoim1r4_2009  = '10'  then '3' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2010 = '10'  then '3'  
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2011 = '10'  then '3' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2012 = '10'  then '3' 
	    when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2013 = '10'  then '3' 
		when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1' ) and  l.ptoim1r4_2014 = '10'  then '3' 
	    
	   -- Ei opiskelevat työttömät
	   when l.suorv = @ensimmainen_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2009  = '12'  then '4' 
	   when l.suorv = @toinen_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2010 = '12'  then '4' 
	   when l.suorv = @kolmas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2011 = '12'  then '4' 
	   when l.suorv = @neljas_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2012 = '12'  then '4' 
	when l.suorv = @viides_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2013 = '12'  then '4'
	when l.suorv = @kuudes_suoritusvuosi and (l.suorlk = '1') and  l.ptoim1r4_2014 = '12'  then '4'
	   -- Ei opiskelevat muut
		else '5' 
	   end ) as koulutuksen_paattaneiden_toiminta
    ,ika_1v = cast((case 
            when syntv = '' then '-1'
            when  (cast(tilv as int) - cast(syntv as int)) > 99 then ''
            else  ((cast(tilv as int) - cast(syntv as int))) end)  as nvarchar(10))
   ,ika_5v =cast(
       (
		case
		when (cast(tilv as int) - cast(syntv as int)) < 15 then '5v10'
		when ((cast(tilv as int) - cast(syntv as int)) >= 15 and (cast(tilv as int) - cast(syntv as int)) <= 19) then '5v15'
		when ((cast(tilv as int) - cast(syntv as int)) >= 20 and (cast(tilv as int) - cast(syntv as int)) <= 24) then '5v20'
		when ((cast(tilv as int) - cast(syntv as int)) >= 25 and (cast(tilv as int) - cast(syntv as int)) <= 29) then '5v25'
		when ((cast(tilv as int) - cast(syntv as int)) >= 30 and (cast(tilv as int) - cast(syntv as int)) <= 34) then '5v30'
		when ((cast(tilv as int) - cast(syntv as int)) >= 35 and (cast(tilv as int) - cast(syntv as int)) <= 39) then '5v35'
		when ((cast(tilv as int) - cast(syntv as int)) >= 40 and (cast(tilv as int) - cast(syntv as int)) <= 44) then '5v40'
		when ((cast(tilv as int) - cast(syntv as int)) >= 45 and (cast(tilv as int) - cast(syntv as int)) <= 49) then '5v45'
		when ((cast(tilv as int) - cast(syntv as int)) >= 50 and (cast(tilv as int) - cast(syntv as int)) <= 54) then '5v50'
		when ((cast(tilv as int) - cast(syntv as int)) >= 55 and (cast(tilv as int) - cast(syntv as int)) <= 59) then '5v55'
		when ((cast(tilv as int) - cast(syntv as int)) >= 60 and (cast(tilv as int) - cast(syntv as int)) <= 64) then '5v60'
		when ((cast(tilv as int) - cast(syntv as int)) >= 65 and (cast(tilv as int) - cast(syntv as int)) <= 69) then '5v65'
		when ((cast(tilv as int) - cast(syntv as int)) >= 70 and (cast(tilv as int) - cast(syntv as int)) <= 74) then '5v70'
		when ((cast(tilv as int) - cast(syntv as int)) >= 75 and (cast(tilv as int) - cast(syntv as int)) <= 79) then '5v75'
		when ((cast(tilv as int) - cast(syntv as int)) >= 80 and (cast(tilv as int) - cast(syntv as int)) <= 84) then '5v80'
		when ((cast(tilv as int) - cast(syntv as int)) >= 85 and (cast(tilv as int) - cast(syntv as int)) <= 89) then '5v85'
		when ((cast(tilv as int) - cast(syntv as int)) >= 90 and (cast(tilv as int) - cast(syntv as int)) <= 94) then '5v90'
		when ((cast(tilv as int) - cast(syntv as int)) >= 95) then '5v95'
		
		end
	   ) as nvarchar (10))
FROM 
    (
	select * from [VipunenTK_SA].[dbo].[v_K3_13_Perusk_paattaneet_amm_tutk_suorittaneet]
	where (suorv = '2004' or suorv = '2005' or suorv = '2006' or suorv= '2007' or suorv = '2008' or suorv = '2009' ) and suorlk = '1'
	) as l
	
	
	WHERE 1=1
end;

--
-- TULOS
-- 
if @debug_what_to_run>=3 begin
	if @debug_what_to_run>0 print 'querying result';
	select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v]
	--select COUNT(*) from vipunen_tk.f_tyol_ja_jatko_opin_ where aineisto=(select id from vipunen_tk.d_aineisto where aineistokoodi='4.3' and @toinen_suoritusvuosi between alkaa and paattyy)
end;

if @debug_what_to_run>0 PRINT 'all done.';

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_ensimmainen_laskenta]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_ensimmainen_laskenta]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_ensimmainen_laskenta] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_ensimmainen_laskenta] AS

TRUNCATE TABLE [VipunenTK_DW].[dbo].[_f_koulutukseen_sijoittuneet_6v_tarkastelu]

INSERT INTO [VipunenTK_DW].[dbo].[_f_koulutukseen_sijoittuneet_6v_tarkastelu]
(
aineistorivinumero,
tarkastelujakso,
tilv, 
tilv_date,
tutkryh,
suorv,
suorlk,
sp,
syntv,
aikielir1,
tutkkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
tunn,
jarj,
kkielir1,
tutklaja,
tutktav,
aikoul,
tutkmaak,
koulutus,
oppilaitos,
koulutuksen_jarjestaja,
koulutuksen_maakunta,
monihaku,
paaasiallinen_toiminta,
ammattiasema,
lkm,
pohjkoulk,
tietolahde,
aineisto,
lukiokoulutuksessa,
ammatillisessa_koulutuksessa,
ammattikorkeakoulutuksessa,
yliopistokoulutuksessa,
lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa,
koulutuksen_paattaneiden_toiminta,
rivinumero,
ika_1v,
ika_5v
)
SELECT
l.rivinumero,
l.tarkastelujakso,
l.tilv, 
l.tilv_date,
l.tutkryh,
l.suorv,
l.suorlk,
l.sp,
l.syntv,
l.aikielir1,
l.tutkkaskun,
l.kansalr1,
l.pohjmaa,
l.eumaa,
l.etamaa,
l.tunn,
l.jarj,
l.kkielir1,
l.tutklaja,
l.tutktav,
l.aikoul,
l.tutkmaak,
l.koulutus_1,--coalesce(nullif(l.koulutus_2,''),l.koulutus_1),
l.oppilaitos_1,--coalesce(nullif(l.oppilaitos_2,''),l.oppilaitos_1),
l.koulutuksen_jarjestaja_1,--coalesce(nullif(l.koulutuksen_jarjestaja_2,''),l.koulutuksen_jarjestaja_1),
l.koulutuksen_maakunta_1,--coalesce(nullif(l.koulutuksen_maakunta_2,''),l.koulutuksen_maakunta_1),
l.monihaku,
l.paaasiallinen_toiminta,
l.ammattiasema,
l.lkm,
l.pohjkoulk,
l.tietolahde,
l.aineisto,
l.lukiokoulutuksessa,
l.ammatillisessa_koulutuksessa,
l.ammattikorkeakoulutuksessa,
l.yliopistokoulutuksessa,
l.lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
l.toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
l.ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa,
l.koulutuksen_paattaneiden_toiminta,
ROW_NUMBER()OVER(ORDER BY l.tarkastelujakso),
l.ika_1v,
l.ika_5v
FROM 
		(
		select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]
		) as l

GO
/****** Object:  StoredProcedure [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_toinen_laskenta]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_toinen_laskenta]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_toinen_laskenta] AS' 
END
GO

ALTER PROCEDURE [dbo].[p_lataa_f_koulutukseen_sijoittuneet_6v_toinen_laskenta] AS
/* Yksi koulutus per henkilö joten tätä ei ajeta
INSERT INTO [VipunenTK_DW].[dbo].[_f_koulutukseen_sijoittuneet_6v_tarkastelu]
(
aineistorivinumero,
tarkastelujakso,
tilv, 
tilv_date,
tutkryh,
suorv,
suorlk,
sp,
syntv,
aikielir1,
tutkkaskun,
kansalr1,
pohjmaa,
eumaa,
etamaa,
tunn,
jarj,
kkielir1,
tutklaja,
tutktav,
aikoul,
tutkmaak,
koulutus,
oppilaitos,
koulutuksen_jarjestaja,
koulutuksen_maakunta,
monihaku,
paaasiallinen_toiminta,
ammattiasema,
lkm,
pohjkoulk,
tietolahde,
aineisto,
lukiokoulutuksessa,
ammatillisessa_koulutuksessa,
ammattikorkeakoulutuksessa,
yliopistokoulutuksessa,
lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa,
koulutuksen_paattaneiden_toiminta,
rivinumero,
ika_1v,
ika_5v
)
SELECT
l.rivinumero,
l.tarkastelujakso,
l.tilv, 
l.tilv_date,
l.tutkryh,
l.suorv,
l.suorlk,
l.sp,
l.syntv,
l.aikielir1,
l.tutkkaskun,
l.kansalr1,
l.pohjmaa,
l.eumaa,
l.etamaa,
l.tunn,
l.jarj,
l.kkielir1,
l.tutklaja,
l.tutktav,
l.aikoul,
l.tutkmaak,
l.koulutus_2,
l.oppilaitos_2,
l.koulutuksen_jarjestaja_2,
l.koulutuksen_maakunta_2,
l.monihaku,
l.paaasiallinen_toiminta,
l.ammattiasema,
l.lkm,
l.pohjkoulk,
l.tietolahde,
l.aineisto,
l.lukiokoulutuksessa,
l.ammatillisessa_koulutuksessa,
l.ammattikorkeakoulutuksessa,
l.yliopistokoulutuksessa,
l.lukiokoulutuksessa_ja_ammatillisessa_koulutuksessa,
l.toisen_asteen_ammatillisessa_koulutuksessa_ja_korkeakoulutuksessa,
l.ammattikorkeakoulutuksessa_ja_yliopistokoulutuksessa,
l.koulutuksen_paattaneiden_toiminta,
(select rivinumero from [VipunenTK_DW].[dbo].[_f_koulutukseen_sijoittuneet_6v_tarkastelu]
 where (aineistorivinumero = l.rivinumero )and (tarkastelujakso = l.tarkastelujakso) and (tilv = l.tilv) and  (suorv = l.suorv) and (suorlk = l.suorlk)),
l.ika_1v,
l.ika_5v
FROM 
		(
		select * from [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu]  where (koulutus_1 <> '') and (koulutus_2 <> '')
		) as l  where (koulutus_1 <> '') and (koulutus_2 <> '')

*/
GO
/****** Object:  StoredProcedure [dbo].[p_lataa_koulutukseen_sijoittuneet_2v]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_koulutukseen_sijoittuneet_2v]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_koulutukseen_sijoittuneet_2v] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_koulutukseen_sijoittuneet_2v] AS

TRUNCATE TABLE [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_2v_tarkastelu];

EXEC [VipunenTK_SA].[dbo].p_lataa_f_koulutukseen_sijoittuneet_2v_0__valittomasti__tarkastelujakso;
EXEC [VipunenTK_SA].[dbo].p_lataa_f_koulutukseen_sijoittuneet_2v_0_5_tarkastelujakso;
EXEC [VipunenTK_SA].[dbo].p_lataa_f_koulutukseen_sijoittuneet_2v_1_tarkastelujakso;
EXEC [VipunenTK_SA].[dbo].p_lataa_f_koulutukseen_sijoittuneet_2v_ensimmainen_laskenta;


GO
/****** Object:  StoredProcedure [dbo].[p_lataa_koulutukseen_sijoittuneet_6v]    Script Date: 21.6.2017 13:03:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[p_lataa_koulutukseen_sijoittuneet_6v]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[p_lataa_koulutukseen_sijoittuneet_6v] AS' 
END
GO
ALTER PROCEDURE [dbo].[p_lataa_koulutukseen_sijoittuneet_6v] AS

TRUNCATE TABLE [VipunenTK_DW].[dbo].[_koulutukseen_sijoittuneet_6v_tarkastelu];

EXEC [VipunenTK_SA].[dbo].p_lataa_f_koulutukseen_sijoittuneet_6v_0_valittomasti_tarkastelujakso;
EXEC [VipunenTK_SA].[dbo].p_lataa_f_koulutukseen_sijoittuneet_6v_0_5_tarkastelujakso;
EXEC [VipunenTK_SA].[dbo].p_lataa_f_koulutukseen_sijoittuneet_6v_1_tarkastelujakso;
EXEC [VipunenTK_SA].[dbo].p_lataa_f_koulutukseen_sijoittuneet_6v_1_5_tarkastelujakso;

EXEC [VipunenTK_SA].[dbo].p_lataa_f_koulutukseen_sijoittuneet_6v_2_0_tarkastelujakso;
EXEC [VipunenTK_SA].[dbo].p_lataa_f_koulutukseen_sijoittuneet_6v_2_5_tarkastelujakso;
EXEC [VipunenTK_SA].[dbo].p_lataa_f_koulutukseen_sijoittuneet_6v_3_0_tarkastelujakso;
EXEC [VipunenTK_SA].[dbo].p_lataa_f_koulutukseen_sijoittuneet_6v_3_5_tarkastelujakso;

EXEC [VipunenTK_SA].[dbo].p_lataa_f_koulutukseen_sijoittuneet_6v_4_0_tarkastelujakso;
EXEC [VipunenTK_SA].[dbo].p_lataa_f_koulutukseen_sijoittuneet_6v_4_5_tarkastelujakso;
EXEC [VipunenTK_SA].[dbo].p_lataa_f_koulutukseen_sijoittuneet_6v_5_0_tarkastelujakso;

EXEC [VipunenTK_SA].[dbo].p_lataa_f_koulutukseen_sijoittuneet_6v_ensimmainen_laskenta;


GO

USE [ANTERO]