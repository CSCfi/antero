USE [VipunenTK_DW]
GO

/****** Object:  View [dbo].[v_f_Ainevalinnat_R2_22_Oppilaitostason_oppil_ja_opisk]    Script Date: 12.12.2019 9:26:11 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER VIEW [dbo].[v_f_Ainevalinnat_R2_22_Oppilaitostason_oppil_ja_opisk] AS
--Select * from [v_f_Ainevalinnat_R2_22_Oppilaitostason_oppil_ja_opisk]


/*
Truncate table VipunenTK_DW.dbo.f_Ainevalinnat_R2_22_Oppilaitostason_oppil_ja_opisk
Insert into VipunenTK_DW.dbo.f_Ainevalinnat_R2_22_Oppilaitostason_oppil_ja_opisk
Select * from [v_f_Ainevalinnat_R2_22_Oppilaitostason_oppil_ja_opisk]
--Drop table VipunenTK_DW.dbo.f_Ainevalinnat_R2_22_Oppilaitostason_oppil_ja_opisk
--Select * into VipunenTK_DW.dbo.f_Ainevalinnat_R2_22_Oppilaitostason_oppil_ja_opisk from [v_f_Ainevalinnat_R2_22_Oppilaitostason_oppil_ja_opisk]
*/

Select 
			[tilv]
           ,[jarj]
           ,[tiedtype]
           ,[tunn]
           ,[edesi]
           ,[edala]
           ,[edyla]
           ,[edlisa]
           ,[edainep]
           ,[syesi]
           ,[syala]
           ,[syyla]
           ,[sylisa]
           ,[symamu]
           ,[sylukio]
           ,[syamm]
           ,[symuu]
           ,[aku]
           ,[kaytto]
           ,[tietolahde]
           ,[rivinumero]
           ,[lkm_arvo]
           ,[lkm_id]
           ,[tilv_date]
from
(Select 
tilv, tilv_date, jarj, tiedtype, tunn, edesi, edala, edyla, edlisa, edainep, syesi, syala, syyla, sylisa, symamu, sylukio, syamm, symuu, keven, kev1, kev1n, kev2, kev2n, kev3, kev3n, kev4, kev4n, kev5, kev5n, kev6, kev6n, kev7, kev7n, kev8, kev8n, kev9, kev9n, kev10, kev10n, kev, kevn, luok1, luok1n, luok2, luok2n, luok3, luok3n, luok4, luok4n, luok5, luok5n, luok6, luok6n, luok7, luok7n, luok8, luok8n, luok9, luok9n, luok, luokn, kelaim, kelaimn, tod, todn, tutkt, tutktn, suor10, suor10n, oeriy, oeriyn, ilmtod, ilmtodn, aku, mamukurs, oppkurs, muukurs, akukurs, kmamu, kmamun, syulkom, syulkomn, sykoti, sykotin, ika4e, ika4en, ika5e, ika5en, pid5v, ika6e, ika6en, ika7e, ika7en, ikae, ikaen, ove, ov1, ov2, ov3, ov4, ov5, ov6, ov7, ov8, ov9, ov10, ovy, tehoe, teho1, teho2, teho3, teho4, teho5, teho6, teho7, teho8, teho9, teho10, tehoy, eipide, eipid1, eipid2, eipid3, eipid4, eipid5, eipid6, eipid7, eipid8, eipid9, eipid10, eipidy, ertuve, ertuv1, ertuv2, ertuv3, ertuv4, ertuv5, ertuv6, ertuv7, ertuv8, ertuv9, ertuv10, ertuvy, ertume, ertum1, ertum2, ertum3, ertum4, ertum5, ertum6, ertum7, ertum8, ertum9, ertum10, ertumy, tavove, tavov1, tavov2, tavov3, tavov4, tavov5, tavov6, tavov7, tavov8, tavov9, tavov10, tavovy, oven, ov1n, ov2n, ov3n, ov4n, ov5n, ov6n, ov7n, ov8n, ov9n, ov10n, ovyn, tehoen, teho1n, teho2n, teho3n, teho4n, teho5n, teho6n, teho7n, teho8n, teho9n, teho10n, tehoyn, eipiden, eipid1n, eipid2n, eipid3n, eipid4n, eipid5n, eipid6n, eipid7n, eipid8n, eipid9n, eipid10n, eipidyn, ertuven, ertuv1n, ertuv2n, ertuv3n, ertuv4n, ertuv5n, ertuv6n, ertuv7n, ertuv8n, ertuv9n, ertuv10n, ertuvyn, ertumen, ertum1n, ertum2n, ertum3n, ertum4n, ertum5n, ertum6n, ertum7n, ertum8n, ertum9n, ertum10n, ertumyn, tavoven, tavov1n, tavov2n, tavov3n, tavov4n, tavov5n, tavov6n, tavov7n, tavov8n, tavov9n, tavov10n, tavovyn, eipidec, eipidpc, eipidlc, eipidyc, ertuvec, ertuvpc, ertuvlc, ertuvyc, ertumec, ertumpc, ertumlc, ertumyc, muuec, muupc, muulc, muuyc, ovec, ovpc, ovlc, ovyc, sisae, sisap, sisal, sisam, sisay, maeipide, maeipidp, maeipidl, maeipidy, maertuve, maertuvp, maertuvl, maertuvy, maertume, maertump, maertuml, maertumy, mamuue, mamuup, mamuul, mamuuy, maove, maovp, maovl, maovy, kueipide, kueipidp, kueipidl, kueipidy, kuertuve, kuertuvp, kuertuvl, kuertuvy, kuertume, kuertump, kuertuml, kuertumy, kumuue, kumuup, kumuul, kumuuy, kuove, kuovp, kuovl, kuovy, vieipide, vieipidp, vieipidl, vieipidy, viertuve, viertuvp, viertuvl, viertuvy, viertume, viertump, viertuml, viertumy, vimuue, vimuup, vimuul, vimuuy, viove, viovp, viovl, viovy, ika61, ika61n, ika71, ika71n, ika81, ika81n, ika91, ika91n, ika1, ika1n, lykk, lykkn, jopo, jopon, kan17v, muu17v, op17v, lukoko, lukokon, luib, luibn, reife, reifen, gymn, gymnn, lueb, luebn, lukio, lukion, opsamm, opsammn, muuamm, muuammn, amm, ammn, peain, peainn, luain, luainn, vapsiv, vapsivn, taiop, taiopn, muukoul, muukouln, muuop, muuopn, tehoec, teho16c, teho79c, teholc, tehoyc, ertuec, ertu16c, ertu79c, ertulc, ertuyc, eritec, erit16c, erit79c, eritlc, erityc, inte4, int164, int794, intl4, inty4, inte3, int163, int793, intl3, inty3, inte2, int162, int792, intl2, inty2, inte1, int161, int791, intl1, inty1, inte0, int160, int790, intl0, inty0, intey, int16y, int79y, intly, intyy, yks160, yks790, yksl0, yksy0, yks161, yks791, yksl1, yksy1, yks162, yks792, yksl2, yksy2, yks164, yks794, yksl4, yksy4, yks16t, yks79t, ykslt, yksyt, yks16y, yks79y, yksly, yksyy, tehoosa, ertuosa, eritosa, tehotuki, ertutuki, erittuki, tehoavu, ertuavu, eritavu, tehomuu, ertumuu, eritmuu, alc, ylc, luc, amc, alkieli0, alkieli1, alkieli2, alkieli3, alkieli4, alkieliy, ylkieli0, ylkieli1, ylkieli2, ylkieli3, ylkieli4, ylkieli5, ylkieliy, lukieli0, lukieli1, lukieli2, lukieli3, lukieli4, lukieli5, lukieli6, lukieliy, amkieli0, amkieli1, amkieli2, amkieli3, amkieli4, amkieli5, amkieli6, amkieliy, aleny, alruy, alsuy, alray, alsay, alvey, alesy, ality, alsaay, almuy, yleny, ylruy, ylsuy, ylray, ylsay, ylvey, ylesy, ylity, ylsaay, yllaty, ylmuy, lueny, luruy, lusuy, luray, lusay, luvey, luesy, luity, lusaay, lulaty, lumuy, ameny, amruy, amsuy, amray, amsay, amvey, amesy, amity, amsaay, amlaty, ammuy, ov1c, ov2c, ov3c, ov4c, ov5c, ov6c, ov16yc, ov16nc, eng1, ru1, su1, ra1, sa1, ve1, es1, it1, saa1, mu1, eopis1, eng2, ru2, su2, ra2, sa2, ve2, es2, it2, saa2, mu2, eopis2, eng3, ru3, su3, ra3, sa3, ve3, es3, it3, saa3, mu3, eopis3, eng4, ru4, su4, ra4, sa4, ve4, es4, it4, saa4, mu4, eopis4, eng5, ru5, su5, ra5, sa5, ve5, es5, it5, saa5, mu5, eopis5, eng6, ru6, su6, ra6, sa6, ve6, es6, it6, saa6, mu6, eopis6, eny, ruy, suy, ray, say, vey, esy, ity, saay, muy, eopisy, enn, run, sun, ran, san, ven, esn, itn, saan, mun, eopisn, ven1, vru1, vsu1, vra1, vsa1, vve1, ves1, vit1, vsaa1, vmu1, vyht1, ven2, vru2, vsu2, vra2, vsa2, vve2, ves2, vit2, vsaa2, vmu2, vyht2, ven3, vru3, vsu3, vra3, vsa3, vve3, ves3, vit3, vsaa3, vmu3, vyht3, ven4, vru4, vsu4, vra4, vsa4, vve4, ves4, vit4, vsaa4, vmu4, vyht4, ven5, vru5, vsu5, vra5, vsa5, vve5, ves5, vit5, vsaa5, vmu5, vyht5, ven6, vru6, vsu6, vra6, vsa6, vve6, ves6, vit6, vsaa6, vmu6, vyht6, veny, vruy, vsuy, vray, vsay, vvey, vesy, vity, vsaay, vmuy, vyht, venn, vrun, vsun, vran, vsan, vven, vesn, vitn, vsaan, vmun, vtyt, ov79yc, ov79nc, yaen1, yaru1, yasu1, yara1, yasa1, yave1, yaes1, yait1, yasaa1, yalat1, yamuu1, yaen2, yaru2, yasu2, yara2, yasa2, yave2, yaes2, yait2, yasaa2, yalat2, yamuu2, yyen, yyru, yysu, yyra, yysa, yen, yru, ysu, yra, ysa, yve, yes, yit, ysaa, ylat, ymuu, enyy, ruyy, suyy, rayy, sayy, veyy, esyy, ityy, saayy, layy, muyy, yaen1n, yaru1n, yasu1n, yara1n, yasa1n, yave1n, yaes1n, yait1n, yasaa1n, yalat1n, yamuu1n, yaen2n, yaru2n, yasu2n, yara2n, yasa2n, yave2n, yaes2n, yait2n, yasaa2n, yalat2n, yamuu2n, yyenn, yyrun, yysun, yyran, yysan, yenn, yrun, ysun, yran, ysan, yven, yesn, yitn, ysaan, ylatn, ymuun, ennn, runn, sunn, rann, sann, vennn, esnn, itnn, saann, lann, munn, asv, arv, asvrv, ysv, yrv, ysvrv, sv, rv, svrv, aev, aort, aisl, amu, aet, aeos, akay, yev, yort, yisl, ymu, yet, yeos, ykay, ev, ort, isl, mu, et, eos, kay, ov89yc, ov89nc, ai, rsb, ma, yl, bi, ge, fy, ke, ter, ue, eti, hi, yh, mus, ku, tt, ts, ks, li, ko, yhd, ain, rsbn, man, yln, bin, gen, fyn, ken, tern, uen, etin, hin, yhn, musn, kun, ttn, tsn, ksn, lin, kon, yhdn, tietop, tietok, tietoi, verkko, kaytto, tietolahde, rivinumero
from dbo.f_R2_22_Oppilaitostason_oppil_ja_opisk
) p
  UNPIVOT 
   (lkm_arvo FOR lkm_id IN 
      (
      --tilv, tilv_date, jarj, tiedtype, tunn, edesi, edala, edyla, edlisa, edainep, syesi, syala, syyla, sylisa, symamu, sylukio, syamm, symuu, 
      keven, kev1, kev1n, kev2, kev2n, kev3, kev3n, kev4, kev4n, kev5, kev5n, kev6, kev6n, kev7, kev7n, kev8, kev8n, kev9, kev9n, kev10, kev10n, kev, kevn, luok1, luok1n, luok2, luok2n, luok3, luok3n, luok4, luok4n, luok5, luok5n, luok6, luok6n, luok7, luok7n, luok8, luok8n, luok9, luok9n, luok, luokn, kelaim, kelaimn, tod, todn, tutkt, tutktn, suor10, suor10n, oeriy, oeriyn, ilmtod, ilmtodn
      --, aku
      , mamukurs, oppkurs, muukurs, akukurs, kmamu, kmamun, syulkom, syulkomn, sykoti, sykotin, ika4e, ika4en, ika5e, ika5en, pid5v, ika6e, ika6en, ika7e, ika7en, ikae, ikaen, ove, ov1, ov2, ov3, ov4, ov5, ov6, ov7, ov8, ov9, ov10, ovy, tehoe, teho1, teho2, teho3, teho4, teho5, teho6, teho7, teho8, teho9, teho10, tehoy, eipide, eipid1, eipid2, eipid3, eipid4, eipid5, eipid6, eipid7, eipid8, eipid9, eipid10, eipidy, ertuve, ertuv1, ertuv2, ertuv3, ertuv4, ertuv5, ertuv6, ertuv7, ertuv8, ertuv9, ertuv10, ertuvy, ertume, ertum1, ertum2, ertum3, ertum4, ertum5, ertum6, ertum7, ertum8, ertum9, ertum10, ertumy, tavove, tavov1, tavov2, tavov3, tavov4, tavov5, tavov6, tavov7, tavov8, tavov9, tavov10, tavovy, oven, ov1n, ov2n, ov3n, ov4n, ov5n, ov6n, ov7n, ov8n, ov9n, ov10n, ovyn, tehoen, teho1n, teho2n, teho3n, teho4n, teho5n, teho6n, teho7n, teho8n, teho9n, teho10n, tehoyn, eipiden, eipid1n, eipid2n, eipid3n, eipid4n, eipid5n, eipid6n, eipid7n, eipid8n, eipid9n, eipid10n, eipidyn, ertuven, ertuv1n, ertuv2n, ertuv3n, ertuv4n, ertuv5n, ertuv6n, ertuv7n, ertuv8n, ertuv9n, ertuv10n, ertuvyn, ertumen, ertum1n, ertum2n, ertum3n, ertum4n, ertum5n, ertum6n, ertum7n, ertum8n, ertum9n, ertum10n, ertumyn, tavoven, tavov1n, tavov2n, tavov3n, tavov4n, tavov5n, tavov6n, tavov7n, tavov8n, tavov9n, tavov10n, tavovyn, eipidec, eipidpc, eipidlc, eipidyc, ertuvec, ertuvpc, ertuvlc, ertuvyc, ertumec, ertumpc, ertumlc, ertumyc, muuec, muupc, muulc, muuyc, ovec, ovpc, ovlc, ovyc, sisae, sisap, sisal, sisam, sisay, maeipide, maeipidp, maeipidl, maeipidy, maertuve, maertuvp, maertuvl, maertuvy, maertume, maertump, maertuml, maertumy, mamuue, mamuup, mamuul, mamuuy, maove, maovp, maovl, maovy, kueipide, kueipidp, kueipidl, kueipidy, kuertuve, kuertuvp, kuertuvl, kuertuvy, kuertume, kuertump, kuertuml, kuertumy, kumuue, kumuup, kumuul, kumuuy, kuove, kuovp, kuovl, kuovy, vieipide, vieipidp, vieipidl, vieipidy, viertuve, viertuvp, viertuvl, viertuvy, viertume, viertump, viertuml, viertumy, vimuue, vimuup, vimuul, vimuuy, viove, viovp, viovl, viovy, ika61, ika61n, ika71, ika71n, ika81, ika81n, ika91, ika91n, ika1, ika1n, lykk, lykkn, jopo, jopon, kan17v, muu17v, op17v, lukoko, lukokon, luib, luibn, reife, reifen, gymn, gymnn, lueb, luebn, lukio, lukion, opsamm, opsammn, muuamm, muuammn, amm, ammn, peain, peainn, luain, luainn, vapsiv, vapsivn, taiop, taiopn, muukoul, muukouln, muuop, muuopn, tehoec, teho16c, teho79c, teholc, tehoyc, ertuec, ertu16c, ertu79c, ertulc, ertuyc, eritec, erit16c, erit79c, eritlc, erityc, inte4, int164, int794, intl4, inty4, inte3, int163, int793, intl3, inty3, inte2, int162, int792, intl2, inty2, inte1, int161, int791, intl1, inty1, inte0, int160, int790, intl0, inty0, intey, int16y, int79y, intly, intyy, yks160, yks790, yksl0, yksy0, yks161, yks791, yksl1, yksy1, yks162, yks792, yksl2, yksy2, yks164, yks794, yksl4, yksy4, yks16t, yks79t, ykslt, yksyt, yks16y, yks79y, yksly, yksyy, tehoosa, ertuosa, eritosa, tehotuki, ertutuki, erittuki, tehoavu, ertuavu, eritavu, tehomuu, ertumuu, eritmuu, alc, ylc, luc, amc, alkieli0, alkieli1, alkieli2, alkieli3, alkieli4, alkieliy, ylkieli0, ylkieli1, ylkieli2, ylkieli3, ylkieli4, ylkieli5, ylkieliy, lukieli0, lukieli1, lukieli2, lukieli3, lukieli4, lukieli5, lukieli6, lukieliy, amkieli0, amkieli1, amkieli2, amkieli3, amkieli4, amkieli5, amkieli6, amkieliy, aleny, alruy, alsuy, alray, alsay, alvey, alesy, ality, alsaay, almuy, yleny, ylruy, ylsuy, ylray, ylsay, ylvey, ylesy, ylity, ylsaay, yllaty, ylmuy, lueny, luruy, lusuy, luray, lusay, luvey, luesy, luity, lusaay, lulaty, lumuy, ameny, amruy, amsuy, amray, amsay, amvey, amesy, amity, amsaay, amlaty, ammuy, ov1c, ov2c, ov3c, ov4c, ov5c, ov6c, ov16yc, ov16nc, eng1, ru1, su1, ra1, sa1, ve1, es1, it1, saa1, mu1, eopis1, eng2, ru2, su2, ra2, sa2, ve2, es2, it2, saa2, mu2, eopis2, eng3, ru3, su3, ra3, sa3, ve3, es3, it3, saa3, mu3, eopis3, eng4, ru4, su4, ra4, sa4, ve4, es4, it4, saa4, mu4, eopis4, eng5, ru5, su5, ra5, sa5, ve5, es5, it5, saa5, mu5, eopis5, eng6, ru6, su6, ra6, sa6, ve6, es6, it6, saa6, mu6, eopis6, eny, ruy, suy, ray, say, vey, esy, ity, saay, muy, eopisy, enn, run, sun, ran, san, ven, esn, itn, saan, mun, eopisn, ven1, vru1, vsu1, vra1, vsa1, vve1, ves1, vit1, vsaa1, vmu1, vyht1, ven2, vru2, vsu2, vra2, vsa2, vve2, ves2, vit2, vsaa2, vmu2, vyht2, ven3, vru3, vsu3, vra3, vsa3, vve3, ves3, vit3, vsaa3, vmu3, vyht3, ven4, vru4, vsu4, vra4, vsa4, vve4, ves4, vit4, vsaa4, vmu4, vyht4, ven5, vru5, vsu5, vra5, vsa5, vve5, ves5, vit5, vsaa5, vmu5, vyht5, ven6, vru6, vsu6, vra6, vsa6, vve6, ves6, vit6, vsaa6, vmu6, vyht6, veny, vruy, vsuy, vray, vsay, vvey, vesy, vity, vsaay, vmuy, vyht, venn, vrun, vsun, vran, vsan, vven, vesn, vitn, vsaan, vmun, vtyt, ov79yc, ov79nc, yaen1, yaru1, yasu1, yara1, yasa1, yave1, yaes1, yait1, yasaa1, yalat1, yamuu1, yaen2, yaru2, yasu2, yara2, yasa2, yave2, yaes2, yait2, yasaa2, yalat2, yamuu2, yyen, yyru, yysu, yyra, yysa, yen, yru, ysu, yra, ysa, yve, yes, yit, ysaa, ylat, ymuu, enyy, ruyy, suyy, rayy, sayy, veyy, esyy, ityy, saayy, layy, muyy, yaen1n, yaru1n, yasu1n, yara1n, yasa1n, yave1n, yaes1n, yait1n, yasaa1n, yalat1n, yamuu1n, yaen2n, yaru2n, yasu2n, yara2n, yasa2n, yave2n, yaes2n, yait2n, yasaa2n, yalat2n, yamuu2n, yyenn, yyrun, yysun, yyran, yysan, yenn, yrun, ysun, yran, ysan, yven, yesn, yitn, ysaan, ylatn, ymuun, ennn, runn, sunn, rann, sann, vennn, esnn, itnn, saann, lann, munn, asv, arv, asvrv, ysv, yrv, ysvrv, sv, rv, svrv, aev, aort, aisl, amu, aet, aeos, akay, yev, yort, yisl, ymu, yet, yeos, ykay, ev, ort, isl, mu, et, eos, kay, ov89yc, ov89nc, ai, rsb, ma, yl, bi, ge, fy, ke, ter, ue, eti, hi, yh, mus, ku, tt, ts, ks, li, ko, yhd, ain, rsbn, man, yln, bin, gen, fyn, ken, tern, uen, etin, hin, yhn, musn, kun, ttn, tsn, ksn, lin, kon, yhdn, tietop, tietok, tietoi, verkko
      --, kaytto, tietolahde, rivinumero
  )  ) AS unpvt
  where lkm_arvo is not null and lkm_arvo <> 0

GO


USE [ANTERO]